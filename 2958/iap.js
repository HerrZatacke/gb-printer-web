"use strict";(self.webpackChunkgb_printer_web=self.webpackChunkgb_printer_web||[]).push([[503],{54:function(e,t,F){F.d(t,{N:function(){return a}});var a,r=F(1511),n=F(7134),s=F(4353),i=F.n(s),o=F(4704),l=F(3299),c=F(7261),A=F(7372);!function(e){e.ADD="add",e.REMOVE="remove"}(a||(a={}));const m=(0,r.v)((0,n.Zr)(((e,t)=>({filtersActiveTags:[],filtersVisible:!1,imageSelection:[],lastSelectedImage:null,recentImports:[],sortBy:"created_asc",sortOptionsVisible:!1,setFiltersActiveTags:t=>e({filtersActiveTags:t,filtersVisible:!1}),setFiltersVisible:t=>e({filtersVisible:t}),setImageSelection:t=>e({imageSelection:t,lastSelectedImage:null}),setSortBy:t=>e({sortBy:t,sortOptionsVisible:!1}),setSortOptionsVisible:t=>e({sortOptionsVisible:t}),cleanRecentImports:F=>{const{recentImports:a}=t(),r=i()().subtract(6,"hour").unix();e({recentImports:a.filter((({hash:e,timestamp:t})=>F.includes(e)&&t>r))})},updateRecentImports:F=>{const a=t().recentImports,r=F.reduce(((e,t)=>(0,c.pl)(t)?e:[...e,{hash:t.hash,timestamp:i()().unix()}]),[]);e({recentImports:(0,l.A)("hash")([...a,...r])})},updateImageSelection:(F,r)=>{const n=t().imageSelection;switch(F){case a.ADD:e({imageSelection:(0,A.A)([...n,...r]),lastSelectedImage:r[0]});break;case a.REMOVE:e({imageSelection:n.filter((e=>!r.includes(e))),lastSelectedImage:null})}}})),{name:`${o.z}-filters`,storage:(0,n.KU)((()=>localStorage))}));t.A=m},521:function(e,t,F){F.d(t,{cg:function(){return o},yH:function(){return A},t9:function(){return m},Hh:function(){return c},UN:function(){return l}});var a=F(6362);var r=e=>{const t=`\nThe following hash is missing in\nyour indexedDb:\n${e}\n\nEither you imported a debug dump\nor your browser decided to do a\ncleanup.\n\nThis image might be able to be\nrecovered if you have set up git\nor dropbox sync.\n`.trim();return(0,a.A)(t)},n=F(894),s=F(2419),i=F(6750);const o=async e=>{const{default:t}=await F.e(802).then(F.t.bind(F,4802,23)),a=e.map((e=>e.replace(/ /gi,"").toUpperCase())).join("\n"),r=await(0,i.K)(a);return{dataHash:t(r),compressed:r}},l=async e=>{const{dataHash:t,compressed:F}=await o(e);return await s.mU.setItem(t,F),t},c=async(e,t,F,a)=>{if(!e)return null;try{const F=await s.mU.getItem(e);if(!F)throw new Error("missing imagedata");const a=(await(0,i.U)(F)).split("\n");return t?(0,n.A)(a,t):a}catch(t){return"function"==typeof a&&a(e),F?[]:r(e)}},A=async e=>s.mU.removeItem(e),m=async e=>s.Uv.removeItem(e)},894:function(e,t,F){var a=F(784),r=F(8222),n=F(6763);t.A=async(e,t)=>{if(360!==e.length)return e;const F=await(0,r.mZ)(t);if(!F)return e;if(14!==F.left.length||14!==F.right.length)return n.error("Invalid frameData"),e;const s=e.reduce(((e,t,F)=>(0,a.o1)(F,2)?e:[...e,t]),[]),i=[...F.upper];for(let e=0;e<14;e+=1)i.push(...F.left[e],...s.slice(16*e,16*(e+1)),...F.right[e]);return i.push(...F.lower),i}},2317:function(e,t,F){var a=F(4353),r=F.n(a),n=F(521),s=F(498);t.A=async({lines:e,filename:t,palette:F,frame:a,tags:i=[],meta:o,created:l=r()().format(s.i$)})=>({hash:await(0,n.UN)(e),created:l,title:t||"",lines:e.length,tags:i,palette:F,framePalette:F,invertFramePalette:!1,invertPalette:!1,frame:a,meta:o})},2625:function(e,t,F){F.d(t,{default:function(){return g}});var a=F(6540),r=F(5338),n=F(54),s=F(2813);var i=F(4353),o=F.n(i),l=F(2317),c=F(8438),A=F(498),m=F(6763);const p=()=>new Array(20).fill("").map((()=>Math.floor(256*Math.random()).toString(16).padStart(2,"0"))).join(" "),u=async e=>{const t=Date.now(),F=new Array(20*18).fill("").map(p);const a=await(0,l.A)({lines:(0,c.A)(F),filename:`${e.toString(10).padStart(6,"0")} - ${t.toString(16)}`,palette:"bw",frame:"int14",tags:["debug","dummy"],created:o()(t).format(A.i$),meta:{}}),r=Date.now()-t;return await new Promise((t=>{m.log(e,r),window.requestAnimationFrame(t)})),{image:a,elapsed:r}};var g=async()=>{const e=document.getElementById("app");if(!e)return;if((()=>{const e=localStorage.getItem("gbp-web-state");if(localStorage.removeItem("gbp-web-state"),e){let t;try{t=JSON.parse(e)}catch{return!1}const F={version:0,state:{frameGroupNames:t.frameGroupNames||[],frames:t.frames||[],images:t.images||[],imageGroups:t.imageGroups||[],palettes:t.palettes||[],plugins:t.plugins||[]}};localStorage.setItem("gbp-z-web-items",JSON.stringify(F));const a={version:0,state:{activePalette:t.activePalette||"bw",enableDebug:t.enableDebug||!1,enableImageGroups:t.enableImageGroups||!1,exportFileTypes:t.exportFileTypes||["png"],exportScaleFactors:t.exportScaleFactors||[4],forceMagicCheck:t.forceMagicCheck||!1,galleryView:t.galleryView||"1x",handleExportFrame:t.handleExportFrame||"keep",hideDates:t.hideDates||!1,importDeleted:"boolean"!=typeof t.importDeleted||t.importDeleted,importLastSeen:"boolean"!=typeof t.importLastSeen||t.importLastSeen,importPad:t.importPad||!1,pageSize:"number"==typeof t.pageSize?t.pageSize:60,preferredLocale:t.preferredLocale||"en-GB",printerParams:t.printerParams||"",printerUrl:t.printerUrl||"",savFrameTypes:t.savFrameTypes||"int",sortPalettes:t.sortPalettes||"default_desc",useSerials:t.useSerials||!1,videoParams:t.videoParams||{}}};localStorage.setItem("gbp-z-web-settings",JSON.stringify(a));const r={version:0,state:{filtersActiveTags:t.filtersActiveTags||[],imageSelection:t.imageSelection||[],recentImports:t.recentImports||[],sortBy:t.sortBy||"created_asc"}};localStorage.setItem("gbp-z-web-filters",JSON.stringify(r));const n={version:0,state:{dropboxStorage:t.dropboxStorage||{},gitStorage:t.gitStorage||{},syncLastUpdate:t.syncLastUpdate||{}}};return localStorage.setItem("gbp-z-web-storages",JSON.stringify(n)),!0}return!1})())return void window.location.reload();const{default:t}=await Promise.all([F.e(802),F.e(740),F.e(524)]).then(F.bind(F,4778));try{const F=(0,r.H)(e),{images:i}=s.h.getState();n.A.getState().cleanRecentImports((i||[]).map((({hash:e})=>e))),F.render(a.createElement(t,null)),window.startFake=async e=>{await(async e=>{const t=[],F=Date.now();for(let F=0;F<e;F+=1)t.push(await u(F));m.log("Generate time: "+(Date.now()-F));const a=Date.now(),{images:r,setImages:n}=s.h.getState();n([...r,...t.map((({image:e})=>e))]),m.log("Dispatch time: "+(Date.now()-a))})(e)}}catch(e){const t=document.getElementById("app");t&&(t.innerHTML=`<p class="init-error">Error while initializing the app:<br>${e.message}<br><small>${e.stack}</small></p>`)}}},6362:function(e,t,F){F.d(t,{A:function(){return s}});const a={"":"006666666600FFFF"," ":"FFFFFFFFFFFFFFFF",0:"FFDDAAAAAADDFFFF",1:"FFDD99DDDDDDFFFF",2:"FF99EEDDBB88FFFF",3:"FF99EE99EE99FFFF",4:"FFDDBBBB88EEFFFF",5:"FF88BB99EE99FFFF",6:"FFCCBB99AADDFFFF",7:"FF88EEDDBBBBFFFF",8:"FFDDAADDAADDFFFF",9:"FFDDAACCEE99FFFF",a:"FFDDAAAA88AAFFFF",b:"FF99AA99AA99FFFF",c:"FFCCBBBBBBCCFFFF",d:"FF99AAAAAA99FFFF",e:"FF88BB99BB88FFFF",f:"FF88BB99BBBBFFFF",g:"FFCCBBAAAACCFFFF",h:"FFAAAA88AAAAFFFF",i:"FF88DDDDDD88FFFF",j:"FF99DDDDDDBBFFFF",k:"FFAAAA99AAAAFFFF",l:"FFBBBBBBBB88FFFF",m:"FFAA888AAAAAFFFF",n:"FFAA8A888AAAFFFF",o:"FFDDAAAAAADDFFFF",p:"FF99AA99BBBBFFFF",q:"FFDDAAAAAACCFFFF",r:"FF99AA99AAAAFFFF",s:"FFCCBBDDEE99FFFF",t:"FF88DDDDDDDDFFFF",u:"FFAAAAAAAACCFFFF",v:"FFAAAAAAAADDFFFF",w:"FFAAAA8A88AAFFFF",x:"FFAAAADDAAAAFFFF",y:"FFAAAADDDDDDFFFF",z:"FF88EEDDBB88FFFF","ä":"AADDAAAA88AAFFFF","ö":"AADDAAAAAADDFFFF","ü":"AAAFAAAAAACCFFFF","ß":"FF99AA99AA99BBFF",".":"FFFFFFFFFFDDFFFF","!":"DDDDDDDDFFDDFFFF","?":"DDAAEEDDFFDDFFFF","-":"FFFFFF88FFFFFFFF",_:"FFFFFFFFFF88FFFF",":":"FFFFDDFFDDFFFFFF"};var r=e=>{const t=[...e.toString(10).toLowerCase().split("")," "," "],F=t.shift()||"",r=t.shift()||"",n=a[F]||a[""],s=a[r]||a[""];return[...Array(16)].map(((e,t)=>`${n[t]}${s[t]}`)).join("")};const n="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n";var s=e=>{const t=[],F=e.split("\n").map((e=>e.match(/.{1,32}/g))).flat().map((e=>e||"")).map(((e="")=>e.padEnd(32," "))).map((e=>e.match(/.{1,2}/g)?.map((e=>r(e)))||[])).map((e=>[n,n,...e,n,n])).flat();for(t.push(...[...Array(40)].map((()=>n))),t.push(...F);t.length<360;)t.push(n);return t}},6750:function(e,t,F){F.d(t,{K:function(){return r},U:function(){return a}});const a=async e=>{const{default:t}=await F.e(668).then(F.t.bind(F,1668,23));return t.inflate(e,{to:"string"})},r=async e=>{const{default:t}=await F.e(668).then(F.t.bind(F,1668,23));return t.deflate(e,{to:"string",strategy:1,level:8})}},8222:function(e,t,F){F.d(t,{Bf:function(){return s},mZ:function(){return o},R_:function(){return i}});var a=F(2419),r=F(6750);const n=e=>e.toUpperCase(),s=async(e,t)=>{const{default:a}=await F.e(802).then(F.t.bind(F,4802,23)),s=JSON.stringify(((e,t)=>{const F=e.slice(0,20*t).map(n),a=e.slice(20*(t+14)).map(n);return{upper:F,left:Array(14).fill(0).map(((F,a)=>{const r=20*(a+t);return e.slice(r,r+2).map(n)})),right:Array(14).fill(0).map(((F,a)=>{const r=20*(a+t);return e.slice(r+18,r+20).map(n)})),lower:a}})(e,t)),i=await(0,r.K)(s);return{dataHash:a(i),compressed:i}},i=async(e,t)=>{const{dataHash:F,compressed:r}=await s(e,t);return await a.Uv.setItem(F,r),F},o=async e=>{if(!e)return null;const t=await a.Uv.getItem(e);if(!t)return null;let F;try{F=await(0,r.U)(t)}catch(e){return null}try{return JSON.parse(F)}catch(e){}try{const e=F.split("\n");return{upper:e.slice(0,40),left:Array(14).fill(0).map(((t,F)=>e.slice(4*F+40,4*F+42))),right:Array(14).fill(0).map(((t,F)=>e.slice(4*F+42,4*F+44))),lower:e.slice(96,136)}}catch(e){return null}}},8438:function(e,t){const F="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF";t.A=e=>{for(;e.length%20;)e.push(F);const t=new Array(20).fill(F);for(;e.length<360;)e.push(...t),e.length<360&&e.unshift(...t);return e}}}]);