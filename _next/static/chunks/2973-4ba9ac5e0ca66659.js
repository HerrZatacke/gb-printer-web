"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2973],{633:(e,t,r)=>{r.d(t,{g:()=>f});var n=r(12115),a=r(41186),i=r(3381),u=r(71620),o=r(48675),s=r(46498),c=r(11760),l=r(24463),f=function(){var e=(0,a.A)(),t=e.dismissDialog,r=e.setDialog,f=(0,i.A)(),m=f.cancelEditFrame,F=f.cancelEditImages,p=f.cancelEditPalette,d=(0,u.A)(),g=d.updateRecentImports,h=d.updateImageSelection,A=(0,o.A)().importQueueCancel,v=(0,s.A)().setPrinterBusy,E=(0,c.h)(),_=E.addImages,D=E.deleteImages,S=E.setImageGroups,I=E.updateFrameGroups,y=E.updateImageHash,b=E.updateImages,B=E.setFrames,w=E.setImages,C=E.setPalettes,P=(0,l.A)().setSyncLastUpdate;return(0,n.useMemo)(function(){var e=function(){return P("local",Math.floor(new Date().getTime()/1e3))},n=function(){v(!1),A()};return{addImages:function(r){_(r),t(0),e(),n(),g(r)},deleteImages:function(r){D(r),h(u.N.REMOVE,r),t(0),e()},dismissDialog:t,globalUpdate:function(t){m(),p(),F(),t.lastUpdateUTC?P("local",t.lastUpdateUTC):e(),t.palettes&&C(t.palettes),t.images&&(w(t.images),g(t.images)),t.frames&&B(t.frames),t.frameGroups&&I(t.frameGroups),t.imageGroups&&S(t.imageGroups)},importQueueCancel:n,setDialog:r,updateImageHash:function(t,r){F(),e(),y(t,r)},updateImages:function(t){b(t),e()},updateLastSyncLocalNow:e}},[_,m,F,p,D,t,A,r,B,w,C,S,v,P,I,y,h,b,g])}},2608:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(97004),a=r(87025),i=r(39249),u=r(5432),o=r(72623),s=function(){var e=(0,n._)(function(e,t,r){var n,s;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,(0,o.Hh)(e)];case 1:return n=(i.sent()||[]).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.join(" "))||""}).reduce(function(e,t,r){return r%40?(0,a._)(e).concat([t]):(0,a._)(e).concat([u.g0,t])},[]),s=[u.dm].concat((0,a._)(n),[u.R2,u.Ys]).join("\n"),[2,{folder:"images",filename:"".concat(r,".txt"),blob:new Blob(Array(s),{type:"text/plain"}),title:t}]}})});return function(t,r,n){return e.apply(this,arguments)}}()},3381:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(65453).v)(function(e){return{editFrame:null,editPalette:null,pickColors:null,editImageGroup:null,editImages:null,editRGBNImages:[],setEditFrame:function(t){return e({editFrame:t})},setEditImageGroup:function(t){return e({editImageGroup:t})},setEditPalette:function(t){return e({editPalette:t,pickColors:null})},setEditRGBNImages:function(t){return e({editRGBNImages:t})},setPickColors:function(t){return e({pickColors:t})},setEditImages:function(t){return e({editImages:t})},cancelEditFrame:function(){return e({editFrame:null})},cancelEditImageGroup:function(){return e({editImageGroup:null})},cancelEditPalette:function(){return e({editPalette:null})},cancelEditRGBNImages:function(){return e({editRGBNImages:[]})},cancelPickColors:function(){return e({pickColors:null})},cancelEditImages:function(){return e({editImages:null})}}})},4862:(e,t,r)=>{r.d(t,{j:()=>n});var n=function(e){return e.GALLERY_VIEW_SMALL="small",e.GALLERY_VIEW_1X="1x",e.GALLERY_VIEW_2X="2x",e.GALLERY_VIEW_MAX="max",e.PALETTE_VIEW="res2x",e}({})},5415:(e,t,r)=>{r.d(t,{R:()=>c,j:()=>E});var n=r(97004),a=r(39249),i=r(91540),u=r(59311),o=r.n(u),s=r(31533);let c=function(e){var t;return t=(0,n._)(function(t){var r,n,u,c;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(1===t.length)return r=t[0],[2,(0,i.saveAs)(r.blob,r.filename)];return n=new(o()),[4,Promise.all(t.map(function(e){var t,r=e.filename;return("function"==typeof(t=e.blob).arrayBuffer?t.arrayBuffer():new Promise(function(e){var r=new FileReader;r.onload=function(t){if(!t.target)throw Error("no file");var r=t.target.result;if("string"==typeof r||null===r)throw Error("unexpected filereader result");e(r)},r.readAsArrayBuffer(t)})).then(function(e){return{filename:r,arrayBuffer:e}})}))];case 1:return u=a.sent(),(0,s.A)(u).forEach(function(e){var t=e.filename,r=e.arrayBuffer;n.file(t,r)}),[4,n.generateAsync({type:"blob",compression:"DEFLATE"})];case 2:if(c=a.sent(),!e)throw Error("missing filename");return[2,(0,i.saveAs)(c,"".concat(e,".zip"))]}})}),function(e){return t.apply(this,arguments)}};var l=r(693),f=r(60376),m=r(87025),F=r(15905),p=r(28952),d=r(18335),g=r(77683),h=r(86964),A=r(55364),v=r(2608);let E=function(e,t,r,i,u){return function(o){var s;return s=(0,n._)(function(s,c){var E,_,D,S,I,y,b,B,w;return(0,a.YH)(this,function(C){switch(C.label){case 0:var P;if(E=(0,A.pl)(o),_=o.lockFrame||!1,D=o.rotation||0,I=(S=(0,d.s)(i,o)).palette,y=S.framePalette,!I)throw Error("Palette missing?");return P=(0,n._)(function(e,t){var n,i,u,m;return(0,a.YH)(this,function(a){return E?[2,(0,F.y1)({tiles:s,palette:I,lockFrame:_,imageStartLine:c,rotation:D,scaleFactor:t,handleExportFrame:r},e)]:(i=(n=(0,h.f)(o)).invertPalette,u=n.invertFramePalette,m=(0,g.C)({imagePalette:I.palette||F.CU,framePalette:(null==y?void 0:y.palette)||F.CU,invertPalette:i,invertFramePalette:u}),[2,(0,F.Yn)((0,f._)((0,l._)({tiles:s,rotation:D,scaleFactor:t,handleExportFrame:r},m),{imageStartLine:c}),e)])})}),b=function(e,t){return P.apply(this,arguments)},B=(0,m._)(e).filter(function(e){return"number"==typeof e}),w=(0,m._)(t),B.length||B.push(4),w.length||w.push("png"),[4,Promise.all(B.map(function(e){return w.map(function(t){return new Promise(function(r){var n=(0,p.A)({image:o,palette:I,exportScaleFactor:e,fileNameStyle:u});switch(t){case"txt":if(E)return void r(null);(0,v.Z)(o.hash,o.title,n).then(r);break;case"pgm":if(E)return void r(null);b("image/png",e).then(createImageBitmap).then(function(e){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var i=a.getContext("2d");i.drawImage(e,0,0);var u=I.palette;if(!i||!(null==u?void 0:u.length))return void r(null);for(var s=["P2","#","# Exported from ".concat(window.location.origin),"#","# hash: ".concat(o.hash),"# created: ".concat(o.created),"# title: ".concat(o.title),"# tags: ".concat(o.tags.join(", ")),"# dimension: ".concat(a.width,"*").concat(a.height," pixels"),"#","".concat(a.width," ").concat(a.height),"3","#"],c=0;c<a.height;c+=1){for(var l=[],f=0;f<a.width;f+=1){var m=i.getImageData(f,c,1,1).data,p=["#",m[0].toString(16).padStart(2,"0"),m[1].toString(16).padStart(2,"0"),m[2].toString(16).padStart(2,"0")].join(""),d=I.palette.indexOf(p);-1===d&&(d=F.eJ.indexOf(parseInt(p.slice(1),16))),l.push(3-d)}s.push(l.join(" "))}r({filename:"".concat(n,".").concat(t),blob:new Blob([s.join("\n")],{type:"text/plain"}),title:o.title})});break;default:b("image/".concat(t),e).then(function(e){r({filename:"".concat(n,".").concat(t),blob:e,title:o.title})}).catch(function(){return r(null)})}})})}).flat())];case 1:return[2,C.sent().reduce(function(e,t){return t?(0,m._)(e).concat([t]):e},[])]}})}),function(e,t){return s.apply(this,arguments)}}}},6732:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(87025),a={"":"006666666600FFFF"," ":"FFFFFFFFFFFFFFFF",0:"FFDDAAAAAADDFFFF",1:"FFDD99DDDDDDFFFF",2:"FF99EEDDBB88FFFF",3:"FF99EE99EE99FFFF",4:"FFDDBBBB88EEFFFF",5:"FF88BB99EE99FFFF",6:"FFCCBB99AADDFFFF",7:"FF88EEDDBBBBFFFF",8:"FFDDAADDAADDFFFF",9:"FFDDAACCEE99FFFF",a:"FFDDAAAA88AAFFFF",b:"FF99AA99AA99FFFF",c:"FFCCBBBBBBCCFFFF",d:"FF99AAAAAA99FFFF",e:"FF88BB99BB88FFFF",f:"FF88BB99BBBBFFFF",g:"FFCCBBAAAACCFFFF",h:"FFAAAA88AAAAFFFF",i:"FF88DDDDDD88FFFF",j:"FF99DDDDDDBBFFFF",k:"FFAAAA99AAAAFFFF",l:"FFBBBBBBBB88FFFF",m:"FFAA888AAAAAFFFF",n:"FFAA8A888AAAFFFF",o:"FFDDAAAAAADDFFFF",p:"FF99AA99BBBBFFFF",q:"FFDDAAAAAACCFFFF",r:"FF99AA99AAAAFFFF",s:"FFCCBBDDEE99FFFF",t:"FF88DDDDDDDDFFFF",u:"FFAAAAAAAACCFFFF",v:"FFAAAAAAAADDFFFF",w:"FFAAAA8A88AAFFFF",x:"FFAAAADDAAAAFFFF",y:"FFAAAADDDDDDFFFF",z:"FF88EEDDBB88FFFF",ä:"AADDAAAA88AAFFFF",ö:"AADDAAAAAADDFFFF",ü:"AAAFAAAAAACCFFFF",ß:"FF99AA99AA99BBFF",".":"FFFFFFFFFFDDFFFF","!":"DDDDDDDDFFDDFFFF","?":"DDAAEEDDFFDDFFFF","-":"FFFFFF88FFFFFFFF",_:"FFFFFFFFFF88FFFF",":":"FFFFDDFFDDFFFFFF"};let i=function(e){var t=(0,n._)(e.toString(10).toLowerCase().split("")).concat([" "," "]),r=t.shift()||"",i=t.shift()||"",u=a[r]||a[""],o=a[i]||a[""];return(0,n._)(Array(16)).map(function(e,t){return"".concat(u[t]).concat(o[t])}).join("")};var u="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n";let o=function(e){var t=[],r=e.split("\n").map(function(e){return e.match(/.{1,32}/g)}).flat().map(function(e){return e||""}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.padEnd(32," ")}).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.map(function(e){return i(e)}))||[]}).map(function(e){return[u,u].concat((0,n._)(e),[u,u])}).flat();for(t.push.apply(t,(0,n._)((0,n._)(Array(40)).map(function(){return u}))),t.push.apply(t,(0,n._)(r));t.length<360;)t.push(u);return t}},18335:(e,t,r)=>{r.d(t,{s:()=>i});var n=r(5432),a=r(55364),i=function(e,t){if((0,a.pl)(t))return{palette:t.palette};var r=e.find(function(e){return e.shortName===t.palette})||n.Fv,i=e.find(function(e){return e.shortName===t.framePalette})||n.Fv;return{palette:r,framePalette:t.lockFrame?i:r}}},24463:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(86447),a=r(693),i=r(60376),u=r(65453),o=r(46786),s=r(10746);let c=(0,u.v)((0,o.eh)((0,o.Zr)(function(e){return{dropboxStorage:{},gitStorage:{},syncLastUpdate:{dropbox:0,local:0},dropboxLogout:function(){return e(function(e){return{dropboxStorage:{use:e.dropboxStorage.use}}})},setDropboxStorage:function(t){return e(function(e){var r=e.dropboxStorage;return{dropboxStorage:(0,a._)({},r,t)}})},setGitStorage:function(t){return e(function(e){var r=e.gitStorage;return{gitStorage:(0,a._)({},r,t)}})},setSyncLastUpdate:function(t,r){return e(function(e){var u=e.syncLastUpdate;return{syncLastUpdate:(0,i._)((0,a._)({},u),(0,n._)({},t,r))}})}}},{name:"".concat(s.z,"-storages"),storage:(0,o.KU)(function(){return localStorage})})))},27803:(e,t,r)=>{r.d(t,{V:()=>n});var n=function(e){return e.DEFAULT_ASC="default_asc",e.DEFAULT_DESC="default_desc",e.USAGE_ASC="usage_asc",e.USAGE_DESC="usage_desc",e.NAME_ASC="name_asc",e.NAME_DESC="name_desc",e}({})},28952:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(30832),a=r.n(n),i=r(35009),u=r(81445),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.reduce(function(e,r){return r?"".concat(e).concat(e?t:"").concat(r):e},"")},s=function(e){var t=e.r,r=e.g,n=e.b,a=e.n,i=function(e){return e.toString(16).padStart(2,"0")};return o([(null==t?void 0:t.map(i).join(""))||"",(null==r?void 0:r.map(i).join(""))||"",(null==n?void 0:n.map(i).join(""))||"",(null==a?void 0:a.map(i).join(""))||""],".")};let c=function(e){var t,r,n=e.image||null,c=e.palette||null,l=e.exportScaleFactor||null,f=e.useCurrentDate||null,m=(null==(t=e.frameRate)?void 0:t.toString(10))||"",F=e.altTitle||"",p=e.frameName||"",d=e.paletteShort||"",g=e.fileNameStyle,h=!f&&(null==n?void 0:n.created)?a()(new Date(n.created)):a()(),A=h.isValid()?h.format("YYYYMMDD-HHmmss"):"",v=d||(c?c.shortName||s(c):""),E=n&&n.title?n.title:F;switch(g){case u.B.TITLE_ONLY:r=[E];break;case u.B.DATE_TITLE:r=[A,E];break;case u.B.FULL:default:r=[A,E,l?"".concat(l,"x"):"",m?"".concat(m,"fps"):"",p,v]}var _=o(r);return(0,i.A)(_,{replacement:""})}},31533:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(693),a=r(60376);let i=function(e){var t=[];return e.map(function(e){var r=e.filename,i=r.split("."),u=i.pop();if(!u)throw Error("unknown file type");for(var o=i.join("."),s=r,c=0;t.includes(s);)c+=1,s="".concat(o,"_(").concat(c,").").concat(u);return t.includes(s)||t.push(s),(0,a._)((0,n._)({},e),{filename:s})})}},37547:(e,t,r)=>{r.d(t,{K:()=>n,o:()=>a});var n=function(e){return e.CART_INDEX="CART_INDEX",e.RAM_INDEX="RAM_INDEX",e}({}),a=[{translationKey:"importOrders.cartIndex",value:"CART_INDEX"},{translationKey:"importOrders.ramIndex",value:"RAM_INDEX"}]},39893:(e,t,r)=>{r.d(t,{C:()=>a,f:()=>n});var n=function(e){return e.WIDER="wider",e.WIDE="wide",e.NORMAL="normal",e.NARROW="narrow",e.NARROWER="narrower",e.EMULATOR="emulator",e}({}),a=[{translationKey:"contrastSettings.wider",baseValues:[0,68,187,255],value:"wider"},{translationKey:"contrastSettings.wide",baseValues:[0,85,170,255],value:"wide"},{translationKey:"contrastSettings.normal",baseValues:[51,102,153,204],value:"normal"},{translationKey:"contrastSettings.narrow",baseValues:[69,115,162,208],value:"narrow"},{translationKey:"contrastSettings.narrower",baseValues:[85,113,141,170],value:"narrower"},{translationKey:"contrastSettings.emulator",baseValues:[64,144,224,255],value:"emulator"}]},41186:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(87025);let a=(0,r(65453).v)(function(e){return{dialogs:[],dismissDialog:function(t){return e(function(e){return{dialogs:e.dialogs.filter(function(e,r){return t!==r})}})},setDialog:function(t){return e(function(e){var r=e.dialogs;return{dialogs:[t].concat((0,n._)(r))}})}}})},44965:(e,t,r)=>{r.d(t,{Gw:()=>u,IB:()=>i,q:()=>a});var n=r(55685),a="en-GB",i=["de-DE","en-CA",a,"en-US","fr-FR"],u=(0,n.A)(i.map(function(e){return e.split("-")[0]}))},46498:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(693),a=r(60376),i=r(87025),u=r(30832),o=r.n(u),s=r(9779),c=r(51368);let l=(0,r(65453).v)(function(e,t){return{dragover:!1,errors:[],isFullscreen:!1,lightboxImage:null,printerBusy:!1,printerData:null,printerFunctions:[],showSerials:!1,syncBusy:!1,syncSelect:!1,trashCount:{frames:0,images:0,show:!1},videoSelection:[],dismissError:function(r){return e({errors:t().errors.filter(function(e,t){return t!==r})})},setDragover:function(t){return e({dragover:t})},setError:function(r){return e({errors:(0,i._)(t().errors).concat([{error:r,timestamp:o()().unix(),id:(0,c.A)()}])})},setIsFullscreen:function(t){return e({isFullscreen:t})},setPrinterBusy:function(t){return e({printerBusy:t})},setPrinterData:function(t){return e({printerData:t})},setPrinterFunctions:function(t){return e({printerFunctions:t})},setShowSerials:function(t){return e({showSerials:t})},setSyncBusy:function(t){return e({syncBusy:t})},setSyncSelect:function(t){return e({syncSelect:t})},showTrashCount:function(r){return e({trashCount:(0,a._)((0,n._)({},t().trashCount),{show:r})})},updateTrashCount:function(r,i){return e({trashCount:(0,a._)((0,n._)({},t().trashCount),{frames:r,images:i})})},setVideoSelection:function(t){return e({videoSelection:t})},setLightboxImage:function(t){null===t&&s.A.exit(),e({lightboxImage:t})},setLightboxImageNext:function(r){var n=t().lightboxImage;null!==n&&e({lightboxImage:Math.min(n+1,r-1)})},setLightboxImagePrev:function(){var r=t().lightboxImage;null!==r&&e({lightboxImage:Math.max(r-1,0)})}}})},47639:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(97004),a=r(87025),i=r(39249),u=r(15905),o=r(53982);let s=function(){var e=(0,n._)(function(e,t){var r,n,s,c,l,f;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(360!==e.length)return[2,e];return[4,(0,o.mZ)(t)];case 1:if(!(n=i.sent()))return[2,e];if(14!==n.left.length||14!==n.right.length)return console.error("Invalid frameData"),[2,e];for(l=0,s=e.reduce(function(e,t,r){return(0,u.o1)(r,2,u.H.FRAMEMODE_KEEP)?e:(0,a._)(e).concat([t])},[]),c=(0,a._)(n.upper);l<14;l+=1)(f=c).push.apply(f,(0,a._)(n.left[l]).concat((0,a._)(s.slice(16*l,(l+1)*16)),(0,a._)(n.right[l])));return(r=c).push.apply(r,(0,a._)(n.lower)),[2,c]}})});return function(t,r){return e.apply(this,arguments)}}()},48675:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(87025);let a=(0,r(65453).v)(function(e,t){return{bitmapQueue:[],frameQueue:[],importQueue:[],bitmapQueueAdd:function(t){return e(function(e){var r=e.bitmapQueue;return{bitmapQueue:(0,n._)(r).concat((0,n._)(t))}})},bitmapQueueCancel:function(){return e({bitmapQueue:[]})},frameQueueAdd:function(t){return e(function(e){var r=e.frameQueue;return{frameQueue:(0,n._)(r).concat((0,n._)(t))}})},frameQueueCancelOne:function(t){return e(function(e){return{frameQueue:e.frameQueue.filter(function(e){return e.tempId!==t})}})},importQueueAdd:function(r){var a=t(),i=a.bitmapQueue,u=a.importQueue,o=r.map(function(e){return e.fileName});e({bitmapQueue:i.filter(function(e){var t=e.fileName;return!o.includes(t)}),importQueue:(0,n._)(u).concat((0,n._)(r))})},importQueueSet:function(t){e({importQueue:t})},importQueueCancel:function(){e({importQueue:[]})},importQueueCancelOne:function(t){return e(function(e){return{importQueue:e.importQueue.filter(function(e){return e.tempId!==t})}})},getImportItem:function(e){return t().importQueue.find(function(t){return t.tempId===e})||null}}})},49432:(e,t,r)=>{r.d(t,{A:()=>n});let n=function(e,t){if(!e.trim())return"";if("/"===e&&"ws"!==t)return e;var r=!!e.match(RegExp("^".concat(t,"(s)?:\\/\\/"),"gi"));return"".concat(r?"":"".concat(t,"://")).concat(e).concat(e.endsWith("/")?"":"/")}},50263:(e,t,r)=>{r.d(t,{K:()=>s,U:()=>o});var n=r(97004),a=r(39249),i=r(98933),u=r.n(i),o=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u().inflate(e,{to:"string"})]})});return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u().deflate(e,{to:"string",strategy:1,level:8})]})});return function(t){return e.apply(this,arguments)}}()},52166:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(693),a=r(78538),i=r(15905),u=r(65453),o=r(46786),s=r(39893),c=r(81445),l=r(80498),f=r(4862),m=r(27803),F=r(37547),p=r(99999),d=r(44965),g=r(49432),h=r(10746),A=function(){var e="";if("undefined"!=typeof navigator){var t=(0,a._)(navigator.language.split("-"),2);e=[t[0],t[1]].filter(Boolean).join("-")}return d.IB.includes(e)?e:d.q};let v=(0,u.v)((0,o.Zr)(function(e){return{activePalette:"bw",bitmapQueueDither:!0,bitmapQueueSetting:s.f.WIDE,enableDebug:!1,exportFileTypes:["png"],exportScaleFactors:[4],fileNameStyle:c.B.FULL,forceMagicCheck:!1,galleryView:f.j.GALLERY_VIEW_1X,galleryClickAction:l.n.SELECT,handleExportFrame:i.H.FRAMEMODE_KEEP,hideDates:!1,importDeleted:!0,importLastSeen:!0,importPad:!1,lastBaudRate:115200,pageSize:30,preferredLocale:A(),printerParams:"",printerUrl:"",savFrameTypes:"int",savImportOrder:F.K.CART_INDEX,themeName:p.V.BRIGHT,sortPalettes:m.V.DEFAULT_DESC,useSerials:!1,videoParams:{},setActivePalette:function(t){return e({activePalette:t})},setBitmapQueueDither:function(t){return e({bitmapQueueDither:t})},setBitmapQueueSetting:function(t){return e({bitmapQueueSetting:t})},setEnableDebug:function(t){return e({enableDebug:t})},setFileNameStyle:function(t){return e({fileNameStyle:t})},setForceMagicCheck:function(t){return e({forceMagicCheck:t})},setGalleryView:function(t){return e({galleryView:t})},setGalleryClickAction:function(t){return e({galleryClickAction:t})},setHandleExportFrame:function(t){return e({handleExportFrame:t})},setHideDates:function(t){return e({hideDates:t})},setImportDeleted:function(t){return e({importDeleted:t})},setImportLastSeen:function(t){return e({importLastSeen:t})},setImportPad:function(t){return e({importPad:t})},setLastBaudRate:function(t){return e({lastBaudRate:t})},setPageSize:function(t){return e({pageSize:t})},setPrinterParams:function(t){return e({printerParams:t})},setPrinterUrl:function(t){return e({printerUrl:(0,g.A)(t,"http")})},setSavFrameTypes:function(t){return e({savFrameTypes:t})},setSavImportOrder:function(t){return e({savImportOrder:t})},setThemeName:function(t){return e({themeName:t})},setSortPalettes:function(t){return e({sortPalettes:t})},setUseSerials:function(t){return e({useSerials:t})},setVideoParams:function(t){return e(function(e){return{videoParams:(0,n._)({},e.videoParams,t)}})},setExportScaleFactors:function(t){return e({exportScaleFactors:t})},setExportFileTypes:function(t){return e({exportFileTypes:t})},setPreferredLocale:function(t){d.IB.includes(t)?e({preferredLocale:t}):console.log('unknown locale "'.concat(t,'"'))}}},{name:"".concat(h.z,"-settings"),storage:(0,o.KU)(function(){return localStorage})}))},53982:(e,t,r)=>{r.d(t,{Bf:()=>c,mZ:()=>f,R_:()=>l});var n=r(97004),a=r(39249),i=function(e){return e.toUpperCase()},u=function(e,t){var r=e.slice(0,20*t).map(i),n=e.slice((t+14)*20).map(i);return{upper:r,left:Array(14).fill(0).map(function(r,n){var a=(n+t)*20;return e.slice(a,a+2).map(i)}),right:Array(14).fill(0).map(function(r,n){var a=(n+t)*20;return e.slice(a+18,a+20).map(i)}),lower:n}},o=r(75380),s=r(50263),c=function(){var e=(0,n._)(function(e,t){var n,i,o;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(r.t.bind(r,52491,23))];case 1:return n=a.sent().default,i=JSON.stringify(u(e,t)),[4,(0,s.K)(i)];case 2:return o=a.sent(),[2,{dataHash:n(o),compressed:o}]}})});return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,n._)(function(e,t){var r,n,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,c(e,t)];case 1:return n=(r=a.sent()).dataHash,i=r.compressed,[4,o.Uv.setItem(n,i)];case 2:return a.sent(),[2,n]}})});return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,n._)(function(e){var t,r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];return[4,o.Uv.getItem(e)];case 1:if(!(t=a.sent()))return[2,null];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,(0,s.U)(t)];case 3:return r=a.sent(),[3,5];case 4:return a.sent(),[2,null];case 5:try{return[2,JSON.parse(r)]}catch(e){}try{return n=r.split("\n"),[2,{upper:n.slice(0,40),left:Array(14).fill(0).map(function(e,t){return n.slice(4*t+40,4*t+42)}),right:Array(14).fill(0).map(function(e,t){return n.slice(4*t+42,4*t+44)}),lower:n.slice(96,136)}]}catch(e){return[2,null]}}})});return function(t){return e.apply(this,arguments)}}()},56491:(e,t,r)=>{r.d(t,{A:()=>i});var n=function(e,t,r){var n=r.find(function(t){return t.id===e});if(n)return n.name;switch(e){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return t}},a=function(e){switch(e){case"int":return"_1";case"jp":return"_2";case"hk":return"_3";default:return e}};let i=function(e,t){return e.reduce(function(e,r){var a=r.id,i=r.name;try{var u,o=null==(u=a.match(/^[a-z]+/g))?void 0:u[0];if(!o)return e;return e.find(function(e){return e.id===o})||e.push({id:o,name:n(o,i,t)}),e}catch(t){return e}},[]).sort(function(e,t){var r=e.id,n=t.id,i=a(r),u=a(n);return i>u?1:i<u?-1:0})}},69176:(e,t,r)=>{r.d(t,{m:()=>E});var n=r(97004),a=r(693),i=r(60376),u=r(39249),o=r(69229),s=r(71620),c=r(11760),l=r(56491),f=r(75380),m=function(){var e=(0,n._)(function(e){var t,r;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.map((i=(0,n._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.Uv.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),r={},t.forEach(function(e){var t=e.hash,n=e.data;n&&(r["frame-".concat(t)]=n)}),[2,r]}})});return function(t){return e.apply(this,arguments)}}();let F=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"frames":return t;case"current_framegroup":return t.filter(function(e){return e.id.startsWith(r)});default:return[]}},p=function(e,t,r){switch(e){case"images":return t.map(function(e){return e.hash});case"selected_images":return r;default:return[]}};var d=r(87025),g=r(55364),h=r(55685),A=function(){var e=(0,n._)(function(e){var t,r;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.reduce(function(e,t){var r=(0,g.pl)(t)?(0,h.A)(Object.values(t.hashes)):[t.hash];return(0,d._)(e).concat((0,d._)(r))},[]).map((i=(0,n._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.mU.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),r={},t.forEach(function(e){var t=e.hash,n=e.data;n&&(r[t]=n)}),[2,r]}})});return function(t){return e.apply(this,arguments)}}(),v=function(e){switch(e){case o.m.ALL:case o.m.JSON_EXPORT:return["frameGroups","frames","imageGroups","images","palettes","plugins"];case o.m.SELECTED_IMAGES:return["images"];case o.m.IMAGES:return["images","imageGroups"];case o.m.PALETTES:return["palettes"];case o.m.FRAMES:case o.m.CURRENT_FRAMEGROUP:return["frames","frameGroups"];case o.m.PLUGINS:return["plugins"];default:return[]}},E=function(){var e=(0,n._)(function(e){var t,r,n,f,d,g,h,E,_,D,S,I,y,b,B,w,C,P,R=arguments;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(r=(t=R.length>1&&void 0!==R[1]?R[1]:{}).lastUpdateUTC,n=t.selectedFrameGroup,h=(g=c.h.getState()).frames,E=g.images,_=g.palettes,D=g.imageGroups,S=g.frameGroups,I=g.plugins,y=s.A.getState().imageSelection,b=(0,i._)((0,a._)({},v(e).reduce(function(t,r){switch(r){case"frameGroups":return(0,i._)((0,a._)({},t),{frameGroups:e===o.m.CURRENT_FRAMEGROUP?S.filter(function(e){return e.id===n}):(0,l.A)(h,S)});case"frames":var u=e===o.m.FRAMES?o.m.FRAMES:o.m.CURRENT_FRAMEGROUP;return(0,i._)((0,a._)({},t),{frames:F(u,h,n)});case"imageGroups":return(0,i._)((0,a._)({},t),{imageGroups:D});case"images":var s=p(e===o.m.SELECTED_IMAGES?"selected_images":"images",E,y);return(0,i._)((0,a._)({},t),{images:E.filter(function(e){var t=e.hash;return s.includes(t)})});case"palettes":return(0,i._)((0,a._)({},t),{palettes:_.filter(function(e){return!e.isPredefined})});case"plugins":return(0,i._)((0,a._)({},t),{plugins:I});default:return t}},{})),{lastUpdateUTC:r||Math.floor(new Date().getTime()/1e3),version:c.A}),B={},!((null==(f=b.images)?void 0:f.length)&&[o.m.IMAGES,o.m.SELECTED_IMAGES,o.m.ALL].includes(e)))return[3,2];return w=[{},B],[4,A(b.images)];case 1:B=a._.apply(void 0,w.concat([u.sent()])),u.label=2;case 2:if(!((null==(d=b.frames)?void 0:d.length)&&[o.m.FRAMES,o.m.CURRENT_FRAMEGROUP,o.m.ALL].includes(e)))return[3,4];return C=e===o.m.CURRENT_FRAMEGROUP?o.m.CURRENT_FRAMEGROUP:o.m.FRAMES,P=[{},B],[4,m(F(C,h,n).map(function(e){return e.hash}))];case 3:B=a._.apply(void 0,P.concat([u.sent()])),u.label=4;case 4:return[2,JSON.stringify((0,a._)({state:b},B),null,2)]}})});return function(t){return e.apply(this,arguments)}}()},69229:(e,t,r)=>{r.d(t,{m:()=>n});var n=function(e){return e.ALL="all",e.JSON_EXPORT="json_export",e.FRAMES="frames",e.CURRENT_FRAMEGROUP="current_framegroup",e.IMAGES="images",e.SELECTED_IMAGES="selected_images",e.PALETTES="palettes",e.PLUGINS="plugins",e}({})},71620:(e,t,r)=>{r.d(t,{A:()=>F,N:()=>m});var n=r(87025),a=r(30832),i=r.n(a),u=r(65453),o=r(46786),s=r(55364),c=r(55685),l=r(85546),f=r(10746),m=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let F=(0,u.v)((0,o.Zr)(function(e,t){return{filtersTags:[],filtersPalettes:[],filtersFrames:[],filtersVisible:!1,imageSelection:[],lastSelectedImage:null,recentImports:[],sortBy:"created_asc",sortOptionsVisible:!1,setFilters:function(t,r,n){e({filtersTags:t,filtersPalettes:r,filtersFrames:n,filtersVisible:!1})},setFiltersVisible:function(t){return e({filtersVisible:t})},setImageSelection:function(t){return e({imageSelection:t,lastSelectedImage:null})},setSortBy:function(t){return e({sortBy:t,sortOptionsVisible:!1})},setSortOptionsVisible:function(t){return e({sortOptionsVisible:t})},cleanRecentImports:function(r){var n=t().recentImports,a=i()().subtract(6,"hour").unix();e({recentImports:n.filter(function(e){var t=e.hash,n=e.timestamp;return r.includes(t)&&n>a})})},updateRecentImports:function(r){var a=t().recentImports,u=r.reduce(function(e,t){return(0,s.pl)(t)?e:(0,n._)(e).concat([{hash:t.hash,timestamp:i()().unix()}])},[]);e({recentImports:(0,l.A)("hash")((0,n._)(a).concat((0,n._)(u)))})},updateImageSelection:function(r,a){var i=t().imageSelection;switch(r){case"add":e({imageSelection:(0,c.A)((0,n._)(i).concat((0,n._)(a))),lastSelectedImage:a[0]});break;case"remove":e({imageSelection:i.filter(function(e){return!a.includes(e)}),lastSelectedImage:null})}}}},{name:"".concat(f.z,"-filters"),storage:(0,o.KU)(function(){return localStorage})}))},72623:(e,t,r)=>{r.d(t,{cg:()=>l,yH:()=>F,t9:()=>p,Hh:()=>m,UN:()=>f});var n=r(97004),a=r(39249),i=r(47639),u=r(75380),o=r(50263),s=r(6732);let c=function(e){var t="\nThe following hash is missing in\nyour indexedDb:\n".concat(e,"\n\nEither you imported a debug dump\nor your browser decided to do a\ncleanup.\n\nThis image might be able to be\nrecovered if you have set up git\nor dropbox sync.\n").trim();return(0,s.A)(t)};var l=function(){var e=(0,n._)(function(e){var t,n,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(r.t.bind(r,52491,23))];case 1:return t=a.sent().default,n=e.map(function(e){return e.replace(/ /gi,"").toUpperCase()}).join("\n"),[4,(0,o.K)(n)];case 2:return i=a.sent(),[2,{dataHash:t(i),compressed:i}]}})});return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,n._)(function(e){var t,r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,l(e)];case 1:return r=(t=a.sent()).dataHash,n=t.compressed,[4,u.mU.setItem(r,n)];case 2:return a.sent(),[2,r]}})});return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,n._)(function(e,t,r,n){var s,l;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];a.label=1;case 1:return a.trys.push([1,4,,5]),[4,u.mU.getItem(e)];case 2:if(!(s=a.sent()))throw Error("missing imagedata");return[4,(0,o.U)(s)];case 3:if(l=a.sent().split("\n"),!t)return[2,l];return[2,(0,i.A)(l,t)];case 4:return a.sent(),"function"==typeof n&&n(e),[2,r?[]:c(e)];case 5:return[2]}})});return function(t,r,n,a){return e.apply(this,arguments)}}(),F=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u.mU.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u.Uv.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}()},77683:(e,t,r)=>{r.d(t,{C:()=>u});var n=r(87025),a=r(15905),i=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");return parseInt(t,16)},u=function(e){var t=e.imagePalette,r=e.framePalette,u=e.invertPalette,o=e.invertFramePalette,s=(t||a.CU).map(i),c=(null==r?void 0:r.map(i))||s;return{imagePalette:void 0!==u&&u?(0,n._)(s).reverse():(0,n._)(s),framePalette:void 0!==o&&o?(0,n._)(c).reverse():(0,n._)(c)}}},80498:(e,t,r)=>{r.d(t,{n:()=>n});var n=function(e){return e.SELECT="select",e.EDIT="edit",e.VIEW="view",e}({})},81445:(e,t,r)=>{r.d(t,{B:()=>n,y:()=>a});var n=function(e){return e.FULL="FULL",e.TITLE_ONLY="TITLE_ONLY",e.DATE_TITLE="DATE_TITLE",e}({}),a=[{id:"FULL",name:"filenameStyles.fullTitle"},{id:"DATE_TITLE",name:"filenameStyles.dateTitle"},{id:"TITLE_ONLY",name:"filenameStyles.titleOnly"}]},83936:(e,t,r)=>{r.d(t,{W:()=>S});var n=r(97004),a=r(39249),i=r(12115),u=r(633),o=r(11760),s=r(52324),c=r(5415),l=r(69176),f=r(75380),m=r(693),F=r(60376),p=r(87025),d=r(85546),g=function(e){var t=(0,d.A)(e);return function(r,n){var a=new Map(r.map(function(t){return[t[e],t]})),i=n.map(function(t){var r=a.get(t[e]);return r?(0,m._)({},r,t):t});return t((0,p._)(i).concat((0,p._)(r)))}},h=g("hash"),A=g("id"),v=g("shortName"),E=g("id");let _=function(e,t,r,n,a,i){var u=e,o=r,s=t,c=n;return i?(a.frames&&a.frames.length&&(u=A(u,a.frames)),a.images&&a.images.length&&(o=h(o,a.images)),a.palettes&&a.palettes.length&&(s=v(s,a.palettes)),a.imageGroups&&a.imageGroups.length&&(c=E(c,a.imageGroups))):(u=a.frames||e,o=a.images||r,s=a.palettes||t,c=a.imageGroups||n),(0,F._)((0,m._)({},a),{images:o,frames:u,palettes:s,imageGroups:c})};var D=function(){var e=(0,n._)(function(e){var t,r,n,i,u,c,l,m=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=m.length>1&&void 0!==m[1]&&m[1],n=(r=o.h.getState()).frames,i=r.palettes,u=r.images,c=r.imageGroups,[4,(0,s.i)(e)];case 1:return Object.keys(l=a.sent()).forEach(function(e){if("state"!==e){var t=l[e];e.match(/^[a-f0-9]{40,}$/gi)?f.mU.setItem("".concat(e),t):e.startsWith("frame-")&&f.Uv.setItem("".concat(e.split("frame-").pop()),t)}}),[2,_(n,i,u,c,l.state||{},t)]}})});return function(t){return e.apply(this,arguments)}}(),S=function(){var e,t,r,o=(0,u.g)().globalUpdate;return{downloadSettings:(0,i.useCallback)((e=(0,n._)(function(e){var t,r,n,i=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:"",[4,(0,l.m)(e,{selectedFrameGroup:t})];case 1:return r=a.sent(),n="frames"===e?"frames":[e,t].filter(Boolean).join("_"),(0,c.R)(null)([{blob:new Blob(Array(r)),filename:"".concat(n,".json")}]),[2]}})}),function(t){return e.apply(this,arguments)}),[]),jsonImport:(0,i.useCallback)((t=(0,n._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,D(e,!0)];case 1:return o(t.sent()),[2]}})}),function(e){return t.apply(this,arguments)}),[o]),remoteImport:(0,i.useCallback)((r=(0,n._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,D(e,!1)];case 1:return o(t.sent()),[2]}})}),function(e){return r.apply(this,arguments)}),[o])}}},86964:(e,t,r)=>{r.d(t,{f:()=>n});var n=function(e){var t=e.invertPalette||!1;if(!e.lockFrame)return{invertPalette:t,invertFramePalette:t};var r=e.invertFramePalette;return{invertPalette:t,invertFramePalette:void 0===r?t:r}}},99999:(e,t,r)=>{r.d(t,{V:()=>n});var n=function(e){return e.BRIGHT="theme-bright",e.DARK="theme-dark",e}({})}}]);