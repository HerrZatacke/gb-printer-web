"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[283],{1470:(e,t,n)=>{n.d(t,{t:()=>r,z:()=>u});var r="ROOT",u=function(){return{id:r,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[]}}},4862:(e,t,n)=>{n.d(t,{j:()=>r});var r=function(e){return e.GALLERY_VIEW_SMALL="small",e.GALLERY_VIEW_1X="1x",e.GALLERY_VIEW_2X="2x",e.GALLERY_VIEW_MAX="max",e.PALETTE_VIEW="res2x",e}({})},5847:(e,t,n)=>{n.d(t,{T:()=>i,p:()=>s});var r=n(97004),u=n(39249),a=n(55364),o=n(72623),i=function(e,t,n){var i,s=(i=(0,r._)(function(r,i,l,c){var d,f,p,g,E,v,m,I,h,T,_,R;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(f=e.find(function(e){return r===e.hash}),p=("string"==typeof l?l:null==f?void 0:f.frame)||void 0,g=null==(d=t.find(function(e){return e.id===p}))?void 0:d.hash,c||!(!f||!(0,a.pl)(f)))return[3,2];return[4,(0,o.Hh)(r,g,i,n)];case 1:return[2,u.sent()||[]];case 2:if(!(E=c||f.hashes).r)return[3,4];return[4,s(E.r,i,p)];case 3:return m=u.sent(),[3,5];case 4:m=[],u.label=5;case 5:if(v=m,!E.g)return[3,7];return[4,s(E.g,i,p)];case 6:return h=u.sent(),[3,8];case 7:h=[],u.label=8;case 8:if(I=h,!E.b)return[3,10];return[4,s(E.b,i,p)];case 9:return _=u.sent(),[3,11];case 10:_=[],u.label=11;case 11:if(T=_,!E.n)return[3,13];return[4,s(E.n,i,p)];case 12:return R=u.sent(),[3,14];case 13:R=[],u.label=14;case 14:return[2,{r:v,g:I,b:T,n:R}]}})}),function(e,t,n,r){return i.apply(this,arguments)});return s},s=function(e,t){var n,a=i(e,t);return n=(0,r._)(function(e){var t,n,r,o,i;return(0,u.YH)(this,function(u){switch(u.label){case 0:return[4,a(e,!0,"")];case 1:if(t=u.sent())return[2,(null==t?void 0:t.length)||(null==(n=t.r)?void 0:n.length)||(null==(r=t.g)?void 0:r.length)||(null==(o=t.b)?void 0:o.length)||(null==(i=t.n)?void 0:i.length)||0];return[2,0]}})}),function(e){return n.apply(this,arguments)}}},6456:(e,t,n)=>{n.d(t,{PM:()=>s,YZ:()=>o,lt:()=>i});var r=n(693),u=n(60376),a=n(78538),o=function(e,t){return(0,u._)((0,r._)({},e),{sortIndex:t})},i=function(e){return(0,u._)((0,r._)({},e),{sortIndex:void 0})},s=function(e){return function(t,n){if(!e)return 0;var r=(0,a._)(e.split("_"),2),u=r[0],o=r[1],i=t[u],s=n[u],l="desc"===o?-1:1;return i&&s?i>s?l:i<s?-l:t.sortIndex<n.sortIndex?l:-l:0}}},7119:(e,t,n)=>{n.d(t,{NavigationToolsProvider:()=>g,g:()=>E});var r=n(95155),u=n(12115),a=n(78538),o=n(35695),i=n(95939),s=n(71620),l=n(52166),c=n(1470),d=n(66785),f=function(){var e=(0,o.useRouter)(),t=(0,i.Z)(),n=t.paths,r=t.root,f=t.isWorking,p=t.path,g=t.getUrl,E=(0,a._)((0,u.useState)(!1),2),v=E[0],m=E[1],I=(0,s.A)(),h=I.sortBy,T=I.filtersActiveTags,_=I.recentImports,R=(0,l.A)().pageSize,S=(0,u.useCallback)(function(e){return(0,d.S)(e,{filtersActiveTags:T,sortBy:h,recentImports:_})},[T,_,h]),A=(0,u.useCallback)(function(e,t){return Math.floor(S(t.images).findIndex(function(t){return t.hash===e})/R)},[S,R]),L=(0,u.useCallback)(function(e,t){var r;return e===c.t?g({pageIndex:t,group:""}):g({pageIndex:t,group:(null==(r=n.find(function(t){return e===t.group.id}))?void 0:r.absolutePath)||""})},[g,n]),G=(0,u.useMemo)(function(){var e;return(null==(e=n.find(function(e){return e.absolutePath===p}))?void 0:e.group)||r},[p,n,r]),N=(0,u.useCallback)(function(e){var t=n.find(function(t){return t.group.images.map(function(e){return e.hash}).includes(e)}),u=(null==t?void 0:t.absolutePath)||"";return g({pageIndex:A(e,(null==t?void 0:t.group)||r),group:u})},[A,g,n,r]),b=(0,u.useCallback)(function(e,t){f||window.setTimeout(function(){m({group:{id:e,pageIndex:t}})},1)},[f]),C=(0,u.useCallback)(function(e){window.setTimeout(function(){m({imageHash:e})},1)},[]);return(0,u.useEffect)(function(){if(!f&&v){var t=window.setTimeout(function(){v.imageHash?(e.push(N(v.imageHash)),m(!1)):v.group&&(e.push(L(v.group.id,v.group.pageIndex)),m(!1))},1);return function(){window.clearTimeout(t)}}},[L,N,f,e,v]),{currentGroup:G,getGroupPath:L,getImagePageIndexInGroup:A,navigateToGroup:b,navigateToImage:C}},p=(0,u.createContext)(null);function g(e){var t=e.children,n=f();return(0,r.jsx)(p.Provider,{value:n,children:t})}var E=function(){var e=(0,u.useContext)(p);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},12360:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(19864);let u=function(e){return function(t){var n=e.filter(function(e){return![r.X3.FILTER_MONOCHROME,r.X3.FILTER_NEW,r.X3.FILTER_RGB,r.X3.FILTER_UNTAGGED,r.X3.FILTER_RECENT,r.X3.FILTER_FAVOURITE,r.X3.FILTER_COMMENTS,r.X3.FILTER_USERNAME].includes(e)});return!n.length||!!t.tags.find(function(e){return n.includes(e)})}}},23747:(e,t,n)=>{n.d(t,{Ay:()=>T,BF:()=>m,Ll:()=>v});var r=n(97004),u=n(693),a=n(60376),o=n(78538),i=n(39249),s=n(12115),l=n(95939),c=n(7119),d=n(3381),f=n(71620),p=n(11760),g=n(80360),E=n(46594),v="NEW_GROUP",m=function(e){return e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase()},I=function(e,t){return e.find(function(e){return e.group.groups.find(function(e){return e.id===t})})||null},h=function(e){return e.CREATE_NEW="CREATE_NEW",e.EDIT_EXISTING="EDIT_EXISTING",e.NOT_EDITING="NOT_EDITING",e}(h||{});let T=function(){var e,t=(0,f.A)().imageSelection,n=(0,d.A)(),h=n.editImageGroup,T=n.cancelEditImageGroup,_=(0,p.h)(),R=_.imageGroups,S=_.addImageGroup,A=_.updateImageGroup,L=_.groupImagesAdd,G=_.ungroupImages,N=(0,c.g)(),b=N.navigateToGroup,C=N.navigateToImage,w=(0,l.Z)(),M=w.path,P=w.view,y=w.paths,F=w.pathsOptions,D=t.length,x=(null==h?void 0:h.groupId)?h.groupId===v?"CREATE_NEW":"EDIT_EXISTING":"NOT_EDITING",X=(0,s.useMemo)(function(){switch(x){case"CREATE_NEW":var e=(null==h?void 0:h.newGroupTitle)||"";return{imageGroup:null,parentPathMap:y.find(function(e){return e.group.id===P.id})||null,title:e,slug:m(e),slugTouched:!1};case"EDIT_EXISTING":var t=R.find(function(e){return e.id===(null==h?void 0:h.groupId)})||null;return{imageGroup:t,parentPathMap:(null==h?void 0:h.groupId)?I(y,h.groupId):null,title:(null==t?void 0:t.title)||"",slug:(null==t?void 0:t.slug)||"",slugTouched:!0};default:return{imageGroup:null,parentPathMap:null,title:"",slug:"",slugTouched:!1}}},[h,x,R,y,P]),O=(0,o._)((0,s.useState)(X.title),2),U=O[0],W=O[1],k=(0,o._)((0,s.useState)(X.slug),2),V=k[0],B=k[1],H=(0,o._)((0,s.useState)(X.slugTouched),2),K=H[0],z=H[1],Y=(0,o._)((0,s.useState)((null==(e=X.parentPathMap)?void 0:e.absolutePath)||""),2),j=Y[0],Z=Y[1],Q=(0,s.useMemo)(function(){if(!(null==h?void 0:h.groupId))return"";if((null==h?void 0:h.groupId)===v)return"".concat(M).concat(V,"/");var e=I(y,h.groupId),t=(null==e?void 0:e.absolutePath)||"";return"".concat(t).concat(V,"/")},[h,y,M,V]),q=(0,s.useMemo)(function(){return!!y.find(function(e){return e.absolutePath===Q})},[Q,y]),J=(0,s.useMemo)(function(){var e;return V!==(null==(e=X.imageGroup)?void 0:e.slug)},[X,V]),$=(0,s.useMemo)(function(){return!!V&&("CREATE_NEW"===x?!q:"EDIT_EXISTING"===x&&(!J||!q))},[x,V,q,J]),ee=(0,s.useMemo)(function(){var e,t,n=(null==(e=y.find(function(e){return e.absolutePath===j}))?void 0:e.group.id)||"";return((null==(t=X.parentPathMap)?void 0:t.group.id)||"")!==n},[X,j,y]),et=(0,s.useMemo)(function(){switch(x){case"EDIT_EXISTING":var e,t=(null==(e=y.find(function(e){return e.group.id===(null==h?void 0:h.groupId)}))?void 0:e.absolutePath)||"";return F.filter(function(e){var n=e.value;return!n.startsWith(Q)&&n!==t});case"CREATE_NEW":return F;default:return[]}},[Q,h,x,y,F]);return{editId:(null==h?void 0:h.groupId)||null,absoluteSlug:Q,possibleParents:et,slug:V,title:U,canConfirm:$,canMove:ee,slugIsInUse:q,slugWasChanged:J,parentSlug:j,selectionCount:D,setSlug:function(e){B(e),z(!0)},setTitle:function(e){W(e),(e.length<2||!K)&&(z(!1),B(m(e)))},setParentSlug:Z,confirm:function(){if(T(),$&&h){var e,n=(null==(e=y.find(function(e){return e.absolutePath===j}))?void 0:e.group.id)||"";if(h.groupId===v){if(!h.newGroupCover)return;var r=(0,g.z)();S({id:r,slug:V,title:U,created:(0,E.J)(),coverImage:h.newGroupCover,images:t,groups:[]},n),b(r,0)}else{if(!X.imageGroup)return;A((0,a._)((0,u._)({},X.imageGroup),{slug:V,title:U}),n),b(h.groupId,0)}}},move:(0,r._)(function(){var e,n;return(0,i.YH)(this,function(r){return T(),ee&&((n=(null==(e=y.find(function(e){return e.absolutePath===j}))?void 0:e.group.id)||"")?L(n,t):G(t),C(t[0])),[2]})}),cancelEditImageGroup:T}}},27803:(e,t,n)=>{n.d(t,{V:()=>r});var r=function(e){return e.DEFAULT_ASC="default_asc",e.DEFAULT_DESC="default_desc",e.USAGE_ASC="usage_asc",e.USAGE_DESC="usage_desc",e.NAME_ASC="name_asc",e.NAME_DESC="name_desc",e}({})},29032:(e,t,n)=>{n.d(t,{j:()=>o});var r=n(78538),u=n(35695),a=n(12115),o=function(){var e=(0,u.usePathname)(),t=(0,r._)((0,a.useState)(window.location.search),2),n=t[0],o=t[1],i=(0,a.useMemo)(function(){return new URLSearchParams(n)},[n]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){o(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var t=history.pushState,n=history.replaceState;return history.pushState=function(){for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];t.apply(this,r),e()},history.replaceState=function(){for(var t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];n.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=t,history.replaceState=n}},[i,e]);var s=(0,a.useMemo)(function(){return i.toString()},[i]);return{fullPath:(0,a.useMemo)(function(){return s?"".concat(e,"?").concat(s):e},[e,s]),pathname:e,query:s,searchParams:i}}},32134:(e,t,n)=>{n.d(t,{GalleryTreeContext:()=>g,K:()=>p});var r=n(78538),u=n(95155),a=n(7062),o=n(12115),i=n(29032),s=n(46498),l=n(11760),c=n(52166),d=n(1470),f="/gallery/",p=(0,o.createContext)({root:(0,d.z)(),view:(0,d.z)(),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(f,"?page=1")}});function g(e){var t=e.children,g=(0,r._)((0,o.useState)(!0),2),E=g[0],v=g[1],m=(0,r._)((0,o.useState)((0,d.z)()),2),I=m[0],h=m[1],T=(0,r._)((0,o.useState)([]),2),_=T[0],R=T[1],S=(0,r._)((0,o.useState)([]),2),A=S[0],L=S[1],G=(0,i.j)(),N=G.searchParams,b=G.pathname,C=(0,r._)((0,o.useState)(""),2),w=C[0],M=C[1],P=(0,c.A)(),y=P.enableImageGroups,F=P.enableDebug,D=(0,s.A)().setError,x=(0,l.h)(),X=x.imageGroups,O=x.images,U=x.setImageGroups,W=(0,o.useMemo)(function(){return y?X:[]},[y,X]);(0,o.useEffect)(function(){var e=new Worker(n.tu(new URL(n.p+n.u(8274),n.b)),{type:void 0}),t=(0,a.LV)(e),r=[],u=(0,a.BX)(function(e){r.push(e)});return v(!0),t.calculate({imageGroups:W,stateImages:O},u).then(function(e){if(h(e.root),R(e.paths),L(e.pathsOptions),r.length&&D(Error(r.join("\n"))),y&&X.length>e.paths.length){var t=e.paths.map(function(e){return e.group.id});U(X.filter(function(e){var n=e.id;return t.includes(n)}))}F&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),D(e)}).finally(function(){v(!1),e.terminate()}),function(){e.terminate(),v(!1)}},[F,y,W,D,U,X,O]);var k=(0,o.useMemo)(function(){var e;return parseInt(null!=(e=N.get("page"))?e:"1",10)-1},[N]),V=(0,o.useMemo)(function(){return N.get("group")||""},[N]),B=(0,o.useCallback)(function(e){var t="number"==typeof e.pageIndex?e.pageIndex:k,n="string"==typeof e.group?e.group:V,r="".concat(f,"?page=").concat(t+1);return n.length&&(r="".concat(r,"&group=").concat(encodeURIComponent(n))),r},[k,V]);(0,o.useEffect)(function(){b===f&&M(B({pageIndex:k,group:V}))},[V,k,b,B]);var H=(0,o.useMemo)(function(){var e,t=(null==(e=_.find(function(e){return e.absolutePath===V}))?void 0:e.group)||I,n=t.groups.map(function(e){return e.coverImage}),r=t.images.filter(function(e){return!n.includes(e.hash)});return{view:t,covers:n,paths:_,images:r,pathsOptions:A,root:I,isWorking:E,pageIndex:k,path:V,lastGalleryLink:w,getUrl:B}},[_,I,A,E,k,V,w,B]);return(0,u.jsx)(p.Provider,{value:H,children:t})}},37547:(e,t,n)=>{n.d(t,{K:()=>r,o:()=>u});var r=function(e){return e.CART_INDEX="CART_INDEX",e.RAM_INDEX="RAM_INDEX",e}({}),u=[{translationKey:"importOrders.cartIndex",value:"CART_INDEX"},{translationKey:"importOrders.ramIndex",value:"RAM_INDEX"}]},39630:(e,t,n)=>{n.d(t,{V:()=>r});var r=function(e){return e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info",e.IMAGE="image",e.META="meta",e}({})},39893:(e,t,n)=>{n.d(t,{C:()=>u,f:()=>r});var r=function(e){return e.WIDER="wider",e.WIDE="wide",e.NORMAL="normal",e.NARROW="narrow",e.NARROWER="narrower",e.EMULATOR="emulator",e}({}),u=[{translationKey:"contrastSettings.wider",baseValues:[0,68,187,255],value:"wider"},{translationKey:"contrastSettings.wide",baseValues:[0,85,170,255],value:"wide"},{translationKey:"contrastSettings.normal",baseValues:[51,102,153,204],value:"normal"},{translationKey:"contrastSettings.narrow",baseValues:[69,115,162,208],value:"narrow"},{translationKey:"contrastSettings.narrower",baseValues:[85,113,141,170],value:"narrower"},{translationKey:"contrastSettings.emulator",baseValues:[64,144,224,255],value:"emulator"}]},44965:(e,t,n)=>{n.d(t,{Gw:()=>o,IB:()=>a,q:()=>u});var r=n(55685),u="en-GB",a=["de-DE","en-CA",u,"en-US"],o=(0,r.A)(a.map(function(e){return e.split("-")[0]}))},49432:(e,t,n)=>{n.d(t,{A:()=>r});let r=function(e,t){if(!e.trim())return"";if("/"===e&&"ws"!==t)return e;var n=!!e.match(RegExp("^".concat(t,"(s)?:\\/\\/"),"gi"));return"".concat(n?"":"".concat(t,"://")).concat(e).concat(e.endsWith("/")?"":"/")}},52166:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(693),u=n(78538),a=n(15905),o=n(65453),i=n(46786),s=n(39893),l=n(81445),c=n(80498),d=n(4862),f=n(27803),p=n(37547),g=n(99999),E=n(44965),v=n(49432),m=n(10746),I=function(){var e="";if("undefined"!=typeof navigator){var t=(0,u._)(navigator.language.split("-"),2);e=[t[0],t[1]].filter(Boolean).join("-")}return E.IB.includes(e)?e:E.q};let h=(0,o.v)((0,i.Zr)(function(e){return{activePalette:"bw",bitmapQueueDither:!0,bitmapQueueSetting:s.f.WIDE,enableDebug:!1,exportFileTypes:["png"],exportScaleFactors:[4],fileNameStyle:l.B.FULL,forceMagicCheck:!1,galleryView:d.j.GALLERY_VIEW_1X,galleryClickAction:c.n.SELECT,handleExportFrame:a.H.FRAMEMODE_KEEP,hideDates:!1,importDeleted:!0,importLastSeen:!0,importPad:!1,lastBaudRate:115200,pageSize:30,preferredLocale:I(),printerParams:"",printerUrl:"",savFrameTypes:"int",savImportOrder:p.K.CART_INDEX,themeName:g.V.BRIGHT,enableImageGroups:!1,sortPalettes:f.V.DEFAULT_DESC,useSerials:!1,videoParams:{},setActivePalette:function(t){return e({activePalette:t})},setBitmapQueueDither:function(t){return e({bitmapQueueDither:t})},setBitmapQueueSetting:function(t){return e({bitmapQueueSetting:t})},setEnableDebug:function(t){return e({enableDebug:t})},setFileNameStyle:function(t){return e({fileNameStyle:t})},setForceMagicCheck:function(t){return e({forceMagicCheck:t})},setGalleryView:function(t){return e({galleryView:t})},setGalleryClickAction:function(t){return e({galleryClickAction:t})},setHandleExportFrame:function(t){return e({handleExportFrame:t})},setHideDates:function(t){return e({hideDates:t})},setImportDeleted:function(t){return e({importDeleted:t})},setImportLastSeen:function(t){return e({importLastSeen:t})},setImportPad:function(t){return e({importPad:t})},setLastBaudRate:function(t){return e({lastBaudRate:t})},setPageSize:function(t){return e({pageSize:t})},setPrinterParams:function(t){return e({printerParams:t})},setPrinterUrl:function(t){return e({printerUrl:(0,v.A)(t,"http")})},setSavFrameTypes:function(t){return e({savFrameTypes:t})},setSavImportOrder:function(t){return e({savImportOrder:t})},setThemeName:function(t){return e({themeName:t})},setEnableImageGroups:function(t){return e({enableImageGroups:t})},setSortPalettes:function(t){return e({sortPalettes:t})},setUseSerials:function(t){return e({useSerials:t})},setVideoParams:function(t){return e(function(e){return{videoParams:(0,r._)({},e.videoParams,t)}})},setExportScaleFactors:function(t){return e({exportScaleFactors:t})},setExportFileTypes:function(t){return e({exportFileTypes:t})},setPreferredLocale:function(t){E.IB.includes(t)?e({preferredLocale:t}):console.log('unknown locale "'.concat(t,'"'))}}},{name:"".concat(m.z,"-settings"),storage:(0,i.KU)(function(){return localStorage})}))},66785:(e,t,n)=>{n.d(t,{S:()=>i});var r=n(87025),u=n(6456),a=n(77840),o=n(12360),i=function(e,t){var n=t.filtersActiveTags,i=t.sortBy,s=t.recentImports;return(0,r._)(e).map(u.YZ).sort((0,u.PM)(i)).map(u.lt).filter((0,a.A)(n,s)).filter((0,o.A)(n))}},77840:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(87025),u=n(30832),a=n.n(u),o=n(19864),i=n(55364);let s=function(e,t){return function(n){var u,s,l=e.reduce(function(e,t){return[o.X3.FILTER_MONOCHROME,o.X3.FILTER_NEW,o.X3.FILTER_RGB,o.X3.FILTER_UNTAGGED,o.X3.FILTER_RECENT,o.X3.FILTER_FAVOURITE,o.X3.FILTER_COMMENTS,o.X3.FILTER_USERNAME].includes(t)?(0,r._)(e).concat([t]):e},[]);if(l.length&&(l.includes(o.X3.FILTER_UNTAGGED)&&0!==n.tags.length||l.includes(o.X3.FILTER_NEW)&&a()(new Date(n.created)).unix()<=a()().subtract(1,"day").unix()||l.includes(o.X3.FILTER_RECENT)&&!t.map(function(e){return e.hash}).includes(n.hash)||l.includes(o.X3.FILTER_RGB)&&!(0,i.pl)(n)||l.includes(o.X3.FILTER_MONOCHROME)&&(0,i.pl)(n)||l.includes(o.X3.FILTER_FAVOURITE)&&!n.tags.includes(o.X3.FILTER_FAVOURITE)||l.includes(o.X3.FILTER_COMMENTS)&&!(null==(u=n.meta)?void 0:u.comment)||l.includes(o.X3.FILTER_USERNAME)&&!(null==(s=n.meta)?void 0:s.userName)))return!1;return!0}}},80360:(e,t,n)=>{n.d(t,{z:()=>r});var r=n(51368).A},80498:(e,t,n)=>{n.d(t,{n:()=>r});var r=function(e){return e.SELECT="select",e.EDIT="edit",e.VIEW="view",e}({})},95939:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(12115),u=n(32134),a=function(){return(0,r.useContext)(u.K)}},99999:(e,t,n)=>{n.d(t,{V:()=>r});var r=function(e){return e.BRIGHT="theme-bright",e.DARK="theme-dark",e}({})}}]);