"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8248],{18786:(e,t,a)=>{a.d(t,{Eh:()=>h,gV:()=>m});var r=(e=>(e[e.INIT=1]="INIT",e[e.PRINT=2]="PRINT",e[e.DATA=4]="DATA",e[e.STATUS=15]="STATUS",e[e.TRANSFER=16]="TRANSFER",e))(r||{}),n=(e=>(e[e.AWAIT_MAGIC_BYTES=0]="AWAIT_MAGIC_BYTES",e[e.AWAIT_COMMAND=1]="AWAIT_COMMAND",e[e.AWAIT_COMPRESSION_INFO=2]="AWAIT_COMPRESSION_INFO",e[e.AWAIT_PACKET_DATA_LENGTH=3]="AWAIT_PACKET_DATA_LENGTH",e[e.AWAIT_DATA=4]="AWAIT_DATA",e[e.AWAIT_CHECKSUM=5]="AWAIT_CHECKSUM",e[e.AWAIT_KEEPALIVE=6]="AWAIT_KEEPALIVE",e[e.AWAIT_STATUS_QUERY=7]="AWAIT_STATUS_QUERY",e))(n||{});let s={command:null,buffer:[],data:[],hasCompression:0,dataLength:0,checksum:0};var A=(e=>(e[e.DETECT_LENGTH=0]="DETECT_LENGTH",e[e.COMPRESSED=1]="COMPRESSED",e[e.UNCOMPRESSED=2]="UNCOMPRESSED",e))(A||{});let o=Array(32).fill(0),i=e=>e.filter(({command:e})=>e===r.DATA||e===r.PRINT),u=e=>e.map(e=>e.command===r.DATA?{...e,hasCompression:0,data:e.hasCompression?(e=>{let t=[],a=A.DETECT_LENGTH,r=0;return e.forEach(e=>{switch(a){case A.DETECT_LENGTH:128&e?(a=A.COMPRESSED,r=(127&e)+2):(a=A.UNCOMPRESSED,r=e+1);return;case A.UNCOMPRESSED:0==(r-=1)&&(a=A.DETECT_LENGTH),t.push(e);return;case A.COMPRESSED:t.push(...[...Array(r)].map(()=>e)),a=A.DETECT_LENGTH,r=0;return}}),t})(e.data):e.data}:e),T=e=>e.map(e=>{if(e.command===r.PRINT){let t={margins:e.data[1],marginUpper:e.data[1]>>4,marginLower:15&e.data[1],palette:e.data[2],paletteData:(e=>[e>>6&3,e>>4&3,e>>2&3,(0|e)&3])(e.data[2])};return{...e,data:t}}return e}),l=(e,t,a=[3,2,1,0])=>{let r=[...Array(8)].map((a,r)=>({a:(t>>7-r)%2,b:(e>>7-r)%2})).map(({a:e,b:t})=>(e<<1)+t).map(e=>a[3-e]).map(e=>({a:(e>>1)%2,b:e%2})).reduce((e,t,a)=>({a:e.a+(t.a<<7-a),b:e.b+(t.b<<7-a)}),{a:0,b:0});return[255&r.b,255&r.a]},c=e=>{let t=[];return e.map(e=>{switch(e.command){case r.DATA:t.push(e);break;case r.PRINT:if(0===e.data.palette){t=[];break}for(;t.length;){let a=t.shift(),r=[];if(!a)throw Error("error harmonizing");for(let t=0;t<a.data.length;t+=2)r.push(...l(a.data[t],a.data[t+1],e.data.paletteData));Object.assign(a,{data:r})}}return e})},f=e=>{let t={transformed:[]},a=[],n=[];return e.forEach(e=>{switch(e.command){case r.DATA:for(let r=0;r<e.data.length;r+=1)a.push(e.data[r].toString(16).padStart(2,"0")),r%16==15&&(t.transformed.push(a.join(" ")),a=[]);break;case r.PRINT:t.palette=e.data.paletteData||t.palette,0!==e.data.marginLower&&(n.push(t.transformed),t={transformed:[]},a=[])}}),t.transformed.length&&n.push(t.transformed),n},E=Array(40).fill("00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"),m=e=>f(c(T(u(i((e=>{let t=n.AWAIT_MAGIC_BYTES,a={...s},r=[];return e.forEach(e=>{switch(t){case n.AWAIT_MAGIC_BYTES:if(0===a.buffer.length&&136===e)return void a.buffer.push(e);if(1===a.buffer.length&&51===e){a.buffer=[],t=n.AWAIT_COMMAND;return}a={...s};return;case n.AWAIT_COMMAND:a.command=e,t=n.AWAIT_COMPRESSION_INFO;return;case n.AWAIT_COMPRESSION_INFO:a.hasCompression=e,t=n.AWAIT_PACKET_DATA_LENGTH;return;case n.AWAIT_PACKET_DATA_LENGTH:if(0===a.buffer.length)return void a.buffer.push(e);a.dataLength=a.buffer[0]+(e<<8),a.buffer=[],t=0===a.dataLength?n.AWAIT_CHECKSUM:n.AWAIT_DATA;return;case n.AWAIT_DATA:if(a.buffer.length<a.dataLength)return void a.buffer.push(e);a.data=a.buffer,a.buffer=[],t=n.AWAIT_CHECKSUM;return;case n.AWAIT_CHECKSUM:if(0===a.buffer.length)return void a.buffer.push(e);a.checksum=a.buffer[0]+(e<<8),a.buffer=[],t=n.AWAIT_KEEPALIVE;return;case n.AWAIT_KEEPALIVE:t=n.AWAIT_STATUS_QUERY;return;case n.AWAIT_STATUS_QUERY:t=n.AWAIT_MAGIC_BYTES,r.push({checksum:a.checksum,command:a.command,data:a.data,dataLength:a.dataLength,hasCompression:a.hasCompression}),a={...s};return}}),r})(e)))))),h=e=>f(c(T(u(i((e=>{let t=n.AWAIT_COMMAND,a={command:null,buffer:[],data:[],hasCompression:0,dataLength:0},s=[],A=()=>{s.push({command:a.command,data:a.data,dataLength:a.dataLength,hasCompression:a.hasCompression}),a={command:null,buffer:[],data:[],hasCompression:0,dataLength:0},t=n.AWAIT_COMMAND};return e.forEach((e,s)=>{switch(t){case n.AWAIT_COMMAND:switch(a.command=e,a.command){case r.INIT:A();return;case r.DATA:t=n.AWAIT_COMPRESSION_INFO;return;case r.PRINT:case r.TRANSFER:t=n.AWAIT_PACKET_DATA_LENGTH;return;default:throw Error(`Unknown packet command: 0x${a.command.toString(16)} at index ${s}`)}case n.AWAIT_COMPRESSION_INFO:a.hasCompression=e,t=n.AWAIT_PACKET_DATA_LENGTH;return;case n.AWAIT_PACKET_DATA_LENGTH:if(0===a.buffer.length)return void a.buffer.push(e);if(a.dataLength=a.buffer[0]+(e<<8),a.buffer=[],0===a.dataLength){t=n.AWAIT_COMMAND,A();return}t=n.AWAIT_DATA;return;case n.AWAIT_DATA:a.buffer.push(e),a.buffer.length===a.dataLength&&(a.data=a.buffer,t=n.AWAIT_COMMAND,a.command===r.TRANSFER&&(A(),a={buffer:[],command:r.PRINT,data:[1,3,228,127],hasCompression:0,dataLength:4}),A())}}),s})(e).map(e=>e.command!==r.TRANSFER?e:{...e,command:r.DATA,data:(e=>{let t=[],a=0,r=e.length;for(;a<r;)t.push(...o,...e.slice(a,a+=256),...o);return t})(e.data)})))))).map(e=>280!==e.length?e:[...E,...e,...E])},81863:(e,t,a)=>{a.d(t,{BX:()=>p,LV:()=>l});let r=Symbol("Comlink.proxy"),n=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),A=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),i=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>i(e)&&e[r],serialize(e){let{port1:t,port2:a}=new MessageChannel;return function e(t,a=globalThis,r=["*"]){a.addEventListener("message",function n(s){let i;if(!s||!s.data)return;if(!function(e,t){for(let a of e)if(t===a||"*"===a||a instanceof RegExp&&a.test(t))return!0;return!1}(r,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);let{id:u,type:l,path:c}=Object.assign({path:[]},s.data),f=(s.data.argumentList||[]).map(I);try{let a=c.slice(0,-1).reduce((e,t)=>e[t],t),r=c.reduce((e,t)=>e[t],t);switch(l){case"GET":i=r;break;case"SET":a[c.slice(-1)[0]]=I(s.data.value),i=!0;break;case"APPLY":i=r.apply(a,f);break;case"CONSTRUCT":{let e=new r(...f);i=p(e)}break;case"ENDPOINT":{var E,m;let{port1:a,port2:r}=new MessageChannel;e(t,r),E=a,m=[a],d.set(E,m),i=E}break;case"RELEASE":i=void 0;break;default:return}}catch(e){i={value:e,[o]:0}}Promise.resolve(i).catch(e=>({value:e,[o]:0})).then(e=>{let[r,s]=_(e);a.postMessage(Object.assign(Object.assign({},r),{id:u}),s),"RELEASE"===l&&(a.removeEventListener("message",n),T(a),A in t&&"function"==typeof t[A]&&t[A]())}).catch(e=>{let[t,r]=_({value:TypeError("Unserializable return value"),[o]:0});a.postMessage(Object.assign(Object.assign({},t),{id:u}),r)})}),a.start&&a.start()}(e,t),[a,[a]]},deserialize:e=>(e.start(),l(e))}],["throw",{canHandle:e=>i(e)&&o in e,serialize:({value:e})=>[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]],deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function T(e){"MessagePort"===e.constructor.name&&e.close()}function l(e,t){let a=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let r=a.get(t.id);if(r)try{r(t)}finally{a.delete(t.id)}}),function e(t,a,r=[],A=function(){}){let o=!1,i=new Proxy(A,{get(n,A){if(c(o),A===s)return()=>{m&&m.unregister(i),f(t),a.clear(),o=!0};if("then"===A){if(0===r.length)return{then:()=>i};let e=g(t,a,{type:"GET",path:r.map(e=>e.toString())}).then(I);return e.then.bind(e)}return e(t,a,[...r,A])},set(e,n,s){c(o);let[A,i]=_(s);return g(t,a,{type:"SET",path:[...r,n].map(e=>e.toString()),value:A},i).then(I)},apply(s,A,i){c(o);let u=r[r.length-1];if(u===n)return g(t,a,{type:"ENDPOINT"}).then(I);if("bind"===u)return e(t,a,r.slice(0,-1));let[T,l]=h(i);return g(t,a,{type:"APPLY",path:r.map(e=>e.toString()),argumentList:T},l).then(I)},construct(e,n){c(o);let[s,A]=h(n);return g(t,a,{type:"CONSTRUCT",path:r.map(e=>e.toString()),argumentList:s},A).then(I)}}),u=(E.get(t)||0)+1;return E.set(t,u),m&&m.register(i,t,i),i}(e,a,[],t)}function c(e){if(e)throw Error("Proxy has been released and is not useable")}function f(e){return g(e,new Map,{type:"RELEASE"}).then(()=>{T(e)})}let E=new WeakMap,m="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(E.get(e)||0)-1;E.set(e,t),0===t&&f(e)});function h(e){var t;let a=e.map(_);return[a.map(e=>e[0]),(t=a.map(e=>e[1]),Array.prototype.concat.apply([],t))]}let d=new WeakMap;function p(e){return Object.assign(e,{[r]:!0})}function _(e){for(let[t,a]of u)if(a.canHandle(e)){let[r,n]=a.serialize(e);return[{type:"HANDLER",name:t,value:r},n]}return[{type:"RAW",value:e},d.get(e)||[]]}function I(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function g(e,t,a,r){return new Promise(n=>{let s=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(s,n),e.start&&e.start(),e.postMessage(Object.assign({id:s},a),r)})}}}]);