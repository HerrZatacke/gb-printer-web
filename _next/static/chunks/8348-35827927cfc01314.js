(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8348],{7062:(e,t,r)=>{"use strict";r.d(t,{BX:()=>p,LV:()=>f});let n=Symbol("Comlink.proxy"),a=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),i=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),u=e=>"object"==typeof e&&null!==e||"function"==typeof e,A=new Map([["proxy",{canHandle:e=>u(e)&&e[n],serialize(e){let{port1:t,port2:r}=new MessageChannel;return function e(t,r=globalThis,n=["*"]){r.addEventListener("message",function a(s){let u;if(!s||!s.data)return;if(!function(e,t){for(let r of e)if(t===r||"*"===r||r instanceof RegExp&&r.test(t))return!0;return!1}(n,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);let{id:A,type:f,path:l}=Object.assign({path:[]},s.data),T=(s.data.argumentList||[]).map(_);try{let r=l.slice(0,-1).reduce((e,t)=>e[t],t),n=l.reduce((e,t)=>e[t],t);switch(f){case"GET":u=n;break;case"SET":r[l.slice(-1)[0]]=_(s.data.value),u=!0;break;case"APPLY":u=n.apply(r,T);break;case"CONSTRUCT":{let e=new n(...T);u=p(e)}break;case"ENDPOINT":{var h,d;let{port1:r,port2:n}=new MessageChannel;e(t,n),h=r,d=[r],E.set(h,d),u=h}break;case"RELEASE":u=void 0;break;default:return}}catch(e){u={value:e,[o]:0}}Promise.resolve(u).catch(e=>({value:e,[o]:0})).then(e=>{let[n,s]=g(e);r.postMessage(Object.assign(Object.assign({},n),{id:A}),s),"RELEASE"===f&&(r.removeEventListener("message",a),c(r),i in t&&"function"==typeof t[i]&&t[i]())}).catch(e=>{let[t,n]=g({value:TypeError("Unserializable return value"),[o]:0});r.postMessage(Object.assign(Object.assign({},t),{id:A}),n)})}),r.start&&r.start()}(e,t),[r,[r]]},deserialize:e=>(e.start(),f(e))}],["throw",{canHandle:e=>u(e)&&o in e,serialize({value:e}){let t;return[e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[]]},deserialize(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function c(e){"MessagePort"===e.constructor.name&&e.close()}function f(e,t){let r=new Map;return e.addEventListener("message",function(e){let{data:t}=e;if(!t||!t.id)return;let n=r.get(t.id);if(n)try{n(t)}finally{r.delete(t.id)}}),function e(t,r,n=[],i=function(){}){let o=!1,u=new Proxy(i,{get(a,i){if(l(o),i===s)return()=>{d&&d.unregister(u),T(t),r.clear(),o=!0};if("then"===i){if(0===n.length)return{then:()=>u};let e=I(t,r,{type:"GET",path:n.map(e=>e.toString())}).then(_);return e.then.bind(e)}return e(t,r,[...n,i])},set(e,a,s){l(o);let[i,u]=g(s);return I(t,r,{type:"SET",path:[...n,a].map(e=>e.toString()),value:i},u).then(_)},apply(s,i,u){l(o);let A=n[n.length-1];if(A===a)return I(t,r,{type:"ENDPOINT"}).then(_);if("bind"===A)return e(t,r,n.slice(0,-1));let[c,f]=m(u);return I(t,r,{type:"APPLY",path:n.map(e=>e.toString()),argumentList:c},f).then(_)},construct(e,a){l(o);let[s,i]=m(a);return I(t,r,{type:"CONSTRUCT",path:n.map(e=>e.toString()),argumentList:s},i).then(_)}}),A=(h.get(t)||0)+1;return h.set(t,A),d&&d.register(u,t,u),u}(e,r,[],t)}function l(e){if(e)throw Error("Proxy has been released and is not useable")}function T(e){return I(e,new Map,{type:"RELEASE"}).then(()=>{c(e)})}let h=new WeakMap,d="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(h.get(e)||0)-1;h.set(e,t),0===t&&T(e)});function m(e){var t;let r=e.map(g);return[r.map(e=>e[0]),(t=r.map(e=>e[1]),Array.prototype.concat.apply([],t))]}let E=new WeakMap;function p(e){return Object.assign(e,{[n]:!0})}function g(e){for(let[t,r]of A)if(r.canHandle(e)){let[n,a]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},E.get(e)||[]]}function _(e){switch(e.type){case"HANDLER":return A.get(e.name).deserialize(e.value);case"RAW":return e.value}}function I(e,t,r,n){return new Promise(a=>{let s=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(s,a),e.start&&e.start(),e.postMessage(Object.assign({id:s},r),n)})}},36816:()=>{},58617:(e,t,r)=>{var n=r(49509);e.exports=r(n.env.PROMISE_QUEUE_COVERAGE?36816:71669)},67299:(e,t,r)=>{"use strict";r.d(t,{Eh:()=>S,gV:()=>C});var n=(e=>(e[e.INIT=1]="INIT",e[e.PRINT=2]="PRINT",e[e.DATA=4]="DATA",e[e.STATUS=15]="STATUS",e[e.TRANSFER=16]="TRANSFER",e))(n||{}),a=(e=>(e[e.AWAIT_MAGIC_BYTES=0]="AWAIT_MAGIC_BYTES",e[e.AWAIT_COMMAND=1]="AWAIT_COMMAND",e[e.AWAIT_COMPRESSION_INFO=2]="AWAIT_COMPRESSION_INFO",e[e.AWAIT_PACKET_DATA_LENGTH=3]="AWAIT_PACKET_DATA_LENGTH",e[e.AWAIT_DATA=4]="AWAIT_DATA",e[e.AWAIT_CHECKSUM=5]="AWAIT_CHECKSUM",e[e.AWAIT_KEEPALIVE=6]="AWAIT_KEEPALIVE",e[e.AWAIT_STATUS_QUERY=7]="AWAIT_STATUS_QUERY",e))(a||{});let s={command:null,buffer:[],data:[],hasCompression:0,dataLength:0,checksum:0};var i=(e=>(e[e.DETECT_LENGTH=0]="DETECT_LENGTH",e[e.COMPRESSED=1]="COMPRESSED",e[e.UNCOMPRESSED=2]="UNCOMPRESSED",e))(i||{});let o=e=>{let t=a.AWAIT_MAGIC_BYTES,r={...s},n=[];return e.forEach(e=>{switch(t){case a.AWAIT_MAGIC_BYTES:if(0===r.buffer.length&&136===e)return void r.buffer.push(e);if(1===r.buffer.length&&51===e){r.buffer=[],t=a.AWAIT_COMMAND;return}r={...s};return;case a.AWAIT_COMMAND:r.command=e,t=a.AWAIT_COMPRESSION_INFO;return;case a.AWAIT_COMPRESSION_INFO:r.hasCompression=e,t=a.AWAIT_PACKET_DATA_LENGTH;return;case a.AWAIT_PACKET_DATA_LENGTH:if(0===r.buffer.length)return void r.buffer.push(e);r.dataLength=r.buffer[0]+(e<<8),r.buffer=[],t=0===r.dataLength?a.AWAIT_CHECKSUM:a.AWAIT_DATA;return;case a.AWAIT_DATA:if(r.buffer.length<r.dataLength)return void r.buffer.push(e);r.data=r.buffer,r.buffer=[],t=a.AWAIT_CHECKSUM;return;case a.AWAIT_CHECKSUM:if(0===r.buffer.length)return void r.buffer.push(e);r.checksum=r.buffer[0]+(e<<8),r.buffer=[],t=a.AWAIT_KEEPALIVE;return;case a.AWAIT_KEEPALIVE:t=a.AWAIT_STATUS_QUERY;return;case a.AWAIT_STATUS_QUERY:t=a.AWAIT_MAGIC_BYTES,n.push({checksum:r.checksum,command:r.command,data:r.data,dataLength:r.dataLength,hasCompression:r.hasCompression}),r={...s};return}}),n},u=e=>{let t=a.AWAIT_COMMAND,r={command:null,buffer:[],data:[],hasCompression:0,dataLength:0},s=[],i=()=>{s.push({command:r.command,data:r.data,dataLength:r.dataLength,hasCompression:r.hasCompression}),r={command:null,buffer:[],data:[],hasCompression:0,dataLength:0},t=a.AWAIT_COMMAND};return e.forEach((e,s)=>{switch(t){case a.AWAIT_COMMAND:switch(r.command=e,r.command){case n.INIT:i();return;case n.DATA:t=a.AWAIT_COMPRESSION_INFO;return;case n.PRINT:case n.TRANSFER:t=a.AWAIT_PACKET_DATA_LENGTH;return;default:throw Error(`Unknown packet command: 0x${r.command.toString(16)} at index ${s}`)}case a.AWAIT_COMPRESSION_INFO:r.hasCompression=e,t=a.AWAIT_PACKET_DATA_LENGTH;return;case a.AWAIT_PACKET_DATA_LENGTH:if(0===r.buffer.length)return void r.buffer.push(e);if(r.dataLength=r.buffer[0]+(e<<8),r.buffer=[],0===r.dataLength){t=a.AWAIT_COMMAND,i();return}t=a.AWAIT_DATA;return;case a.AWAIT_DATA:r.buffer.push(e),r.buffer.length===r.dataLength&&(r.data=r.buffer,t=a.AWAIT_COMMAND,r.command===n.TRANSFER&&(i(),r={buffer:[],command:n.PRINT,data:[1,3,228,127],hasCompression:0,dataLength:4}),i())}}),s},A=Array(32).fill(0),c=e=>{let t=[],r=0,n=e.length;for(;r<n;)t.push(...A,...e.slice(r,r+=256),...A);return t},f=e=>e.map(e=>e.command!==n.TRANSFER?e:{...e,command:n.DATA,data:c(e.data)}),l=e=>e.filter(({command:e})=>e===n.DATA||e===n.PRINT),T=e=>{let t=[],r=i.DETECT_LENGTH,n=0;return e.forEach(e=>{switch(r){case i.DETECT_LENGTH:128&e?(r=i.COMPRESSED,n=(127&e)+2):(r=i.UNCOMPRESSED,n=e+1);return;case i.UNCOMPRESSED:0==(n-=1)&&(r=i.DETECT_LENGTH),t.push(e);return;case i.COMPRESSED:t.push(...[...Array(n)].map(()=>e)),r=i.DETECT_LENGTH,n=0;return}}),t},h=e=>e.map(e=>e.command===n.DATA?{...e,hasCompression:0,data:e.hasCompression?T(e.data):e.data}:e),d=e=>[e>>6&3,e>>4&3,e>>2&3,(0|e)&3],m=e=>e.map(e=>{if(e.command===n.PRINT){let t={margins:e.data[1],marginUpper:e.data[1]>>4,marginLower:15&e.data[1],palette:e.data[2],paletteData:d(e.data[2])};return{...e,data:t}}return e}),E=(e,t,r=[3,2,1,0])=>{let n=[...Array(8)].map((r,n)=>({a:(t>>7-n)%2,b:(e>>7-n)%2})).map(({a:e,b:t})=>(e<<1)+t).map(e=>r[3-e]).map(e=>({a:(e>>1)%2,b:e%2})).reduce((e,t,r)=>({a:e.a+(t.a<<7-r),b:e.b+(t.b<<7-r)}),{a:0,b:0});return[255&n.b,255&n.a]},p=e=>{let t=[];return e.map(e=>{switch(e.command){case n.DATA:t.push(e);break;case n.PRINT:if(0===e.data.palette){t=[];break}for(;t.length;){let r=t.shift(),n=[];if(!r)throw Error("error harmonizing");for(let t=0;t<r.data.length;t+=2)n.push(...E(r.data[t],r.data[t+1],e.data.paletteData));Object.assign(r,{data:n})}}return e})},g=e=>{let t={transformed:[]},r=[],a=[];return e.forEach(e=>{switch(e.command){case n.DATA:for(let n=0;n<e.data.length;n+=1)r.push(e.data[n].toString(16).padStart(2,"0")),n%16==15&&(t.transformed.push(r.join(" ")),r=[]);break;case n.PRINT:t.palette=e.data.paletteData||t.palette,0!==e.data.marginLower&&(a.push(t.transformed),t={transformed:[]},r=[])}}),t.transformed.length&&a.push(t.transformed),a},_=Array(40).fill("00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"),I=e=>e.map(e=>280!==e.length?e:[..._,...e,..._]),C=e=>g(p(m(h(l(o(e)))))),S=e=>I(g(p(m(h(l(f(u(e))))))))},71669:function(e,t,r){var n,a;!function(s,i){"use strict";e.exports&&1?e.exports=i():void 0===(a="function"==typeof(n=i)?n.call(t,r,t,e):n)||(e.exports=a)}(0,function(){"use strict";var e="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw Error("Queue.configure() before use Queue")}}},t=function(){};function r(e,t,r){this.options=r=r||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==e?e:1/0,this.maxQueuedPromises=void 0!==t?t:1/0,this.queue=[]}return r.configure=function(t){e=t},r.prototype.add=function(r){var n=this;return new e(function(e,a,s){if(n.queue.length>=n.maxQueuedPromises)return void a(Error("Queue limit reached"));n.queue.push({promiseGenerator:r,resolve:e,reject:a,notify:s||t}),n._dequeue()})},r.prototype.getPendingLength=function(){return this.pendingPromises},r.prototype.getQueueLength=function(){return this.queue.length},r.prototype._dequeue=function(){var t,r=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n=this.queue.shift();if(!n)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,((t=n.promiseGenerator())&&"function"==typeof t.then?t:new e(function(e){e(t)})).then(function(e){r.pendingPromises--,n.resolve(e),r._dequeue()},function(e){r.pendingPromises--,n.reject(e),r._dequeue()},function(e){n.notify(e)})}catch(e){r.pendingPromises--,n.reject(e),r._dequeue()}return!0},r})}}]);