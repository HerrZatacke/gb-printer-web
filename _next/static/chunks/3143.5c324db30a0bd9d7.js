(()=>{var e={53143:(e,t,r)=>{"use strict";var n,i=r(97004),a=r(577),c=r(39249),s=r(86447),u=function(e){return e.USB="USB",e.SERIAL="SERIAL",e}({}),o=function(e){return e.UNKNOWN="unknown",e.PASSIVE="passive",e.INACTIVE="inactive",e.PACKET_CAPTURE="packet_capture",e.SUPER_PRINTER_INTERFACE="super_printer_interface",e}({});n={},(0,s._)(n,"unknown","Unknown Device"),(0,s._)(n,"passive","Passive Device"),(0,s._)(n,"inactive","Inactive Device"),(0,s._)(n,"packet_capture","Packet Capture device"),(0,s._)(n,"super_printer_interface","Super Printer Interface");var f=function(e){return e.OPEN="OPEN",e.SEND_DATA="SEND_DATA",e.ANSWER="ANSWER",e}({}),d=function(e){return e.ENABLED_STATE="ENABLED_STATE",e.ERROR="ERROR",e.PORTS_CHANGE="PORTS_CHANGE",e.DATA="DATA",e.RECEIVING="RECEIVING",e.QUESTION="QUESTION",e}({}),v=r(26002),l=r(65492),p=r(66214),h=r(62570),g=r(40662),b=r.n(g),y=function(){var e=(0,i._)(function(e){return(0,c.YH)(this,function(t){return[2,new Promise(function(t){self.setTimeout(t,e)})]})});return function(t){return e.apply(this,arguments)}}(),m=function(e,t){for(var r=t.length,n=e.length-r+1,i=0;i<n;i++){for(var a=!0,c=0;c<r;c++)if(e[i+c]!==t[c]){a=!1;break}if(a)return i}return -1},E=function(e){var t=e.filter(Boolean),r=new Uint8Array(t.reduce(function(e,t){return e+t.length},0)),n=0,i=!0,a=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var o=s.value;r.set(o,n),n+=o.length}}catch(e){a=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw c}}return r},P="GAMEBOY PRINTER Packet Capture",T="GAMEBOY PRINTER Emulator",D="Super Printer Interface by Rapha\xebl BOICHOT",_=function(e){function t(){var e;return(0,l._)(this,t),(e=(0,v._)(this,t)).portDeviceType=o.UNKNOWN,e.readTimeoutDuration=1e3,e.textDecoder=new TextDecoder,e.textEncoder=new TextEncoder,e.bufferedData=null,e.readQueue=Promise.resolve(),e}(0,p._)(t,e);var r=t.prototype;return r.getPortDeviceType=function(){return this.portDeviceType},r.startBuffering=function(){var e=this;(0,i._)(function(){var t;return(0,c.YH)(this,function(r){switch(r.label){case 0:if(!e.canRead())return[3,5];return[4,e.readChunk()];case 1:if(!(t=r.sent()).byteLength)return[3,2];return e.bufferedData=E([e.bufferedData,t]),[3,4];case 2:return[4,y(150)];case 3:r.sent(),r.label=4;case 4:return[3,0];case 5:return[2]}})})()},r.readFromBuffer=function(e){var t=e.timeout,r=e.length,n=e.texts,a=this;return(0,i._)(function(){var e,i,s,u,o,f,d,v;return(0,c.YH)(this,function(c){switch(c.label){case 0:if(e="number"==typeof r?r:1/0,i=!0,s=10,"number"==typeof t&&setTimeout(function(){i=!1},t),"number"!=typeof r)return[3,9];0===r&&(i=!1),c.label=1;case 1:c.trys.push([1,7,,8]),c.label=2;case 2:if(!(a.canRead()&&i))return[3,6];if(!(a.bufferedData&&a.bufferedData.byteLength>=r))return[3,3];return i=!1,[3,5];case 3:return[4,y(s)];case 4:c.sent(),c.label=5;case 5:return[3,2];case 6:return[3,8];case 7:return u=c.sent(),a.emit("error",u.message),[3,8];case 8:return[3,20];case 9:if(!(n instanceof Array))return[3,18];0===(o=n.map(function(e){return a.textEncoder.encode(e)})).length&&(i=!1),c.label=10;case 10:if(!(a.canRead()&&i))return[3,17];if(!(a.bufferedData&&a.bufferedData.byteLength))return[3,14];if(!(d=null!=(f=o.map(function(e){return{needle:e,index:m(a.bufferedData,e)}}).filter(function(e){return -1!==e.index}).sort(function(e,t){return e.index-t.index})[0])?f:null))return[3,11];return e=d.index+d.needle.byteLength,i=!1,[3,13];case 11:return[4,y(s)];case 12:c.sent(),c.label=13;case 13:return[3,16];case 14:return[4,y(s)];case 15:c.sent(),c.label=16;case 16:return[3,10];case 17:return[3,20];case 18:if(!(a.canRead()&&i))return[3,20];return[4,y(s)];case 19:return c.sent(),[3,18];case 20:if(!a.bufferedData)return[2,new Uint8Array];return v=a.bufferedData.slice(0,e),a.bufferedData=a.bufferedData.slice(e),[2,v]}})})()},r.read=function(e){var t=this;return new Promise(function(r){t.readQueue=t.readQueue.then(function(){return t.readFromBuffer(e)}).then(r)})},r.detectActiveType=function(e){var t=this.textDecoder.decode(e);-1!==t.indexOf(P)||-1!==t.indexOf(T)?(this.portDeviceType=o.PACKET_CAPTURE,this.readTimeoutDuration=100,this.emit("typechange")):-1!==t.indexOf(D)&&(this.portDeviceType=o.SUPER_PRINTER_INTERFACE,this.readTimeoutDuration=10,this.emit("typechange"))},r.send=function(e,t,r){var n=this;return(0,i._)(function(){var i,a;return(0,c.YH)(this,function(c){switch(c.label){case 0:return r&&(n.bufferedData=null),i=n.read({length:0}),a=t.map(function(e){return n.read(e)}),[4,i];case 1:return c.sent(),[4,n.sendRaw(e)];case 2:return c.sent(),[2,Promise.all(a)]}})})()},r.emitData=function(e){if(0!==e.byteLength){var t={string:this.textDecoder.decode(e),bytes:e,deviceId:this.getId(),portDeviceType:this.portDeviceType};this.emit("data",t)}},r.readLoop=function(){var e=this;return(0,i._)(function(){var t,r,n,i;return(0,c.YH)(this,function(a){switch(a.label){case 0:return e.startBuffering(),[4,e.read({timeout:5e3,texts:[P,T,D]})];case 1:if(t=a.sent(),e.detectActiveType(t),e.portDeviceType===o.UNKNOWN)return[3,2];return e.bufferedData=null,[3,5];case 2:if(!t.byteLength)return[3,3];return e.emitData(t),e.portDeviceType=o.INACTIVE,e.emit("typechange"),[3,5];case 3:return[4,e.send(new Uint8Array([13,10]),[{timeout:500}],!0)];case 4:(r=h._.apply(void 0,[a.sent(),1])[0]).byteLength&&e.emitData(r),e.portDeviceType=o.INACTIVE,e.emit("typechange"),a.label=5;case 5:if(e.portDeviceType===o.INACTIVE)return[2];a.label=6;case 6:a.trys.push([6,10,,11]),a.label=7;case 7:if(!e.canRead())return[3,9];return[4,e.read({timeout:e.readTimeoutDuration})];case 8:return(n=a.sent()).byteLength&&(e.emit("receiving"),e.emitData(n)),[3,7];case 9:return[3,11];case 10:return i=a.sent(),e.emit("error",i.message),[3,11];case 11:return[2]}})})()},t}(b()),R=r(51368).A,A=function(e){function t(e){var r;return(0,l._)(this,t),(r=(0,v._)(this,t)).device=e,r.baudRate=0,r.reader=null,r.id=R(),r}(0,p._)(t,e);var r=t.prototype;return r.getDevice=function(){return this.device},r.getBaudRate=function(){return this.baudRate},r.getId=function(){return this.id},r.canRead=function(){return!!(this.reader&&this.getPortDeviceType()!==o.INACTIVE)},r.readChunk=function(){var e=this;return(0,i._)(function(){var t,r;return(0,c.YH)(this,function(n){switch(n.label){case 0:return[4,null==(t=e.reader)?void 0:t.read()];case 1:return[2,null==(r=n.sent())?void 0:r.value]}})})()},r.queryPortSettings=function(){var e=this;return(0,i._)(function(){var t;return(0,c.YH)(this,function(r){switch(r.label){case 0:return[4,new Promise(function(e){var t=R(),r=function(n){n.data.type===f.ANSWER&&n.data.questionId===t&&(self.removeEventListener("message",r),e(n.data.response))};self.addEventListener("message",r),postMessage({type:d.QUESTION,questionId:t})})];case 1:return e.baudRate=(null==(t=r.sent())?void 0:t.baudRate)||0,[2]}})})()},r.connect=function(){var e=this;return(0,i._)(function(){return(0,c.YH)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,e.queryPortSettings()];case 1:if(t.sent(),!e.baudRate)return[2];return console.log(e.baudRate),[4,e.device.open({baudRate:e.baudRate})];case 2:return t.sent(),e.device.addEventListener("disconnect",function(){e.emit("close")}),e.reader=e.device.readable.getReader(),e.readLoop(),[3,4];case 3:return console.error(t.sent()),e.emit("errormessage","could not mount device"),[3,4];case 4:return[2]}})})()},r.sendRaw=function(e){var t=this;return(0,i._)(function(){var r,n;return(0,c.YH)(this,function(i){switch(i.label){case 0:(null==(r=t.device)?void 0:r.writable)||t.emit("errormessage","device is not writable"),n=t.device.writable.getWriter(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,n.write(e)];case 2:return i.sent(),[3,5];case 3:return i.sent(),console.error("Failed to write to serial port"),[3,5];case 4:return n.releaseLock(),[7];case 5:return[2]}})})()},t}(_),I=new(function(e){function t(){var e;return(0,l._)(this,t),(e=(0,v._)(this,t)).enabled="undefined"!=typeof navigator&&!!navigator.serial&&!!TextDecoderStream,e.activePorts=[],e.initPorts(),e}(0,p._)(t,e);var r=t.prototype;return r.getActivePorts=function(){return this.activePorts},r.getWorkerPorts=function(){return this.getActivePorts().map(function(e){return{id:e.getId(),description:"".concat(e.getBaudRate()," baud"),portDeviceType:e.getPortDeviceType()}})},r.initDevice=function(e){var t=this;return(0,i._)(function(){var r;return(0,c.YH)(this,function(n){switch(n.label){case 0:if(e.readable)return[2];return(r=new A(e)).addListener("error",function(e){console.warn(e),t.activePorts=t.activePorts.filter(function(e){return e!==r}),t.emit("activePortsChange")}),r.addListener("errormessage",function(e){t.emit("errormessage",e)}),r.addListener("data",function(e){t.emit("data",e)}),r.addListener("receiving",function(){t.emit("receiving",r.getPortDeviceType())}),r.addListener("typechange",function(){t.emit("activePortsChange")}),[4,r.connect()];case 1:return n.sent(),t.activePorts.push(r),t.emit("activePortsChange"),[2]}})})()},r.initPorts=function(){var e=this;return(0,i._)(function(){return(0,c.YH)(this,function(t){switch(t.label){case 0:if(!e.enabled)return[2];return[4,navigator.serial.getPorts()];case 1:return t.sent().forEach(function(t){return e.initDevice(t)}),navigator.serial.addEventListener("connect",function(t){e.initDevice(t.target)}),navigator.serial.addEventListener("disconnect",function(t){e.activePorts=e.activePorts.filter(function(e){if(e.getDevice()===t.target)return!1}),e.emit("activePortsChange")}),[2]}})})()},t}(b())),N=function(e){function t(e){var r;return(0,l._)(this,t),(r=(0,v._)(this,t)).device=e,r.productName=e.productName||"",r.interfaceNumber=2,r.endpointIn=5,r.endpointOut=4,r.id=R(),r}(0,p._)(t,e);var r=t.prototype;return r.getDevice=function(){return this.device},r.getProductName=function(){return this.productName},r.getId=function(){return this.id},r.canRead=function(){return!!(this.device&&this.device.opened&&this.getPortDeviceType()!==o.INACTIVE)},r.readChunk=function(){var e=this;return(0,i._)(function(){var t,r;return(0,c.YH)(this,function(n){switch(n.label){case 0:return[4,e.device.transferIn(e.endpointIn,64)];case 1:return r=(null==(t=n.sent())?void 0:t.data)||new DataView(new Uint8Array([]).buffer),[2,new Uint8Array(r.buffer,r.byteOffset,r.byteLength)]}})})()},r.connect=function(){var e=this;return(0,i._)(function(){var t,r,n;return(0,c.YH)(this,function(i){switch(i.label){case 0:i.trys.push([0,9,,10]),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.device.open()];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),e.emit("error",r.message),e.emit("errormessage","could not mount device"),[2];case 4:return[4,e.device.selectConfiguration(1)];case 5:if(i.sent(),!(n=null==(t=e.device.configuration)?void 0:t.interfaces))return[2];return n.forEach(function(t){t.alternates.forEach(function(r){255===r.interfaceClass&&(e.interfaceNumber=t.interfaceNumber,r.endpoints.forEach(function(t){"out"===t.direction&&(e.endpointOut=t.endpointNumber),"in"===t.direction&&(e.endpointIn=t.endpointNumber)}))})}),[4,e.device.claimInterface(e.interfaceNumber)];case 6:return i.sent(),[4,e.device.selectAlternateInterface(e.interfaceNumber,0)];case 7:return i.sent(),[4,e.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:e.interfaceNumber})];case 8:return i.sent(),e.readLoop(),[3,10];case 9:return console.error(i.sent()),e.emit("errormessage","could not mount device"),[3,10];case 10:return[2]}})})()},r.sendRaw=function(e){var t=this;return(0,i._)(function(){return(0,c.YH)(this,function(r){switch(r.label){case 0:return[4,t.device.transferOut(t.endpointOut,e)];case 1:return r.sent(),[2]}})})()},t}(_),w=new(function(e){function t(){var e;return(0,l._)(this,t),(e=(0,v._)(this,t)).enabled="undefined"!=typeof navigator&&!!navigator.usb&&!!navigator.usb.getDevices,e.activePorts=[],e.initPorts(),e}(0,p._)(t,e);var r=t.prototype;return r.getActivePorts=function(){return this.activePorts},r.getWorkerPorts=function(){return this.getActivePorts().map(function(e){return{id:e.getId(),description:e.getProductName(),portDeviceType:e.getPortDeviceType()}})},r.initDevice=function(e){var t=this;return(0,i._)(function(){var r;return(0,c.YH)(this,function(n){switch(n.label){case 0:if(e.opened)return[2];return(r=new N(e)).addListener("error",function(e){console.warn(e),t.activePorts=t.activePorts.filter(function(e){return e!==r}),t.emit("activePortsChange")}),r.addListener("errormessage",function(e){t.emit("errormessage",e)}),r.addListener("data",function(e){t.emit("data",e)}),r.addListener("receiving",function(){t.emit("receiving",r.getPortDeviceType())}),r.addListener("typechange",function(){t.emit("activePortsChange")}),t.activePorts.push(r),t.emit("activePortsChange"),[4,r.connect()];case 1:return n.sent(),[2]}})})()},r.initPorts=function(){var e=this;return(0,i._)(function(){return(0,c.YH)(this,function(t){switch(t.label){case 0:if(!e.enabled)return[2];return[4,navigator.usb.getDevices()];case 1:return t.sent().forEach(function(t){return e.initDevice(t)}),navigator.usb.addEventListener("connect",function(t){e.initDevice(t.device)}),navigator.usb.addEventListener("disconnect",function(t){e.activePorts=e.activePorts.filter(function(e){if(e.getDevice()===t.device)return!1}),e.emit("activePortsChange")}),[2]}})})()},t}(b())),L=function(e){return function(){var t=e===u.SERIAL?I.getWorkerPorts():w.getWorkerPorts(),r={type:d.PORTS_CHANGE,activePorts:t,portType:e};self.postMessage(r)}};I.addListener("activePortsChange",L(u.SERIAL)),w.addListener("activePortsChange",L(u.USB));var S=function(e){return function(t){var r={type:d.DATA,readResults:[t],portType:e};self.postMessage(r)}};I.addListener("data",S(u.SERIAL)),w.addListener("data",S(u.USB));var C=function(e){return function(t){var r={type:d.RECEIVING,portDeviceType:t,portType:e};self.postMessage(r)}};I.addListener("receiving",C(u.SERIAL)),w.addListener("receiving",C(u.USB));var O=function(e){return function(t){var r={type:d.ERROR,portType:e,errorMessage:t};self.postMessage(r)}};I.addListener("errormessage",O(u.SERIAL)),w.addListener("errormessage",O(u.USB)),self.onmessage=function(){var e=(0,i._)(function(e){var t,r,n,i,s,o,v,l,p,h,g;return(0,c.YH)(this,function(c){switch(c.label){case 0:switch(t=new TextDecoder,e.data.type){case f.OPEN:return[3,1];case f.SEND_DATA:return[3,2];case f.ANSWER:return[3,4]}return[3,5];case 1:switch(e.data.portType){case u.SERIAL:I.initPorts();break;case u.USB:w.initPorts()}return[3,6];case 2:if(n=(r=e.data).deviceId,i=r.message,s=r.readParamss,o=r.flush,v=r.messageId,!(l=(0,a._)(I.getActivePorts()).concat((0,a._)(w.getActivePorts())).find(function(e){return e.getId()===n})))throw Error("device not found");return p=l instanceof A?u.SERIAL:u.USB,[4,l.send(i,s,o)];case 3:return h=c.sent().map(function(e){return{string:t.decode(e),bytes:e,deviceId:l.getId(),portDeviceType:l.getPortDeviceType()}}),g={type:d.DATA,readResults:h,portType:p,replyToMessageId:v},self.postMessage(g),[3,6];case 4:return[3,6];case 5:console.log(e),c.label=6;case 6:return[2]}})});return function(t){return e.apply(this,arguments)}}(),function(){var e={type:d.ENABLED_STATE,webSerialEnabled:I.enabled,webUSBEnabled:w.enabled};self.postMessage(e)}()}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}},c=!0;try{e[n](a,a.exports,r),c=!1}finally{c&&delete t[n]}return a.exports}r.m=e,r.x=()=>{var e=r.O(void 0,[5955,9449],()=>r(53143));return r.O(e)},(()=>{var e=[];r.O=(t,n,i,a)=>{if(n){a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a];return}for(var s=1/0,c=0;c<e.length;c++){for(var[n,i,a]=e[c],u=!0,o=0;o<n.length;o++)(!1&a||s>=a)&&Object.keys(r.O).every(e=>r.O[e](n[o]))?n.splice(o--,1):(u=!1,a<s&&(s=a));if(u){e.splice(c--,1);var f=i();void 0!==f&&(t=f)}}return t}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,n)=>(r.f[n](e,t),t),[])),r.u=e=>5955===e?"static/chunks/5955-0429eec6e04765df.js":"static/chunks/"+e+".bf533c0f1c804aaa.js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.tt=()=>(void 0===e&&(e={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(e=trustedTypes.createPolicy("nextjs#bundler",e))),e)})(),r.tu=e=>r.tt().createScriptURL(e),r.p="/gb-printer-web/_next/",(()=>{var e={3143:1};r.f.i=(t,n)=>{e[t]||importScripts(r.tu(r.p+r.u(t)))};var t=self.webpackChunk_N_E=self.webpackChunk_N_E||[],n=t.push.bind(t);t.push=t=>{var[i,a,c]=t;for(var s in a)r.o(a,s)&&(r.m[s]=a[s]);for(c&&c(r);i.length;)e[i.pop()]=1;n(t)}})(),(()=>{var e=r.x;r.x=()=>Promise.all([r.e(5955),r.e(9449)]).then(e)})(),_N_E=r.x()})();