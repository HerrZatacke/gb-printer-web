"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4768],{5672:(e,t,r)=>{r.d(t,{A:()=>u,Z:()=>a});var n=r(49641).Buffer,a=function(e){return e.UINT8_ARRAY="uint8array",e.TEXT="text",e.DATA_URL="dataURL",e.BINARY_STRING="binaryString",e}({});let u=function(e,t){return new Promise(function(r,a){var u=new FileReader;switch(u.onload=function(e){var u=e.target;if(null==u?void 0:u.result)return"uint8array"===t?void r(n.from(u.result)):void r(u.result);a(Error("Filereader has no result"))},u.onerror=function(e){a(e)},t){case"uint8array":u.readAsArrayBuffer(e);break;case"text":u.readAsText(e);break;case"binaryString":u.readAsBinaryString(e);break;case"dataURL":u.readAsDataURL(e);break;default:a(Error('readAs param missing or unknown type "'.concat(t,'"')))}})}},27338:(e,t,r)=>{r.d(t,{A:()=>eD});var n=r(97004),a=r(39249),u=r(5672),i=function(e){var t;return t=(0,n._)(function(t){var r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,(0,u.A)(t,u.Z.TEXT)];case 1:r=a.sent();try{n=JSON.parse(r)}catch(e){throw Error("Not a valid .json file")}if(!(null==n?void 0:n.state))throw Error("Not a settings .json file");return e(n),[2,!0]}})}),function(e){return t.apply(this,arguments)}},s=r(48675),o=r(80360),c=r(72623),l=function(){var e=(0,n._)(function(e){var t,r,n,i,l,f,p;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=s.A.getState().importQueueAdd,[4,(0,u.A)(e,u.Z.UINT8_ARRAY)];case 1:var m;if(71!==(m=r=a.sent())[0]||66!==m[1]||45!==m[2]||66!==m[3]||73!==m[4]||78!==m[5]||48!==m[6]||49!==m[7])throw Error('Not a valid .bin file - is it missing the "GB-BIN01" header?');for(n=[],i=[],l=8;l<r.length;l+=1)f=r[l],i.push(f.toString(16).padStart(2,"0").toUpperCase()),16===i.length&&(n.push(i.join(" ")),i=[]);if(i.length){for(;i.length<16;)i.push("FF");n.push(i.join(" "))}return[4,(0,c.cg)(n)];case 2:return p=a.sent().dataHash,t([{fileName:e.name,imageHash:p,tiles:n,lastModified:e.lastModified,tempId:(0,o.z)()}]),[2,!0]}})});return function(t){return e.apply(this,arguments)}}(),f=r(85539),p=r(34687),m=function(){var e=(0,n._)(function(e){var t,r,n=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=n.length>1&&void 0!==n[1]&&n[1],[4,(0,p.A)(e)];case 1:return r=a.sent(),t?(0,f._)({bitmapQueue:[r],dither:!1,contrastBaseValues:[0,85,170,255],importQueueAdd:s.A.getState().importQueueAdd}):s.A.getState().bitmapQueueAdd([r]),[2,!0]}})});return function(t){return e.apply(this,arguments)}}(),d=r(67299);let h=function(e){var t=e.split("\n").map(function(e){return e.trim()}).filter(function(e){return e.length&&0!==e.indexOf("//")&&0!==e.indexOf("/*")}).map(function(e){return e.split(" ")}).flat().map(function(e){return parseInt(e,16)}).filter(function(e){return!isNaN(e)});return(0,d.gV)(t)};var g=r(577),v=r(5432),b=function(e){return e.NEW_LINES="NEW_LINES",e.IMAGE_COMPLETE="IMAGE_COMPLETE",e.PARSE_ERROR="PARSE_ERROR",e}({});let y=function(e){if("#"===e.charAt(0)||"/"===e.charAt(0))return null;if("!"===e.charAt(0)||"{"===e.charAt(0)){try{var t=JSON.parse(e.slice(e.indexOf("{")).trim()),r=t.command,n=t.margin_lower;if("PRNT"===r&&n>0)return{type:b.IMAGE_COMPLETE}}catch(e){return{type:b.PARSE_ERROR,payload:"Error while trying to parse JSON data command block"}}return null}var a=e.replace(/[^0-9A-F]/ig,"");return a.length?{type:b.NEW_LINES,payload:[a]}:null},w=function(e,t){var r="".concat(e,"\n").concat(v.Ys).split("\n").map(y).reduce(function(e,t){switch(null==t?void 0:t.type){case b.NEW_LINES:var r;return(r=e[e.length-1]).push.apply(r,(0,g._)(t.payload)),e;case b.IMAGE_COMPLETE:return(0,g._)(e).concat([[]]);default:return e}},[[]]).filter(function(e){return e.length>0});return r.length||console.warn("File ".concat(t," did not contain images")),r};var V=function(){var e=(0,n._)(function(e){var t,r,i;return(0,a.YH)(this,function(l){switch(l.label){case 0:return t=s.A.getState().importQueueAdd,[4,(0,u.A)(e,u.Z.TEXT)];case 1:if(-1===(r=l.sent()).indexOf('{"command"'))return[3,3];return[4,w(r,e.name)];case 2:return i=l.sent(),[3,5];case 3:return[4,h(r)];case 4:i=l.sent(),l.label=5;case 5:var f;return[4,Promise.all(i.map((f=(0,n._)(function(r,n){var u,s;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,(0,c.cg)(r)];case 1:return u=a.sent().dataHash,s=i.length<2?"":" ".concat((n+1).toString(10).padStart(2,"0")),t([{fileName:"".concat(e.name).concat(s),imageHash:u,tiles:r,lastModified:e.lastModified?e.lastModified+n:void 0,tempId:(0,o.z)()}]),[2,!0]}})}),function(e,t){return f.apply(this,arguments)})))];case 6:return l.sent(),[2,!0]}})});return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,n._)(function(e){var t,r,i;return(0,a.YH)(this,function(l){switch(l.label){case 0:return t=s.A.getState().importQueueAdd,[4,(0,u.A)(e,u.Z.UINT8_ARRAY)];case 1:return r=l.sent(),[4,(0,d.Eh)(r)];case 2:var f;return[4,Promise.all((i=l.sent()).map((f=(0,n._)(function(r,n){var u,s;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,(0,c.cg)(r)];case 1:return u=a.sent().dataHash,s=i.length<2?"":" (".concat(n+1,")"),t([{fileName:"".concat(e.name).concat(s),imageHash:u,tiles:r,lastModified:e.lastModified?e.lastModified+n:void 0,tempId:(0,o.z)()}]),[2,!0]}})}),function(e,t){return f.apply(this,arguments)})))];case 3:return l.sent(),[2,!0]}})});return function(t){return e.apply(this,arguments)}}(),E=r(3899),_=r.n(E),S=r(52166),k=r(693),I=r(58617),D=r.n(I),F=r(47639),B=r(99451),N=r(87031),M=r(62570),H={86:"A",87:"B",88:"C",89:"D",90:"E",91:"F",92:"G",93:"H",94:"I",95:"J",96:"K",97:"L",98:"M",99:"N",100:"O",101:"P",102:"Q",103:"R",104:"S",105:"T",106:"U",107:"V",108:"W",109:"X",110:"Y",111:"Z",112:"_",113:"'",114:",",115:".",116:"\xc1",117:"\xc2",118:"\xc0",119:"\xc4",120:"\xc9",121:"\xca",122:"\xc8",123:"\xcb",124:"\xcd",125:"\xcf",126:"\xd3",127:"\xd6",128:"\xda",129:"\xdc",130:"\xd1",131:"-",132:"&",133:"!",134:"?",135:" ",136:"a",137:"b",138:"c",139:"d",140:"e",141:"f",142:"g",143:"h",144:"i",145:"j",146:"k",147:"l",148:"m",149:"n",150:"o",151:"p",152:"q",153:"r",154:"s",155:"t",156:"u",157:"v",158:"w",159:"x",160:"y",161:"z",162:"•",163:"~",164:"\uD83D\uDCF1",165:" ",166:"\xe1",167:"\xe2",168:"\xe0",169:"\xe4",170:"\xe9",171:"\xea",172:"\xe8",173:"\xeb",174:"\xed",175:"\xef",176:"\xf3",177:"\xf6",178:"\xfa",179:"\xfc",180:"\xf1",181:"ḉ",182:"\xdf",183:"\uD83D\uDE04",184:"\uD83D\uDE1F",185:"\uD83D\uDE05",186:"0",187:"1",188:"2",189:"3",190:"4",191:"5",192:"6",193:"7",194:"8",195:"9",196:"/",197:":",198:"~",199:'"',200:"@"},C={1:"あ",2:"い",3:"う",4:"え",5:"お",6:"か",7:"き",8:"く",9:"け",10:"こ",11:"さ",12:"し",13:"す",14:"せ",15:"そ",16:"た",17:"ち",18:"つ",19:"て",20:"と",21:"な",22:"に",23:"ぬ",24:"ね",25:"の",26:"は",27:"ひ",28:"ふ",29:"へ",30:"ほ",31:"ま",32:"み",33:"む",34:"め",35:"も",36:"や",37:"ゆ",38:"よ",39:"、",40:"。",41:"ら",42:"り",43:"る",44:"れ",45:"ろ",46:"わ",47:"を",48:"ん",49:"〜",50:"♥",51:"が",52:"ぎ",53:"ぐ",54:"げ",55:"ご",56:"ざ",57:"じ",58:"ず",59:"ぜ",60:"ぞ",61:"だ",62:"ぢ",63:"づ",64:"で",65:"ど",66:"ば",67:"び",68:"ぶ",69:"べ",70:"ぼ",71:"ぱ",72:"ぴ",73:"ぷ",74:"ぺ",75:"ぽ",76:"っ",77:"ゃ",78:"ゅ",79:"ょ",80:"・",81:"ぁ",82:"ぃ",83:"ぅ",84:"ぇ",85:"ぉ",86:"ア",87:"イ",88:"ウ",89:"エ",90:"オ",91:"カ",92:"キ",93:"ク",94:"ケ",95:"コ",96:"サ",97:"シ",98:"ス",99:"セ",100:"ソ",101:"タ",102:"チ",103:"ツ",104:"テ",105:"ト",106:"ナ",107:"ニ",108:"ヌ",109:"ネ",110:"ノ",111:"ハ",112:"ヒ",113:"フ",114:"ヘ",115:"ホ",116:"マ",117:"ミ",118:"ム",119:"メ",120:"モ",121:"ヤ",122:"ユ",123:"ヨ",124:"!",125:"?",126:"ラ",127:"リ",128:"ル",129:"レ",130:"ロ",131:"ワ",132:"ヲ",133:"ン",134:"ヴ",135:" ",136:"ガ",137:"ギ",138:"グ",139:"ゲ",140:"ゴ",141:"ザ",142:"ジ",143:"ズ",144:"ゼ",145:"ゾ",146:"ダ",147:"ヂ",148:"ヅ",149:"デ",150:"ド",151:"バ",152:"ビ",153:"ブ",154:"ベ",155:"ボ",156:"パ",157:"ピ",158:"プ",159:"ペ",160:"ポ",161:"ッ",162:"ャ",163:"ュ",164:"ョ",165:"ー",166:"ァ",167:"ィ",168:"ゥ",169:"ェ",170:"ォ",171:"A",172:"B",173:"C",174:"D",175:"E",176:"F",177:"G",178:"H",179:"I",180:"J",181:"K",182:"L",183:"M",184:"N",185:"O",186:"P",187:"Q",188:"R",189:"S",190:"T",191:"U",192:"V",193:"W",194:"X",195:"Y",196:"Z",197:"_",198:"'",199:",",200:".",201:"a",202:"b",203:"c",204:"d",205:"e",206:"f",207:"g",208:"h",209:"i",210:"j",211:"k",212:"l",213:"m",214:"n",215:"o",216:"p",217:"q",218:"r",219:"s",220:"t",221:"u",222:"v",223:"w",224:"x",225:"y",226:"z",227:"\uD83D\uDCF1",228:"\uD83D\uDE05",229:"\uD83D\uDE04",230:"_",231:"0",232:"1",233:"2",234:"3",235:"4",236:"5",237:"6",238:"7",239:"8",240:"9",241:"/",242:":",243:"~",244:'"',245:"@"},x="00123456789?????",R=function(e){return e.PHOTO="photo",e.STOCK="stock",e.PXLR="pxlr",e}({}),T={positive:2,negative:0},P={140:0,155:1,170:2,185:3,200:4,"200Dup":16,215:5,"215Dup":17,230:6,"230Dup":18,245:7,"245Dup":19,260:8,"260Dup":20,275:21,290:9,"290Dup":22,305:23,320:10,"320Dup":24,350:11,"350Dup":25,380:12,"380Dup":26,410:13,"410Dup":27,440:28,455:14,470:29,515:15,"515Dup":30,575:31},O={none:0,horizontal:32,vertical:64,"2d":96},L={on:128,off:0},Y={"050":0,"075":16,100:32,125:48,200:64,300:80,400:96,500:112},z={on:8,off:0},j={"00v":0,"05v":1,"10v":2,"15v":3,"20v":4,"25v":5,"30v":6,"35v":7},U={disabled:0,positive:128,negative:64},W={neg992:31,neg960:30,neg928:29,neg896:28,neg864:27,neg832:26,neg800:25,neg768:24,neg736:23,neg704:22,neg672:21,neg640:20,neg608:19,neg576:18,neg544:17,neg512:16,neg480:15,neg448:14,neg416:13,neg384:12,neg352:11,neg320:10,neg288:9,neg256:8,neg224:7,neg192:6,neg160:5,neg128:4,neg096:3,neg064:2,neg032:1,neg000:0,pos000:32,pos032:33,pos064:34,pos096:35,pos128:36,pos160:37,pos192:38,pos224:39,pos256:40,pos288:41,pos320:42,pos352:43,pos384:44,pos416:45,pos448:46,pos480:47,pos512:48,pos544:49,pos576:50,pos608:51,pos640:52,pos672:53,pos704:54,pos736:55,pos768:56,pos800:57,pos832:58,pos864:59,pos896:60,pos928:61,pos960:62,pos992:63},Q={setHigh:0,setLow:1,on:0,off:16},G={thumbnailByteCapture:0,thumbnailByteEdgegains:16,thumbnailByteExposureHigh:32,thumbnailByteExposureLow:48,thumbnailByteEdmovolt:198,thumbnailByteVoutzero:214,thumbnailByteDitherset:230,thumbnailByteContrast:246},Z={thumbnailByteCapture:200,thumbnailByteEdgegains:201,thumbnailByteExposureHigh:203,thumbnailByteExposureLow:202,thumbnailByteEdmovolt:204,thumbnailByteVoutzero:205,thumbnailByteDitherset:200,thumbnailByteContrast:200},X=function(e,t){var r=.016*e+4.096*t;return r<10?"".concat(r.toFixed(1),"ms"):"".concat(Math.floor(r),"ms")},J=function(e){switch(e){case T.positive:return"positive";case T.negative:return"negative";default:return"unknown"}},K=function(e){switch(e){case L.on:return"on";case L.off:return"off";default:return"unknown"}},q=function(e){switch(e){case O.none:return"none";case O.horizontal:return"horizontal";case O.vertical:return"vertical";case O["2d"]:return"2d";default:return"unknown"}},$=function(e){switch(e){case P["140"]:return"14.0";case P["155"]:return"15.5";case P["170"]:return"17.0";case P["185"]:return"18.5";case P["200"]:return"20.0";case P["200Dup"]:return"20.0 (d)";case P["215"]:return"21.5";case P["215Dup"]:return"21.5 (d)";case P["230"]:return"23.0";case P["230Dup"]:return"23.0 (d)";case P["245"]:return"24.5";case P["245Dup"]:return"24.5 (d)";case P["260"]:return"26.0";case P["260Dup"]:return"26.0 (d)";case P["275"]:return"27.5";case P["290"]:return"29.0";case P["290Dup"]:return"29.0 (d)";case P["305"]:return"30.5";case P["320"]:return"32.0";case P["320Dup"]:return"32.0 (d)";case P["350"]:return"35.0";case P["350Dup"]:return"35.0 (d)";case P["380"]:return"38.0";case P["380Dup"]:return"38.0 (d)";case P["410"]:return"41.0";case P["410Dup"]:return"41.0 (d)";case P["440"]:return"44.0";case P["455"]:return"45.5";case P["470"]:return"47.0";case P["515"]:return"51.5";case P["515Dup"]:return"51.5 (d)";case P["575"]:return"57.5";default:return"unknown"}},ee=function(e){switch(e){case Y["050"]:return"50%";case Y["075"]:return"75%";case Y["100"]:return"100%";case Y["125"]:return"125%";case Y["200"]:return"200%";case Y["300"]:return"300%";case Y["400"]:return"400%";case Y["500"]:return"500%";default:return"unknown"}},et=function(e){switch(e){case z.on:return"on";case z.off:return"off";default:return"unknown"}},er=function(e){switch(e){case j["00v"]:return"0.0V";case j["05v"]:return"0.5V";case j["10v"]:return"1.0V";case j["15v"]:return"1.5V";case j["20v"]:return"2.0V";case j["25v"]:return"2.5V";case j["30v"]:return"3.0V";case j["35v"]:return"3.5V";default:return"unknown"}},en=function(e){switch(e){case U.disabled:return"none";case U.positive:return"positive";case U.negative:return"negative";default:return"unknown"}},ea=function(e){switch(e){case W.neg992:return"-0.992mV";case W.neg960:return"-0.960mV";case W.neg928:return"-0.928mV";case W.neg896:return"-0.896mV";case W.neg864:return"-0.864mV";case W.neg832:return"-0.832mV";case W.neg800:return"-0.800mV";case W.neg768:return"-0.768mV";case W.neg736:return"-0.736mV";case W.neg704:return"-0.704mV";case W.neg672:return"-0.672mV";case W.neg640:return"-0.640mV";case W.neg608:return"-0.608mV";case W.neg576:return"-0.576mV";case W.neg544:return"-0.544mV";case W.neg512:return"-0.512mV";case W.neg480:return"-0.480mV";case W.neg448:return"-0.448mV";case W.neg416:return"-0.416mV";case W.neg384:return"-0.384mV";case W.neg352:return"-0.352mV";case W.neg320:return"-0.320mV";case W.neg288:return"-0.288mV";case W.neg256:return"-0.256mV";case W.neg224:return"-0.224mV";case W.neg192:return"-0.192mV";case W.neg160:return"-0.160mV";case W.neg128:return"-0.128mV";case W.neg096:return"-0.096mV";case W.neg064:return"-0.064mV";case W.neg032:return"-0.032mV";case W.neg000:return"-0.000mV";case W.pos000:return" 0.000mV";case W.pos032:return"0.032mV";case W.pos064:return"0.064mV";case W.pos096:return"0.096mV";case W.pos128:return"0.128mV";case W.pos160:return"0.160mV";case W.pos192:return"0.192mV";case W.pos224:return"0.224mV";case W.pos256:return"0.256mV";case W.pos288:return"0.288mV";case W.pos320:return"0.320mV";case W.pos352:return"0.352mV";case W.pos384:return"0.384mV";case W.pos416:return"0.416mV";case W.pos448:return"0.448mV";case W.pos480:return"0.480mV";case W.pos512:return"0.512mV";case W.pos544:return"0.544mV";case W.pos576:return"0.576mV";case W.pos608:return"0.608mV";case W.pos640:return"0.640mV";case W.pos672:return"0.672mV";case W.pos704:return"0.704mV";case W.pos736:return"0.736mV";case W.pos768:return"0.768mV";case W.pos800:return"0.800mV";case W.pos832:return"0.832mV";case W.pos864:return"0.864mV";case W.pos896:return"0.896mV";case W.pos928:return"0.928mV";case W.pos960:return"0.960mV";case W.pos992:return"0.992mV";default:return"unknown"}},eu=function(e){var t,r;switch(1&e){case Q.setHigh:t="High";break;case Q.setLow:t="Low";break;default:t="unknown"}switch(2&e){case Q.on:r="On";break;case Q.off:r="Off";break;default:r="unknown"}return"".concat(t,"/").concat(r)},ei=function(e){var t=[200,201,202,203,204,205,206,207,216,217,218,219,220,221,222,223,232,233,234,235,236,237,238,239,248,249,250,251,252,253,254,255];return t.map(function(t){return e[t]}).filter(function(e){return 0===e}).length===t.length?R.STOCK:t.map(function(t){return e[t]}).filter(function(e){return 255===e}).length===t.length?R.PXLR:R.PHOTO},es=function(e,t){switch(t){case R.PHOTO:r=Z;break;case R.PXLR:r=G;break;default:return null}var r,n=e[r.thumbnailByteExposureHigh],a=e[r.thumbnailByteExposureLow],u=2&e[r.thumbnailByteCapture],i=128&e[r.thumbnailByteEdgegains],s=96&e[r.thumbnailByteEdgegains],o=31&e[r.thumbnailByteEdgegains],c=112&e[r.thumbnailByteEdmovolt],l=8&e[r.thumbnailByteEdmovolt],f=7&e[r.thumbnailByteEdmovolt],p=192&e[r.thumbnailByteVoutzero],m=63&e[r.thumbnailByteVoutzero],d=e[r.thumbnailByteDitherset],h=e[r.thumbnailByteContrast];return t===R.PHOTO?{romType:t,exposure:X(n,a),captureMode:J(u),edgeExclusive:K(i),edgeOperation:q(s),gain:$(o),edgeMode:ee(c),invertOut:et(l),voltageRef:er(f),zeroPoint:en(p),vOut:ea(m)}:{romType:t,exposure:X(n,a),captureMode:J(u),edgeExclusive:K(i),edgeOperation:q(s),gain:$(o),edgeMode:ee(c),invertOut:et(l),voltageRef:er(f),zeroPoint:en(p),vOut:ea(m),ditherset:eu(d),contrast:h+1}},eo=function(e,t){var r=t?C:H;return(0,g._)(e).map(function(e){return r[e]||" "}).join("").trim()},ec=function(e){switch(28&e){case 4:return"A";case 8:return"B";case 12:return"0";case 16:return"AB";default:return"-"}},el=function(e){if(!e)return"--";var t=x[e>>4],r=x[15&e];return"".concat(t).concat(r)},ef=function(e,t){var r=(0,M._)((0,g._)(e).map(el),4),n=r[0],a=r[1],u=r[2],i=r[3],s="--"===n&&"--"!==a?"00".concat(a):"--"!==n&&"--"===a?"".concat(n,"00"):"".concat(n).concat(a);return t?"".concat(s,"年").concat(u,"月").concat(i,"日"):"".concat(u,"/").concat(i,"/").concat(s)},ep=function(e,t){var r=(0,g._)(e).map(el).map(function(e){return"--"===e?"00":e});return"".concat(t?"PC-":"GC-").concat(r.join(""))},em=function(e,t,r){var n=e.subarray(t+3840,t+3843+1),a=e.subarray(t+3844,t+3852+1),u=e[t+3853],i=e.subarray(t+3854,t+3857+1),s=e.subarray(t+3861,t+3887+1),o=!!e[t+3891];return{userId:ep(n,r),birthDate:ef(i,r),userName:eo(a,r),gender:1&u?"m":2&u?"f":"-",bloodType:ec(u),comment:eo(s,r),isCopy:o}};let ed=function(e,t,r){var n,a=t/4096-2,u=a>=0?e[4530+a]:64,i=e[t+3924],s=e.slice(t+3584,t+3839+1);if(u<64){var o=ei(s);n={romType:o},"stock"!==o&&(n=(0,k._)({},n,es(s,o))),"stock"===o&&(n=(0,k._)({},n,em(e,t,r)))}return{cartIndex:a,albumIndex:u,baseAddress:t,frameNumber:i,meta:n}},eh=function(e,t,r){if(!t)return"";var n,a=function(e){return r.find(function(t){return t.id===e})},u=(e+1).toString(10).padStart(2,"0"),i=a("".concat(t).concat(u));if(null==i?void 0:i.hash)return i.hash;if("jp"===t){var s=a("int".concat(u));if(null==s?void 0:s.hash)return s.hash}var o=a("".concat(t,"01"));if(null==o?void 0:o.hash)return o.hash;if("jp"!==t){var c=a("int".concat(u));if(null==c?void 0:c.hash)return c.hash}return(null==(n=a("int01"))?void 0:n.hash)||""};var eg="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF";let ev=function(e,t){var r=[],n="",a=!1;r.push.apply(r,(0,g._)((0,g._)(Array(40)).map(function(){return eg})));for(var u=0;u<3584;u+=1)u%256==0&&r.push.apply(r,(0,g._)((0,g._)([,,]).map(function(){return eg}))),n+=" ".concat(e[t+u].toString(16).padStart(2,"0")),u%16==15&&(r.push(n.trim()),a||"00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"===n.trim()||(a=!0),n=""),u%256==255&&r.push.apply(r,(0,g._)((0,g._)([,,]).map(function(){return eg})));return r.push.apply(r,(0,g._)((0,g._)(Array(40)).map(function(){return eg}))),a?r:null};var eb=(0,N.A)("albumIndex");let ey=function(e){var t,r=e.importLastSeen,u=e.data,i=e.lastModified,l=e.frames,f=e.fileName,p=e.importDeleted,m=e.forceMagicCheck,d=s.A.getState().importQueueAdd;return m&&[4306,4523,4560,4597].some(function(e){return"Magic"!==(0,g._)(u.subarray(e,e+5)).map(function(e){return String.fromCharCode(e)}).join("")})?null:(t=(0,n._)(function(e,t){var s,m,h,g;return(0,a.YH)(this,function(v){var b,y;switch(v.label){case 0:return s=Array(30).fill(null).map(function(e,t){return(t+2)*4096}).filter(function(e){return e<u.length}),r&&s.unshift(0),[4,Promise.all(s.map((b=(0,n._)(function(r){var n,i,s,o;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(i=(n=ed(u,r,t)).frameNumber,!(s=ev(u,r)))return[3,2];return[4,(0,F.A)(s,eh(i,e,l))];case 1:return o=a.sent(),[2,(0,k._)({tiles:o},n)];case 2:return[2,null]}})}),function(e){return b.apply(this,arguments)})))];case 1:return m=eb(v.sent().filter(Boolean)),h=new(D())(1,1/0),g=0,[4,Promise.all(m.map((y=(0,n._)(function(e){var t,r,u;return(0,a.YH)(this,function(s){return t=e.albumIndex,r=e.tiles,u=e.meta,[2,h.add((0,n._)(function(){var e,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:switch(t){case 64:e="[last seen]";break;case 255:if(!p)return[2,void 0];e="[deleted]";break;default:g+=1,e=g.toString(10).padStart(2,"0")}return[4,(0,c.cg)(r)];case 1:return n=a.sent().dataHash,[2,{fileName:"function"==typeof f?f({indexText:e,albumIndex:t,displayIndex:g}):"".concat(f," ").concat(e),imageHash:n,tiles:r,lastModified:i,meta:u,tempId:(0,o.z)()}]}})}))]})}),function(e){return y.apply(this,arguments)})))];case 2:return d(v.sent().reduce(B.N,[])),[2,!0]}})}),function(e,r){return t.apply(this,arguments)})};var ew=function(e){return e.toString(10).padStart(2,"0")},eV=function(){var e=(0,n._)(function(e){var t,i,s,o,c,l,f;return(0,a.YH)(this,function(p){switch(p.label){case 0:return[4,Promise.resolve().then(r.t.bind(r,52491,23))];case 1:return t=p.sent().default,[4,(0,u.A)(e,u.Z.UINT8_ARRAY)];case 2:var m;return i=p.sent(),o=(s=S.A.getState()).importLastSeen,c=s.importDeleted,l=s.forceMagicCheck,[4,_()(i,131072).reduce(function(e,r,n){var a=t(r);return -1!==e.findIndex(function(e){return e.hash===a})?e:(0,g._)(e).concat([{bankData:r,bankIndex:n,hash:a}])},[]).reduce((m=(0,n._)(function(t,r){var n,u,i,s,f,p,m;return(0,a.YH)(this,function(a){switch(a.label){case 0:return n=r.bankData,u=r.bankIndex,[4,t];case 1:if(i=a.sent(),0===u||(s=function(t){var r=t.albumIndex;return 64===r?"".concat(e.name," - bank ").concat(ew(u)," [last seen]"):255===r?"".concat(e.name," - bank ").concat(ew(u)," [deleted]"):"".concat(e.name," - bank ").concat(ew(u)," - image ").concat(ew(r+1))},!(f=ey({importLastSeen:o,data:n,lastModified:e.lastModified,frames:[],fileName:s,importDeleted:c,forceMagicCheck:l}))))return[2,(0,g._)(i).concat([!1])];return m=(p=(0,g._)(i)).concat,[4,f("",!1)];case 2:return[2,m.apply(p,[[a.sent()]])]}})}),function(e,t){return m.apply(this,arguments)}),Promise.resolve([]))];case 3:if(!(f=p.sent()).filter(Boolean).length)throw Error("File does not contain any recognizable images");return[2,f]}})});return function(t){return e.apply(this,arguments)}}(),eA=r(39630),eE=r(41186),e_=r(11760),eS=r(56491),ek=function(){var e=(0,n._)(function(e,t){var r,i,s,o,c,l,f,p,m,d,h,g,v,b,y,w;return(0,a.YH)(this,function(V){switch(V.label){case 0:return i=(r=eE.A.getState()).dismissDialog,s=r.setDialog,c=(o=e_.h.getState()).frames,l=o.frameGroups,p=(f=S.A.getState()).savFrameTypes,m=f.setSavFrameTypes,[4,(0,u.A)(e,u.Z.UINT8_ARRAY)];case 1:if(d=V.sent(),g=(h=S.A.getState()).importLastSeen,v=h.importDeleted,b=h.forceMagicCheck,(y=(0,eS.A)(c,l).map(function(e){var t=e.id;return{value:t,name:e.name,selected:p===t}})).unshift({value:"",name:"None (Black frame)"}),!(w=ey({importLastSeen:!!t||e.size<=4096||g,data:d,lastModified:e.lastModified,frames:c,fileName:e.name,importDeleted:!!t||v,forceMagicCheck:!t&&b})))throw Error(".sav file seems to be invalid");if(!t)return[3,3];return[4,w("",!1)];case 2:return V.sent(),[2,!0];case 3:return[2,new Promise(function(t){var r;s({message:"Importing '".concat(e.name,"'"),questions:function(){return[{type:eA.V.CHECKBOX,label:"Import is from a Japanese Cart (PocketCamera)",key:"cartIsJP"},y.length>1?{type:eA.V.SELECT,label:"Select frame group to use with this import",key:"chosenFrameset",options:y}:void 0].reduce(B.N,[])},confirm:(r=(0,n._)(function(e){var r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:return r=e.chosenFrameset,n=e.cartIsJP,i(0),m(r),[4,w(r||"",!!n)];case 1:return a.sent(),t(!0),[2]}})}),function(e){return r.apply(this,arguments)}),deny:(0,n._)(function(){return(0,a.YH)(this,function(e){return i(0),t(!0),[2]})})})})]}})});return function(t,r){return e.apply(this,arguments)}}();let eI=function(e){if(e.blob){var t,r;if(t=new File([e.blob],e.blobName||"blob"),r=e.contentType||"application/unknown",void 0!==e.ok&&!e.ok)throw Error("Invalid file received from printer")}else r=(t=e).type;if(!t.size)throw Error("empty file");return{file:t,contentType:r}},eD=function(e){var t,r=i(e);return t=(0,n._)(function(e){var t,n=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=(n.length>1&&void 0!==n[1]?n[1]:{fromPrinter:!1}).fromPrinter,[4,Promise.all(e.map(function(e){var n,a,u,i=eI(e),s=i.file,o=i.contentType;if(o&&o.startsWith("image/"))return m(s,t);if(s.size>0xfffffff)throw Error("File too large");if("text/plain"===o)return V(s);if("application/json"===o)return r(s);if((null==(n=s.name)?void 0:n.toLowerCase().endsWith(".sav"))&&(s.size%4096==0||3584===s.size))return ek(s,3584===s.size);if(((null==(a=s.name)?void 0:a.toLowerCase().endsWith(".gb"))||(null==(u=s.name)?void 0:u.toLowerCase().endsWith(".gbc")))&&s.size%1048576==0)return eV(s);if("application/pico-printer-binary-log"===o)return A(s);if(o.startsWith("application/"))return l(s);throw Error("Not a dump")}))];case 1:return a.sent(),[2]}})}),function(e){return t.apply(this,arguments)}}},34687:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(5672),a=function(e){e.fillStyle="#000",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.filter="grayscale(1)",e.imageSmoothingEnabled=!1};let u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(r,u){var i=document.createElement("img"),s=document.createElement("canvas");s.width=160;var o=s.getContext("2d");if(!o)return void u(Error("No canvas context"));i.onerror=u,i.onload=function(){var n,u=i.naturalWidth,c=i.naturalHeight;.875==c/u?(s.height=144,n=i.naturalWidth/128,t||a(o),o.drawImage(i,0,0,u,c,16,16,s.width-32,s.height-32)):(s.height=s.width*c/u,n=u/160,t||a(o),o.drawImage(i,0,0,u,c,0,0,s.width,s.height)),r({imageData:o.getImageData(0,0,s.width,s.height),scaleFactor:n,width:s.width,height:s.height,fileName:e.name,lastModified:e.lastModified||null})},(0,n.A)(e,n.Z.DATA_URL).then(function(e){i.src=e})})}},64768:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(97004),a=r(39249),u=r(12115),i=r(46498),s=r(27338),o=r(83936);let c=function(){var e,t=i.A.getState().setError,r=(0,o.W)().jsonImport,c=(0,u.useMemo)(function(){return(0,s.A)(r)},[r]);return{handleFileImport:(0,u.useCallback)((e=(0,n._)(function(e,r){return(0,a.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c(e,r)];case 1:return n.sent(),[3,3];case 2:return t(n.sent()),[3,3];case 3:return[2]}})}),function(t,r){return e.apply(this,arguments)}),[c,t])}}},70661:(e,t,r)=>{r.d(t,{q:()=>l,$:()=>c});let n=function(e,t){var r=(t-e)/16;return Array(16).fill(null).map(function(t,n){return Math.floor(e+r*n)})},a=function(e){var t="number"==typeof e[0]?e[0]:0,r="number"==typeof e[1]?e[1]:85,a="number"==typeof e[2]?e[2]:170,u="number"==typeof e[3]?e[3]:255;return[n(t,r),n(r,a),n(a,u)]},u=function(e){for(var t=e.baseValues,r=e.orderPatterns,n=[],a=0;a<4;a+=1){var u=[];n.push(u);for(var i=0;i<4;i+=1){var s=[];u.push(s);for(var o=0;o<3;o+=1)s.push(t[o][r[o][4*a+i]])}}return n};var i=[0,12,3,15,8,4,11,7,2,14,1,13,10,6,9,5],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0,c=function(e){for(var t=e.imageData,r=e.contrastBaseValues,n=e.dither,c=e.colors,l=new ImageData(t.width,t.height),f=u({baseValues:a(r),orderPatterns:[n?i:s,n?i:s,n?i:s]}),p=t.width,m=t.data,d=0;d<m.length;d+=4){var h=o%p%4,g=Math.ceil(o/p)%4,v=m[d],b=void 0,y=f[h][g];b=v<=y[0]?c[3]:v<=y[1]?c[2]:v<=y[2]?c[1]:c[0],l.data[d]=b.r,l.data[d+1]=b.g,l.data[d+2]=b.b,l.data[d+3]=255,o+=1}return l},l=function(e){var t=e.targetCanvas,r=e.originalCanvas,n=e.imageData,a=e.palette,u=e.dither,i=e.contrastBaseValues,s=a.map(function(e){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}}),o=t.getContext("2d"),l=r.getContext("2d");if(!o||!l)return void console.error("canvas context is missing");o.putImageData(c({imageData:n,contrastBaseValues:i,dither:u,colors:s}),0,0),l.putImageData(n,0,0)}},80360:(e,t,r)=>{r.d(t,{z:()=>n});var n=r(51368).A},85539:(e,t,r)=>{r.d(t,{_:()=>l});var n=r(97004),a=r(39249),u=r(70661),i=r(80360),s=r(72623),o=[0,256,1,257],c=function(e){for(var t=[],r=0;r<8;r+=1){for(var n=0,a=0;a<8;a+=1)n+=o[e[8*r+a]]<<7-a;t.push((n>>8).toString(16).padStart(2,"0"),(255&n).toString(16).padStart(2,"0"))}return t.join(" ").toUpperCase()},l=function(e){var t,r=e.bitmapQueue,o=e.dither,l=e.contrastBaseValues,f=e.importQueueAdd;r.forEach((t=(0,n._)(function(e){var t,r,n,p,m,d,h,g,v;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=e.imageData,r=e.height,n=e.fileName,p=e.lastModified,m=Array.from((0,u.$)({imageData:t,contrastBaseValues:l,dither:o,colors:[{r:0,g:0,b:0},{r:1,g:0,b:0},{r:2,g:0,b:0},{r:3,g:0,b:0}]}).data).filter(function(e,t){return!(t%4)}),d=20*Math.ceil(r/8),h=function(e){var t=Math.floor(e/20),r=e%20*8,n=8*t;return Array(8).fill(null).map(function(e,t){return m.slice(r+(n+t)*160).slice(0,8)}).flat(1)},g=Array(d).fill(null).map(function(e,t){return h(t)}).map(c),[4,(0,s.cg)(g)];case 1:return v=a.sent().dataHash,f([{fileName:n,imageHash:v,tiles:g,lastModified:p,tempId:(0,i.z)()}]),[2]}})}),function(e){return t.apply(this,arguments)}))}},99451:(e,t,r)=>{r.d(t,{N:()=>a});var n=r(577),a=function(e,t){return t?(0,n._)(e).concat([t]):e}}}]);