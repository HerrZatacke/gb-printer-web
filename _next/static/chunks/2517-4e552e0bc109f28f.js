"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2517],{11496:(e,t,r)=>{r.d(t,{Gw:()=>u,IB:()=>i,q:()=>a});var n=r(36336),a="en-GB",i=["de-DE","en-CA",a,"en-US","fr-FR"],u=(0,n.A)(i.map(function(e){return e.split("-")[0]}))},15431:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(82732),a=r(22043),i=r(96569),u=r(25959),o=r(89863),s=r(92564),c=r(89922),l=r(45485),f=r(94529),m=r(73204),d=r(96132),p=r(18282),g=r(11496),h=r(32537),v=r(25764),E=function(){var e="";if("undefined"!=typeof navigator){var t=(0,a._)(navigator.language.split("-"),2);e=[t[0],t[1]].filter(Boolean).join("-")}return g.IB.includes(e)?e:g.q};let _=(0,u.v)((0,o.Zr)(function(e){return{activePalette:"bw",alwaysShowDownloadDialog:!0,bitmapQueueDither:!0,bitmapQueueSetting:s.f.WIDE,createGroup:!0,enableDebug:!1,exportFileTypes:["png"],exportScaleFactors:[4],fileNameStyle:c.B.FULL,forceMagicCheck:!1,galleryView:f.j.GALLERY_VIEW_1X,galleryClickAction:l.n.SELECT,handleExportFrame:i.H.FRAMEMODE_KEEP,hideDates:!1,importDeleted:!0,importLastSeen:!0,importPad:!1,lastBaudRate:115200,pageSize:30,preferredLocale:E(),printerParams:"",printerUrl:"",savFrameTypes:"int",savImportOrder:d.K.CART_INDEX,themeName:p.V.BRIGHT,sortPalettes:m.V.DEFAULT_DESC,useSerials:!1,videoParams:{},setActivePalette:function(t){return e({activePalette:t})},setAlwaysShowDownloadDialog:function(t){return e({alwaysShowDownloadDialog:t})},setBitmapQueueDither:function(t){return e({bitmapQueueDither:t})},setBitmapQueueSetting:function(t){return e({bitmapQueueSetting:t})},setCreateGroup:function(t){return e({createGroup:t})},setEnableDebug:function(t){return e({enableDebug:t})},setFileNameStyle:function(t){return e({fileNameStyle:t})},setForceMagicCheck:function(t){return e({forceMagicCheck:t})},setGalleryView:function(t){return e({galleryView:t})},setGalleryClickAction:function(t){return e({galleryClickAction:t})},setHandleExportFrame:function(t){return e({handleExportFrame:t})},setHideDates:function(t){return e({hideDates:t})},setImportDeleted:function(t){return e({importDeleted:t})},setImportLastSeen:function(t){return e({importLastSeen:t})},setImportPad:function(t){return e({importPad:t})},setLastBaudRate:function(t){return e({lastBaudRate:t})},setPageSize:function(t){return e({pageSize:t})},setPrinterParams:function(t){return e({printerParams:t})},setPrinterUrl:function(t){return e({printerUrl:(0,h.A)(t,"http")})},setSavFrameTypes:function(t){return e({savFrameTypes:t})},setSavImportOrder:function(t){return e({savImportOrder:t})},setThemeName:function(t){return e({themeName:t})},setSortPalettes:function(t){return e({sortPalettes:t})},setUseSerials:function(t){return e({useSerials:t})},setVideoParams:function(t){return e(function(e){return{videoParams:(0,n._)({},e.videoParams,t)}})},setExportScaleFactors:function(t){return e({exportScaleFactors:t})},setExportFileTypes:function(t){return e({exportFileTypes:t})},setPreferredLocale:function(t){g.IB.includes(t)?e({preferredLocale:t}):console.log('unknown locale "'.concat(t,'"'))}}},{name:"".concat(v.z,"-settings"),storage:(0,o.KU)(function(){return localStorage})}))},17654:(e,t,r)=>{r.d(t,{s:()=>i});var n=r(15719),a=r(17403),i=function(e,t){if((0,a.pl)(t))return{palette:t.palette};var r=e.find(function(e){return e.shortName===t.palette})||n.Fv,i=e.find(function(e){return e.shortName===t.framePalette})||n.Fv;return{palette:r,framePalette:t.lockFrame?i:r}}},18282:(e,t,r)=>{r.d(t,{V:()=>n});var n=function(e){return e.BRIGHT="theme-bright",e.DARK="theme-dark",e}({})},26490:(e,t,r)=>{r.d(t,{C:()=>u});var n=r(45377),a=r(96569),i=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");return parseInt(t,16)},u=function(e){var t=e.imagePalette,r=e.framePalette,u=e.invertPalette,o=e.invertFramePalette,s=(t||a.CU).map(i),c=(null==r?void 0:r.map(i))||s;return{imagePalette:void 0!==u&&u?(0,n._)(s).reverse():(0,n._)(s),framePalette:void 0!==o&&o?(0,n._)(c).reverse():(0,n._)(c)}}},28802:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(87922),a=r(82732),i=r(45849),u=r(25959),o=r(89863),s=r(25764),c={use:!1,refreshToken:"",accessToken:"",expiresAt:0,path:"",autoDropboxSync:!1},l={branch:"",owner:"",repo:"",throttle:10,token:"",use:!1};let f=(0,u.v)((0,o.eh)((0,o.Zr)(function(e){return{dropboxStorage:{},gitStorage:{},syncLastUpdate:{dropbox:0,local:0},dropboxLogout:function(){return e(function(e){var t=e.dropboxStorage;return{dropboxStorage:(0,i._)((0,a._)({},c),{use:t.use,path:t.path})}})},setDropboxStorage:function(t){return e(function(e){var r=e.dropboxStorage;return{dropboxStorage:(0,a._)({},c,r,t)}})},setGitStorage:function(t){return e(function(e){var r=e.gitStorage;return{gitStorage:(0,a._)({},l,r,t)}})},setSyncLastUpdate:function(t,r){return e(function(e){var u=e.syncLastUpdate;return{syncLastUpdate:(0,i._)((0,a._)({},u),(0,n._)({},t,r))}})}}},{name:"".concat(s.z,"-storages"),storage:(0,o.KU)(function(){return localStorage})})))},31343:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(61975),a=r(45377),i=r(71450),u=r(15719),o=r(75036),s=function(e,t,r){return(0,n._)(function(){var n,s;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,(0,o.Hh)(e)];case 1:return n=(i.sent()||[]).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.join(" "))||""}).reduce(function(e,t,r){return r%40?(0,a._)(e).concat([t]):(0,a._)(e).concat([u.g0,t])},[]),s=[u.dm].concat((0,a._)(n),[u.R2,u.Ys]).join("\n"),[2,{folder:"images",filename:"".concat(r,".txt"),blob:new Blob(Array(s),{type:"text/plain"}),title:t}]}})})()}},32537:(e,t,r)=>{r.d(t,{A:()=>n});let n=function(e,t){if(!e.trim())return"";if("/"===e&&"ws"!==t)return e;var r=!!e.match(RegExp("^".concat(t,"(s)?:\\/\\/"),"gi"));return"".concat(r?"":"".concat(t,"://")).concat(e).concat(e.endsWith("/")?"":"/")}},34093:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(45377);let a=(0,r(25959).v)(function(e){return{dialogs:[],dismissDialog:function(t){return e(function(e){return{dialogs:e.dialogs.filter(function(e,r){return t!==r})}})},setDialog:function(t){return e(function(e){var r=e.dialogs;return{dialogs:[t].concat((0,n._)(r))}})}}})},35797:(e,t,r)=>{r.d(t,{f:()=>n});var n=function(e){var t=e.invertPalette||!1;if(!e.lockFrame)return{invertPalette:t,invertFramePalette:t};var r=e.invertFramePalette;return{invertPalette:t,invertFramePalette:void 0===r?t:r}}},39852:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(45377);let a=(0,r(25959).v)(function(e,t){return{bitmapQueue:[],frameQueue:[],importQueue:[],bitmapQueueAdd:function(t){return e(function(e){var r=e.bitmapQueue;return{bitmapQueue:(0,n._)(r).concat((0,n._)(t))}})},bitmapQueueCancel:function(){return e({bitmapQueue:[]})},frameQueueAdd:function(t){return e(function(e){var r=e.frameQueue;return{frameQueue:(0,n._)(r).concat((0,n._)(t))}})},frameQueueCancelOne:function(t){return e(function(e){return{frameQueue:e.frameQueue.filter(function(e){return e.tempId!==t})}})},importQueueAdd:function(r){var a=t(),i=a.bitmapQueue,u=a.importQueue,o=r.map(function(e){return e.fileName});e({bitmapQueue:i.filter(function(e){var t=e.fileName;return!o.includes(t)}),importQueue:(0,n._)(u).concat((0,n._)(r))})},importQueueSet:function(t){e({importQueue:t})},importQueueCancel:function(){e({importQueue:[]})},importQueueCancelOne:function(t){return e(function(e){return{importQueue:e.importQueue.filter(function(e){return e.tempId!==t})}})},getImportItem:function(e){return t().importQueue.find(function(t){return t.tempId===e})||null}}})},43230:(e,t,r)=>{r.d(t,{m:()=>E});var n=r(61975),a=r(82732),i=r(45849),u=r(71450),o=r(46544),s=r(99861),c=r(57203),l=r(72879),f=r(94468);let m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"frames":return t;case"current_framegroup":return t.filter(function(e){return e.id.startsWith(r)});default:return[]}},d=function(e,t,r){switch(e){case"images":return t.map(function(e){return e.hash});case"selected_images":return r;default:return[]}};var p=r(45377),g=r(17403),h=r(36336),v=function(e){switch(e){case o.m.ALL:case o.m.JSON_EXPORT:return["frameGroups","frames","imageGroups","images","palettes","plugins"];case o.m.SELECTED_IMAGES:return["images"];case o.m.IMAGES:return["images","imageGroups"];case o.m.PALETTES:return["palettes"];case o.m.FRAMES:case o.m.CURRENT_FRAMEGROUP:return["frames","frameGroups"];case o.m.PLUGINS:return["plugins"];default:return[]}},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.lastUpdateUTC,E=t.selectedFrameGroup;return(0,n._)(function(){var t,_,S,A,I,b,w,y,P,R,F,L,T,C,D;return(0,u.YH)(this,function(G){var U,N;switch(G.label){case 0:if(A=(S=l.h.getState()).frames,I=S.images,b=S.palettes,w=S.imageGroups,y=S.frameGroups,P=S.plugins,R=c.A.getState().imageSelection,F=(0,i._)((0,a._)({},v(e).reduce(function(t,r){switch(r){case"frameGroups":return(0,i._)((0,a._)({},t),{frameGroups:e===o.m.CURRENT_FRAMEGROUP?y.filter(function(e){return e.id===E}):(0,s.E)(A,y)});case"frames":var n=e===o.m.FRAMES?o.m.FRAMES:o.m.CURRENT_FRAMEGROUP;return(0,i._)((0,a._)({},t),{frames:m(n,A,E)});case"imageGroups":return(0,i._)((0,a._)({},t),{imageGroups:w});case"images":var u=d(e===o.m.SELECTED_IMAGES?"selected_images":"images",I,R);return(0,i._)((0,a._)({},t),{images:I.filter(function(e){var t=e.hash;return u.includes(t)})});case"palettes":return(0,i._)((0,a._)({},t),{palettes:b.filter(function(e){return!e.isPredefined})});case"plugins":return(0,i._)((0,a._)({},t),{plugins:P});default:return t}},{})),{lastUpdateUTC:r||Math.floor(new Date().getTime()/1e3),version:l.A}),L={},!((null==(t=F.images)?void 0:t.length)&&[o.m.IMAGES,o.m.SELECTED_IMAGES,o.m.ALL].includes(e)))return[3,2];return T=[{},L],[4,(U=F.images,(0,n._)(function(){var e,t;return(0,u.YH)(this,function(r){switch(r.label){case 0:return[4,Promise.all(U.reduce(function(e,t){var r=(0,g.pl)(t)?(0,h.A)(Object.values(t.hashes)):[t.hash];return(0,p._)(e).concat((0,p._)(r))},[]).map(function(e){return(0,n._)(function(){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.mU.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})})()}))];case 1:return e=r.sent(),t={},e.forEach(function(e){var r=e.hash,n=e.data;n&&(t[r]=n)}),[2,t]}})})())];case 1:L=a._.apply(void 0,T.concat([G.sent()])),G.label=2;case 2:if(!((null==(_=F.frames)?void 0:_.length)&&[o.m.FRAMES,o.m.CURRENT_FRAMEGROUP,o.m.ALL].includes(e)))return[3,4];return C=e===o.m.CURRENT_FRAMEGROUP?o.m.CURRENT_FRAMEGROUP:o.m.FRAMES,D=[{},L],[4,(N=m(C,A,E).map(function(e){return e.hash}),(0,n._)(function(){var e,t;return(0,u.YH)(this,function(r){switch(r.label){case 0:return[4,Promise.all(N.map(function(e){return(0,n._)(function(){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.Uv.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})})()}))];case 1:return e=r.sent(),t={},e.forEach(function(e){var r=e.hash,n=e.data;n&&(t["frame-".concat(r)]=n)}),[2,t]}})})())];case 3:L=a._.apply(void 0,D.concat([G.sent()])),G.label=4;case 4:return[2,JSON.stringify((0,a._)({state:F},L),null,2)]}})})()}},45485:(e,t,r)=>{r.d(t,{n:()=>n});var n=function(e){return e.SELECT="select",e.EDIT="edit",e.VIEW="view",e}({})},46544:(e,t,r)=>{r.d(t,{m:()=>n});var n=function(e){return e.ALL="all",e.JSON_EXPORT="json_export",e.FRAMES="frames",e.CURRENT_FRAMEGROUP="current_framegroup",e.IMAGES="images",e.SELECTED_IMAGES="selected_images",e.PALETTES="palettes",e.PLUGINS="plugins",e}({})},50751:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(82732),a=r(45849),i=r(45377),u=r(36117),o=r.n(u),s=r(44344),c=r(74879);let l=(0,r(25959).v)(function(e,t){return{downloadHashes:[],dragover:!1,errors:[],isFullscreen:!1,lightboxImage:null,printerBusy:!1,printerData:null,printerFunctions:[],showSerials:!1,syncBusy:!1,syncSelect:!1,trashBusy:!1,trashCount:{frames:0,images:0,show:!1},videoSelection:[],dismissError:function(r){return e({errors:t().errors.filter(function(e,t){return t!==r})})},setDownloadHashes:function(t){return e({downloadHashes:t})},setDragover:function(t){return e({dragover:t})},setError:function(r){return e({errors:(0,i._)(t().errors).concat([{error:r,timestamp:o()().unix(),id:(0,c.A)()}])})},setIsFullscreen:function(t){return e({isFullscreen:t})},setPrinterBusy:function(t){return e({printerBusy:t})},setPrinterData:function(t){return e({printerData:t})},setPrinterFunctions:function(t){return e({printerFunctions:t})},setShowSerials:function(t){return e({showSerials:t})},setSyncBusy:function(t){return e({syncBusy:t})},setSyncSelect:function(t){return e({syncSelect:t})},showTrashCount:function(r){return e({trashCount:(0,a._)((0,n._)({},t().trashCount),{show:r})})},setTrashBusy:function(t){return e({trashBusy:t})},updateTrashCount:function(r,i){return e({trashCount:(0,a._)((0,n._)({},t().trashCount),{frames:r,images:i})})},setVideoSelection:function(t){return e({videoSelection:t})},setLightboxImage:function(t){null===t&&s.A.isEnabled&&s.A.exit(),e({lightboxImage:t})}}})},55382:(e,t,r)=>{r.d(t,{g:()=>f});var n=r(12115),a=r(34093),i=r(86072),u=r(57203),o=r(39852),s=r(50751),c=r(72879),l=r(28802),f=function(){var e=(0,a.A)(),t=e.dismissDialog,r=e.setDialog,f=(0,i.A)(),m=f.cancelEditFrame,d=f.cancelEditImages,p=f.cancelEditPalette,g=(0,u.A)(),h=g.updateRecentImports,v=g.updateImageSelection,E=(0,o.A)().importQueueCancel,_=(0,s.A)().setPrinterBusy,S=(0,c.h)(),A=S.addImages,I=S.deleteImages,b=S.setImageGroups,w=S.updateFrameGroups,y=S.updateImageHash,P=S.updateImages,R=S.setFrames,F=S.setImages,L=S.setPalettes,T=(0,l.A)().setSyncLastUpdate;return(0,n.useMemo)(function(){var e=function(){return T("local",Math.floor(new Date().getTime()/1e3))},n=function(){_(!1),E()};return{addImages:function(r){A(r),t(0),e(),n(),h(r)},deleteImages:function(r){I(r),v(u.N.REMOVE,r),t(0),e()},dismissDialog:t,globalUpdate:function(t){m(),p(),d(),t.lastUpdateUTC?T("local",t.lastUpdateUTC):e(),t.palettes&&L(t.palettes),t.images&&(F(t.images),h(t.images)),t.frames&&R(t.frames),t.frameGroups&&w(t.frameGroups),t.imageGroups&&b(t.imageGroups)},importQueueCancel:n,setDialog:r,updateImageHash:function(t,r){d(),e(),y(t,r)},updateImages:function(t){P(t),e()},updateLastSyncLocalNow:e}},[A,m,d,p,I,t,E,r,R,F,L,b,_,T,w,y,v,P,h])}},57203:(e,t,r)=>{r.d(t,{A:()=>d,N:()=>m});var n=r(45377),a=r(36117),i=r.n(a),u=r(25959),o=r(89863),s=r(17403),c=r(36336),l=r(37145),f=r(25764),m=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let d=(0,u.v)((0,o.Zr)(function(e,t){return{filtersTags:[],filtersPalettes:[],filtersFrames:[],filtersVisible:!1,imageSelection:[],lastSelectedImage:null,recentImports:[],sortBy:"created_asc",sortOptionsVisible:!1,setFilters:function(t,r,n){e({filtersTags:t,filtersPalettes:r,filtersFrames:n,filtersVisible:!1})},setFiltersVisible:function(t){return e({filtersVisible:t})},setImageSelection:function(t){return e({imageSelection:t,lastSelectedImage:null})},setSortBy:function(t){return e({sortBy:t,sortOptionsVisible:!1})},setSortOptionsVisible:function(t){return e({sortOptionsVisible:t})},cleanRecentImports:function(r){var n=t().recentImports,a=i()().subtract(6,"hour").unix();e({recentImports:n.filter(function(e){var t=e.hash,n=e.timestamp;return r.includes(t)&&n>a})})},updateRecentImports:function(r){var a=t().recentImports,u=r.reduce(function(e,t){return(0,s.pl)(t)?e:(0,n._)(e).concat([{hash:t.hash,timestamp:i()().unix()}])},[]);e({recentImports:(0,l.A)("hash")((0,n._)(a).concat((0,n._)(u)))})},updateImageSelection:function(r,a){var i=t().imageSelection;switch(r){case"add":e({imageSelection:(0,c.A)((0,n._)(i).concat((0,n._)(a))),lastSelectedImage:a[0]});break;case"remove":e({imageSelection:i.filter(function(e){return!a.includes(e)}),lastSelectedImage:null})}}}},{name:"".concat(f.z,"-filters"),storage:(0,o.KU)(function(){return localStorage})}))},73204:(e,t,r)=>{r.d(t,{V:()=>n});var n=function(e){return e.DEFAULT_ASC="default_asc",e.DEFAULT_DESC="default_desc",e.USAGE_ASC="usage_asc",e.USAGE_DESC="usage_desc",e.NAME_ASC="name_asc",e.NAME_DESC="name_desc",e}({})},83231:(e,t,r)=>{r.d(t,{W:()=>b});var n=r(61975),a=r(71450),i=r(12115),u=r(55382),o=r(72879),s=r(65113),c=r(84784),l=r(43230),f=r(94468),m=r(82732),d=r(45849),p=r(45377),g=r(37145),h=function(e){var t=(0,g.A)(e);return function(r,n){var a=new Map(r.map(function(t){return[t[e],t]})),i=n.map(function(t){var r=a.get(t[e]);return r?(0,m._)({},r,t):t});return t((0,p._)(i).concat((0,p._)(r)))}},v=h("hash"),E=h("id"),_=h("shortName"),S=h("id");let A=function(e,t,r,n,a,i){var u=e,o=r,s=t,c=n;return i?(a.frames&&a.frames.length&&(u=E(u,a.frames)),a.images&&a.images.length&&(o=v(o,a.images)),a.palettes&&a.palettes.length&&(s=_(s,a.palettes)),a.imageGroups&&a.imageGroups.length&&(c=S(c,a.imageGroups))):(u=a.frames||e,o=a.images||r,s=a.palettes||t,c=a.imageGroups||n),(0,d._)((0,m._)({},a),{images:o,frames:u,palettes:s,imageGroups:c})};var I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,n._)(function(){var r,n,i,u,c,l;return(0,a.YH)(this,function(a){switch(a.label){case 0:return n=(r=o.h.getState()).frames,i=r.palettes,u=r.images,c=r.imageGroups,[4,(0,s.i)(e)];case 1:return Object.keys(l=a.sent()).forEach(function(e){if("state"!==e){var t=l[e];e.match(/^[a-f0-9]{40,}$/gi)?f.mU.setItem("".concat(e),t):e.startsWith("frame-")&&f.Uv.setItem("".concat(e.split("frame-").pop()),t)}}),[2,A(n,i,u,c,l.state||{},t)]}})})()},b=function(){var e=(0,u.g)().globalUpdate;return{downloadSettings:(0,i.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,n._)(function(){var r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,(0,l.m)(e,{selectedFrameGroup:t})];case 1:return r=a.sent(),n="frames"===e?"frames":[e,t].filter(Boolean).join("_"),(0,c.R)(null)([{blob:new Blob(Array(r)),filename:"".concat(n,".json")}]),[2]}})})()},[]),jsonImport:(0,i.useCallback)(function(t){return(0,n._)(function(){return(0,a.YH)(this,function(r){switch(r.label){case 0:return[4,I(t,!0)];case 1:return e(r.sent()),[2]}})})()},[e]),remoteImport:(0,i.useCallback)(function(t){return(0,n._)(function(){return(0,a.YH)(this,function(r){switch(r.label){case 0:return[4,I(t,!1)];case 1:return e(r.sent()),[2]}})})()},[e])}}},84784:(e,t,r)=>{r.d(t,{R:()=>c,j:()=>S});var n=r(61975),a=r(71450),i=r(20097),u=r(7496),o=r.n(u),s=r(92878);let c=function(e){return function(t){return(0,n._)(function(){var r,n,u,c;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(1===t.length)return r=t[0],[2,(0,i.saveAs)(r.blob,r.filename)];return n=new(o()),[4,Promise.all(t.map(function(e){var t,r=e.filename;return("function"==typeof(t=e.blob).arrayBuffer?t.arrayBuffer():new Promise(function(e){var r=new FileReader;r.onload=function(t){if(!t.target)throw Error("no file");var r=t.target.result;if("string"==typeof r||null===r)throw Error("unexpected filereader result");e(r)},r.readAsArrayBuffer(t)})).then(function(e){return{filename:r,arrayBuffer:e}})}))];case 1:return u=a.sent(),(0,s.A)(u).forEach(function(e){var t=e.filename,r=e.arrayBuffer;n.file(t,r)}),[4,n.generateAsync({type:"blob",compression:"DEFLATE"})];case 2:if(c=a.sent(),!e)throw Error("missing filename");return[2,(0,i.saveAs)(c,"".concat(e,".zip"))]}})})()}};var l=r(82732),f=r(45849),m=r(45377),d=r(96569),p=r(99353),g=r(17654),h=r(26490),v=r(35797),E=r(17403),_=r(31343);let S=function(e,t,r,i,u){return function(o,s,c){return(0,n._)(function(){var S,A,I,b,w,y,P,R,F;return(0,a.YH)(this,function(L){switch(L.label){case 0:if(S=(0,E.pl)(o),A=o.lockFrame||!1,I=o.rotation||0,w=(b=(0,g.s)(i,o)).palette,y=b.framePalette,!w)throw Error("Palette missing?");return P=function(e,t){return(0,n._)(function(){var n,i,u,m;return(0,a.YH)(this,function(a){return S?[2,(0,d.y1)({tiles:s,palette:w,lockFrame:A,imageStartLine:c,rotation:I,scaleFactor:t,handleExportFrame:r},e)]:(i=(n=(0,v.f)(o)).invertPalette,u=n.invertFramePalette,m=(0,h.C)({imagePalette:w.palette||d.CU,framePalette:(null==y?void 0:y.palette)||d.CU,invertPalette:i,invertFramePalette:u}),[2,(0,d.Yn)((0,f._)((0,l._)({tiles:s,rotation:I,scaleFactor:t,handleExportFrame:r},m),{imageStartLine:c}),e)])})})()},R=(0,m._)(e).filter(function(e){return"number"==typeof e}),F=(0,m._)(t),R.length||R.push(4),F.length||F.push("png"),[4,Promise.all(R.map(function(e){return F.map(function(t){return new Promise(function(r){var n=(0,p.A)({image:o,palette:w,exportScaleFactor:e,fileNameStyle:u});switch(t){case"txt":if(S)return void r(null);(0,_.Z)(o.hash,o.title,n).then(r);break;case"pgm":if(S)return void r(null);P("image/png",e).then(createImageBitmap).then(function(e){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var i=a.getContext("2d");i.drawImage(e,0,0);var u=w.palette;if(!i||!(null==u?void 0:u.length))return void r(null);for(var s=["P2","#","# Exported from ".concat(window.location.origin),"#","# hash: ".concat(o.hash),"# created: ".concat(o.created),"# title: ".concat(o.title),"# tags: ".concat(o.tags.join(", ")),"# dimension: ".concat(a.width,"*").concat(a.height," pixels"),"#","".concat(a.width," ").concat(a.height),"3","#"],c=0;c<a.height;c+=1){for(var l=[],f=0;f<a.width;f+=1){var m=i.getImageData(f,c,1,1).data,p="#"+m[0].toString(16).padStart(2,"0")+m[1].toString(16).padStart(2,"0")+m[2].toString(16).padStart(2,"0"),g=w.palette.indexOf(p);-1===g&&(g=d.eJ.indexOf(parseInt(p.slice(1),16))),l.push(3-g)}s.push(l.join(" "))}r({filename:"".concat(n,".").concat(t),blob:new Blob([s.join("\n")],{type:"text/plain"}),title:o.title})});break;default:P("image/".concat(t),e).then(function(e){r({filename:"".concat(n,".").concat(t),blob:e,title:o.title})}).catch(function(){return r(null)})}})})}).flat())];case 1:return[2,L.sent().reduce(function(e,t){return t?(0,m._)(e).concat([t]):e},[])]}})})()}}},86072:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(25959).v)(function(e){return{editFrame:null,editPalette:null,pickColors:null,editImageGroup:null,editImages:null,editRGBNImages:[],setEditFrame:function(t){return e({editFrame:t})},setEditImageGroup:function(t){return e({editImageGroup:t})},setEditPalette:function(t){return e({editPalette:t,pickColors:null})},setEditRGBNImages:function(t){return e({editRGBNImages:t})},setPickColors:function(t){return e({pickColors:t})},setEditImages:function(t){return e({editImages:t})},cancelEditFrame:function(){return e({editFrame:null})},cancelEditImageGroup:function(){return e({editImageGroup:null})},cancelEditPalette:function(){return e({editPalette:null})},cancelEditRGBNImages:function(){return e({editRGBNImages:[]})},cancelPickColors:function(){return e({pickColors:null})},cancelEditImages:function(){return e({editImages:null})}}})},89922:(e,t,r)=>{r.d(t,{B:()=>n,y:()=>a});var n=function(e){return e.FULL="FULL",e.TITLE_ONLY="TITLE_ONLY",e.DATE_TITLE="DATE_TITLE",e}({}),a=[{id:"FULL",name:"filenameStyles.fullTitle"},{id:"DATE_TITLE",name:"filenameStyles.dateTitle"},{id:"TITLE_ONLY",name:"filenameStyles.titleOnly"}]},92564:(e,t,r)=>{r.d(t,{C:()=>a,f:()=>n});var n=function(e){return e.WIDER="wider",e.WIDE="wide",e.NORMAL="normal",e.NARROW="narrow",e.NARROWER="narrower",e.EMULATOR="emulator",e}({}),a=[{translationKey:"contrastSettings.wider",baseValues:[0,68,187,255],value:"wider"},{translationKey:"contrastSettings.wide",baseValues:[0,85,170,255],value:"wide"},{translationKey:"contrastSettings.normal",baseValues:[51,102,153,204],value:"normal"},{translationKey:"contrastSettings.narrow",baseValues:[69,115,162,208],value:"narrow"},{translationKey:"contrastSettings.narrower",baseValues:[85,113,141,170],value:"narrower"},{translationKey:"contrastSettings.emulator",baseValues:[64,144,224,255],value:"emulator"}]},92878:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(82732),a=r(45849);let i=function(e){var t=[];return e.map(function(e){var r=e.filename,i=r.split("."),u=i.pop();if(!u)throw Error("unknown file type");for(var o=i.join("."),s=r,c=0;t.includes(s);)c+=1,s="".concat(o,"_(").concat(c,").").concat(u);return t.includes(s)||t.push(s),(0,a._)((0,n._)({},e),{filename:s})})}},94529:(e,t,r)=>{r.d(t,{j:()=>n});var n=function(e){return e.GALLERY_VIEW_SMALL="small",e.GALLERY_VIEW_1X="1x",e.GALLERY_VIEW_2X="2x",e.GALLERY_VIEW_MAX="max",e.PALETTE_VIEW="res2x",e}({})},96132:(e,t,r)=>{r.d(t,{K:()=>n,o:()=>a});var n=function(e){return e.CART_INDEX="CART_INDEX",e.RAM_INDEX="RAM_INDEX",e}({}),a=[{translationKey:"importOrders.cartIndex",value:"CART_INDEX"},{translationKey:"importOrders.ramIndex",value:"RAM_INDEX"}]},99353:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(36117),a=r.n(n),i=r(49611),u=r(89922),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.reduce(function(e,r){return r?"".concat(e).concat(e?t:"").concat(r):e},"")},s=function(e){var t=e.r,r=e.g,n=e.b,a=e.n,i=function(e){return e.toString(16).padStart(2,"0")};return o([(null==t?void 0:t.map(i).join(""))||"",(null==r?void 0:r.map(i).join(""))||"",(null==n?void 0:n.map(i).join(""))||"",(null==a?void 0:a.map(i).join(""))||""],".")};let c=function(e){var t,r,n=e.image||null,c=e.palette||null,l=e.exportScaleFactor||null,f=e.useCurrentDate||null,m=(null==(t=e.frameRate)?void 0:t.toString(10))||"",d=e.altTitle||"",p=e.frameName||"",g=e.paletteShort||"",h=e.fileNameStyle,v=!f&&(null==n?void 0:n.created)?a()(new Date(n.created)):a()(),E=v.isValid()?v.format("YYYYMMDD-HHmmss"):"",_=g||(c?c.shortName||s(c):""),S=n&&n.title?n.title:d;switch(h){case u.B.TITLE_ONLY:r=[S];break;case u.B.DATE_TITLE:r=[E,S];break;case u.B.FULL:default:r=[E,S,l?"".concat(l,"x"):"",m?"".concat(m,"fps"):"",p,_]}var A=o(r);return(0,i.A)(A,{replacement:""})}},99861:(e,t,r)=>{r.d(t,{E:()=>o,R:()=>s});var n=r(12115),a=r(72879),i=function(e,t,r){var n=r.find(function(t){return t.id===e});if(n)return n.name;switch(e){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return t}},u=function(e){switch(e){case"int":return"_1";case"jp":return"_2";case"hk":return"_3";default:return e}},o=function(e,t){return e.reduce(function(e,r){var n=r.id,a=r.name;try{var u,o=null==(u=n.match(/^[a-z]+/g))?void 0:u[0];if(!o)return e;return e.find(function(e){return e.id===o})||e.push({id:o,name:i(o,a,t)}),e}catch(t){return e}},[]).sort(function(e,t){var r=e.id,n=t.id,a=u(r),i=u(n);return a>i?1:a<i?-1:0})},s=function(){var e=(0,a.h)(),t=e.frameGroups,r=e.frames;return{frameGroups:(0,n.useMemo)(function(){return o(r,t)},[t,r])}}}}]);