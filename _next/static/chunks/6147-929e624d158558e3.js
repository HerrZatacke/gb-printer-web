"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6147],{4599:(e,n,t)=>{t.d(n,{NavigationToolsProvider:()=>d,g:()=>p});var r=t(95155),u=t(12115),a=t(22043),o=t(20063),i=t(89386),s=t(10022),c=t(86539),l=t(84470),f=function(){var e=(0,o.useRouter)(),n=(0,i.Z)(),t=n.paths,r=n.root,f=n.isWorking,g=n.path,d=n.getUrl,p=(0,a._)((0,u.useState)(!1),2),h=p[0],v=p[1],m=(0,s.cr)(),E=m.sortBy,I=m.filtersTags,T=m.filtersFrames,R=m.filtersPalettes,_=m.recentImports,w=(0,s.C$)().pageSize,F=(0,u.useCallback)(function(e){return(0,l.S)(e,{filtersTags:I,filtersFrames:T,filtersPalettes:R,sortBy:E,recentImports:_})},[T,R,I,_,E]),L=(0,u.useCallback)(function(e,n){return Math.floor(F(n).findIndex(function(n){return n.hash===e})/w)},[F,w]),b=(0,u.useCallback)(function(e,n){var r;return e===c.t?d({pageIndex:n,group:""}):d({pageIndex:n,group:(null==(r=t.find(function(n){return e===n.group.id}))?void 0:r.absolutePath)||""})},[d,t]),x=(0,u.useMemo)(function(){var e;return(null==(e=t.find(function(e){return e.absolutePath===g}))?void 0:e.group)||r},[g,t,r]),C=(0,u.useCallback)(function(e){var n=t.find(function(n){return n.group.images.map(function(e){return e.hash}).includes(e)}),u=(null==n?void 0:n.absolutePath)||"";return d({pageIndex:L(e,(null==n?void 0:n.group)||r),group:u})},[L,d,t,r]),X=(0,u.useCallback)(function(e,n){f||window.setTimeout(function(){v({group:{id:e,pageIndex:n}})},1)},[f]),y=(0,u.useCallback)(function(e){window.setTimeout(function(){v({imageHash:e})},1)},[]);return(0,u.useEffect)(function(){if(!f&&h){var n=window.setTimeout(function(){h.imageHash?(e.push(C(h.imageHash)),v(!1)):h.group&&(e.push(b(h.group.id,h.group.pageIndex)),v(!1))},1);return function(){window.clearTimeout(n)}}},[b,C,f,e,h]),{currentGroup:x,getGroupPath:b,getImagePageIndexInGroup:L,navigateToGroup:X,navigateToImage:y}},g=(0,u.createContext)(null);function d(e){var n=e.children,t=f();return(0,r.jsx)(g.Provider,{value:t,children:n})}var p=function(){var e=(0,u.useContext)(g);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},24849:(e,n,t)=>{t.d(n,{T:()=>i,p:()=>s});var r=t(61975),u=t(71450),a=t(17403),o=t(75036),i=function(e,n,t){var i=function(s,c,l,f){return(0,r._)(function(){var r,g,d,p,h,v,m,E,I,T,R,_;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(g=e.find(function(e){return s===e.hash}),d=("string"==typeof l?l:null==g?void 0:g.frame)||void 0,p=null==(r=n.find(function(e){return e.id===d}))?void 0:r.hash,f||!(!g||!(0,a.pl)(g)))return[3,2];return[4,(0,o.Hh)(s,p,c,t)];case 1:return[2,u.sent()||[]];case 2:if(!(h=f||g.hashes).r)return[3,4];return[4,i(h.r,c,d)];case 3:return m=u.sent(),[3,5];case 4:m=[],u.label=5;case 5:if(v=m,!h.g)return[3,7];return[4,i(h.g,c,d)];case 6:return I=u.sent(),[3,8];case 7:I=[],u.label=8;case 8:if(E=I,!h.b)return[3,10];return[4,i(h.b,c,d)];case 9:return R=u.sent(),[3,11];case 10:R=[],u.label=11;case 11:if(T=R,!h.n)return[3,13];return[4,i(h.n,c,d)];case 12:return _=u.sent(),[3,14];case 13:_=[],u.label=14;case 14:return[2,{r:v,g:E,b:T,n:_}]}})})()};return i},s=function(e,n){var t=i(e,n);return function(e){return(0,r._)(function(){var n,r,a,o,i;return(0,u.YH)(this,function(u){switch(u.label){case 0:return[4,t(e,!0,"")];case 1:if(n=u.sent())return[2,(null==n?void 0:n.length)||(null==(r=n.r)?void 0:r.length)||(null==(a=n.g)?void 0:a.length)||(null==(o=n.b)?void 0:o.length)||(null==(i=n.n)?void 0:i.length)||0];return[2,0]}})})()}}},25969:(e,n,t)=>{t.d(n,{j:()=>o});var r=t(22043),u=t(20063),a=t(12115),o=function(){var e=(0,u.usePathname)(),n=(0,r._)((0,a.useState)(window.location.search),2),t=n[0],o=n[1],i=(0,a.useMemo)(function(){return new URLSearchParams(t)},[t]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){o(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var n=history.pushState,t=history.replaceState;return history.pushState=function(){for(var t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];n.apply(this,r),e()},history.replaceState=function(){for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];t.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=n,history.replaceState=t}},[i,e]);var s=(0,a.useMemo)(function(){return i.toString()},[i]);return{fullPath:(0,a.useMemo)(function(){return s?"".concat(e,"?").concat(s):e},[e,s]),pathname:e,query:s,searchParams:i}}},42485:(e,n,t)=>{t.d(n,{A:()=>u});var r=t(45073);let u=function(e){return function(n){var t=e.filter(function(e){return![r.X3.FILTER_MONOCHROME,r.X3.FILTER_NEW,r.X3.FILTER_RGB,r.X3.FILTER_UNTAGGED,r.X3.FILTER_RECENT,r.X3.FILTER_FAVOURITE,r.X3.FILTER_COMMENTS,r.X3.FILTER_USERNAME].includes(e)});return!t.length||!!n.tags.find(function(e){return t.includes(e)})}}},66375:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(45377),u=t(36117),a=t.n(u),o=t(45073),i=t(17403);let s=function(e,n,t,u,s){var c=function(s){var c,l,f=e.reduce(function(e,n){return[o.X3.FILTER_MONOCHROME,o.X3.FILTER_NEW,o.X3.FILTER_RGB,o.X3.FILTER_UNTAGGED,o.X3.FILTER_RECENT,o.X3.FILTER_FAVOURITE,o.X3.FILTER_COMMENTS,o.X3.FILTER_USERNAME].includes(n)?(0,r._)(e).concat([n]):e},[]);if(f.length&&(f.includes(o.X3.FILTER_UNTAGGED)&&0!==s.tags.length||f.includes(o.X3.FILTER_NEW)&&a()(new Date(s.created)).unix()<=a()().subtract(1,"day").unix()||f.includes(o.X3.FILTER_RECENT)&&!u.map(function(e){return e.hash}).includes(s.hash)||f.includes(o.X3.FILTER_RGB)&&!(0,i.pl)(s)||f.includes(o.X3.FILTER_MONOCHROME)&&(0,i.pl)(s)||f.includes(o.X3.FILTER_FAVOURITE)&&!s.tags.includes(o.X3.FILTER_FAVOURITE)||f.includes(o.X3.FILTER_COMMENTS)&&!(null==(c=s.meta)?void 0:c.comment)||f.includes(o.X3.FILTER_USERNAME)&&!(null==(l=s.meta)?void 0:l.userName)))return!1;return(!t.length||"string"==typeof s.palette&&!!t.includes(s.palette))&&(!n.length||!!s.frame&&!!n.includes(s.frame))};return function(e){if(c(e))return!0;var n=s.find(function(n){return n.coverImage===e.hash})||null;return!!n&&n.allImages.some(c)}}},84470:(e,n,t)=>{t.d(n,{S:()=>i});var r=t(45377),u=t(85773),a=t(66375),o=t(42485),i=function(e,n){var t=e.images,i=e.groups,s=n.filtersTags,c=n.filtersFrames,l=n.filtersPalettes,f=n.sortBy,g=n.recentImports;return(0,r._)(t).map(u.YZ).sort((0,u.PM)(f)).map(u.lt).filter((0,a.A)(s,c,l,g,i)).filter((0,o.A)(s))}},85773:(e,n,t)=>{t.d(n,{PM:()=>s,YZ:()=>o,lt:()=>i});var r=t(82732),u=t(45849),a=t(22043),o=function(e,n){return(0,u._)((0,r._)({},e),{sortIndex:n})},i=function(e){return(0,u._)((0,r._)({},e),{sortIndex:void 0})},s=function(e){return function(n,t){if(!e)return 0;var r=(0,a._)(e.split("_"),2),u=r[0],o=r[1],i=n[u],s=t[u],c="desc"===o?-1:1;return i&&s?i>s?c:i<s?-c:n.sortIndex<t.sortIndex?c:-c:0}}},86539:(e,n,t)=>{t.d(n,{t:()=>r,z:()=>u});var r="ROOT",u=function(e){return{id:r,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[],allImages:e}}},89386:(e,n,t)=>{t.d(n,{Z:()=>a});var r=t(12115),u=t(96471),a=function(){return(0,r.useContext)(u.K)}},96471:(e,n,t)=>{t.d(n,{GalleryTreeContext:()=>g,K:()=>f});var r=t(22043),u=t(95155),a=t(81863),o=t(12115),i=t(25969),s=t(10022),c=t(86539),l="/gallery/",f=(0,o.createContext)({root:(0,c.z)([]),view:(0,c.z)([]),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(l,"?page=1")}});function g(e){var n=e.children,g=(0,s.Vs)(),d=g.imageGroups,p=g.images,h=g.setImageGroups,v=(0,r._)((0,o.useState)(!0),2),m=v[0],E=v[1],I=(0,r._)((0,o.useState)((0,c.z)(p)),2),T=I[0],R=I[1],_=(0,r._)((0,o.useState)([]),2),w=_[0],F=_[1],L=(0,r._)((0,o.useState)([]),2),b=L[0],x=L[1],C=(0,i.j)(),X=C.searchParams,y=C.pathname,M=(0,r._)((0,o.useState)(""),2),N=M[0],S=M[1],O=(0,s.C$)().enableDebug,P=(0,s.I0)().setError;(0,o.useEffect)(function(){var e=new Worker(t.tu(new URL(t.p+t.u(5647),t.b)),{type:void 0}),n=(0,a.LV)(e),r=[],u=(0,a.BX)(function(e){r.push(e)});return E(!0),n.calculate({imageGroups:d,stateImages:p},u).then(function(e){if(R(e.root),F(e.paths),x(e.pathsOptions),r.length&&P(Error(r.join("\n"))),d.length>e.paths.length){var n=e.paths.map(function(e){return e.group.id});h(d.filter(function(e){var t=e.id;return n.includes(t)}))}O&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),P(e)}).finally(function(){E(!1),e.terminate()}),function(){e.terminate(),E(!1)}},[O,d,P,h,p]);var G=(0,o.useMemo)(function(){var e;return parseInt(null!=(e=X.get("page"))?e:"1",10)-1},[X]),k=(0,o.useMemo)(function(){return X.get("group")||""},[X]),A=(0,o.useCallback)(function(e){var n="number"==typeof e.pageIndex?e.pageIndex:G,t="string"==typeof e.group?e.group:k,r="".concat(l,"?page=").concat(n+1);return t.length&&(r="".concat(r,"&group=").concat(encodeURIComponent(t))),r},[G,k]);(0,o.useEffect)(function(){y===l&&S(A({pageIndex:G,group:k}))},[k,G,y,A]);var U=(0,o.useMemo)(function(){var e,n=(null==(e=w.find(function(e){return e.absolutePath===k}))?void 0:e.group)||T,t=n.groups.map(function(e){return e.coverImage}),r=n.images.filter(function(e){return!t.includes(e.hash)});return{view:n,covers:t,paths:w,images:r,pathsOptions:b,root:T,isWorking:m,pageIndex:G,path:k,lastGalleryLink:N,getUrl:A}},[w,T,b,m,G,k,N,A]);return(0,u.jsx)(f.Provider,{value:U,children:n})}}}]);