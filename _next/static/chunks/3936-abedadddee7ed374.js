"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3936],{633:(e,t,r)=>{r.d(t,{g:()=>f});var n=r(12115),a=r(41186),i=r(3381),u=r(71620),o=r(48675),c=r(46498),s=r(11760),l=r(24463),f=function(){var e=(0,a.A)(),t=e.dismissDialog,r=e.setDialog,f=(0,i.A)(),F=f.cancelEditFrame,m=f.cancelEditImages,p=f.cancelEditPalette,d=(0,u.A)(),g=d.updateRecentImports,h=d.updateImageSelection,A=(0,o.A)().importQueueCancel,v=(0,c.A)(),_=v.setProgress,D=v.setPrinterBusy,E=(0,s.h)(),b=E.addImages,y=E.deleteImages,I=E.setImageGroups,S=E.updateFrameGroups,B=E.updateImageHash,w=E.updateImages,C=E.setFrames,P=E.setImages,L=E.setPalettes,U=(0,l.A)().setSyncLastUpdate;return(0,n.useMemo)(function(){var e=function(){return U("local",Math.floor(new Date().getTime()/1e3))},n=function(){_("printer",0),D(!1),A()};return{addImages:function(r){b(r),t(0),e(),n(),g(r)},deleteImages:function(r){y(r),h(u.N.REMOVE,r),t(0),e()},dismissDialog:t,globalUpdate:function(t){F(),p(),m(),t.lastUpdateUTC?U("local",t.lastUpdateUTC):e(),t.palettes&&L(t.palettes),t.images&&(P(t.images),g(t.images)),t.frames&&C(t.frames),t.frameGroups&&S(t.frameGroups),t.imageGroups&&I(t.imageGroups)},importQueueCancel:n,setDialog:r,updateImageHash:function(t,r){m(),e(),B(t,r)},updateImages:function(t){w(t),e()},updateLastSyncLocalNow:e}},[b,F,m,p,y,t,A,r,C,P,L,I,D,_,U,S,B,h,w,g])}},2608:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(97004),a=r(577),i=r(39249),u=r(5432),o=r(72623),c=function(){var e=(0,n._)(function(e,t,r){var n,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,(0,o.Hh)(e)];case 1:return n=(i.sent()||[]).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.join(" "))||""}).reduce(function(e,t,r){return r%40?(0,a._)(e).concat([t]):(0,a._)(e).concat([u.g0,t])},[]),c=[u.dm].concat((0,a._)(n),[u.R2,u.Ys]).join("\n"),[2,{folder:"images",filename:"".concat(r,".txt"),blob:new Blob(Array(c),{type:"text/plain"}),title:t}]}})});return function(t,r,n){return e.apply(this,arguments)}}()},3381:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(65453).v)(function(e){return{editFrame:null,editPalette:null,pickColors:null,editImageGroup:null,editImages:null,editRGBNImages:[],setEditFrame:function(t){return e({editFrame:t})},setEditImageGroup:function(t){return e({editImageGroup:t})},setEditPalette:function(t){return e({editPalette:t,pickColors:null})},setEditRGBNImages:function(t){return e({editRGBNImages:t})},setPickColors:function(t){return e({pickColors:t})},setEditImages:function(t){return e({editImages:t})},cancelEditFrame:function(){return e({editFrame:null})},cancelEditImageGroup:function(){return e({editImageGroup:null})},cancelEditPalette:function(){return e({editPalette:null})},cancelEditRGBNImages:function(){return e({editRGBNImages:[]})},cancelPickColors:function(){return e({pickColors:null})},cancelEditImages:function(){return e({editImages:null})}}})},5415:(e,t,r)=>{r.d(t,{R:()=>s,j:()=>_});var n=r(97004),a=r(39249),i=r(91540),u=r(59311),o=r.n(u),c=r(31533);let s=function(e){var t;return t=(0,n._)(function(t){var r,n,u,s;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(1===t.length)return r=t[0],[2,(0,i.saveAs)(r.blob,r.filename)];return n=new(o()),[4,Promise.all(t.map(function(e){var t,r=e.filename;return("function"==typeof(t=e.blob).arrayBuffer?t.arrayBuffer():new Promise(function(e){var r=new FileReader;r.onload=function(t){if(!t.target)throw Error("no file");var r=t.target.result;if("string"==typeof r||null===r)throw Error("unexpected filereader result");e(r)},r.readAsArrayBuffer(t)})).then(function(e){return{filename:r,arrayBuffer:e}})}))];case 1:return u=a.sent(),(0,c.A)(u).forEach(function(e){var t=e.filename,r=e.arrayBuffer;n.file(t,r)}),[4,n.generateAsync({type:"blob",compression:"DEFLATE"})];case 2:if(s=a.sent(),!e)throw Error("missing filename");return[2,(0,i.saveAs)(s,"".concat(e,".zip"))]}})}),function(e){return t.apply(this,arguments)}};var l=r(693),f=r(60376),F=r(577),m=r(15905),p=r(28952),d=r(18335),g=r(77683),h=r(86964),A=r(55364),v=r(2608);let _=function(e,t,r,i,u){return function(o){var c;return c=(0,n._)(function(c,s){var _,D,E,b,y,I,S,B,w;return(0,a.YH)(this,function(C){switch(C.label){case 0:var P;if(_=(0,A.pl)(o),D=o.lockFrame||!1,E=o.rotation||0,y=(b=(0,d.s)(i,o)).palette,I=b.framePalette,!y)throw Error("Palette missing?");return P=(0,n._)(function(e,t){var n,i,u,F;return(0,a.YH)(this,function(a){return _?[2,(0,m.y1)({tiles:c,palette:y,lockFrame:D,imageStartLine:s,rotation:E,scaleFactor:t,handleExportFrame:r},e)]:(i=(n=(0,h.f)(o)).invertPalette,u=n.invertFramePalette,F=(0,g.C)({imagePalette:y.palette||m.CU,framePalette:(null==I?void 0:I.palette)||m.CU,invertPalette:i,invertFramePalette:u}),[2,(0,m.Yn)((0,f._)((0,l._)({tiles:c,rotation:E,scaleFactor:t,handleExportFrame:r},F),{imageStartLine:s}),e)])})}),S=function(e,t){return P.apply(this,arguments)},B=(0,F._)(e).filter(function(e){return"number"==typeof e}),w=(0,F._)(t),B.length||B.push(4),w.length||w.push("png"),[4,Promise.all(B.map(function(e){return w.map(function(t){return new Promise(function(r){var n=(0,p.A)({image:o,palette:y,exportScaleFactor:e,fileNameStyle:u});switch(t){case"txt":if(_)return void r(null);(0,v.Z)(o.hash,o.title,n).then(r);break;case"pgm":if(_)return void r(null);S("image/png",e).then(createImageBitmap).then(function(e){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var i=a.getContext("2d");i.drawImage(e,0,0);var u=y.palette;if(!i||!(null==u?void 0:u.length))return void r(null);for(var c=["P2","#","# Exported from ".concat(window.location.origin),"#","# hash: ".concat(o.hash),"# created: ".concat(o.created),"# title: ".concat(o.title),"# tags: ".concat(o.tags.join(", ")),"# dimension: ".concat(a.width,"*").concat(a.height," pixels"),"#","".concat(a.width," ").concat(a.height),"3","#"],s=0;s<a.height;s+=1){for(var l=[],f=0;f<a.width;f+=1){var F=i.getImageData(f,s,1,1).data,p=["#",F[0].toString(16).padStart(2,"0"),F[1].toString(16).padStart(2,"0"),F[2].toString(16).padStart(2,"0")].join(""),d=y.palette.indexOf(p);-1===d&&(d=m.eJ.indexOf(parseInt(p.slice(1),16))),l.push(3-d)}c.push(l.join(" "))}r({filename:"".concat(n,".").concat(t),blob:new Blob([c.join("\n")],{type:"text/plain"}),title:o.title})});break;default:S("image/".concat(t),e).then(function(e){r({filename:"".concat(n,".").concat(t),blob:e,title:o.title})}).catch(function(){return r(null)})}})})}).flat())];case 1:return[2,C.sent().reduce(function(e,t){return t?(0,F._)(e).concat([t]):e},[])]}})}),function(e,t){return c.apply(this,arguments)}}}},6732:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(577),a={"":"006666666600FFFF"," ":"FFFFFFFFFFFFFFFF",0:"FFDDAAAAAADDFFFF",1:"FFDD99DDDDDDFFFF",2:"FF99EEDDBB88FFFF",3:"FF99EE99EE99FFFF",4:"FFDDBBBB88EEFFFF",5:"FF88BB99EE99FFFF",6:"FFCCBB99AADDFFFF",7:"FF88EEDDBBBBFFFF",8:"FFDDAADDAADDFFFF",9:"FFDDAACCEE99FFFF",a:"FFDDAAAA88AAFFFF",b:"FF99AA99AA99FFFF",c:"FFCCBBBBBBCCFFFF",d:"FF99AAAAAA99FFFF",e:"FF88BB99BB88FFFF",f:"FF88BB99BBBBFFFF",g:"FFCCBBAAAACCFFFF",h:"FFAAAA88AAAAFFFF",i:"FF88DDDDDD88FFFF",j:"FF99DDDDDDBBFFFF",k:"FFAAAA99AAAAFFFF",l:"FFBBBBBBBB88FFFF",m:"FFAA888AAAAAFFFF",n:"FFAA8A888AAAFFFF",o:"FFDDAAAAAADDFFFF",p:"FF99AA99BBBBFFFF",q:"FFDDAAAAAACCFFFF",r:"FF99AA99AAAAFFFF",s:"FFCCBBDDEE99FFFF",t:"FF88DDDDDDDDFFFF",u:"FFAAAAAAAACCFFFF",v:"FFAAAAAAAADDFFFF",w:"FFAAAA8A88AAFFFF",x:"FFAAAADDAAAAFFFF",y:"FFAAAADDDDDDFFFF",z:"FF88EEDDBB88FFFF",ä:"AADDAAAA88AAFFFF",ö:"AADDAAAAAADDFFFF",ü:"AAAFAAAAAACCFFFF",ß:"FF99AA99AA99BBFF",".":"FFFFFFFFFFDDFFFF","!":"DDDDDDDDFFDDFFFF","?":"DDAAEEDDFFDDFFFF","-":"FFFFFF88FFFFFFFF",_:"FFFFFFFFFF88FFFF",":":"FFFFDDFFDDFFFFFF"};let i=function(e){var t=(0,n._)(e.toString(10).toLowerCase().split("")).concat([" "," "]),r=t.shift()||"",i=t.shift()||"",u=a[r]||a[""],o=a[i]||a[""];return(0,n._)(Array(16)).map(function(e,t){return"".concat(u[t]).concat(o[t])}).join("")};var u="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n";let o=function(e){var t=[],r=e.split("\n").map(function(e){return e.match(/.{1,32}/g)}).flat().map(function(e){return e||""}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.padEnd(32," ")}).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.map(function(e){return i(e)}))||[]}).map(function(e){return[u,u].concat((0,n._)(e),[u,u])}).flat();for(t.push.apply(t,(0,n._)((0,n._)(Array(40)).map(function(){return u}))),t.push.apply(t,(0,n._)(r));t.length<360;)t.push(u);return t}},18335:(e,t,r)=>{r.d(t,{s:()=>i});var n=r(5432),a=r(55364),i=function(e,t){if((0,a.pl)(t))return{palette:t.palette};var r=e.find(function(e){return e.shortName===t.palette})||n.Fv,i=e.find(function(e){return e.shortName===t.framePalette})||n.Fv;return{palette:r,framePalette:t.lockFrame?i:r}}},24463:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(86447),a=r(693),i=r(60376),u=r(65453),o=r(46786),c=r(10746);let s=(0,u.v)((0,o.eh)((0,o.Zr)(function(e){return{dropboxStorage:{},gitStorage:{},syncLastUpdate:{dropbox:0,local:0},dropboxLogout:function(){return e(function(e){return{dropboxStorage:{use:e.dropboxStorage.use}}})},setDropboxStorage:function(t){return e(function(e){var r=e.dropboxStorage;return{dropboxStorage:(0,a._)({},r,t)}})},setGitStorage:function(t){return e(function(e){var r=e.gitStorage;return{gitStorage:(0,a._)({},r,t)}})},setSyncLastUpdate:function(t,r){return e(function(e){var u=e.syncLastUpdate;return{syncLastUpdate:(0,i._)((0,a._)({},u),(0,n._)({},t,r))}})}}},{name:"".concat(c.z,"-storages"),storage:(0,o.KU)(function(){return localStorage})})))},28952:(e,t,r)=>{r.d(t,{A:()=>F});var n=r(30832),a=r.n(n),i=r(99124),u=r.n(i),o=r(35009),c=r(5432),s=r(81445);a().extend(u());var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.reduce(function(e,r){return r?"".concat(e).concat(e?t:"").concat(r):e},"")},f=function(e){var t=e.r,r=e.g,n=e.b,a=e.n,i=function(e){return e.toString(16).padStart(2,"0")};return l([(null==t?void 0:t.map(i).join(""))||"",(null==r?void 0:r.map(i).join(""))||"",(null==n?void 0:n.map(i).join(""))||"",(null==a?void 0:a.map(i).join(""))||""],".")};let F=function(e){var t,r,n=e.image||null,i=e.palette||null,u=e.exportScaleFactor||null,F=e.useCurrentDate||null,m=(null==(t=e.frameRate)?void 0:t.toString(10))||"",p=e.altTitle||"",d=e.frameName||"",g=e.paletteShort||"",h=e.fileNameStyle,A=F||!n?a()():a()(n.created,c.i$),v=A.isValid()?A.format(c.fE):"",_=g||(i?i.shortName||f(i):""),D=n&&n.title?n.title:p;switch(h){case s.B.TITLE_ONLY:r=[D];break;case s.B.DATE_TITLE:r=[v,D];break;case s.B.FULL:default:r=[v,D,u?"".concat(u,"x"):"",m?"".concat(m,"fps"):"",d,_]}var E=l(r);return(0,o.A)(E,{replacement:""})}},31533:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(693),a=r(60376);let i=function(e){var t=[];return e.map(function(e){var r=e.filename,i=r.split("."),u=i.pop();if(!u)throw Error("unknown file type");for(var o=i.join("."),c=r,s=0;t.includes(c);)s+=1,c="".concat(o,"_(").concat(s,").").concat(u);return t.includes(c)||t.push(c),(0,a._)((0,n._)({},e),{filename:c})})}},41186:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(577);let a=(0,r(65453).v)(function(e){return{dialogs:[],dismissDialog:function(t){return e(function(e){return{dialogs:e.dialogs.filter(function(e,r){return t!==r})}})},setDialog:function(t){return e(function(e){var r=e.dialogs;return{dialogs:[t].concat((0,n._)(r))}})}}})},45854:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(97004),a=r(693),i=r(60376),u=r(39249),o=r(69229),c=r(71620),s=r(11760),l=r(56491),f=r(75380),F=function(){var e=(0,n._)(function(e){var t,r;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.map((i=(0,n._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.Uv.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),r={},t.forEach(function(e){var t=e.hash,n=e.data;n&&(r["frame-".concat(t)]=n)}),[2,r]}})});return function(t){return e.apply(this,arguments)}}();let m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"frames":return t;case"current_framegroup":return t.filter(function(e){return e.id.startsWith(r)});default:return[]}},p=function(e,t,r){switch(e){case"images":return t.map(function(e){return e.hash});case"selected_images":return r;default:return[]}};var d=r(577),g=r(55364),h=r(55685),A=function(){var e=(0,n._)(function(e){var t,r;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.reduce(function(e,t){var r=(0,g.pl)(t)?(0,h.A)(Object.values(t.hashes)):[t.hash];return(0,d._)(e).concat((0,d._)(r))},[]).map((i=(0,n._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.mU.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),r={},t.forEach(function(e){var t=e.hash,n=e.data;n&&(r[t]=n)}),[2,r]}})});return function(t){return e.apply(this,arguments)}}(),v=function(e){switch(e){case o.m.ALL:case o.m.JSON_EXPORT:return["frameGroups","frames","imageGroups","images","palettes","plugins"];case o.m.SELECTED_IMAGES:return["images"];case o.m.IMAGES:return["images","imageGroups"];case o.m.PALETTES:return["palettes"];case o.m.FRAMES:case o.m.CURRENT_FRAMEGROUP:return["frames","frameGroups"];case o.m.PLUGINS:return["plugins"];default:return[]}};let _=function(){var e;return e=(0,n._)(function(e){var t,r,n,f,d,g,h,_,D,E,b,y,I,S,B,w,C,P,L=arguments;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(r=(t=L.length>1&&void 0!==L[1]?L[1]:{}).lastUpdateUTC,n=t.selectedFrameGroup,h=(g=s.h.getState()).frames,_=g.images,D=g.palettes,E=g.imageGroups,b=g.frameGroups,y=g.plugins,I=c.A.getState().imageSelection,S=(0,i._)((0,a._)({},v(e).reduce(function(t,r){switch(r){case"frameGroups":return(0,i._)((0,a._)({},t),{frameGroups:e===o.m.CURRENT_FRAMEGROUP?b.filter(function(e){return e.id===n}):(0,l.A)(h,b)});case"frames":var u=e===o.m.FRAMES?o.m.FRAMES:o.m.CURRENT_FRAMEGROUP;return(0,i._)((0,a._)({},t),{frames:m(u,h,n)});case"imageGroups":return(0,i._)((0,a._)({},t),{imageGroups:E});case"images":var c=p(e===o.m.SELECTED_IMAGES?"selected_images":"images",_,I);return(0,i._)((0,a._)({},t),{images:_.filter(function(e){var t=e.hash;return c.includes(t)})});case"palettes":return(0,i._)((0,a._)({},t),{palettes:D.filter(function(e){return!e.isPredefined})});case"plugins":return(0,i._)((0,a._)({},t),{plugins:y});default:return t}},{})),{lastUpdateUTC:r||Math.floor(new Date().getTime()/1e3),version:s.A}),B={},!((null==(f=S.images)?void 0:f.length)&&[o.m.IMAGES,o.m.SELECTED_IMAGES,o.m.ALL].includes(e)))return[3,2];return w=[{},B],[4,A(S.images)];case 1:B=a._.apply(void 0,w.concat([u.sent()])),u.label=2;case 2:if(!((null==(d=S.frames)?void 0:d.length)&&[o.m.FRAMES,o.m.CURRENT_FRAMEGROUP,o.m.ALL].includes(e)))return[3,4];return C=e===o.m.CURRENT_FRAMEGROUP?o.m.CURRENT_FRAMEGROUP:o.m.FRAMES,P=[{},B],[4,F(m(C,h,n).map(function(e){return e.hash}))];case 3:B=a._.apply(void 0,P.concat([u.sent()])),u.label=4;case 4:return[2,JSON.stringify((0,a._)({state:S},B),null,2)]}})}),function(t){return e.apply(this,arguments)}}},46498:(e,t,r)=>{r.d(t,{A:()=>F});var n=r(86447),a=r(693),i=r(60376),u=r(577),o=r(30832),c=r.n(o),s=r(9779),l=r(51368),f=(0,r(65453).v)(function(e,t){return{dragover:!1,errors:[],isFullscreen:!1,lightboxImage:null,printerBusy:!1,printerData:null,printerFunctions:[],progress:{gif:0,printer:0,plugin:0},progressLog:{git:[],dropbox:[]},showSerials:!1,syncBusy:!1,syncSelect:!1,trashCount:{frames:0,images:0,show:!1},videoSelection:[],dismissError:function(r){return e({errors:t().errors.filter(function(e,t){return t!==r})})},resetProgressLog:function(){return e({progressLog:{git:[],dropbox:[]}})},setDragover:function(t){return e({dragover:t})},setError:function(r){return e({errors:(0,u._)(t().errors).concat([{error:r,timestamp:c()().unix(),id:(0,l.A)()}])})},setIsFullscreen:function(t){return e({isFullscreen:t})},setPrinterBusy:function(t){return e({printerBusy:t})},setPrinterData:function(t){return e({printerData:t})},setPrinterFunctions:function(t){return e({printerFunctions:t})},setProgress:function(r,u){return e({progress:(0,i._)((0,a._)({},t().progress),(0,n._)({},r,u))})},setShowSerials:function(t){return e({showSerials:t})},setSyncBusy:function(t){return e({syncBusy:t})},setSyncSelect:function(t){return e({syncSelect:t})},showTrashCount:function(r){return e({trashCount:(0,i._)((0,a._)({},t().trashCount),{show:r})})},updateTrashCount:function(r,n){return e({trashCount:(0,i._)((0,a._)({},t().trashCount),{frames:r,images:n})})},setVideoSelection:function(t){return e({videoSelection:t})},setProgressLog:function(r,o){var c=t().progressLog;e({progressLog:(0,i._)((0,a._)({},c),(0,n._)({},r,[o].concat((0,u._)(c[r]))))})},setLightboxImage:function(t){null===t&&s.A.exit(),e({lightboxImage:t})},setLightboxImageNext:function(r){var n=t().lightboxImage;null!==n&&e({lightboxImage:Math.min(n+1,r-1)})},setLightboxImagePrev:function(){var r=t().lightboxImage;null!==r&&e({lightboxImage:Math.max(r-1,0)})}}});window.se=f.getState().setError;let F=f},47639:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(97004),a=r(577),i=r(39249),u=r(15905),o=r(53982);let c=function(){var e=(0,n._)(function(e,t){var r,n,c,s,l,f;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(360!==e.length)return[2,e];return[4,(0,o.mZ)(t)];case 1:if(!(n=i.sent()))return[2,e];if(14!==n.left.length||14!==n.right.length)return console.error("Invalid frameData"),[2,e];for(l=0,c=e.reduce(function(e,t,r){return(0,u.o1)(r,2,u.H.FRAMEMODE_KEEP)?e:(0,a._)(e).concat([t])},[]),s=(0,a._)(n.upper);l<14;l+=1)(f=s).push.apply(f,(0,a._)(n.left[l]).concat((0,a._)(c.slice(16*l,(l+1)*16)),(0,a._)(n.right[l])));return(r=s).push.apply(r,(0,a._)(n.lower)),[2,s]}})});return function(t,r){return e.apply(this,arguments)}}()},48675:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(577);let a=(0,r(65453).v)(function(e,t){return{bitmapQueue:[],frameQueue:[],importQueue:[],bitmapQueueAdd:function(t){return e(function(e){var r=e.bitmapQueue;return{bitmapQueue:(0,n._)(r).concat((0,n._)(t))}})},bitmapQueueCancel:function(){return e({bitmapQueue:[]})},frameQueueAdd:function(t){return e(function(e){var r=e.frameQueue;return{frameQueue:(0,n._)(r).concat((0,n._)(t))}})},frameQueueCancelOne:function(t){return e(function(e){return{frameQueue:e.frameQueue.filter(function(e){return e.tempId!==t})}})},importQueueAdd:function(r){var a=t(),i=a.bitmapQueue,u=a.importQueue,o=r.map(function(e){return e.fileName});e({bitmapQueue:i.filter(function(e){var t=e.fileName;return!o.includes(t)}),importQueue:(0,n._)(u).concat((0,n._)(r))})},importQueueCancel:function(){e({importQueue:[]})},importQueueCancelOne:function(t){return e(function(e){return{importQueue:e.importQueue.filter(function(e){return e.tempId!==t})}})}}})},50263:(e,t,r)=>{r.d(t,{K:()=>c,U:()=>o});var n=r(97004),a=r(39249),i=r(98933),u=r.n(i),o=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u().inflate(e,{to:"string"})]})});return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u().deflate(e,{to:"string",strategy:1,level:8})]})});return function(t){return e.apply(this,arguments)}}()},53982:(e,t,r)=>{r.d(t,{Bf:()=>s,mZ:()=>f,R_:()=>l});var n=r(97004),a=r(39249),i=function(e){return e.toUpperCase()},u=function(e,t){var r=e.slice(0,20*t).map(i),n=e.slice((t+14)*20).map(i);return{upper:r,left:Array(14).fill(0).map(function(r,n){var a=(n+t)*20;return e.slice(a,a+2).map(i)}),right:Array(14).fill(0).map(function(r,n){var a=(n+t)*20;return e.slice(a+18,a+20).map(i)}),lower:n}},o=r(75380),c=r(50263),s=function(){var e=(0,n._)(function(e,t){var n,i,o;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(r.t.bind(r,52491,23))];case 1:return n=a.sent().default,i=JSON.stringify(u(e,t)),[4,(0,c.K)(i)];case 2:return o=a.sent(),[2,{dataHash:n(o),compressed:o}]}})});return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,n._)(function(e,t){var r,n,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,s(e,t)];case 1:return n=(r=a.sent()).dataHash,i=r.compressed,[4,o.Uv.setItem(n,i)];case 2:return a.sent(),[2,n]}})});return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,n._)(function(e){var t,r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];return[4,o.Uv.getItem(e)];case 1:if(!(t=a.sent()))return[2,null];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,(0,c.U)(t)];case 3:return r=a.sent(),[3,5];case 4:return a.sent(),[2,null];case 5:try{return[2,JSON.parse(r)]}catch(e){}try{return n=r.split("\n"),[2,{upper:n.slice(0,40),left:Array(14).fill(0).map(function(e,t){return n.slice(4*t+40,4*t+42)}),right:Array(14).fill(0).map(function(e,t){return n.slice(4*t+42,4*t+44)}),lower:n.slice(96,136)}]}catch(e){return[2,null]}}})});return function(t){return e.apply(this,arguments)}}()},56491:(e,t,r)=>{r.d(t,{A:()=>i});var n=function(e,t,r){var n=r.find(function(t){return t.id===e});if(n)return n.name;switch(e){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return t}},a=function(e){switch(e){case"int":return"_1";case"jp":return"_2";case"hk":return"_3";default:return e}};let i=function(e,t){return e.reduce(function(e,r){var a=r.id,i=r.name;try{var u,o=null==(u=a.match(/^[a-z]+/g))?void 0:u[0];if(!o)return e;return e.find(function(e){return e.id===o})||e.push({id:o,name:n(o,i,t)}),e}catch(t){return e}},[]).sort(function(e,t){var r=e.id,n=t.id,i=a(r),u=a(n);return i>u?1:i<u?-1:0})}},69229:(e,t,r)=>{r.d(t,{m:()=>n});var n=function(e){return e.ALL="all",e.JSON_EXPORT="json_export",e.FRAMES="frames",e.CURRENT_FRAMEGROUP="current_framegroup",e.IMAGES="images",e.SELECTED_IMAGES="selected_images",e.PALETTES="palettes",e.PLUGINS="plugins",e}({})},71620:(e,t,r)=>{r.d(t,{A:()=>m,N:()=>F});var n=r(577),a=r(30832),i=r.n(a),u=r(65453),o=r(46786),c=r(55364),s=r(55685),l=r(85546),f=r(10746),F=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let m=(0,u.v)((0,o.Zr)(function(e,t){return{filtersActiveTags:[],filtersVisible:!1,imageSelection:[],lastSelectedImage:null,recentImports:[],sortBy:"created_asc",sortOptionsVisible:!1,setFiltersActiveTags:function(t){return e({filtersActiveTags:t,filtersVisible:!1})},setFiltersVisible:function(t){return e({filtersVisible:t})},setImageSelection:function(t){return e({imageSelection:t,lastSelectedImage:null})},setSortBy:function(t){return e({sortBy:t,sortOptionsVisible:!1})},setSortOptionsVisible:function(t){return e({sortOptionsVisible:t})},cleanRecentImports:function(r){var n=t().recentImports,a=i()().subtract(6,"hour").unix();e({recentImports:n.filter(function(e){var t=e.hash,n=e.timestamp;return r.includes(t)&&n>a})})},updateRecentImports:function(r){var a=t().recentImports,u=r.reduce(function(e,t){return(0,c.pl)(t)?e:(0,n._)(e).concat([{hash:t.hash,timestamp:i()().unix()}])},[]);e({recentImports:(0,l.A)("hash")((0,n._)(a).concat((0,n._)(u)))})},updateImageSelection:function(r,a){var i=t().imageSelection;switch(r){case"add":e({imageSelection:(0,s.A)((0,n._)(i).concat((0,n._)(a))),lastSelectedImage:a[0]});break;case"remove":e({imageSelection:i.filter(function(e){return!a.includes(e)}),lastSelectedImage:null})}}}},{name:"".concat(f.z,"-filters"),storage:(0,o.KU)(function(){return localStorage})}))},72623:(e,t,r)=>{r.d(t,{cg:()=>l,yH:()=>m,t9:()=>p,Hh:()=>F,UN:()=>f});var n=r(97004),a=r(39249),i=r(47639),u=r(75380),o=r(50263),c=r(6732);let s=function(e){var t="\nThe following hash is missing in\nyour indexedDb:\n".concat(e,"\n\nEither you imported a debug dump\nor your browser decided to do a\ncleanup.\n\nThis image might be able to be\nrecovered if you have set up git\nor dropbox sync.\n").trim();return(0,c.A)(t)};var l=function(){var e=(0,n._)(function(e){var t,n,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(r.t.bind(r,52491,23))];case 1:return t=a.sent().default,n=e.map(function(e){return e.replace(/ /gi,"").toUpperCase()}).join("\n"),[4,(0,o.K)(n)];case 2:return i=a.sent(),[2,{dataHash:t(i),compressed:i}]}})});return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,n._)(function(e){var t,r,n;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,l(e)];case 1:return r=(t=a.sent()).dataHash,n=t.compressed,[4,u.mU.setItem(r,n)];case 2:return a.sent(),[2,r]}})});return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,n._)(function(e,t,r,n){var c,l;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];a.label=1;case 1:return a.trys.push([1,4,,5]),[4,u.mU.getItem(e)];case 2:if(!(c=a.sent()))throw Error("missing imagedata");return[4,(0,o.U)(c)];case 3:if(l=a.sent().split("\n"),!t)return[2,l];return[2,(0,i.A)(l,t)];case 4:return a.sent(),"function"==typeof n&&n(e),[2,r?[]:s(e)];case 5:return[2]}})});return function(t,r,n,a){return e.apply(this,arguments)}}(),m=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u.mU.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,n._)(function(e){return(0,a.YH)(this,function(t){return[2,u.Uv.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}()},77683:(e,t,r)=>{r.d(t,{C:()=>u});var n=r(577),a=r(15905),i=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");return parseInt(t,16)},u=function(e){var t=e.imagePalette,r=e.framePalette,u=e.invertPalette,o=e.invertFramePalette,c=(t||a.CU).map(i),s=(null==r?void 0:r.map(i))||c;return{imagePalette:void 0!==u&&u?(0,n._)(c).reverse():(0,n._)(c),framePalette:void 0!==o&&o?(0,n._)(s).reverse():(0,n._)(s)}}},81445:(e,t,r)=>{r.d(t,{B:()=>n,y:()=>a});var n=function(e){return e.FULL="FULL",e.TITLE_ONLY="TITLE_ONLY",e.DATE_TITLE="DATE_TITLE",e}({}),a=[{id:"FULL",name:"Full Title"},{id:"DATE_TITLE",name:"Date and Title"},{id:"TITLE_ONLY",name:"Title only"}]},83936:(e,t,r)=>{r.d(t,{W:()=>E});var n=r(97004),a=r(39249),i=r(12115),u=r(633),o=r(11760),c=r(52324),s=r(5415),l=r(45854),f=r(75380),F=r(693),m=r(60376),p=r(577),d=r(85546),g=function(e){var t=(0,d.A)(e);return function(r,n){var a=n.map(function(t){var n=r.find(function(r){return r[e]===t[e]});return n?(0,F._)({},n,t):t});return t((0,p._)(a).concat((0,p._)(r)))}},h=g("hash"),A=g("id"),v=g("shortName");let _=function(e,t,r,n,a){var i=e,u=r,o=t;return a?(n.frames&&n.frames.length&&(i=A(i,n.frames)),n.images&&n.images.length&&(u=h(u,n.images)),n.palettes&&n.palettes.length&&(o=v(o,n.palettes))):(i=n.frames||e,u=n.images||r,o=n.palettes||t),(0,m._)((0,F._)({},n),{images:u,frames:i,palettes:o})};var D=function(){var e=(0,n._)(function(e){var t,r,n,i,u,s,l=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=l.length>1&&void 0!==l[1]&&l[1],n=(r=o.h.getState()).frames,i=r.palettes,u=r.images,[4,(0,c.i)(e)];case 1:return Object.keys(s=a.sent()).forEach(function(e){if("state"!==e){var t=s[e];e.match(/^[a-f0-9]{40,}$/gi)?f.mU.setItem("".concat(e),t):e.startsWith("frame-")&&f.Uv.setItem("".concat(e.split("frame-").pop()),t)}}),[2,_(n,i,u,s.state||{},t)]}})});return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,u.g)().globalUpdate;return(0,i.useMemo)(function(){var t,r,i,u=(0,l.A)();return{downloadSettings:(t=(0,n._)(function(e){var t,r,n,i=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,u(e,{selectedFrameGroup:t=i.length>1&&void 0!==i[1]?i[1]:""})];case 1:return r=a.sent(),n="frames"===e?"frames":[e,t].filter(Boolean).join("_"),(0,s.R)(null)([{blob:new Blob(Array(r)),filename:"".concat(n,".json")}]),[2]}})}),function(e){return t.apply(this,arguments)}),jsonImport:(r=(0,n._)(function(t){return(0,a.YH)(this,function(r){switch(r.label){case 0:return[4,D(t,!0)];case 1:return e(r.sent()),[2]}})}),function(e){return r.apply(this,arguments)}),remoteImport:(i=(0,n._)(function(t){return(0,a.YH)(this,function(r){switch(r.label){case 0:return[4,D(t,!1)];case 1:return e(r.sent()),[2]}})}),function(e){return i.apply(this,arguments)})}},[e])}},86964:(e,t,r)=>{r.d(t,{f:()=>n});var n=function(e){var t=e.invertPalette||!1;if(!e.lockFrame)return{invertPalette:t,invertFramePalette:t};var r=e.invertFramePalette;return{invertPalette:t,invertFramePalette:void 0===r?t:r}}}}]);