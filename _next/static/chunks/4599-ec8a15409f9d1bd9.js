"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4599],{4599:(e,t,n)=>{n.d(t,{NavigationToolsProvider:()=>g,g:()=>d});var r=n(95155),u=n(12115),a=n(22043),o=n(20063),i=n(89386),s=n(10022),c=n(86539),l=n(84470),f=function(){var e=(0,o.useRouter)(),t=(0,i.Z)(),n=t.paths,r=t.root,f=t.isWorking,p=t.path,g=t.getUrl,d=(0,a._)((0,u.useState)(!1),2),h=d[0],v=d[1],m=(0,s.cr)(),E=m.sortBy,I=m.filtersTags,T=m.filtersFrames,R=m.filtersPalettes,_=m.recentImports,F=(0,s.C$)().pageSize,L=(0,u.useCallback)(function(e){return(0,l.S)(e,{filtersTags:I,filtersFrames:T,filtersPalettes:R,sortBy:E,recentImports:_})},[T,R,I,_,E]),w=(0,u.useCallback)(function(e,t){return Math.floor(L(t).findIndex(function(t){return t.hash===e})/F)},[L,F]),x=(0,u.useCallback)(function(e,t){var r;return e===c.t?g({pageIndex:t,group:""}):g({pageIndex:t,group:(null==(r=n.find(function(t){return e===t.group.id}))?void 0:r.absolutePath)||""})},[g,n]),C=(0,u.useMemo)(function(){var e;return(null==(e=n.find(function(e){return e.absolutePath===p}))?void 0:e.group)||r},[p,n,r]),X=(0,u.useCallback)(function(e){var t=n.find(function(t){return t.group.images.map(function(e){return e.hash}).includes(e)}),u=(null==t?void 0:t.absolutePath)||"";return g({pageIndex:w(e,(null==t?void 0:t.group)||r),group:u})},[w,g,n,r]),M=(0,u.useCallback)(function(e,t){f||window.setTimeout(function(){v({group:{id:e,pageIndex:t}})},1)},[f]),y=(0,u.useCallback)(function(e){window.setTimeout(function(){v({imageHash:e})},1)},[]);return(0,u.useEffect)(function(){if(!f&&h){var t=window.setTimeout(function(){h.imageHash?(e.push(X(h.imageHash)),v(!1)):h.group&&(e.push(x(h.group.id,h.group.pageIndex)),v(!1))},1);return function(){window.clearTimeout(t)}}},[x,X,f,e,h]),{currentGroup:C,getGroupPath:x,getImagePageIndexInGroup:w,navigateToGroup:M,navigateToImage:y}},p=(0,u.createContext)(null);function g(e){var t=e.children,n=f();return(0,r.jsx)(p.Provider,{value:n,children:t})}var d=function(){var e=(0,u.useContext)(p);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},25969:(e,t,n)=>{n.d(t,{j:()=>o});var r=n(22043),u=n(20063),a=n(12115),o=function(){var e=(0,u.usePathname)(),t=(0,r._)((0,a.useState)(window.location.search),2),n=t[0],o=t[1],i=(0,a.useMemo)(function(){return new URLSearchParams(n)},[n]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){o(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var t=history.pushState,n=history.replaceState;return history.pushState=function(){for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];t.apply(this,r),e()},history.replaceState=function(){for(var t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];n.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=t,history.replaceState=n}},[i,e]);var s=(0,a.useMemo)(function(){return i.toString()},[i]);return{fullPath:(0,a.useMemo)(function(){return s?"".concat(e,"?").concat(s):e},[e,s]),pathname:e,query:s,searchParams:i}}},42485:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(45073);let u=function(e){return function(t){var n=e.filter(function(e){return![r.X3.FILTER_MONOCHROME,r.X3.FILTER_NEW,r.X3.FILTER_RGB,r.X3.FILTER_UNTAGGED,r.X3.FILTER_RECENT,r.X3.FILTER_FAVOURITE,r.X3.FILTER_COMMENTS,r.X3.FILTER_USERNAME].includes(e)});return!n.length||!!t.tags.find(function(e){return n.includes(e)})}}},66375:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(45377),u=n(36117),a=n.n(u),o=n(45073),i=n(17403);let s=function(e,t,n,u,s){var c=function(s){var c,l,f=e.reduce(function(e,t){return[o.X3.FILTER_MONOCHROME,o.X3.FILTER_NEW,o.X3.FILTER_RGB,o.X3.FILTER_UNTAGGED,o.X3.FILTER_RECENT,o.X3.FILTER_FAVOURITE,o.X3.FILTER_COMMENTS,o.X3.FILTER_USERNAME].includes(t)?(0,r._)(e).concat([t]):e},[]);if(f.length&&(f.includes(o.X3.FILTER_UNTAGGED)&&0!==s.tags.length||f.includes(o.X3.FILTER_NEW)&&a()(new Date(s.created)).unix()<=a()().subtract(1,"day").unix()||f.includes(o.X3.FILTER_RECENT)&&!u.map(function(e){return e.hash}).includes(s.hash)||f.includes(o.X3.FILTER_RGB)&&!(0,i.pl)(s)||f.includes(o.X3.FILTER_MONOCHROME)&&(0,i.pl)(s)||f.includes(o.X3.FILTER_FAVOURITE)&&!s.tags.includes(o.X3.FILTER_FAVOURITE)||f.includes(o.X3.FILTER_COMMENTS)&&!(null==(c=s.meta)?void 0:c.comment)||f.includes(o.X3.FILTER_USERNAME)&&!(null==(l=s.meta)?void 0:l.userName)))return!1;return(!n.length||"string"==typeof s.palette&&!!n.includes(s.palette))&&(!t.length||!!s.frame&&!!t.includes(s.frame))};return function(e){if(c(e))return!0;var t=s.find(function(t){return t.coverImage===e.hash})||null;return!!t&&t.allImages.some(c)}}},84470:(e,t,n)=>{n.d(t,{S:()=>i});var r=n(45377),u=n(85773),a=n(66375),o=n(42485),i=function(e,t){var n=e.images,i=e.groups,s=t.filtersTags,c=t.filtersFrames,l=t.filtersPalettes,f=t.sortBy,p=t.recentImports;return(0,r._)(n).map(u.YZ).sort((0,u.PM)(f)).map(u.lt).filter((0,a.A)(s,c,l,p,i)).filter((0,o.A)(s))}},85773:(e,t,n)=>{n.d(t,{PM:()=>s,YZ:()=>o,lt:()=>i});var r=n(82732),u=n(45849),a=n(22043),o=function(e,t){return(0,u._)((0,r._)({},e),{sortIndex:t})},i=function(e){return(0,u._)((0,r._)({},e),{sortIndex:void 0})},s=function(e){return function(t,n){if(!e)return 0;var r=(0,a._)(e.split("_"),2),u=r[0],o=r[1],i=t[u],s=n[u],c="desc"===o?-1:1;return i&&s?i>s?c:i<s?-c:t.sortIndex<n.sortIndex?c:-c:0}}},86539:(e,t,n)=>{n.d(t,{t:()=>r,z:()=>u});var r="ROOT",u=function(e){return{id:r,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[],allImages:e}}},89386:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(12115),u=n(96471),a=function(){return(0,r.useContext)(u.K)}},96471:(e,t,n)=>{n.d(t,{GalleryTreeContext:()=>p,K:()=>f});var r=n(22043),u=n(95155),a=n(81863),o=n(12115),i=n(25969),s=n(10022),c=n(86539),l="/gallery/",f=(0,o.createContext)({root:(0,c.z)([]),view:(0,c.z)([]),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(l,"?page=1")}});function p(e){var t=e.children,p=(0,s.Vs)(),g=p.imageGroups,d=p.images,h=p.setImageGroups,v=(0,r._)((0,o.useState)(!0),2),m=v[0],E=v[1],I=(0,r._)((0,o.useState)((0,c.z)(d)),2),T=I[0],R=I[1],_=(0,r._)((0,o.useState)([]),2),F=_[0],L=_[1],w=(0,r._)((0,o.useState)([]),2),x=w[0],C=w[1],X=(0,i.j)(),M=X.searchParams,y=X.pathname,N=(0,r._)((0,o.useState)(""),2),S=N[0],O=N[1],P=(0,s.C$)().enableDebug,b=(0,s.I0)().setError;(0,o.useEffect)(function(){var e=new Worker(n.tu(new URL(n.p+n.u(5647),n.b)),{type:void 0}),t=(0,a.LV)(e),r=[],u=(0,a.BX)(function(e){r.push(e)});return E(!0),t.calculate({imageGroups:g,stateImages:d},u).then(function(e){if(R(e.root),L(e.paths),C(e.pathsOptions),r.length&&b(Error(r.join("\n"))),g.length>e.paths.length){var t=e.paths.map(function(e){return e.group.id});h(g.filter(function(e){var n=e.id;return t.includes(n)}))}P&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),b(e)}).finally(function(){E(!1),e.terminate()}),function(){e.terminate(),E(!1)}},[P,g,b,h,d]);var G=(0,o.useMemo)(function(){var e;return parseInt(null!=(e=M.get("page"))?e:"1",10)-1},[M]),k=(0,o.useMemo)(function(){return M.get("group")||""},[M]),A=(0,o.useCallback)(function(e){var t="number"==typeof e.pageIndex?e.pageIndex:G,n="string"==typeof e.group?e.group:k,r="".concat(l,"?page=").concat(t+1);return n.length&&(r="".concat(r,"&group=").concat(encodeURIComponent(n))),r},[G,k]);(0,o.useEffect)(function(){y===l&&O(A({pageIndex:G,group:k}))},[k,G,y,A]);var U=(0,o.useMemo)(function(){var e,t=(null==(e=F.find(function(e){return e.absolutePath===k}))?void 0:e.group)||T,n=t.groups.map(function(e){return e.coverImage}),r=t.images.filter(function(e){return!n.includes(e.hash)});return{view:t,covers:n,paths:F,images:r,pathsOptions:x,root:T,isWorking:m,pageIndex:G,path:k,lastGalleryLink:S,getUrl:A}},[F,T,x,m,G,k,S,A]);return(0,u.jsx)(f.Provider,{value:U,children:t})}}}]);