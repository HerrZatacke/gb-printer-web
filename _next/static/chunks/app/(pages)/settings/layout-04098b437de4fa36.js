(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7437],{1607:(e,t,n)=>{"use strict";n.d(t,{D:()=>p,EnvProvider:()=>h});var r=n(97004),i=n(693),s=n(60376),u=n(78538),a=n(39249),o=n(95155),l=n(12115),c=n(52166),f=n(75380),d=(0,l.createContext)(null),p=function(){return(0,l.useContext)(d)},h=function(e){var t=e.children,n=(0,u._)((0,l.useState)(null),2),p=n[0],h=n[1],v=(0,c.A)().setPrinterUrl;return(0,l.useEffect)(function(){var e=["/gb-printer-web","/env.json"].filter(Boolean).join("/");e&&(0,r._)(function(){var t,n,r,u;return(0,a.YH)(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),[4,(0,f.ZU)()];case 1:return a.sent(),[4,fetch(e)];case 2:return[4,a.sent().json()];case 3:return t=a.sent(),r=[(0,i._)({},t)],u={},[4,f.mU.driver()];case 4:return"esp8266"===(n=s._.apply(void 0,r.concat([(u.localforage=a.sent(),u)]))).env&&v("/"),h(n),[3,6];case 5:return a.sent(),h({version:"0.0.0",maximages:0,localforage:"error",env:"error",fstype:"-",bootmode:"-",oled:!1}),[3,6];case 6:return[2]}})})()},[v]),(0,o.jsx)(d.Provider,{value:p,children:t})}},5687:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=n(14810).A},9700:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=n(22550).A},14810:(e,t,n)=>{"use strict";function r(e){return e&&e.ownerDocument||document}n.d(t,{A:()=>r})},21329:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=n(43430).A},22550:(e,t,n)=>{"use strict";function r(e,t=166){let n;function i(...r){clearTimeout(n),n=setTimeout(()=>{e.apply(this,r)},t)}return i.clear=()=>{clearTimeout(n)},i}n.d(t,{A:()=>r})},31178:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(14810);function i(e){return(0,r.A)(e).defaultView||window}},32299:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l,useRtl:()=>o});var r=n(693),i=n(37414),s=n(12115),u=n(95155),a=s.createContext(),o=function(){var e=s.useContext(a);return null!=e&&e};let l=function(e){var t=e.value,n=(0,i._)(e,["value"]);return(0,u.jsx)(a.Provider,(0,r._)({value:null==t||t},n))}},34742:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=n(31178).A},38584:(e,t,n)=>{Promise.resolve().then(n.bind(n,91128))},50422:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(693),i=n(60376),s=n(37414),u=n(81616),a=n(13051),o=n(56501),l=n(89602);let c=function(e){var t,n=e.elementType,c=e.externalSlotProps,f=e.ownerState,d=e.skipResolvingSlotProps,p=(0,s._)(e,["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"]),h=void 0!==d&&d?{}:(0,l.A)(c,f),v=(0,o.A)((0,i._)((0,r._)({},p),{externalSlotProps:h})),g=v.props,m=v.internalRef,_=(0,u.A)(m,null==h?void 0:h.ref,null==(t=e.additionalProps)?void 0:t.ref);return(0,a.A)(n,(0,i._)((0,r._)({},g),{ref:_}),f)}},53267:(e,t,n)=>{"use strict";n.d(t,{default:()=>l});var r=n(67908),i=n(34084),s=n(69077),u=n(54107),a=(0,n(55170).A)("MuiBox",["root"]),o=(0,s.A)();let l=(0,r.default)({themeId:u.A,defaultTheme:o,defaultClassName:a.root,generateClassName:i.A.generate})},61564:(e,t,n)=>{"use strict";n.d(t,{t:()=>h});var r=n(97004),i=n(39249),s=n(12115),u=n(33236),a=n(39630),o=n(95939),l=n(23747),c=n(41186),f=n(3381),d=n(71620),p=n(11760),h=function(){var e=(0,o.Z)().view,t=(0,c.A)(),n=t.dismissDialog,h=t.setDialog,v=(0,f.A)().setEditImageGroup,g=(0,p.h)(),m=g.deleteImageGroup,_=g.setImageGroups,x=g.images,w=(0,d.A)().imageSelection,b=(0,s.useMemo)(function(){if(!w.length)return"";var e,t=x.filter(function(e){var t=e.hash;return w.includes(t)}).map(function(e){return e.title}).filter(function(e){return e.length>3}),n=null==(e=(0,u.Hg)(t).filter(function(e){return e.length>3})[0])?void 0:e.trim();return n?n.replace(/[_-]/g," ").replace(/^\s*\d+\s+|\s+\d+\s*$/g,"").trim():"New Group"},[w,x]);return{resetGroups:function(){h({message:"Reset image groups?",questions:function(){return[{key:"info",type:a.V.INFO,label:"This will remove ALL your created groups and all existing images will be moved to the top level."}]},confirm:(0,r._)(function(){return(0,i.YH)(this,function(e){return n(0),_([]),[2]})}),deny:(0,r._)(function(){return(0,i.YH)(this,function(e){return n(0),[2]})})})},createGroup:function(e){v({groupId:l.Ll,newGroupCover:e,newGroupTitle:b})},editGroup:function(e){v({groupId:e})},deleteGroup:function(t){var s=e.groups.find(function(e){return e.id===t});s&&h({message:"Delete image group?",questions:function(){return[{key:"info",type:a.V.INFO,label:'This will delete this group "'.concat(s.title||s.slug,'" and move all children (images & groups) to the current level.')}]},confirm:(0,r._)(function(){return(0,i.YH)(this,function(e){return n(0),m(t),[2]})}),deny:(0,r._)(function(){return(0,i.YH)(this,function(e){return n(0),[2]})})})}}}},67908:(e,t,n)=>{"use strict";n.d(t,{default:()=>d});var r=n(693),i=n(37414),s=n(12115),u=n(52596),a=n(46879),o=n(13184),l=n(5300),c=n(64330),f=n(95155);function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.themeId,n=e.defaultTheme,d=e.defaultClassName,p=void 0===d?"MuiBox-root":d,h=e.generateClassName,v=(0,a.default)("div",{shouldForwardProp:function(e){return"theme"!==e&&"sx"!==e&&"as"!==e}})(o.A);return s.forwardRef(function(e,s){var a=(0,c.default)(n),o=(0,l.A)(e),d=o.className,g=o.component,m=(0,i._)(o,["className","component"]);return(0,f.jsx)(v,(0,r._)({as:void 0===g?"div":g,ref:s,className:(0,u.A)(d,h?h(p):p),theme:t&&a[t]||a},m))})}},91128:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q});var r=n(95155),i=n(53267),s=n(7068),u=n(700),a=n(12115),o=n(1607);let l=function(){var e=(0,o.D)(),t=(0,a.useMemo)(function(){return e?["Web-App version: ".concat("master"),"Web-App branch: ".concat("1.49.3"),"Printer version: ".concat(e.version),"Max Images: ".concat(e.maximages),"Localforage driver: ".concat(e.localforage),"Environment type: ".concat(e.env),"Compiled Filesystem: ".concat(e.fstype),"Compiled Bootmode: ".concat(e.bootmode),"Compiled for OLED: ".concat(e.oled?"yes":"no")]:[]},[e]);return(0,r.jsx)(s.default,{component:"ul",direction:"column",children:t.map(function(e){return(0,r.jsx)(u.default,{component:"li",variant:"caption",color:"textDisabled",align:"right",lineHeight:1.25,children:e},e)})})};var c=n(7642),f=n(61487),d=n(69229),p=n(61564),h=n(83936),v=n(97004),g=n(78538),m=n(39249),_=function(e){return e.PERSISTED="persisted",e.NOT_PERSISTED="not-persisted",e.FAILED="failed",e.NO_API="no_api",e}({}),x=!!("undefined"!=typeof navigator&&navigator.storage&&navigator.storage.persist),w=function(){var e=(0,v._)(function(e){return(0,m.YH)(this,function(t){switch(t.label){case 0:if(!x)return[3,2];return[4,navigator.storage.persisted()];case 1:return e(t.sent()?"persisted":"not-persisted"),[3,3];case 2:e("no_api"),t.label=3;case 3:return[2]}})});return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,v._)(function(e){return(0,m.YH)(this,function(t){switch(t.label){case 0:if(!x)return[3,2];return[4,navigator.storage.persist()];case 1:return e(t.sent()?"persisted":"failed"),[3,3];case 2:e("no_api"),t.label=3;case 3:return[2]}})});return function(t){return e.apply(this,arguments)}}();let A=function(){var e,t=(0,g._)((0,a.useState)("not-persisted"),2),n=t[0],r=t[1];return(0,a.useEffect)(function(){w(r)},[]),{persistAPIAvailable:x,persisted:n,requestPersist:(e=(0,v._)(function(){return(0,m.YH)(this,function(e){return b(r),[2]})}),function(){return e.apply(this,arguments)})}};var P=n(86447),S=n(693),y=n(60376),C=n(633),j=n(11760),I=n(55364),E=n(5847),N=n(72623),T=function(){var e=(0,v._)(function(e,t,n){var r;return(0,m.YH)(this,function(i){switch(i.label){case 0:return[4,(0,E.T)(e,t)(n,!1)];case 1:if(!(r=i.sent()))return[2,null];return[4,(0,N.cg)(r)];case 2:if(i.sent().dataHash!==n)return[2,(0,N.UN)(r)];return[2,null]}})});return function(t,n,r){return e.apply(this,arguments)}}();let k=function(){var e=(0,j.h)(),t=e.frames,r=e.images,i=(0,C.g)().updateImageHash,s=(0,g._)((0,a.useState)(!0),2),u=s[0],o=s[1];return window.enableHashCleanup=function(){return o(!1)},{cleanupBusy:u,hashCleanup:(0,v._)(function(){var e,s,u;return(0,m.YH)(this,function(a){switch(a.label){case 0:return o(!0),e=0,s=0,[4,Promise.resolve().then(n.t.bind(n,52491,23))];case 1:var l;return u=a.sent().default,[4,Promise.all(r.map((l=(0,v._)(function(n){var a,o,l,c,f;return(0,m.YH)(this,function(d){switch(d.label){case 0:var p;if(a=n.hash,!(0,I.pl)(n))return[3,2];return[4,Promise.all(Object.keys(o=n.hashes).map((p=(0,v._)(function(e){var n,i;return(0,m.YH)(this,function(s){switch(s.label){case 0:if(n=o[e],i=null,!n)return[3,2];return[4,T(r,t,n)];case 1:i=s.sent(),s.label=2;case 2:return[2,(0,P._)({},e,i||n)]}})}),function(e){return p.apply(this,arguments)})))];case 1:return(c=u(l=d.sent().reduce(function(e,t){return(0,S._)({},e,t)},{})))!==a&&(e+=1,i(a,(0,y._)((0,S._)({},n),{hash:c,hashes:l}))),[3,4];case 2:return[4,T(r,t,a)];case 3:(f=d.sent())&&(s+=1,i(a,(0,y._)((0,S._)({},n),{hash:f}))),d.label=4;case 4:return[2]}})}),function(e){return l.apply(this,arguments)})))];case 2:return a.sent(),o(!1),console.info({iCounterRGBN:e,iCounterMono:s}),[2]}})})}};var H=function(e){switch(e){case _.PERSISTED:return"Storage is persistent";case _.NOT_PERSISTED:return"Request storage persistence";case _.NO_API:return"Persistance API not available";case _.FAILED:default:return"Failed to persist storage"}};let D=function(){var e=k(),t=e.hashCleanup,n=e.cleanupBusy,i=(0,h.W)().downloadSettings,s=(0,p.t)().resetGroups,u=function(e){return i(e)},a=A(),o=a.persisted,l=a.requestPersist;return(0,r.jsxs)(f.default,{variant:"contained",fullWidth:!0,children:[(0,r.jsx)(c.default,{disabled:o!==_.NOT_PERSISTED,onClick:l,children:H(o)}),(0,r.jsx)(c.default,{onClick:s,children:"Reset image groups"}),(0,r.jsx)(c.default,{onClick:function(){return u(d.m.ALL)},children:"Export Everything"}),(0,r.jsx)(c.default,{onClick:function(){return u(d.m.PLUGINS)},children:"Export Plugins"}),(0,r.jsx)(c.default,{disabled:n,onClick:t,children:"Hash Cleanup"})]})};var G=n(18096),R=n(53369),Y=n(6874),O=n.n(Y),L=n(35695),F=n(99451);let M=function(){var e=(0,L.usePathname)(),t=(0,o.D)(),n=(0,a.useMemo)(function(){return[{path:"/settings/generic/",headline:"Generic Settings",prefetch:!0},{path:"/settings/dropbox/",headline:"Dropbox Settings",prefetch:!1},(null==t?void 0:t.env)==="esp8266"||(null==t?void 0:t.env)==="webpack-dev"?{path:"/settings/wifi/",headline:"WiFi Settings",prefetch:!1}:null,{path:"/settings/plugins/",headline:"Plugin Settings",prefetch:!1},{path:"/settings/git/",headline:"Git Settings",prefetch:!1}].reduce(F.N,[])},[t]),i=(0,a.useMemo)(function(){return n.length&&"/settings"!==e?e:null},[e,n]);return i?(0,r.jsx)(R.default,{value:i,children:n.map(function(e){var t=e.headline,n=e.path,i=e.prefetch;return(0,r.jsx)(G.default,{label:t,component:O(),href:n,prefetch:i,value:n},n)})}):null};function q(e){var t,n,o,c=e.children,f=(n=(t=(0,g._)((0,a.useState)(!1),2))[0],o=t[1],(0,a.useEffect)(function(){if("function"==typeof window.requestIdleCallback){var e=requestIdleCallback(function(){return o(!0)});return function(){window.cancelIdleCallback(e)}}var t=window.setTimeout(function(){return o(!0)},1e3);return function(){window.clearTimeout(t)}},[]),n);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.default,{component:"h1",variant:"h1",children:"Settings"}),f&&(0,r.jsxs)(s.default,{direction:"column",gap:4,justifyContent:"space-between",sx:{flexGrow:1},children:[(0,r.jsxs)(s.default,{direction:"column",gap:6,children:[(0,r.jsx)(M,{}),(0,r.jsx)(i.default,{children:c}),(0,r.jsx)(D,{})]}),(0,r.jsx)(l,{})]})]})}},99451:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(87025),i=function(e,t){return t?(0,r._)(e).concat([t]):e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4453,700,7859,7271,8250,2491,7642,7890,1487,6672,6874,3678,4297,1760,3936,283,8441,1684,7358],()=>t(38584)),_N_E=e.O()}]);