(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2784],{6768:(e,t,n)=>{"use strict";n.d(t,{default:()=>er});var r=n(82732),i=n(45849),s=n(22043),a=n(95155),l=n(32630),o=n(41942),c=n(4615),u=n(7291),d=n(49571),h=n(32968),g=n(64647),A=n(13802),m=n(34782),f=n(24288),p=n(37440),x=n(18955),S=n(12115),j=n(25148),v=n(98447),b=n(75970),I=n(19102),k=n(98638),C=n(56120),E=n(80223),P=n(54463),_=n(31512),N=n(6388),y=n(96002),G=n(98631),T=n(49337),w=n(80317),L=n(61491),M=function(e){return e?new Date(e).toLocaleString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A"},R=function(e,t,n){if(0===t&&0===n)return"≠";switch(e){case -1:return"<";case 1:return">";default:return"="}};let U=function(e){var t=e.sheetStats,n=e.disabled,r=(0,L.A)(),i=r.performPush,s=r.performPull,l=r.performMerge,c=(0,x.c)("SheetsTable"),u=t.sheetName,d=t.sheetId,h=t.columnCount,g=t.rowCount,A=t.remoteTimestamp,m=t.localTimestamp,p=t.diff,S=t.sort,j=t.Icon,v=R(p,A,m);return(0,a.jsxs)(P.A,{sx:{"--color-match":"="!==v?"var(--color-match-diff)":"var(--color-match-same)"},children:[(0,a.jsxs)(_.A,{align:"right",children:[(0,a.jsx)(f.A,{disabled:n,title:c("syncPush"),onClick:function(){return i({sheetName:u,newLastUpdateValue:m,sort:S})},children:(0,a.jsx)(G.A,{})}),(0,a.jsx)(f.A,{disabled:n,title:c("syncMerge"),onClick:function(){return l({sheetName:u,lastRemoteUpdate:A,lastLocalUpdate:m,sort:S})},children:(0,a.jsx)(T.A,{})}),(0,a.jsx)(f.A,{disabled:n,title:c("syncPull"),onClick:function(){return s({merge:!1,sheetName:u,lastRemoteUpdate:A})},children:(0,a.jsx)(y.A,{})})]}),(0,a.jsx)(_.A,{align:"right",children:(0,a.jsxs)(o.A,{direction:"row",gap:1,alignItems:"center",justifyContent:"right",children:[(0,a.jsx)("span",{children:u}),j&&(0,a.jsx)(j,{})]})}),(0,a.jsx)(_.A,{align:"right",sx:{backgroundColor:"var(--color-match)"},children:M(A)}),(0,a.jsx)(_.A,{align:"center",sx:{backgroundColor:"var(--color-match)"},children:(0,a.jsxs)(w.A,{variant:"h4",children:[p>0&&"✨ ",p<0&&"\uD83D\uDD70️ ",v,p>0&&" \uD83D\uDD70️",p<0&&" ✨"]})}),(0,a.jsx)(_.A,{align:"left",sx:{backgroundColor:"var(--color-match)"},children:M(m)}),(0,a.jsx)(_.A,{align:"right",children:h}),(0,a.jsx)(_.A,{align:"right",children:g}),(0,a.jsx)(_.A,{align:"right",children:d})]},u)};var B=n(73533),F=n(20251),$=n(10022);let z=(0,S.memo)(function(e){var t=e.sheetsStats,n=(0,B.A)().updateSheets,r=(0,$.N$)().gapiStorage,i=(0,L.A)().busy,s=(0,F.A)(),l=s.isReady,o=s.isSignedIn,c=(0,x.c)("SheetsTable"),u=i||!r.sheetId||!r.use||!l||!o;return(0,a.jsxs)(v.A,{component:b.A,sx:function(e){return{"--color-match-same":"rgb(from ".concat(e.palette.success.main," r g b / 0.25)"),"--color-match-diff":"rgb(from ".concat(e.palette.error.main," r g b / 0.25)"),position:"relative",overflowX:"auto"}},children:[(0,a.jsx)(I.A,{sx:{position:"absolute"},open:i,children:(0,a.jsx)(k.A,{color:"inherit"})}),(0,a.jsxs)(C.A,{sx:{minWidth:1024},padding:"normal",size:"small",children:[(0,a.jsx)(E.A,{children:(0,a.jsxs)(P.A,{children:[(0,a.jsx)(_.A,{align:"right",children:(0,a.jsx)(f.A,{disabled:u,title:c("refreshStats"),onClick:n,children:(0,a.jsx)(j.A,{})})}),(0,a.jsx)(_.A,{align:"right",children:c("title")}),(0,a.jsx)(_.A,{align:"right",children:c("lastRemoteUpdate")}),(0,a.jsx)(_.A,{}),(0,a.jsx)(_.A,{align:"left",children:c("lastLocalUpdate")}),(0,a.jsx)(_.A,{align:"right",children:c("columns")}),(0,a.jsx)(_.A,{align:"right",children:c("rows")}),(0,a.jsx)(_.A,{align:"right",children:c("id")})]})}),(0,a.jsx)(N.A,{children:t.map(function(e){return(0,a.jsx)(U,{sheetStats:e,disabled:u},e.sheetName)})})]})]})}),O=function(){var e=(0,x.c)("SettingsGapiSheets"),t=(0,s._)((0,S.useState)(""),2),n=t[0],r=t[1],i=(0,$.N$)().gapiStorage;return(0,S.useEffect)(function(){var e=setInterval(function(){var e=(i.tokenExpiry||0)-Date.now();if(e<=0)return void r("N/A");r(new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC"}))},1e3);return function(){return clearInterval(e)}},[i.tokenExpiry]),(0,a.jsx)(w.A,{children:e("tokenExpiry",{time:n})})};var D=n(53776),H=n(98818),W=n(32946),Z=n(22094),V=n(46763),X=n(24305),q=n(8994),J=n(33452),K=n(27448),Q=n(65486),Y=function(e){switch(e){case Q.Pu.IMAGES:return q.A;case Q.Pu.RGBN_IMAGES:return X.A;case Q.Pu.IMAGE_GROUPS:return H.A;case Q.Pu.FRAMES:return J.A;case Q.Pu.FRAME_GROUPS:return V.A;case Q.Pu.PALETTES:return K.A;case Q.Pu.PLUGINS:return Z.A;case Q.Pu.BIN_IMAGES:case Q.Pu.BIN_FRAMES:return W.A}},ee=function(){var e=(0,B.A)(),t=e.gapiLastRemoteUpdates,n=e.sheets,r=(0,$.Vs)().gapiLastLocalUpdates,i=(0,S.useMemo)(function(){return Q.kD.map(function(e){var i,s,a,l,o,c,u=null==(i=n.find(function(t){var n;return(null==(n=t.properties)?void 0:n.title)===e}))?void 0:i.properties,d=(null==u||null==(s=u.sheetId)?void 0:s.toString(10))||"N/A",h=(null==u||null==(l=u.gridProperties)||null==(a=l.columnCount)?void 0:a.toString(10))||"N/A",g=(null==u||null==(c=u.gridProperties)||null==(o=c.rowCount)?void 0:o.toString(10))||"N/A",A=(null==t?void 0:t[e])||0,m=null==r?void 0:r[e],f=Math.sign(A-m),p=e!==Q.Pu.BIN_IMAGES&&e!==Q.Pu.BIN_FRAMES,x=Y(e);return{sheetName:e,sheetId:d,columnCount:h,rowCount:g,remoteTimestamp:A,localTimestamp:m,diff:f,sort:p,Icon:x}})},[r,t,n]),s=(0,S.useMemo)(function(){return!i.find(function(e){var t=e.diff,n=e.remoteTimestamp,r=e.localTimestamp;return 0!==t||!n||!r})},[i]);return{sheetsStats:i,canEnableAutoSync:s}},et=n(55703),en=function(e){var t=e.trim();if(!t)return"";if(/^[a-zA-Z0-9-_]{24,}$/.test(t))return t;var n=t.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]{24,})\/edit(?:[?#].*)?$/);return n?n[1]:""};let er=function(){var e=(0,F.A)(),t=e.isSignedIn,n=e.handleSignIn,j=e.handleSignOut,v=(0,$.C$)().featureFlags,b=(0,$.N$)(),I=b.gapiStorage,k=b.setGapiSettings,C=(0,B.A)().clearGapiLastRemoteUpdates,E=ee(),P=E.sheetsStats,_=E.canEnableAutoSync,N=(0,s._)((0,S.useState)(I.use||!1),2),y=N[0],G=N[1],T=(0,s._)((0,S.useState)(I.autoSync||!1),2),w=T[0],L=T[1],M=(0,s._)((0,S.useState)(I.sheetId||""),2),R=M[0],U=M[1],H=(0,x.c)("SettingsGapiSheets");return((0,S.useEffect)(function(){G(I.use||!1),L(I.autoSync||!1),U(I.sheetId||"")},[I]),v.includes(et.T.GAPI_SHEETS))?(0,a.jsxs)(o.A,{direction:"column",gap:6,children:[(0,a.jsx)(c.A,{severity:"warning",variant:"filled",children:H("about")}),(0,a.jsx)(u.A,{label:H("enableStorage"),control:(0,a.jsx)(d.A,{checked:y,onChange:function(e){var t=e.target;G(t.checked),k({use:t.checked})}})}),(0,a.jsx)(u.A,{label:H("enableAutoSync"),disabled:!y||!_,control:(0,a.jsx)(d.A,{checked:w,onChange:function(e){var t=e.target;L(t.checked),k({autoSync:t.checked})}})}),(0,a.jsxs)(h.A,{variant:"contained",fullWidth:!0,children:[(0,a.jsx)(g.A,{disabled:t||!I.use,onClick:n,children:H("authenticate")}),(0,a.jsx)(g.A,{disabled:!t,onClick:j,children:H("logout")})]}),y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.A,{label:H("sheetId"),helperText:H("sheetIdHelper"),type:"text",value:R,slotProps:(0,i._)((0,r._)({},D.y),{input:{endAdornment:(0,a.jsx)(m.A,{position:"end",children:(0,a.jsx)(f.A,{title:H("openSheetLink"),"aria-label":H("openSheetLink"),disabled:!I.sheetId,edge:"end",component:p.A,href:"https://docs.google.com/spreadsheets/d/".concat(I.sheetId,"/edit"),target:"_blank",rel:"noreferrer",children:(0,a.jsx)(l.A,{})})})}}),onChange:function(e){U(e.target.value)},onBlur:function(e){var t=en(e.target.value);U(t),k({sheetId:t,autoSync:!1}),C()}}),t&&(0,a.jsx)(O,{}),(0,a.jsx)(z,{sheetsStats:P})]}):null]}):null}},53776:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var r={htmlInput:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1},inputLabel:{shrink:!0},fullWidth:!0,size:"small"}},55703:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});var r=function(e){return e.GAPI_SHEETS="gapiSheets",e}({})},59437:(e,t,n)=>{Promise.resolve().then(n.bind(n,6768))}},e=>{e.O(0,[5266,7400,8955,3632,317,1346,7115,4688,4647,3683,3802,2968,4615,9144,7161,7922,9314,4468,1491,8441,9342,1255,7358],()=>e(e.s=59437)),_N_E=e.O()}]);