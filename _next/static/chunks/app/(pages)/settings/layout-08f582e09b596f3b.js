(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7437],{1607:(e,t,n)=>{"use strict";n.d(t,{D:()=>d,EnvProvider:()=>g});var r=n(97004),u=n(693),i=n(60376),s=n(78538),a=n(39249),o=n(95155),l=n(12115),c=n(52166),f=n(75380),p=(0,l.createContext)(null),d=function(){return(0,l.useContext)(p)},g=function(e){var t=e.children,n=(0,s._)((0,l.useState)(null),2),d=n[0],g=n[1],h=(0,c.A)().setPrinterUrl;return(0,l.useEffect)(function(){var e=["/gb-printer-web","/env.json"].filter(Boolean).join("/");e&&(0,r._)(function(){var t,n,r,s;return(0,a.YH)(this,function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),[4,(0,f.ZU)()];case 1:return a.sent(),[4,fetch(e)];case 2:return[4,a.sent().json()];case 3:return t=a.sent(),r=[(0,u._)({},t)],s={},[4,f.mU.driver()];case 4:return"esp8266"===(n=i._.apply(void 0,r.concat([(s.localforage=a.sent(),s)]))).env&&h("/"),g(n),[3,6];case 5:return a.sent(),g({version:"0.0.0",maximages:0,localforage:"error",env:"error",fstype:"-",bootmode:"-",oled:!1}),[3,6];case 6:return[2]}})})()},[h]),(0,o.jsx)(p.Provider,{value:d,children:t})}},23747:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>_,BF:()=>m,Ll:()=>v});var r=n(97004),u=n(693),i=n(60376),s=n(78538),a=n(39249),o=n(12115),l=n(95939),c=n(7119),f=n(3381),p=n(71620),d=n(11760),g=n(80360),h=n(46594),v="NEW_GROUP",m=function(e){return e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase()},I=function(e,t){return e.find(function(e){return e.group.groups.find(function(e){return e.id===t})})||null},E=function(e){return e.CREATE_NEW="CREATE_NEW",e.EDIT_EXISTING="EDIT_EXISTING",e.NOT_EDITING="NOT_EDITING",e}(E||{});let _=function(){var e,t=(0,p.A)().imageSelection,n=(0,f.A)(),E=n.editImageGroup,_=n.cancelEditImageGroup,T=(0,d.h)(),b=T.imageGroups,G=T.addImageGroup,S=T.updateImageGroup,A=T.groupImagesAdd,w=T.ungroupImages,P=(0,c.g)(),N=P.navigateToGroup,x=P.navigateToImage,C=(0,l.Z)(),y=C.path,j=C.view,D=C.paths,M=C.pathsOptions,H=t.length,O=(null==E?void 0:E.groupId)?E.groupId===v?"CREATE_NEW":"EDIT_EXISTING":"NOT_EDITING",k=(0,o.useMemo)(function(){switch(O){case"CREATE_NEW":var e=(null==E?void 0:E.newGroupTitle)||"";return{imageGroup:null,parentPathMap:D.find(function(e){return e.group.id===j.id})||null,title:e,slug:m(e),slugTouched:!1};case"EDIT_EXISTING":var t=b.find(function(e){return e.id===(null==E?void 0:E.groupId)})||null;return{imageGroup:t,parentPathMap:(null==E?void 0:E.groupId)?I(D,E.groupId):null,title:(null==t?void 0:t.title)||"",slug:(null==t?void 0:t.slug)||"",slugTouched:!0};default:return{imageGroup:null,parentPathMap:null,title:"",slug:"",slugTouched:!1}}},[E,O,b,D,j]),R=(0,s._)((0,o.useState)(k.title),2),Y=R[0],W=R[1],L=(0,s._)((0,o.useState)(k.slug),2),U=L[0],B=L[1],X=(0,s._)((0,o.useState)(k.slugTouched),2),q=X[0],F=X[1],V=(0,s._)((0,o.useState)((null==(e=k.parentPathMap)?void 0:e.absolutePath)||""),2),Z=V[0],z=V[1],J=(0,o.useMemo)(function(){if(!(null==E?void 0:E.groupId))return"";if((null==E?void 0:E.groupId)===v)return"".concat(y).concat(U,"/");var e=I(D,E.groupId),t=(null==e?void 0:e.absolutePath)||"";return"".concat(t).concat(U,"/")},[E,D,y,U]),K=(0,o.useMemo)(function(){return!!D.find(function(e){return e.absolutePath===J})},[J,D]),$=(0,o.useMemo)(function(){var e;return U!==(null==(e=k.imageGroup)?void 0:e.slug)},[k,U]),Q=(0,o.useMemo)(function(){return!!U&&("CREATE_NEW"===O?!K:"EDIT_EXISTING"===O&&(!$||!K))},[O,U,K,$]),ee=(0,o.useMemo)(function(){var e,t,n=(null==(e=D.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"";return((null==(t=k.parentPathMap)?void 0:t.group.id)||"")!==n},[k,Z,D]),et=(0,o.useMemo)(function(){switch(O){case"EDIT_EXISTING":var e,t=(null==(e=D.find(function(e){return e.group.id===(null==E?void 0:E.groupId)}))?void 0:e.absolutePath)||"";return M.filter(function(e){var n=e.value;return!n.startsWith(J)&&n!==t});case"CREATE_NEW":return M;default:return[]}},[J,E,O,D,M]);return{editId:(null==E?void 0:E.groupId)||null,absoluteSlug:J,possibleParents:et,slug:U,title:Y,canConfirm:Q,canMove:ee,slugIsInUse:K,slugWasChanged:$,parentSlug:Z,selectionCount:H,setSlug:function(e){B(e),F(!0)},setTitle:function(e){W(e),(e.length<2||!q)&&(F(!1),B(m(e)))},setParentSlug:z,confirm:function(){if(_(),Q&&E){var e,n=(null==(e=D.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"";if(E.groupId===v){if(!E.newGroupCover)return;var r=(0,g.z)();G({id:r,slug:U,title:Y,created:(0,h.J)(),coverImage:E.newGroupCover,images:t,groups:[]},n),N(r,0)}else{if(!k.imageGroup)return;S((0,i._)((0,u._)({},k.imageGroup),{slug:U,title:Y}),n),N(E.groupId,0)}}},move:(0,r._)(function(){var e,n;return(0,a.YH)(this,function(r){return _(),ee&&((n=(null==(e=D.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"")?A(n,t):w(t),x(t[0])),[2]})}),cancelEditImageGroup:_}}},38584:(e,t,n)=>{Promise.resolve().then(n.bind(n,91128))},39630:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info",e.IMAGE="image",e.META="meta",e}({})},61564:(e,t,n)=>{"use strict";n.d(t,{t:()=>h});var r=n(97004),u=n(39249),i=n(17652),s=n(12115),a=n(33236),o=n(39630),l=n(95939),c=n(23747),f=n(41186),p=n(3381),d=n(71620),g=n(11760),h=function(){var e=(0,i.c3)("useImageGroups"),t=(0,l.Z)().view,n=(0,f.A)(),h=n.dismissDialog,v=n.setDialog,m=(0,p.A)().setEditImageGroup,I=(0,g.h)(),E=I.deleteImageGroup,_=I.setImageGroups,T=I.images,b=(0,d.A)().imageSelection,G=(0,s.useMemo)(function(){if(!b.length)return"";var t,n=T.filter(function(e){var t=e.hash;return b.includes(t)}).map(function(e){return e.title}).filter(function(e){return e.length>3}),r=null==(t=(0,a.Hg)(n).filter(function(e){return e.length>3})[0])?void 0:t.trim();return r?r.replace(/[_-]/g," ").replace(/^\s*\d+\s+|\s+\d+\s*$/g,"").trim():e("newGroupDefault")},[b,T,e]);return{resetGroups:function(){v({message:e("resetGroupsMessage"),questions:function(){return[{key:"info",type:o.V.INFO,label:e("resetGroupsInfo")}]},confirm:(0,r._)(function(){return(0,u.YH)(this,function(e){return h(0),_([]),[2]})}),deny:(0,r._)(function(){return(0,u.YH)(this,function(e){return h(0),[2]})})})},createGroup:function(e){m({groupId:c.Ll,newGroupCover:e,newGroupTitle:G})},editGroup:function(e){m({groupId:e})},deleteGroup:function(n){var i=t.groups.find(function(e){return e.id===n});i&&v({message:e("deleteGroupMessage"),questions:function(){return[{key:"info",type:o.V.INFO,label:e("deleteGroupInfo",{groupTitle:i.title||i.slug})}]},confirm:(0,r._)(function(){return(0,u.YH)(this,function(e){return h(0),E(n),[2]})}),deny:(0,r._)(function(){return(0,u.YH)(this,function(e){return h(0),[2]})})})}}}},80360:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=n(51368).A},91128:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var r=n(95155),u=n(54581),i=n(71803),s=n(700),a=n(17652),o=n(12115),l=n(1607);let c=function(){var e=(0,l.D)(),t=(0,a.c3)("EnvInfo"),n=(0,o.useMemo)(function(){return e?[t("appVersion",{value:"1.50.2"}),t("appBranch",{value:"master"}),t("printerVersion",{value:e.version}),t("maxImages",{value:e.maximages}),t("storageDriver",{value:e.localforage}),t("envType",{value:e.env}),t("filesystem",{value:e.fstype}),t("bootmode",{value:e.bootmode}),t("hasOled",{value:e.oled?t("yes"):t("no")})]:[]},[e,t]);return(0,r.jsx)(i.A,{component:"ul",direction:"column",children:n.map(function(e){return(0,r.jsx)(s.A,{component:"li",variant:"caption",color:"textDisabled",align:"right",lineHeight:1.25,children:e},e)})})};var f=n(7642),p=n(61487),d=n(69229),g=n(61564),h=n(83936),v=n(97004),m=n(78538),I=n(39249),E=function(e){return e.PERSISTED="persisted",e.NOT_PERSISTED="not-persisted",e.FAILED="failed",e.NO_API="no_api",e}({}),_=!!("undefined"!=typeof navigator&&navigator.storage&&navigator.storage.persist),T=function(){var e=(0,v._)(function(e){return(0,I.YH)(this,function(t){switch(t.label){case 0:if(!_)return[3,2];return[4,navigator.storage.persisted()];case 1:return e(t.sent()?"persisted":"not-persisted"),[3,3];case 2:e("no_api"),t.label=3;case 3:return[2]}})});return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,v._)(function(e){return(0,I.YH)(this,function(t){switch(t.label){case 0:if(!_)return[3,2];return[4,navigator.storage.persist()];case 1:return e(t.sent()?"persisted":"failed"),[3,3];case 2:e("no_api"),t.label=3;case 3:return[2]}})});return function(t){return e.apply(this,arguments)}}();let G=function(){var e,t=(0,m._)((0,o.useState)("not-persisted"),2),n=t[0],r=t[1];return(0,o.useEffect)(function(){T(r)},[]),{persistAPIAvailable:_,persisted:n,requestPersist:(e=(0,v._)(function(){return(0,I.YH)(this,function(e){return b(r),[2]})}),function(){return e.apply(this,arguments)})}};var S=n(86447),A=n(693),w=n(60376),P=n(633),N=n(11760),x=n(55364),C=n(5847),y=n(72623),j=function(){var e=(0,v._)(function(e,t,n){var r;return(0,I.YH)(this,function(u){switch(u.label){case 0:return[4,(0,C.T)(e,t)(n,!1)];case 1:if(!(r=u.sent()))return[2,null];return[4,(0,y.cg)(r)];case 2:if(u.sent().dataHash!==n)return[2,(0,y.UN)(r)];return[2,null]}})});return function(t,n,r){return e.apply(this,arguments)}}();let D=function(){var e=(0,N.h)(),t=e.frames,r=e.images,u=(0,P.g)().updateImageHash,i=(0,m._)((0,o.useState)(!0),2),s=i[0],a=i[1];return window.enableHashCleanup=function(){return a(!1)},{cleanupBusy:s,hashCleanup:(0,v._)(function(){var e,i,s;return(0,I.YH)(this,function(o){switch(o.label){case 0:return a(!0),e=0,i=0,[4,Promise.resolve().then(n.t.bind(n,52491,23))];case 1:var l;return s=o.sent().default,[4,Promise.all(r.map((l=(0,v._)(function(n){var a,o,l,c,f;return(0,I.YH)(this,function(p){switch(p.label){case 0:var d;if(a=n.hash,!(0,x.pl)(n))return[3,2];return[4,Promise.all(Object.keys(o=n.hashes).map((d=(0,v._)(function(e){var n,u;return(0,I.YH)(this,function(i){switch(i.label){case 0:if(n=o[e],u=null,!n)return[3,2];return[4,j(r,t,n)];case 1:u=i.sent(),i.label=2;case 2:return[2,(0,S._)({},e,u||n)]}})}),function(e){return d.apply(this,arguments)})))];case 1:return(c=s(l=p.sent().reduce(function(e,t){return(0,A._)({},e,t)},{})))!==a&&(e+=1,u(a,(0,w._)((0,A._)({},n),{hash:c,hashes:l}))),[3,4];case 2:return[4,j(r,t,a)];case 3:(f=p.sent())&&(i+=1,u(a,(0,w._)((0,A._)({},n),{hash:f}))),p.label=4;case 4:return[2]}})}),function(e){return l.apply(this,arguments)})))];case 2:return o.sent(),a(!1),console.info({iCounterRGBN:e,iCounterMono:i}),[2]}})})}};var M=function(e){switch(e){case E.PERSISTED:return"persistState.isPersistent";case E.NOT_PERSISTED:return"persistState.requestPersistence";case E.NO_API:return"persistState.apiUnavailable";case E.FAILED:default:return"persistState.failed"}};let H=function(){var e=D(),t=e.hashCleanup,n=e.cleanupBusy,u=(0,h.W)().downloadSettings,i=(0,a.c3)("ExportSettings"),s=(0,g.t)().resetGroups,o=function(e){return u(e)},l=G(),c=l.persisted,v=l.requestPersist;return(0,r.jsxs)(p.A,{variant:"contained",fullWidth:!0,children:[(0,r.jsx)(f.A,{title:i(M(c)),disabled:c!==E.NOT_PERSISTED,onClick:v,children:i(M(c))}),(0,r.jsx)(f.A,{title:i("resetGroups"),onClick:s,children:i("resetGroups")}),(0,r.jsx)(f.A,{title:i("exportAll"),onClick:function(){return o(d.m.ALL)},children:i("exportAll")}),(0,r.jsx)(f.A,{title:i("exportPlugins"),onClick:function(){return o(d.m.PLUGINS)},children:i("exportPlugins")}),(0,r.jsx)(f.A,{title:i("hashCleanup"),disabled:n,onClick:t,children:i("hashCleanup")})]})};var O=n(18096),k=n(70541),R=n(6874),Y=n.n(R),W=n(35695),L=n(99451);let U=function(){var e=(0,W.usePathname)(),t=(0,l.D)(),n=(0,a.c3)("SettingsTabs"),u=(0,o.useMemo)(function(){return[{path:"/settings/generic/",headline:n("genericSettings"),prefetch:!0},{path:"/settings/dropbox/",headline:n("dropboxSettings"),prefetch:!1},(null==t?void 0:t.env)==="esp8266"||(null==t?void 0:t.env)==="webpack-dev"?{path:"/settings/wifi/",headline:n("wifiSettings"),prefetch:!1}:null,{path:"/settings/plugins/",headline:n("pluginSettings"),prefetch:!1},{path:"/settings/git/",headline:n("gitSettings"),prefetch:!1}].reduce(L.N,[])},[n,t]),i=(0,o.useMemo)(function(){return u.length&&"/settings"!==e?e:null},[e,u]);return i?(0,r.jsx)(k.A,{value:i,children:u.map(function(e){var t=e.headline,n=e.path,u=e.prefetch;return(0,r.jsx)(O.A,{label:t,component:Y(),href:n,prefetch:u,value:n},n)})}):null};function B(e){var t,n,l,f=e.children,p=(0,a.c3)("Navigation"),d=(n=(t=(0,m._)((0,o.useState)(!1),2))[0],l=t[1],(0,o.useEffect)(function(){if("function"==typeof window.requestIdleCallback){var e=requestIdleCallback(function(){return l(!0)});return function(){window.cancelIdleCallback(e)}}var t=window.setTimeout(function(){return l(!0)},1e3);return function(){window.clearTimeout(t)}},[]),n);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{component:"h1",variant:"h1",children:p("settings")}),d&&(0,r.jsxs)(i.A,{direction:"column",gap:4,justifyContent:"space-between",sx:{flexGrow:1},children:[(0,r.jsxs)(i.A,{direction:"column",gap:6,children:[(0,r.jsx)(U,{}),(0,r.jsx)(u.A,{children:f}),(0,r.jsx)(H,{})]}),(0,r.jsx)(c,{})]})]})}},99451:(e,t,n)=>{"use strict";n.d(t,{N:()=>u});var r=n(87025),u=function(e,t){return t?(0,r._)(e).concat([t]):e}}},e=>{var t=t=>e(e.s=t);e.O(0,[5271,4453,700,8250,5232,7271,2491,7642,7890,6672,1487,4556,1190,3236,7652,1760,2973,9194,8441,1684,7358],()=>t(38584)),_N_E=e.O()}]);