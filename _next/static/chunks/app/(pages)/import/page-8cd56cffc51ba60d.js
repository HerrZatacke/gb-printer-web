(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5862],{15015:(e,n,t)=>{"use strict";t.d(n,{_Y:()=>i,k4:()=>o,qt:()=>r});var r=function(e){return e.USB="USB",e.SERIAL="SERIAL",e}({}),i=function(e){return e.INACTIVE="inactive",e.PACKET_CAPTURE="packet_capture",e.SUPER_PRINTER_INTERFACE="super_printer_interface",e.GBXCART="gbxcart",e}({}),o=[{vendorId:9025,productId:32822},{vendorId:9025,productId:32823},{vendorId:9025,productId:32845},{vendorId:9025,productId:32846},{vendorId:9025,productId:32847},{vendorId:9025,productId:32848},{vendorId:9025,productId:32850},{vendorId:9025,productId:32851},{vendorId:9025,productId:32852},{vendorId:9025,productId:32853},{vendorId:9025,productId:32854},{vendorId:9025,productId:32855},{vendorId:9114}]},28425:(e,n,t)=>{"use strict";t.d(n,{l:()=>a});var r=t(45377),i=t(83231),o=t(30771),s=t(10022),a=function(){var e=(0,s.C$)().printerUrl,n=(0,s.I0)().printerFunctions,t=(0,i.W)().downloadSettings,a=n.length>0,c=(0,o.A)().handleFileImport;return{printerUrl:e?"".concat(e,"remote.html"):void 0,printerConnected:a,importPlainText:function(e){c([new File((0,r._)(e),"Text input.txt",{type:"text/plain"})])},importFiles:c,exportJson:function(e){return t(e)}}}},34476:(e,n,t)=>{"use strict";t.d(n,{U:()=>i,Z:()=>o});var r=t(12115),i=(0,r.createContext)({connectedDevices:[],isReceiving:!1,webSerialEnabled:!1,openWebSerial:function(){throw Error("PortsContext is missing")},webUSBEnabled:!1,openWebUSB:function(){throw Error("PortsContext is missing")},unknownDeviceResponse:null,hasInactiveDevices:!1}),o=function(){return(0,r.useContext)(i)}},41574:(e,n,t)=>{"use strict";t.d(n,{A:()=>A});var r=t(82732),i=t(17389),o=t(12115),s=t(2821),a=t(72131),c=t(35885),l=t(47627),u=t(57915),d=t(95155),f=t(27923),m=t(65595),p=t(15370),h=(0,t(13053).A)("MuiBox",["root"]),v=(0,m.A)();let A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.themeId,t=e.defaultTheme,f=e.defaultClassName,m=void 0===f?"MuiBox-root":f,p=e.generateClassName,h=(0,a.Ay)("div",{shouldForwardProp:function(e){return"theme"!==e&&"sx"!==e&&"as"!==e}})(c.A);return o.forwardRef(function(e,o){var a=(0,u.A)(t),c=(0,l.A)(e),f=c.className,v=c.component,A=(0,i._)(c,["className","component"]);return(0,d.jsx)(h,(0,r._)({as:void 0===v?"div":v,ref:o,className:(0,s.A)(f,p?p(m):m),theme:n&&a[n]||a},A))})}({themeId:p.A,defaultTheme:v,defaultClassName:h.root,generateClassName:f.A.generate})},45407:(e,n,t)=>{"use strict";t.d(n,{n:()=>r});var r=function(e){return e.TESTFILE="testFile",e.CHECKPRINTER="checkPrinter",e.FETCHIMAGES="fetchImages",e.CLEARPRINTER="clearPrinter",e.TEAR="tear",e}({})},46074:(e,n,t)=>{"use strict";t.d(n,{G:()=>s,b:()=>a});var r=t(61975),i=t(71450),o=t(12115),s=(0,o.createContext)({callRemoteFunction:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return[2]})})()}}),a=function(){return(0,o.useContext)(s)}},80738:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>J});var r=t(95155),i=t(80317),o=t(18955),s=t(22043),a=t(45377),c=t(64647),l=t(32968),u=t(41942),d=t(13802),f=t(12115),m=t(41574),p=t(98638),h=t(10022);let v=function(e){var n=(0,h.C$)(),t=n.printerUrl,r=n.printerParams,i=r?"#".concat(encodeURI(r)):"",o=t?"".concat(t,"remote.html").concat(i):void 0,a=(0,h.I0)().printerFunctions.length>0,c=(0,s._)((0,f.useState)(!1),2),l=c[0],u=c[1],d=(0,s._)((0,f.useState)(!1),2),m=d[0],p=d[1],v=(0,f.useRef)(void 0);return(0,f.useEffect)(function(){return l||m||v.current||(v.current=window.setTimeout(function(){p(!0)},e)),function(){window.clearTimeout(v.current),v.current=void 0}},[m,l,e]),!l&&a&&(window.clearTimeout(v.current),v.current=void 0,u(!0)),{failed:m,loaded:l,printerUrl:o,printerConnected:a}};var A=function(e){if(!e)return!1;if(e.startsWith("/"))return!0;var n=new URL(e).protocol,t=new URL(window.location.href).protocol;return"http:"===t||t===n};let x=function(){var e=(0,o.c)("ConnectPrinter"),n=v(3e4),t=n.printerUrl,i=n.failed,s=n.loaded,a=n.printerConnected;return A(t)&&!i?(0,r.jsxs)(m.A,{sx:{display:"flex",justifyContent:"center"},children:[(0,r.jsx)("iframe",{style:{position:"absolute",top:"80px",left:"-200vw",width:"480px",height:"90px"},src:t}),!s&&(0,r.jsx)(p.A,{color:"secondary"})]}):(!a||i)&&(0,r.jsx)(l.A,{variant:"contained",fullWidth:!0,children:(0,r.jsx)(c.A,{onClick:function(){window.open(t,"remoteprinter","width=480,height=400")},children:e("openPrinterPage")})})};var g=t(4615),I=t(75970),C=t(56120),R=t(6388),j=t(31512),E=t(98447),b=t(80223),P=t(54463),T=t(32893),w=t.n(T),_=t(45407),M=t(46074),F=function(){var e=(0,h.I0)(),n=e.printerData,t=e.printerFunctions,r=e.printerBusy,i=(0,M.b)().callRemoteFunction,o=t.length>0;return{printerData:n,printerFunctions:t,printerBusy:r,printerConnected:o,callRemoteFunction:i}},S={testFile:"functions.printTestImage",checkPrinter:"functions.checkPrinter",fetchImages:"",clearPrinter:"functions.clearPrinter",tear:"functions.tear"};let N=function(){var e,n=(0,o.c)("PrinterReport"),t=F(),i=t.printerData,s=t.printerFunctions,a=t.printerConnected,d=t.callRemoteFunction,m=t.printerBusy,p=(0,f.useMemo)(function(){var e,t=(null==i||null==(e=i.dumps)?void 0:e.length)||0;return s.includes(_.n.TEAR)||!t?n("functions.fetchImagesGeneric"):n("functions.fetchImagesCount",{count:t})},[null==i||null==(e=i.dumps)?void 0:e.length,s,n]);return a?(0,r.jsxs)(u.A,{direction:"column",gap:2,children:[(0,r.jsx)(l.A,{variant:"contained",fullWidth:!0,children:s.map(function(e){var t;return(0,r.jsx)(c.A,{disabled:m||[_.n.FETCHIMAGES,_.n.CLEARPRINTER,_.n.TEAR].includes(e)&&!(null==i||null==(t=i.dumps)?void 0:t.length),onClick:function(){return d(e)},children:e===_.n.FETCHIMAGES?p:n(S[e])},e)})}),(null==i?void 0:i.message)?(0,r.jsx)(g.A,{severity:"info",children:null==i?void 0:i.message}):null,(null==i?void 0:i.fs)&&(null==i?void 0:i.dumps)?(0,r.jsx)(E.A,{component:I.A,children:(0,r.jsxs)(C.A,{sx:{minWidth:650},size:"small","aria-label":"a dense table",children:[(0,r.jsx)(b.A,{children:(0,r.jsxs)(P.A,{children:[(0,r.jsx)(j.A,{align:"right",children:n("printerFilesystem")}),(0,r.jsx)(j.A,{align:"left"})]})}),(0,r.jsxs)(R.A,{children:[(0,r.jsxs)(P.A,{children:[(0,r.jsx)(j.A,{align:"right",children:n("total")}),(0,r.jsx)(j.A,{align:"left",children:w()(null==i?void 0:i.fs.total)})]}),(0,r.jsxs)(P.A,{children:[(0,r.jsx)(j.A,{align:"right",children:n("used")}),(0,r.jsx)(j.A,{align:"left",children:w()(null==i?void 0:i.fs.used)})]}),(0,r.jsxs)(P.A,{children:[(0,r.jsx)(j.A,{align:"right",children:n("free")}),(0,r.jsx)(j.A,{align:"left",children:n("freeImages",{count:Math.max(0,((null==i?void 0:i.fs.maximages)||0)-((null==i?void 0:i.dumps.length)||0))})})]}),(0,r.jsxs)(P.A,{children:[(0,r.jsx)(j.A,{align:"right",children:n("images")}),(0,r.jsx)(j.A,{align:"left",children:null==i?void 0:i.dumps.length})]})]})]})}):null]}):null};var k=t(46544),y=t(61975),O=t(71450),H=t(81863),U=t(15015),B=t(34476),G=t(7766),L=t(83231),D=t(93657),W=t(60139),Y=function(){var e=(0,B.Z)().connectedDevices,n=(0,h.Ml)(),t=n.setProgress,r=n.startProgress,i=n.stopProgress,o=(0,G.A)().sendEvent,a=(0,h.I0)().setError,c=(0,L.W)().jsonImport,l=(0,f.useMemo)(function(){return(0,W.A)(c)},[c]),u=(0,s._)((0,f.useState)(!1),2),d=u[0],m=u[1],p=(0,s._)((0,f.useState)(!1),2),v=p[0],A=p[1],x=(0,f.useMemo)(function(){var n=e.find(function(e){return e.portDeviceType===U._Y.GBXCART});return n?n.device:null},[e]),g=!!x;return(0,f.useEffect)(function(){x&&(A(!0),x.readROMName().then(function(e){m("PHOTO"===e.trim()),A(!1)}))},[x]),(0,f.useEffect)(function(){(0,y._)(function(){return(0,O.YH)(this,function(e){switch(e.label){case 0:if(!x)return[2];return[4,x.setup((0,H.BX)({setProgress:t,startProgress:function(e){return(0,y._)(function(){return(0,O.YH)(this,function(n){return[2,r(e)]})})()},stopProgress:i}))];case 1:return e.sent(),[2]}})})()},[x,t,r,i]),{gbxCartAvailable:g,canReadPhotoRom:d,readRAMImage:(0,f.useCallback)(function(){return(0,y._)(function(){var e,n,t,r;return(0,O.YH)(this,function(i){switch(i.label){case 0:if(!x)return[2];return A(!0),[4,x.readROMName()];case 1:switch(m("PHOTO"===(e=i.sent()).trim()),e){case"GAMEBOYCAMERA":case"GAMEBOYCAMERA G":n="int";break;case"POCKETCAMERA":n="jp";break;case"POCKETCAMERA_SN":n="hk";break;case"PHOTO":n="photo";break;case"PXLR":case"PXLR_SLSC":n="pxlr"}return[4,x.readRAMImage()];case 2:return t=i.sent(),A(!1),[4,l([new File(t,"".concat(e.trim()||"dump",".sav"),{type:"application/octet-stream"})],{fromPrinter:!1,savFrameSet:n})];case 3:return r=i.sent(),o("importQueue",(0,D.c)(r,"gbxCart")),[2]}})})()},[x,l,o]),readPhotoRom:(0,f.useCallback)(function(){return(0,y._)(function(){var e,n;return(0,O.YH)(this,function(t){switch(t.label){case 0:if(!x)return[2];return A(!0),[4,x.readROMName()];case 1:if(m("PHOTO"===(e=t.sent()).trim()),"PHOTO"!==e)return a(Error("ROM is not PHOTO!")),[2];return[4,x.readPhotoAlbums()];case 2:return n=t.sent(),A(!1),l([new File(n,"".concat(e.trim()||"dump",".sav"),{type:"application/octet-stream"})],{fromPrinter:!1}),[2]}})})()},[x,l,a]),readRomName:(0,f.useCallback)(function(){return(0,y._)(function(){return(0,O.YH)(this,function(e){switch(e.label){case 0:if(!x)return[2];return[4,x.readROMName()];case 1:return console.log("ROM name",e.sent()),[2]}})})()},[x]),busy:v}},X=t(28425);let K=function(){var e=(0,s._)((0,f.useState)(""),2),n=e[0],i=e[1],m=(0,o.c)("Import"),p=(0,X.l)(),h=p.importPlainText,v=p.importFiles,A=p.printerUrl,g=p.exportJson,I=Y(),C=I.gbxCartAvailable,R=I.readRAMImage,j=I.readPhotoRom,E=I.canReadPhotoRom,b=I.busy;return(0,f.useEffect)(function(){t.e(7963).then(t.bind(t,52467)).then(function(e){i(e.default.join("\n"))})},[]),(0,r.jsxs)(u.A,{direction:"column",gap:6,children:[A&&(0,r.jsx)(N,{}),A&&(0,r.jsx)(x,{}),(0,r.jsxs)(l.A,{variant:"contained",fullWidth:!0,children:[(0,r.jsxs)(c.A,{component:"label",variant:"contained",title:m("selectFiles"),children:[m("selectFiles"),(0,r.jsx)("input",{type:"file",tabIndex:-1,hidden:!0,multiple:!0,onChange:function(e){var n=e.target,t=n.files;t&&t.length&&v((0,a._)(t)),n.value=""}})]}),C&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{onClick:R,title:m("importMemory"),disabled:b,children:m("importMemory")}),(0,r.jsx)(c.A,{onClick:j,disabled:!E||b,title:m("importAlbumRolls"),children:m("importAlbumRolls")})]})]}),(0,r.jsxs)(u.A,{flexDirection:"column",gap:1,justifyContent:"flex-end",justifyItems:"end",children:[(0,r.jsx)(d.A,{id:"import-plaintext",label:m("serialMonitorLabel"),multiline:!0,rows:20,value:n,onChange:function(e){i(e.target.value)}}),(0,r.jsx)(u.A,{direction:"row",justifyContent:"flex-end",children:(0,r.jsx)(c.A,{variant:"contained",onClick:function(){h(n)},children:m("import")})})]}),(0,r.jsxs)(l.A,{variant:"contained",fullWidth:!0,children:[(0,r.jsx)(c.A,{onClick:function(){return g(k.m.IMAGES)},title:m("exportImages"),children:m("exportImages")}),(0,r.jsx)(c.A,{onClick:function(){return g(k.m.SELECTED_IMAGES)},title:m("exportSelectedImages"),children:m("exportSelectedImages")})]})]})};function J(){var e=(0,o.c)("Navigation");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{component:"h1",variant:"h1",children:e("import")}),(0,r.jsx)(K,{})]})}},98447:(e,n,t)=>{"use strict";t.d(n,{A:()=>A});var r=t(82732),i=t(45849),o=t(17389),s=t(12115),a=t(2821),c=t(37659),l=t(49714),u=t(57179),d=t(13053),f=t(81421);function m(e){return(0,f.Ay)("MuiTableContainer",e)}(0,d.A)("MuiTableContainer",["root"]);var p=t(95155),h=function(e){var n=e.classes;return(0,c.A)({root:["root"]},m,n)},v=(0,l.Ay)("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"});let A=s.forwardRef(function(e,n){var t=(0,u.b)({props:e,name:"MuiTableContainer"}),s=t.className,c=t.component,l=void 0===c?"div":c,d=(0,o._)(t,["className","component"]),f=(0,i._)((0,r._)({},t),{component:l}),m=h(f);return(0,p.jsx)(v,(0,r._)({ref:n,as:l,className:(0,a.A)(m.root,s),ownerState:f},d))})},99513:(e,n,t)=>{Promise.resolve().then(t.bind(t,80738))}},e=>{e.O(0,[9832,8955,5266,1081,3632,317,1346,7115,4688,4647,3683,3802,7164,2968,4615,7922,1156,8248,22,3231,771,8441,9342,1255,7358],()=>e(e.s=99513)),_N_E=e.O()}]);