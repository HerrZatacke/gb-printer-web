(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6147,7133],{1108:(e,t,F)=>{"use strict";F.d(t,{A:()=>a});var n=F(19357),r=function(e){e.fillStyle="#000",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.filter="grayscale(1)",e.imageSmoothingEnabled=!1};let a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(F,a){var i=document.createElement("img"),o=document.createElement("canvas");o.width=160;var l=o.getContext("2d");if(!l)return void a(Error("No canvas context"));i.onerror=a,i.onload=function(){var n,a=i.naturalWidth,s=i.naturalHeight;.875==s/a?(o.height=144,n=i.naturalWidth/128,t||r(l),l.drawImage(i,0,0,a,s,16,16,o.width-32,o.height-32)):(o.height=o.width*s/a,n=a/160,t||r(l),l.drawImage(i,0,0,a,s,0,0,o.width,o.height)),F({imageData:l.getImageData(0,0,o.width,o.height),scaleFactor:n,width:o.width,height:o.height,fileName:e.name,lastModified:e.lastModified||null})},(0,n.A)(e,n.Z.DATA_URL).then(function(e){i.src=e})})}},3027:(e,t,F)=>{"use strict";F.r(t),F.d(t,{default:()=>nG});var n,r=F(82732),a=F(45849),i=F(22043),o=F(95155);F(85922),F(68111),F(18097);var l=F(32703),s=F(89869),c=F(41942),u=F(97533),d=F(33868),m=F(12115),h=F(50751),f=F(29999),p=F(39620),g=F(4615),v=F(92880),x=F(24288),A=F(80317),b=F(63528);let j=function(e){var t=e.dismiss,F=e.errorMessage,n=(0,i._)((0,m.useState)(!1),2),r=n[0],a=n[1];return(0,o.jsxs)(g.A,{severity:"error",variant:"filled",sx:{minWidth:300},action:(0,o.jsxs)(o.Fragment,{children:[F.error.stack&&!r&&(0,o.jsx)(x.A,{size:"small",title:"Show error stack","aria-label":"close",color:"inherit",onClick:function(){return a(!0)},children:(0,o.jsx)(p.A,{fontSize:"small"})}),(0,o.jsx)(x.A,{size:"small","aria-label":"close",color:"inherit",onClick:function(e,F){"clickaway"!==F&&t()},children:(0,o.jsx)(f.A,{fontSize:"small"})})]}),children:[(0,o.jsx)(v.A,{sx:{color:"inherit",whiteSpace:"pre"},children:F.error.message}),r&&(0,o.jsx)(A.A,{variant:"caption",fontFamily:"monospace",component:"pre",sx:function(e){return(0,b.E)(e,{backgroundColor:"#FFFFFF22",maxHeight:"200px",overflow:"auto",p:1})},children:F.error.stack})]})},y=function(){var e=(0,h.A)(),t=e.errors,F=e.dismissError;return(0,o.jsx)(c.A,{direction:"column",gap:4,sx:function(e){return{position:"fixed",top:e.spacing(10),right:e.spacing(2),zIndex:30}},children:t.map(function(e,t){return(0,o.jsx)(j,{dismiss:function(){return F(t)},errorMessage:e},e.id)})})};var C=F(40726),I=F(6170),E=F(96024),w=F(61974),S=F(15102),_=F(37941),D=F(53097),k=F(8492),T=F(74246),B=F(64647),M=F(32968),P=F(84389),N=F(92455),R=F(29518),O=F(39970),L=F(1269),G=F(19131),H=F(52531),U=F(52619),z=F.n(U),V=F(18955),W=F(18282),X=F(89386),Y=F(34476),Q=F(15431),K=F(28802);let Z=function(){var e=(0,K.A)(),t=e.gitStorage,F=e.dropboxStorage,n=F.autoDropboxSync||!1,r=!!(F.use||t.use&&t.owner&&t.repo&&t.branch&&t.throttle&&t.token),a=(0,h.A)(),i=a.syncBusy,o=a.setSyncSelect,l=a.setShowSerials,s=(0,Q.A)().useSerials,c=(0,K.A)().syncLastUpdate,u=(0,Y.Z)(),d=u.webUSBEnabled,m=u.webSerialEnabled,f=u.hasInactiveDevices,p=u.unknownDeviceResponse;return{disableSerials:!d&&!m,serialWarning:!!(f&&p),portCount:u.connectedDevices.length,syncBusy:i,useSync:r,useSerials:s,syncLastUpdate:c,autoDropboxSync:n,selectSync:function(){return o(!0)},setShowSerials:function(){return l(!0)}}};var q=F(25969),J=F(65595),$=F(45377),ee=F(53776),et=F(87922),eF=function(e){var t;return{styleOverrides:{root:(t={},(0,et._)(t,e.breakpoints.up("xs"),{minHeight:"var(--navigation-height)"}),(0,et._)(t,"justifyContent","end"),(0,et._)(t,"& .MuiButton-root",{height:"var(--navigation-height)",padding:"0 20px",fontSize:e.typography.body1.fontSize}),(0,et._)(t,"& .MuiButtonGroup-horizontal",{paddingRight:"8px"}),(0,et._)(t,"& .MuiSvgIcon-root",{fontSize:"1.8rem"}),t)}}},en=function(e){return{MuiAppBar:{variants:(0,$._)(["primary","secondary"].map(function(t){return{props:{color:t},style:{"--AppBar-background":e.palette[t].dark,"--AppBar-color":e.palette[t].contrastText,"& .MuiButton-root.active":{backgroundColor:e.palette["primary"===t?"secondary":"primary"].main},"& .MuiButton-root:hover":{backgroundColor:e.palette[t].light,color:e.palette[t].contrastText},"& .MuiIconButton-root:hover":{backgroundColor:e.palette[t].light,color:e.palette[t].contrastText}}}}))},MuiButton:{styleOverrides:{root:{fontSize:"13px",textTransform:"none",minHeight:"40px"}},variants:(0,$._)(["primary","secondary","tertiary"].map(function(t){return{props:{color:t},style:{"&.MuiButton-outlined":{color:e.palette[t].light,borderColor:e.palette[t].light,"&:hover":{backgroundColor:(0,D.X4)(e.palette[t].main,.25)},"&.Mui-disabled":{backgroundColor:(0,D.X4)(e.palette.fgtext.main,.33),color:e.palette.fgtext.main,borderColor:e.palette.fgtext.main,opacity:.4}}}}}))},MuiCardActionArea:{styleOverrides:{root:{height:"100%",".MuiCardActionArea-focusHighlight":{background:"transparent"}}}},MuiCardContent:{styleOverrides:{root:{padding:"24px 16px"}}},MuiDialogTitle:{styleOverrides:{root:{backgroundColor:e.palette.primary[e.palette.mode],color:e.palette.primary.contrastText,"&& + .MuiDialogContent-root":{padding:e.spacing(2)}}}},MuiFormControl:{styleOverrides:{root:{paddingTop:16,".MuiStack-root &:first-of-type":{marginTop:12}}}},MuiInputLabel:{styleOverrides:{root:{transform:"translate(14px, 25px) scale(1)","&.MuiInputLabel-shrink":{transform:"translate(2px, -12px) scale(1)"}}}},MuiLink:{styleOverrides:{root:{color:"inherit"}}},MuiList:{styleOverrides:{root:{".MuiListSubheader-root":{display:"flex",".MuiListItemIcon-root":{minWidth:32,flexDirection:"column",justifyContent:"center"}}}}},MuiMenuItem:{styleOverrides:{root:{"&.Mui-selected":{backgroundColor:(0,D.X4)(e.palette.secondary.main,.8),color:e.palette.secondary.contrastText,"&:hover,&.Mui-focusVisible":{backgroundColor:e.palette.secondary.main}}}}},MuiOutlinedInput:{styleOverrides:{root:{background:"dark"===e.palette.mode?"#000000":"#ffffff",color:"dark"===e.palette.mode?"#ffffff":"#000000",".MuiInputBase-inputMultiline":{fontSize:"13px",lineHeight:"16px",fontFamily:"monospace"},".MuiOutlinedInput-notchedOutline legend span":{display:"none"}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none"}}},MuiSelect:{styleOverrides:{select:{display:"flex",".MuiListItemIcon-root":{minWidth:32,flexDirection:"column",justifyContent:"center"}}},defaultProps:{displayEmpty:!0}},MuiSwitch:{defaultProps:{color:"tertiary"}},MuiTab:{styleOverrides:{root:{fontSize:16,textTransform:"none",minHeight:60,"&.Mui-selected":{backgroundColor:(0,D.X4)(e.palette.primary.main,.2),color:"inherit"},"&:hover":{backgroundColor:(0,D.X4)(e.palette.secondary.main,.35)}}}},MuiTabs:{styleOverrides:{root:{"&~.MuiTabPanel-root":{padding:0,marginTop:e.spacing(2)},"& .MuiTabScrollButton-root.Mui-disabled":{opacity:.25}}},defaultProps:{scrollButtons:"auto",indicatorColor:"secondary",variant:"scrollable"}},MuiTextField:{defaultProps:{color:"tertiary",slotProps:ee.y}},MuiToggleButtonGroup:{styleOverrides:{grouped:{variants:(0,$._)(["primary","secondary","tertiary"].map(function(t){return{props:{color:t},style:{"&.Mui-selected":{background:e.palette[t].main,color:e.palette[t].contrastText,"&:hover":{backgroundColor:(0,D.X4)(e.palette[t].main,.7)}},"&:hover":{backgroundColor:(0,D.X4)(e.palette[t].main,.4)}}}}))}},defaultProps:{color:"tertiary"}},MuiToolbar:eF(e)}},er=function(e){var t=e.mode,F=e.colorPrimary,n=e.colorSecondary,r=e.colorTertiary,a=e.colorSuccess,i=e.colorWarn,o=e.colorError,l=e.colorPageBackground,s=e.colorText,c=(0,J.A)({shape:{borderRadius:0},breakpoints:{values:{xs:0,sm:570,md:768,lg:1024,xl:1264}},typography:{fontFamily:'"Trebuchet MS", Helvetica, sans-serif',body1:{fontSize:16},body2:{fontSize:13},h1:{fontSize:30,fontWeight:"bold"},h2:{fontSize:24,fontWeight:"bold"},h3:{fontSize:20,fontWeight:"bold"},h4:{fontSize:18,fontWeight:"bold"}},palette:{mode:t,primary:{main:F},secondary:{main:n},success:{main:a},warning:{main:i},error:{main:o},background:{default:l,paper:(0,D.a)(l,"light"===t?.6:.02)}}}),u=(0,J.A)(c,{palette:{tertiary:c.palette.augmentColor({color:{main:r},name:"tertiary"}),fgtext:c.palette.augmentColor({color:{main:s},name:"fgtext"}),bg:c.palette.augmentColor({color:{main:l},name:"bg"}),text:{primary:s,secondary:s}}}),d=(0,D.au)(u.palette.primary.main,s,.7);return(0,J.A)(u,{typography:{fontFamily:'"Trebuchet MS", Helvetica, sans-serif',body1:{color:s},body2:{color:s},h1:{color:d},h2:{color:d},h3:{color:d},h4:{color:d}},components:en(u)})},ea={colorInfo:"#3f769e",colorSuccess:"#3f9e7c",colorWarn:"#8b7b2c",colorError:"#cb0003",colorPrimary:"#503281",colorSecondary:"#455c63",colorTertiary:"#4a6959"},ei=er((0,r._)({mode:"dark",colorPageBackground:"#2a292b",colorText:"#b2b2b2"},ea)),eo=er((0,r._)({mode:"light",colorPageBackground:"#d6d3dc",colorText:"#333333"},ea)),el=F(81200),es=function(e){return e.ERROR="error",e.INFO="info",e.DEFAULT="default",e}(es||{});let ec=function(){var e=(0,V.c3)("Navigation"),t=(0,i._)((0,m.useState)(!1),2),F=t[0],n=t[1],r=(0,i._)((0,m.useState)(void 0),2),a=r[0],s=r[1],c=(0,q.j)().fullPath,d=(0,Q.A)(),p=d.themeName,g=d.setThemeName,v=(0,h.A)(),A=v.showTrashCount,b=v.trashCount,j=v.trashBusy,y=(0,X.Z)(),U=y.lastGalleryLink,K=y.getUrl,J=(0,i._)((0,m.useState)(K({pageIndex:0,group:""})),2),$=J[0],ee=J[1];(0,m.useEffect)(function(){ee(U&&c!==U?U:K({pageIndex:0,group:""}))},[c,K,U]),(0,m.useEffect)(function(){s(document.body)},[]);var et=Z(),eF=et.disableSerials,en=et.serialWarning,er=et.portCount,ea=et.syncBusy,ei=et.useSync,es=et.useSerials,ec=et.syncLastUpdate,eu=et.autoDropboxSync,ed=et.selectSync,em=et.setShowSerials,eh=(0,Y.Z)().isReceiving,ef=(0,m.useMemo)(function(){return b.frames+b.images},[b]),ep=(0,m.useMemo)(function(){return eu&&ec.local!==ec.dropbox},[eu,ec]),eg=(0,m.useMemo)(function(){return[{label:e("home"),route:"/",prefetch:!1},{label:e("gallery"),route:$,prefetch:!0},{label:e("import"),route:"/import",prefetch:!1},{label:e("palettes"),route:"/palettes",prefetch:!0},{label:e("frames"),route:"/frames",prefetch:!0},{label:e("settings"),route:"/settings/generic",prefetch:!1}].reduce(el.N,[])},[$,e]),ev=(0,m.useMemo)(function(){return[{title:e("trash"),icon:(0,o.jsx)(I.A,{}),badgeContent:ef>0?ef.toString(10):null,badgeColor:"error",disabled:j,isBusy:j,onClick:function(){return A(!0)}},ei?{title:e("syncRemote"),icon:(0,o.jsx)(S.A,{}),badgeContent:ep?"!":null,badgeColor:"error",disabled:ea,isBusy:!1,onClick:ed}:null,{title:p===W.V.BRIGHT?e("switchToDark"):e("switchToBright"),icon:p===W.V.BRIGHT?(0,o.jsx)(E.A,{}):(0,o.jsx)(C.A,{}),badgeContent:null,badgeColor:"default",disabled:!1,isBusy:!1,onClick:function(){return g(p===W.V.BRIGHT?W.V.DARK:W.V.BRIGHT)}},es?{title:eF?e("usbDisabled"):e("usbDevices"),icon:(0,o.jsx)(_.A,{}),badgeContent:en&&"!"||er&&er.toString(10)||null,badgeColor:en?"error":"info",disabled:eF,isBusy:eh,onClick:em}:null].reduce(el.N,[])},[eF,er,ed,en,em,g,A,j,ea,ep,e,p,ef,es,ei,eh]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.A,{theme:eo,children:(0,o.jsx)(k.A,{color:"primary",enableColorOnDark:!0,position:"sticky",children:(0,o.jsx)(l.A,{maxWidth:"xl",disableGutters:!0,children:(0,o.jsxs)(H.A,{disableGutters:!0,children:[(0,o.jsx)(M.A,{variant:"text",component:"nav",role:"navigation","aria-label":e("mainNavAriaLabel"),sx:{display:{xs:"none",md:"inline-flex"},width:"100%"},children:eg.map(function(e){var t=e.route,F=e.label,r=e.prefetch;return(0,o.jsx)(B.A,{href:t,prefetch:r,component:z(),color:"inherit",onClick:function(){return n(!1)},children:F},t)})}),(0,o.jsxs)(M.A,{variant:"text",role:"navigation","aria-label":e("utilityNavAriaLabel"),children:[ev.map(function(e){var t=e.title,F=e.icon,n=e.onClick,r=e.badgeContent,a=e.badgeColor,i=e.isBusy,l=e.disabled;return(0,o.jsx)(x.A,{color:"inherit",disabled:l,title:t,onClick:n,sx:i?{animation:"pulse-bg 600ms infinite"}:void 0,children:(0,o.jsx)(T.A,{badgeContent:r,color:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:F})},t)}),(0,o.jsx)(x.A,{color:"inherit",title:e("openMainNav"),onClick:function(){return n(!0)},sx:{display:{md:"none"}},children:(0,o.jsx)(w.A,{})})]})]})})})}),(0,o.jsxs)(N.Ay,{container:a,variant:"temporary",open:F,onClose:function(){return n(!1)},ModalProps:{keepMounted:!0},sx:function(e){return{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{width:{xs:"100%",sm:e.breakpoints.values.sm}}}},children:[(0,o.jsx)(H.A,{disableGutters:!0,children:(0,o.jsx)(M.A,{variant:"text",sx:{display:{md:"none"}},children:(0,o.jsx)(x.A,{color:"inherit",title:e("closeMainNav"),onClick:function(){return n(!1)},children:(0,o.jsx)(f.A,{})})})}),(0,o.jsx)(P.A,{}),(0,o.jsx)(R.A,{children:eg.map(function(e){var t=e.route,F=e.label;return(0,o.jsx)(O.Ay,{disablePadding:!0,children:(0,o.jsx)(L.A,{href:t,component:z(),onClick:function(){return n(!1)},sx:function(e){return{"&.active":{background:e.palette.secondary.light,color:e.palette.secondary.contrastText},"&:hover":{background:(0,D.X4)(e.palette.primary.main,.3)}}},children:(0,o.jsx)(G.A,{primary:F})})},t)})})]})]})},eu=function(){return(0,o.jsx)(u.A,{theme:eo,children:(0,o.jsx)(k.A,{color:"primary",enableColorOnDark:!0,position:"sticky",children:(0,o.jsx)(l.A,{maxWidth:"xl",disableGutters:!0,children:(0,o.jsx)(H.A,{disableGutters:!0})})})})};var ed=F(7291),em=F(23405),eh=F(49571),ef=F(13802),ep=F(66965),eg=F(90148);let ev=function(e){return Math.floor(e)===e&&!!(e&&!(e&e-1))},ex=function(e){var t=e.imageData,F=e.scaleFactor,n=e.width,r=e.height,a=e.fileName,i=e.palette,l=e.dither,s=e.contrastBaseValues,u=(0,m.useRef)(null),d=(0,m.useRef)(null),h=(0,V.c3)("ImportPreviewImage");return(0,m.useEffect)(function(){u.current&&d.current&&(null==s?void 0:s.length)&&(0,eg.q)({targetCanvas:u.current,originalCanvas:d.current,imageData:t,palette:i,dither:l,contrastBaseValues:s})}),(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsxs)(c.A,{title:"".concat(a," - ").concat(F,"x"),direction:"row",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,o.jsx)("canvas",{width:n,height:r,ref:d}),(0,o.jsx)(ep.A,{fontSize:"large"}),(0,o.jsx)("canvas",{width:n,height:r,ref:u})]}),ev(F)?null:(0,o.jsx)(g.A,{severity:"warning",variant:"filled",children:h("scaleFactorWarning",{scaleFactor:F.toPrecision(3)})})]})};var eA=F(34731),eb=F(92564),ej=F(39852),ey=F(80904);let eC=function(){var e=(0,V.c3)("BitmapQueue"),t=(0,ej.A)(),F=t.bitmapQueue,n=t.bitmapQueueCancel,r=t.importQueueAdd,a=(0,Q.A)(),i=a.bitmapQueueDither,l=a.bitmapQueueSetting,s=a.setBitmapQueueDither,u=a.setBitmapQueueSetting,d=(0,m.useMemo)(function(){return(eb.C.find(function(e){return e.value===l})||eb.C[0]).baseValues},[l]);return(0,o.jsx)(eA.A,{header:e("dialogHeader"),confirm:function(){(0,ey._)({bitmapQueue:F,dither:i,contrastBaseValues:d,importQueueAdd:r})},deny:n,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[F.map(function(e,t){return(0,o.jsx)(ex,{imageData:e.imageData,scaleFactor:e.scaleFactor,width:e.width,height:e.height,fileName:e.fileName,dither:i,contrastBaseValues:d,palette:["#ffffff","#aaaaaa","#555555","#000000"]},t)}),(0,o.jsx)(ed.A,{label:e("enableDither"),control:(0,o.jsx)(eh.A,{checked:i,onChange:function(e){s(e.target.checked)}})}),(0,o.jsx)(ef.A,{value:l,label:e("contrastPreset"),select:!0,size:"small",onChange:function(e){u(e.target.value)},children:eb.C.map(function(t){var F=t.value,n=t.translationKey;return(0,o.jsx)(em.A,{value:F,children:e(n)},F)})})]})})};var eI=F(41574),eE=F(56120),ew=F(6388),eS=F(31512),e_=F(98447),eD=F(54463);let ek=function(e){var t=e.hash,F=e.hashes,n=e.meta,i=(0,V.c3)("MetaTable"),l=(0,a._)((0,r._)({},n),{hash:t}),s=Object.keys(l).reduce(function(e,t){var F="number"!=typeof l[t]&&"string"!=typeof l[t]?JSON.stringify(l[t]):l[t];return(0,$._)(e).concat([{key:t,value:F}])},[]);if(F){var c=Object.keys(F).reduce(function(e,t){var n={key:i("hashChannel",{channel:t}),value:F[t]};return(0,$._)(e).concat([n])},[]);s.push.apply(s,(0,$._)(c))}return(0,o.jsx)(e_.A,{children:(0,o.jsx)(eE.A,{padding:"none",sx:{fontFamily:"monospace"},children:(0,o.jsx)(ew.A,{children:s.map(function(e){var t=e.key,F=e.value;return(0,o.jsxs)(eD.A,{children:[(0,o.jsx)(eS.A,{component:"th",scope:"row",children:t}),(0,o.jsx)(eS.A,{align:"right",children:F})]},t)})})})})};var eT=F(11081),eB=F(34093);let eM=function(){var e=(0,eB.A)().dialogs[0],t=e.questions,F=(0,i._)((0,m.useState)(t?t({}).reduce(function(e,t){var F,n,i,o=t.key;switch(t.type){case eT.V.SELECT:F=(null==(i=(0,r._)({},t).options)||null==(n=i.find(function(e){return e.selected}))?void 0:n.value)||"";break;case eT.V.CHECKBOX:F=!1;break;case eT.V.TEXT:F=t.initialValue||"";break;case eT.V.NUMBER:F=0;break;case eT.V.INFO:default:return e}return(0,a._)((0,r._)({},e),(0,et._)({},o,F))},{}):{}),2),n=F[0],o=F[1];return{message:e.message,confirm:function(){return e.confirm(n)},deny:e.deny,questions:t?t(n):[],values:n,setSelected:function(e){o((0,r._)({},n,e))}}},eP=function(){var e=eM(),t=e.message,F=e.questions,n=e.values,r=e.setSelected,a=e.confirm,i=e.deny;return(0,o.jsx)(eA.A,{confirm:a,deny:i,header:t,headerOnly:!F.length,children:(0,o.jsx)(c.A,{direction:"column",gap:2,children:F.map(function(e){switch(e.type){case eT.V.SELECT:var t=e.label,F=e.key,a=e.options,i=e.disabled;return(0,o.jsx)(ef.A,{select:!0,disabled:void 0!==i&&i,size:"small",value:n[F]||"",label:t,onChange:function(e){return r((0,et._)({},F,e.target.value))},children:a.map(function(e){var t=e.value,F=e.name;return(0,o.jsx)(em.A,{value:t,children:F},t)})},F);case eT.V.TEXT:var l=e.label,s=e.key,c=e.disabled;return(0,o.jsx)(ef.A,{disabled:void 0!==c&&c,size:"small",value:n[s]||"",label:l,onChange:function(e){return r((0,et._)({},s,e.target.value))}},s);case eT.V.NUMBER:var u=e.label,d=e.key,m=e.min,h=e.max,f=e.disabled;return(0,o.jsx)(ef.A,{disabled:void 0!==f&&f,size:"small",value:n[d]||"",type:"number",label:u,slotProps:{htmlInput:{min:m,max:h}},onChange:function(e){return r((0,et._)({},d,e.target.value))}},d);case eT.V.CHECKBOX:var p=e.label,v=e.key,x=e.disabled;return(0,o.jsx)(ed.A,{disabled:void 0!==x&&x,label:p,control:(0,o.jsx)(eh.A,{checked:n[v],onChange:function(e){var t=e.target;r((0,et._)({},v,t.checked))}})},v);case eT.V.INFO:var b=e.label,j=e.key,y=e.severity;return y?(0,o.jsx)(g.A,{severity:y,variant:"filled",children:b},j):(0,o.jsx)(A.A,{children:b},j);case eT.V.IMAGE:var C=e.label,I=e.key,E=e.src;return(0,o.jsx)(eI.A,{component:"img",src:E,alt:C,title:C,sx:{imageRendering:"pixelated"}},I);case eT.V.META:var w=e.key,S=e.meta;return(0,o.jsx)(ek,{hash:S.hash,meta:null==S?void 0:S.meta,hashes:null==S?void 0:S.hashes},w);default:return null}})})})};var eN=F(21014),eR=F(5800);let eO=function(){var e=(0,V.c3)("DownloadOptions"),t=(0,h.A)(),F=t.downloadHashes,n=t.setDownloadHashes,r=(0,eR.A)().downloadImages;return(0,o.jsx)(eA.A,{header:e("dialogHeader",{count:F.length}),confirm:function(){r(F),n([])},deny:function(){return n([])},children:(0,o.jsx)(c.A,{direction:"column",gap:4,children:(0,o.jsx)(eN.A,{inDialog:!0})})})};var eL=F(98631),eG=F(75970),eH=F(25789);let eU=function(){var e=(0,eH.A)(),t=(0,V.c3)("DragOver");return(0,o.jsx)(c.A,{justifyContent:"center",alignItems:"center",sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:30,background:(0,D.X4)(e.palette.background.paper,.6),backdropFilter:"blur(6px)"},children:(0,o.jsx)(eG.A,{elevation:12,sx:{px:{xs:6,md:10},py:{xs:4,md:9}},children:(0,o.jsxs)(c.A,{direction:"column",gap:4,alignItems:"center",color:e.palette.tertiary.main,children:[(0,o.jsx)(eL.A,{sx:{fontSize:64}}),(0,o.jsx)(A.A,{variant:"h5",fontWeight:"bold",children:t("dropFilesHere")}),(0,o.jsx)(A.A,{variant:"body2",sx:{maxWidth:"70vw"},textAlign:"center",children:t("supportedFileTypes")})]})})})};var ez=F(89041),eV=F(9877),eW=F(11731),eX=F(23503),eY=F(75416),eQ=F(62661),eK=F(45279),eZ=F(34804),eq=F(72879),eJ=F(66803);let e$=function(e){var t=e.frame,F=e.updateFrame,n=e.noFrameOption,r=e.updateFrameLock,a=e.lockFrame,i=e.selectLabel,l=(0,V.c3)("FrameSelect"),s=(0,eq.h)(),u=s.frames,d=s.frameGroups,h=(0,m.useMemo)(function(){return d.map(function(e){var t=(0,eJ.d)(u,e.id);return 0===t.length?[]:[{id:e.id,name:e.name,isGroup:!0}].concat((0,$._)(t.map(function(e){return{id:e.id,name:e.name,isGroup:!1}})))}).flat()},[d,u]);return(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsxs)(ef.A,{label:i||l("frameLabel"),select:!0,size:"small",value:t,onChange:function(e){F(e.target.value)},children:[(0,o.jsx)(em.A,{value:"",children:n||l("noFrameOption")}),h.map(function(e){var t=e.id,F=e.name;return e.isGroup?(0,o.jsxs)(eZ.A,{children:[(0,o.jsx)(eK.A,{children:(0,o.jsx)(eQ.A,{})}),(0,o.jsx)(G.A,{children:"".concat(F," (").concat(t,")")})]},t):(0,o.jsx)(em.A,{value:t,children:F},t)})]}),"function"==typeof r?(0,o.jsx)(ed.A,{label:l("separateColorSettings"),control:(0,o.jsx)(eh.A,{checked:a,onChange:function(e){r(e.target.checked)}})}):null]})};var e0=F(40277),e1=F(87805),e2=F(74577);let e3=function(e){var t=e.color,F=e.onChange,n=e.values,r=(0,m.useMemo)(function(){switch(t){case"r":return"#ff0000";case"g":return"#00dd00";case"b":return"#0000ff";default:return"#888888"}},[t]);return(0,o.jsxs)(c.A,{direction:"row",gap:2,alignItems:"center",sx:{pr:2},children:[(0,o.jsx)(x.A,{title:"Reset",onClick:function(){F([0,85,170,255])},children:(0,o.jsx)(e1.A,{})}),(0,o.jsx)(e2.Ay,{min:0,max:255,value:n,sx:{color:r},defaultValue:[0,85,170,255],onChange:function(e,t){F(t)},disableSwap:!0})]})};var e4=F(96569),e5=[{id:e4.Nx.NORMAL,translationKey:"blendModes.normal"},{id:e4.Nx.NORMAL_S,translationKey:"blendModes.normalS"},{id:e4.Nx.LIGHTEN,translationKey:"blendModes.lighten"},{id:e4.Nx.SCREEN,translationKey:"blendModes.screen"},{id:e4.Nx.DODGE,translationKey:"blendModes.dodge"},{id:e4.Nx.ADDITION,translationKey:"blendModes.addition"},{id:e4.Nx.DARKEN,translationKey:"blendModes.darken"},{id:e4.Nx.MULTIPLY,translationKey:"blendModes.multiply"},{id:e4.Nx.BURN,translationKey:"blendModes.burn"},{id:e4.Nx.OVERLAY,translationKey:"blendModes.overlay"},{id:e4.Nx.SOFTLIGHT,translationKey:"blendModes.softLight"},{id:e4.Nx.HARDLIGHT,translationKey:"blendModes.hardLight"},{id:e4.Nx.DIFFERENCE,translationKey:"blendModes.difference"},{id:e4.Nx.EXCLUSION,translationKey:"blendModes.exclusion"}];let e8=function(e){var t=(0,V.c3)("GreySelect"),F=(0,i._)((0,m.useState)(e.values),2),n=F[0],l=F[1],s=(0,e0.A)(function(t){e.onChange(t,!0)},150,{leading:!0,trailing:!0}),u=function(e,t){var F=(0,a._)((0,r._)({},n),(0,et._)({},e,t));l(F),s.callback(F)},d=["r","g","b","n"].reduce(function(t,F){return e.useChannels[F]?(0,$._)(t).concat([F]):t},[]);return(0,o.jsx)(c.A,{direction:"column",gap:3,children:d.map(function(e){return(0,o.jsxs)(c.A,{direction:"column",gap:0,children:["n"===e?(0,o.jsx)(ef.A,{value:n.blend,label:t("neutralLayerBlendmode"),select:!0,size:"small",onChange:function(e){u("blend",e.target.value)},children:e5.map(function(e){var F=e.id,n=e.translationKey;return(0,o.jsx)(em.A,{value:F,children:t(n)},F)})}):null,(0,o.jsx)(e3,{color:e,values:n[e],onChange:function(t){u(e,t)}})]},"slider-".concat(e))})})};var e7=F(61975),e6=F(71450),e9=F(62995),te=F(68060),tt=F(35497),tF=F(71583),tn=F(71101),tr=F(53298),ta=F(47317),ti=F(36117),to=F.n(ti),tl=F(71667);let ts=function(e){var t=e.children,F=(0,eH.A)(),n=(0,m.useMemo)(function(){if(!(null==(e=F.components)?void 0:e.MuiTextField))return F;var e,t,n,i=(0,r._)({},F.components.MuiTextField);return(null==(n=i.defaultProps)||null==(t=n.slotProps)?void 0:t.htmlInput)&&delete i.defaultProps.slotProps.htmlInput,(0,a._)((0,r._)({},F),{components:(0,a._)((0,r._)({},F.components),{MuiTextField:i})})},[F]);return(0,o.jsx)(u.A,{theme:n,children:t})};var tc=[e4.pL.DEG_0,e4.pL.DEG_90,e4.pL.DEG_180,e4.pL.DEG_270];let tu=function(e){var t=e.created,n=e.hash,r=e.hashes,a=e.updateCreated,l=e.meta,s=e.rotation,u=e.updateRotation,d=(0,Q.A)().preferredLocale,h=(0,V.c3)("ImageMeta"),f=(0,i._)((0,m.useState)(void 0),2),p=f[0],g=f[1];return(0,m.useEffect)(function(){(0,e7._)(function(){var e,t;return(0,e6.YH)(this,function(n){switch(n.label){case 0:e=d.toLowerCase(),n.label=1;case 1:return n.trys.push([1,3,,8]),[4,F(39234)("./".concat(e,".js"))];case 2:return n.sent(),g(e),[3,8];case 3:n.sent(),n.label=4;case 4:return n.trys.push([4,6,,7]),t=e.split("-")[0],[4,F(39234)("./".concat(t,".js"))];case 5:return n.sent(),g(t),[3,7];case 6:return n.sent(),g(void 0),[3,7];case 7:return[3,8];case 8:return[2]}})})()},[d]),(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(ts,{children:(0,o.jsx)(tn.$,{dateAdapter:ta.R,adapterLocale:p,children:(0,o.jsx)(tr.K,{label:h("dateTime"),closeOnSelect:!1,views:["year","month","day","hours","minutes","seconds"],value:to()(t),onChange:function(e){e&&a((0,tl.J)(e.toDate()))}})})}),(0,o.jsxs)(e9.A,{children:[(0,o.jsx)(te.A,{shrink:!0,children:h("editRotation")}),(0,o.jsx)(tF.A,{exclusive:!0,fullWidth:!0,value:s||e4.pL.DEG_0,onChange:function(e,t){u(t)},children:tc.map(function(e){return(0,o.jsx)(tt.A,{value:e,children:"".concat(90*e,"\xb0")},e)})})]}),(0,o.jsx)(ek,{meta:l,hash:n,hashes:r})]})};var td=F(74282);let tm=function(e){var t=e.palette,F=e.fontSize;return(0,o.jsx)(eI.A,{sx:(0,a._)((0,r._)({display:"inline-block",fontSize:F||"2rem",width:"1em",height:"1em",lineHeight:"1em",verticalAlign:"middle",borderRadius:"50%"},(0,td.O)(t,td.h.CONIC)),{"&:hover":{animation:"spin 800ms infinite linear"}})})};var th=F(62431);let tf=function(e){var t=e.value,F=e.allowEmpty,n=e.invertPalette,r=e.noFancy,a=e.onChange,l=e.updateInvertPalette,s=(0,V.c3)("PaletteSelect"),u=(0,i._)((0,m.useState)(t),2),d=u[0],h=u[1],f=(0,eq.h)().palettes,p=(0,eH.A)(),g=(0,th.A)().sortFn,v=(0,$._)(f).sort(g);return F&&v.unshift({shortName:"",name:s("asSelectedPerImage"),palette:[],isPredefined:!1,origin:""}),(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsx)(ef.A,{value:t,label:s("palette"),size:"small",select:!0,onChange:function(e){a(e.target.value,!0),h(e.target.value)},children:v.map(function(e){var t=e.shortName,F=e.name,n=e.palette;return(0,o.jsxs)(em.A,{value:t,children:[(0,o.jsx)(eK.A,{children:(0,o.jsx)(tm,{palette:n,fontSize:"1.5rem"})}),(0,o.jsx)(G.A,{children:F})]},t)})}),l?(0,o.jsx)(ed.A,{label:s("invertPalette"),control:(0,o.jsx)(eh.A,{checked:n,onChange:function(e){l(e.target.checked)}})}):null,r?null:(0,o.jsx)(eI.A,{component:"ul",sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 2.5rem)",justifyContent:"center",gap:.25,button:{padding:0,cursor:"pointer",width:"2.5rem",height:"2.5rem",border:"none",borderRadius:"50%"}},children:v.map(function(e){var t=e.shortName,F=e.name,n=e.palette;return(0,o.jsx)(eI.A,{component:"li",children:(0,o.jsx)("button",{type:"button",title:F,style:{background:t===d?p.palette.tertiary.main:"transparent"},onMouseEnter:function(){a(t,!1)},onMouseLeave:function(){a(d,!1)},onClick:function(){a(t,!0),h(t)},children:(0,o.jsx)(tm,{palette:n})})},t)})})]})};var tp=F(86596),tg=F(35057),tv=F(96999),tx=F(29053),tA=F(74193),tb=F(45073),tj=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let ty=function(e,t){var F=t.mode,n=t.tag;switch(F){case"add":return{add:(0,$._)(e.add).concat([n]),remove:(0,$._)(e.remove.filter(function(e){return e!==n}))};case"remove":return{remove:(0,$._)(e.remove).concat([n]),add:(0,$._)(e.add.filter(function(e){return e!==n}))};default:return e}};var tC=F(36336),tI=F(21695),tE=function(e){var t=new Set,F=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(F=(a=i.next()).done);F=!0){var o=a.value.tags,l=!0,s=!1,c=void 0;try{for(var u,d=o[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var m=u.value;m!==tb.X3.FILTER_FAVOURITE&&t.add(m)}}catch(e){s=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(s)throw c}}}}catch(e){n=!0,r=e}finally{try{F||null==i.return||i.return()}finally{if(n)throw r}}return Array.from(t).sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})},tw=function(){var e=(0,eq.h)().images,t=(0,i._)((0,m.useState)(tE(e)),2),F=t[0],n=t[1];return(0,m.useEffect)(function(){n(tE(e))},[e]),{availableTags:F}};let tS=function(e){var t=e.updateTags,F=e.selectedTags,n=(0,V.c3)("InputNewTag"),l=tw().availableTags.filter(function(e){return!F.includes(e)}),s=(0,i._)((0,m.useState)(""),2),c=s[0],u=s[1];return(0,o.jsx)(ts,{children:(0,o.jsx)(tI.A,{options:l,fullWidth:!0,size:"small",inputValue:c,renderInput:function(e){return(0,o.jsx)(ef.A,(0,a._)((0,r._)({},e),{label:n("tagsLabel")}))},clearOnBlur:!0,clearOnEscape:!0,freeSolo:!0,onInputChange:function(e,t,F){switch(F){case"input":u(t||"");break;case"reset":case"clear":case"blur":case"selectOption":u("")}},onChange:function(e,F,n){var r=F||"";switch(console.log("onChange",r,n),n){case"createOption":t(tj.ADD,r.trim()),u("");break;case"selectOption":t(tj.ADD,r.trim())}}})})},t_=function(e){var t=e.tags,F=e.updateTags,n=e.resetTags,r=(0,V.c3)("TagsSelect"),a=(0,tC.A)((0,$._)(t.initial).concat((0,$._)(t.add)));return(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsx)(tS,{updateTags:F,selectedTags:a}),a.length>0&&(0,o.jsxs)(c.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:[a.map(function(e){var n,r=t.add.includes(e),a=t.remove.includes(e);return n=r?"success":a?"error":"default",(0,o.jsx)(tA.A,{label:(0,o.jsxs)(c.A,{direction:"row",gap:1,alignItems:"center",children:[e===tb.X3.FILTER_FAVOURITE?"❤️":e,(0,o.jsxs)(c.A,{direction:"row",gap:0,sx:{mr:-1,".MuiButtonBase-root":{opacity:.4,borderRadius:"50%","&:hover":{opacity:1},"&:focus-visible":{opacity:1,background:"color-mix(in srgb, currentColor 20%, transparent)"}}},children:[(0,o.jsx)(tx.A,{onClick:function(){return F(tj.ADD,e)},children:(0,o.jsx)(tp.A,{})}),(0,o.jsx)(tx.A,{onClick:function(){return F(tj.REMOVE,e)},children:(0,o.jsx)(tg.A,{})})]})]}),color:n,variant:"filled"},e)}),t.add.length+t.remove.length>0&&(0,o.jsx)(x.A,{onClick:n,title:r("resetTags"),size:"small",children:(0,o.jsx)(tv.A,{})})]})]})};var tD=function(e){return e.PALETTE="pal",e.FRAME="frame",e.TAGS="tags",e.MISC="misc",e}(tD||{}),tk=function(e,t){switch(e){case"frame":return"tabTypes.frame";case"misc":return"tabTypes.misc";case"pal":return t?"tabTypes.colors":"tabTypes.palette";case"tags":return"tabTypes.tags";default:return""}};let tT=function(e){var t,F,n,r,a=(0,V.c3)("EditImageTabs"),l=(0,m.useMemo)(function(){var t=[];return e.mixedTypes||t.push("pal"),e.regularImage&&t.push("frame"),t.push("tags","misc"),t},[e.mixedTypes,e.regularImage]),s=(0,i._)((0,m.useState)(null),2),u=s[0],d=s[1];return(0,m.useEffect)(function(){d(l[0])},[l]),(0,o.jsx)(c.A,{direction:"column",spacing:1,children:(0,o.jsxs)(eV.Ay,{value:u||l[0],children:[(0,o.jsx)(eW.A,{variant:"fullWidth",indicatorColor:"secondary",allowScrollButtonsMobile:!1,children:l.map(function(t){return(0,o.jsx)(eY.A,{label:a(tk(t,!!e.paletteRGBN)),value:t,onClick:function(){return d(t)}},t)})}),(0,o.jsx)(eX.A,{value:"pal",children:e.paletteRGBN?(0,o.jsx)(e8,{values:e.paletteRGBN,onChange:e.updatePalette,useChannels:{r:!!(null==(t=e.hashes)?void 0:t.r),g:!!(null==(F=e.hashes)?void 0:F.g),b:!!(null==(n=e.hashes)?void 0:n.b),n:!!(null==(r=e.hashes)?void 0:r.n)}}):(0,o.jsx)(tf,{value:e.paletteShort||"",invertPalette:e.invertPalette,onChange:e.updatePalette,updateInvertPalette:e.updateInvertPalette})}),(0,o.jsxs)(eX.A,{value:"frame",children:[(0,o.jsx)(e$,{updateFrame:e.updateFrame,updateFrameLock:e.updateFrameLock,frame:e.frame||"",lockFrame:e.lockFrame}),e.lockFrame&&!e.paletteRGBN?(0,o.jsx)(tf,{value:e.framePaletteShort||"",invertPalette:e.invertFramePalette,onChange:e.updateFramePalette,updateInvertPalette:e.updateInvertFramePalette}):null]}),(0,o.jsx)(eX.A,{value:"tags",children:(0,o.jsx)(t_,{updateTags:e.updateTags,resetTags:e.resetTags,tags:e.tags})}),(0,o.jsx)(eX.A,{value:"misc",children:(0,o.jsx)(tu,{created:e.created,hash:e.hash,hashes:e.hashes,updateCreated:e.updateCreated,meta:e.meta,rotation:e.rotation,updateRotation:e.updateRotation})})]})})};var tB=F(18565),tM=F(42086),tP=F(55382),tN=F(86072),tR=F(57203);let tO=function(e){var t=e.initial,F=e.add,n=e.remove;return(0,tC.A)((0,$._)(t).concat((0,$._)(F))).filter(function(e){return!n.includes(e)})};var tL=F(17403),tG=F(85773);let tH=function(){var e=(0,tN.A)(),t=e.editImages,F=e.cancelEditImages,n=(0,tR.A)().sortBy,i=(0,eq.h)().images,o=(0,tP.g)().updateImages;return{batchUpdateImages:(0,m.useCallback)(function(e){var l=e.shouldUpdate,s=e.updates,c=e.tagChanges,u=(0,tG.PM)(n),d=(null==t?void 0:t.batch)||[];l&&(null==d?void 0:d.length)&&o(d.reduce(function(e,t){var F=i.find(function(e){return e.hash===t});return F?(0,$._)(e).concat([F]):e},[]).map(tG.YZ).sort(u).map(tG.lt).map(function(e,t){return tM.RQ.reduce(function(e,F){if(!l[F])return e;switch(F){case tM.No.TITLE:return(0,a._)((0,r._)({},e),{title:s.title.replace(/%(n+)/gi,function(e,F){return(t+1).toString(10).padStart(F.length,"0")})});case tM.No.TAGS:var n=tO((0,a._)((0,r._)({},c),{initial:e.tags}));return(0,a._)((0,r._)({},e),{tags:n});case tM.No.ROTATION:case tM.No.LOCK_FRAME:case tM.No.FRAME:case tM.No.CREATED:return(0,a._)((0,r._)({},e),(0,et._)({},F,s[F]))}if((0,tL.pl)(e))return F===tM.No.PALETTE?(0,a._)((0,r._)({},e),{palette:s.palette}):e;switch(F){case tM.No.PALETTE:case tM.Q3.FRAME_PALETTE:case tM.Q3.INVERT_FRAME_PALETTE:case tM.Q3.INVERT_PALETTE:return(0,a._)((0,r._)({},e),(0,et._)({},F,s[F]));default:return e}},e)})),F()},[F,null==t?void 0:t.batch,i,n,o])}};var tU=F(23441),tz=F(24849),tV=function(){var e=(0,V.c3)("useEditForm"),t=(0,tN.A)(),F=t.editImages,n=t.cancelEditImages,o=(0,eq.h)(),l=o.frames,s=o.images,c=tH().batchUpdateImages,u=(0,tz.p)(s,l),d=(0,tU.h)(),h=(0,m.useMemo)(function(){if(F){var e=F.batch||[],t=F.tags||[];if(e[0]){var n=s.find(function(t){return t.hash===e[0]});if(n){var r=d.width<=600?d.height:Math.min(900,d.height),a=e.reduce(function(e,t){var F=s.find(function(e){return e.hash===t});if(!F)return e;var n=(0,tL.pl)(F);return{mono:e.mono||!n,rgb:e.rgb||n}},{mono:!1,rgb:!1}),i=a.mono&&a.rgb,o=(0,tL.pl)(n)?n.palette:void 0,l=(0,tL.pl)(n)?void 0:n.palette,c=(0,tL.pl)(n)?void 0:n.framePalette;return{created:n.created,hash:n.hash,height:r,imageCount:(null==e?void 0:e.length)||0,invertPalette:n.invertPalette||!1,invertFramePalette:n.invertFramePalette||!1,lockFrame:n.lockFrame||!1,mixedTypes:i,tags:t,title:n.title,frame:n.frame,hashes:(0,tL.pl)(n)?n.hashes:void 0,meta:n.meta,paletteRGBN:o,paletteShort:l,framePaletteShort:c,rotation:n.rotation}}}}},[F,s,d]),f=(0,i._)((0,m.useState)((null==h?void 0:h.title)||""),2),p=f[0],g=f[1],v=(0,i._)((0,m.useState)((null==h?void 0:h.created)||""),2),x=v[0],A=v[1],b=(0,i._)((0,m.useState)((null==h?void 0:h.frame)||""),2),j=b[0],y=b[1],C=(0,i._)((0,m.useState)(null==h?void 0:h.lockFrame),2),I=C[0],E=C[1],w=(0,i._)((0,m.useState)(null==h?void 0:h.rotation),2),S=w[0],_=w[1],D=(0,i._)((0,m.useState)(null==h?void 0:h.invertPalette),2),k=D[0],T=D[1],B=(0,i._)((0,m.useState)(null==h?void 0:h.invertFramePalette),2),M=B[0],P=B[1],N=(0,i._)((0,m.useState)((null==h?void 0:h.paletteShort)||""),2),R=N[0],O=N[1],L=(0,i._)((0,m.useState)((null==h?void 0:h.framePaletteShort)||""),2),G=L[0],H=L[1],U=(0,i._)((0,m.useState)(null==h?void 0:h.paletteRGBN),2),z=U[0],W=U[1],X=(0,i._)((0,m.useState)(!1),2),Y=X[0],Q=X[1],K=(0,m.useMemo)(function(){return{title:p,created:x,frame:j,lockFrame:I,rotation:S,invertPalette:k,paletteShort:R,framePaletteShort:G,invertFramePalette:M,paletteRGBN:z}},[x,j,G,M,k,I,z,R,S,p]),Z=(0,m.useMemo)(function(){return{frameId:K.frame,framePaletteId:K.framePaletteShort,paletteId:K.paletteShort,invertFramePalette:K.invertFramePalette,invertPalette:K.invertPalette,lockFrame:K.lockFrame,palette:K.paletteRGBN,rotation:K.rotation}},[K]),q=null==h?void 0:h.hash;(0,m.useEffect)(function(){(0,e7._)(function(){return(0,e6.YH)(this,function(e){switch(e.label){case 0:if(!q)return[2];return[4,u(q)];case 1:return Q(360===e.sent()),[2]}})})()},[u,q]);var J=(0,i._)((0,m.useState)({initial:(null==h?void 0:h.tags)||[],add:[],remove:[]}),2),$=J[0],ee=J[1],eF=(0,i._)((0,m.useState)({created:!1,title:!1,frame:!1,lockFrame:!1,tags:!1,rotation:!1,palette:!1,invertPalette:!1,framePalette:!1,invertFramePalette:!1}),2),en=eF[0],er=eF[1];return{toEdit:h,form:K,overrides:Z,isRegularImage:Y,shouldUpdate:en,willUpdateBatch:[en.created?e("updateDate"):"",en.title?e("updateTitle"):"",en.palette?e("updatePalette"):"",en.invertPalette?e("updateInvertPalette"):"",en.frame?e("updateFrame"):"",en.lockFrame?e("updateLockFrame"):"",en.framePalette?e("updateFramePalette"):"",en.invertFramePalette?e("updateInvertFramePalette"):"",en.tags?e("updateTags"):"",en.rotation?e("updateRotation"):""].filter(Boolean),tagChanges:$,updateForm:function(e){return function(t){switch(er((0,a._)((0,r._)({},en),(0,et._)({},e,!0))),e){case"title":g(t);break;case"created":A(t);break;case"invertPalette":T(t);break;case"invertFramePalette":P(t);break;case"framePalette":H(t);break;case"frame":y(t);break;case"lockFrame":E(t);break;case"rotation":_(t)}}},updatePalette:function(e,t){e&&(t&&er((0,a._)((0,r._)({},en),{palette:!0})),"string"==typeof e?O(e):W(e))},updateFramePalette:function(e,t){t&&er((0,a._)((0,r._)({},en),{framePalette:!0})),H(e)},updateTags:function(e,t){er((0,a._)((0,r._)({},en),{tags:!0})),ee((0,r._)({},$,ty($,{mode:e,tag:t})))},resetTags:function(){er((0,a._)((0,r._)({},en),{tags:!1})),ee(function(e){return{initial:e.initial,add:[],remove:[]}})},save:function(){c({shouldUpdate:en,updates:{title:p,created:x,frame:j,lockFrame:I,rotation:S,palette:z||R,invertPalette:k||!1,framePalette:G,invertFramePalette:M||!1},tagChanges:$})},cancel:function(){return n()}}},tW=F(37965),tX=function(e){for(var t=e.parentElement;t;){var F=getComputedStyle(t),n=F.overflowY,r=F.overflowX,a=("auto"===n||"scroll"===n)&&t.scrollHeight>t.clientHeight,i=("auto"===r||"scroll"===r)&&t.scrollWidth>t.clientWidth;if(a||i)return t;t=t.parentElement}return document.scrollingElement||document.documentElement};let tY=function(){var e=(0,V.c3)("EditForm"),t=tV(),F=t.toEdit,n=t.form,r=t.overrides,a=t.isRegularImage,l=t.willUpdateBatch,s=t.tagChanges,u=t.updateForm,d=t.updatePalette,h=t.updateFramePalette,f=t.updateTags,p=t.resetTags,x=t.save,b=t.cancel,j=(0,eH.A)(),y=(0,i._)((0,m.useState)(null),2),C=y[0],I=y[1],E=(0,i._)((0,m.useState)({top:j.spacing(-2)}),2),w=E[0],S=E[1];(0,m.useEffect)(function(){if(!C)return function(){};var e,t=function(e){var t=C.getBoundingClientRect(),F=Math.min(1,Math.max(144/t.height,1-e.scrollTop/t.height)),n=Math.min(t.height-144,e.scrollTop);S({position:"sticky",zIndex:2,transition:"top ease-in-out 150ms",transform:"translateY(-16px)",top:"-".concat(Math.round(n),"px"),"& .gameboy-image":{transformOrigin:"center bottom",transition:"transform ease-in-out 150ms",transform:"scale(".concat(F.toPrecision(4),")")}})};t(C);var F=function(F){clearTimeout(e),e=setTimeout(function(){t(F.target)},50)},n=tX(C);return n.addEventListener("scroll",F),function(){clearTimeout(e),n.removeEventListener("scroll",F)}},[C]);var _=(0,tW.b)((null==F?void 0:F.hash)||"",r).gbImageProps;return _&&F?(0,o.jsx)(eA.A,{contentHeight:F.height,header:e("dialogHeader",{count:F.imageCount}),open:!0,confirm:x,deny:b,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(eI.A,{ref:I,sx:w,children:(0,o.jsxs)(eI.A,{sx:{mx:j.spacing(-2),position:"relative",backgroundColor:j.palette.background.default},children:[(0,o.jsx)(tB.A,{hash:F.hash,overrides:r}),F.imageCount>1?(0,o.jsxs)(g.A,{severity:"info",sx:{position:"absolute",width:"75%",top:"11%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,o.jsx)(v.A,{children:e("editingMultiple",{count:F.imageCount})}),l.length?(0,o.jsx)(eI.A,{component:"ul",children:l.map(function(e){return(0,o.jsx)(A.A,{component:"li",variant:"caption",children:e},e)})}):null]}):null]})}),(0,o.jsx)(ef.A,{helperText:F.imageCount>1?e("indexHelperText"):void 0,type:"text",label:e("editTitle"),value:n.title,onChange:function(e){var t=e.target.value;u("title")(t)}}),(0,o.jsx)(tT,{created:n.created,updateCreated:u("created"),regularImage:a,mixedTypes:F.mixedTypes,lockFrame:n.lockFrame,hash:F.hash,hashes:F.hashes,paletteShort:n.paletteShort,framePaletteShort:n.framePaletteShort,paletteRGBN:n.paletteRGBN,invertPalette:n.invertPalette,invertFramePalette:n.invertFramePalette,frame:n.frame,tags:s,meta:F.meta,rotation:n.rotation,updatePalette:d,updateInvertPalette:u("invertPalette"),updateFramePalette:h,updateInvertFramePalette:u("invertFramePalette"),updateFrame:u("frame"),updateFrameLock:u("lockFrame"),updateRotation:u("rotation"),updateTags:f,resetTags:p})]})}):F?(0,o.jsx)(eA.A,{contentHeight:F.height,header:e("dialogHeader",{count:F.imageCount}),open:!0,deny:b,children:(0,o.jsx)(ez.A,{variant:"indeterminate"})}):(console.warn('Editform should be open, but "toEdit" is undefined',F,_),null)};var tQ=F(99861);let tK=function(e){var t,F,n=(null==e?void 0:e.id)||"",r=(0,tN.A)().cancelEditFrame,a=(0,eq.h)().frames,o=(0,eq.h)().addFrames,l=(0,tP.g)().updateLastSyncLocalNow,s=(0,tQ.R)().frameGroups,c=RegExp("^(?<groupName>[a-z]+)(?<id>[0-9]+)","g").exec(n),u=(null==c||null==(t=c.groups)?void 0:t.groupName)||"",d=(null==c||null==(F=c.groups)?void 0:F.id)||"0",h=(0,i._)((0,m.useState)(u),2),f=h[0],p=h[1],g=(0,i._)((0,m.useState)(parseInt(d,10)),2),v=g[0],x=g[1],A=(0,i._)((0,m.useState)((null==e?void 0:e.name)||""),2),b=A[0],j=A[1],y="".concat(f).concat(v.toString(10).padStart(2,"0")),C=y===n||!a.find(function(e){return y===e.id}),I=!!f.match(/^[a-z]{2,}$/g),E=v>0;return{frameGroups:s,updateId:n,fullId:y,frameIndex:v,frameGroup:f,frameName:b,idValid:C,formValid:C&&I&&E,groupIdValid:I,frameIndexValid:E,setFrameIndex:x,setFrameGroup:p,setFrameName:j,saveFrame:function(){r(),l(),o([{hash:(null==e?void 0:e.hash)||"",id:y,name:b,lines:(null==e?void 0:e.lines)||0}])},cancelEdit:r}},tZ=function(e){var t=e.frameIndex,F=e.frameName,n=e.idValid,r=e.groupIdValid,a=e.frameIndexValid,i=e.frameGroup,l=e.groups,s=e.fullId,u=e.frameGroupName,d=e.extraFields,m=e.setFrameGroupName,h=e.setFrameIndex,f=e.setFrameGroup,p=e.setFrameName,v=(0,V.c3)("EditFrameForm"),x=!!l.find(function(e){return i===e.id});return(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[d,(0,o.jsxs)(ef.A,{label:v("frameGroup"),select:!0,size:"small",type:"text",value:i,onChange:function(e){f(e.target.value)},slotProps:{inputLabel:{shrink:!0},select:{renderValue:function(e){var t;return x?(null==(t=l.find(function(t){return t.id===e}))?void 0:t.name)||v("unknown"):""===e?v("selectFrameGroup"):v("newFrameGroup")}}},children:[(0,o.jsx)(em.A,{value:"",children:x?v("selectFrameGroup"):v("newFrameGroup")}),l.map(function(e){var t=e.id,F=e.name;return(0,o.jsx)(em.A,{value:t,children:F},t)})]}),(0,o.jsx)(ef.A,{label:x?v("frameGroupId"):v("newFrameGroupId"),size:"small",type:"text",value:i,onChange:function(e){f(e.target.value)},helperText:r?void 0:v("groupIdHelperText")}),m?(0,o.jsx)(ef.A,{label:v("newFrameGroupName"),size:"small",type:"text",onChange:function(e){m(e.target.value)},value:x?"":u,disabled:x}):null,(0,o.jsx)(ef.A,{label:v("frameIndex"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:99}},value:t,onChange:function(e){h(parseInt(e.target.value,10))},helperText:a?null:v("frameIndexHelperText")}),(0,o.jsx)(ef.A,{label:v("frameName"),size:"small",type:"text",value:F,onChange:function(e){p(e.target.value)}}),!n&&(0,o.jsx)(g.A,{severity:"warning",variant:"filled",children:v("idInUse",{id:s})})]})},tq=function(){var e=(0,V.c3)("EditFrame"),t=(0,tN.A)().editFrame,F=(0,eq.h)().frames.find(function(e){return e.id===t}),n=tK(F),r=n.cancelEdit,a=n.saveFrame,i=n.updateId,l=n.fullId,s=n.formValid,c=n.frameGroups,u=n.frameGroup,d=n.frameIndex,m=n.setFrameIndex,h=n.frameName,f=n.setFrameGroup,p=n.setFrameName,g=n.idValid,v=n.groupIdValid,x=n.frameIndexValid,A=i!==l?e("idChange",{newId:l}):"";return(0,o.jsx)(eA.A,{confirm:a,canConfirm:s,header:F?e("dialogHeader",{id:i,idChange:A}):void 0,deny:r,children:F?(0,o.jsx)(tZ,{groups:c,fullId:l,frameIndex:d,frameGroup:u,frameName:h,idValid:g,groupIdValid:v,frameIndexValid:x,setFrameIndex:m,setFrameGroup:f,setFrameName:p}):null})};var tJ=F(14539),t$=F(96112);let t0=function(){var e=(0,V.c3)("EditImageGroup"),t=(0,t$.Ay)(),F=t.editId,n=t.absoluteSlug,r=t.possibleParents,a=t.slug,i=t.title,l=t.canConfirm,s=t.canMove,u=t.slugIsInUse,d=t.slugWasChanged,m=t.parentSlug,h=t.selectionCount,f=t.setSlug,p=t.setTitle,g=t.setParentSlug,v=t.confirm,x=t.move,A=t.cancelEditImageGroup;return(0,o.jsx)(eA.A,{confirm:v,canConfirm:l,header:F!==t$.Ll?e("dialogHeader",{title:i?'"'.concat(i,'"'):""}):e("createNewGroupDialogHeader",{count:h}),deny:A,contentWidth:"auto",actionButtons:r.length>1&&F===t$.Ll&&(0,o.jsx)(B.A,{disabled:!s,onClick:x,variant:"contained",color:"secondary",children:e("moveSelectedImages",{count:h})}),children:(0,o.jsx)(c.A,{direction:"column",gap:4,children:F&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ef.A,{label:e("title"),size:"small",type:"text",value:i,onChange:function(e){return p(e.target.value)}}),(0,o.jsx)(ef.A,{label:e("pathSegment"),size:"small",type:"text",value:a,onChange:function(e){return f(e.target.value)},helperText:e(u&&d?"pathInUse":"path",{path:n}),error:!l}),r.length>1&&(0,o.jsx)(ef.A,{label:e("parentGroup"),size:"small",select:!0,onChange:function(e){return g(e.target.value)},value:m,children:r.map(function(e){var t=e.value,F=e.name;return(0,o.jsx)(em.A,{value:t,children:F},t)})}),(0,o.jsx)(tJ.A,{text:JSON.stringify({slug:a,parentSlug:m,canConfirm:l,slugIsInUse:u},null,2)})]})})})};var t1=F(21844),t2=function(e){return/^#[0-9a-fA-F]{6}$/.test(e)};let t3=function(e){var t=e.value,F=e.onChange,n=e.label,r=(0,i._)((0,m.useState)(t),2),a=r[0],l=r[1],s=(0,i._)((0,m.useState)("id-".concat(Math.random().toString(16).split(".")[1])),1)[0];(0,m.useEffect)(function(){l(t)},[t]);var u=(0,m.useRef)(F);return(0,m.useEffect)(function(){u.current=F},[F]),(0,m.useEffect)(function(){var e=setTimeout(function(){t2(a)&&u.current(a)},125);return function(){clearTimeout(e)}},[a]),(0,o.jsxs)(e9.A,{variant:"outlined",fullWidth:!0,size:"small",color:"tertiary",sx:{"--palette-color":t2(a)?a:"#000000",".MuiOutlinedInput-notchedOutline":{inset:0},"[type=color]":{height:"100%",width:"100%",opacity:"0",cursor:"pointer"}},children:[(0,o.jsx)(te.A,{shrink:!0,htmlFor:s,children:n}),(0,o.jsxs)(c.A,{direction:"row",gap:1,sx:{"& > *":{flexBasis:"auto",flexShrink:0,flexGrow:1},"& > *:first-of-type":{flexBasis:"40px",flexShrink:0,flexGrow:0,backgroundColor:"var(--palette-color)"}},children:[(0,o.jsx)(eG.A,{variant:"outlined",children:(0,o.jsx)("input",{type:"color",value:a,onChange:function(e){return l(e.target.value)},tabIndex:-1})}),(0,o.jsx)(t1.A,{id:s,type:"text",value:a,onChange:function(e){return l(e.target.value)},onBlur:function(e){return l(e.target.value.toLowerCase())}})]})]})};var t4=F(84470),t5=(0,F(37145).A)("hash");let t8=function(){var e=(0,X.Z)().root,t=(0,tR.A)(),F=t.imageSelection,n=t.sortBy,r=t.filtersTags,a=t.filtersFrames,i=t.filtersPalettes,o=t.recentImports,l=(0,m.useMemo)(function(){return{sortBy:n,filtersTags:r,filtersPalettes:i,filtersFrames:a,recentImports:o}},[a,i,r,o,n]);return{previewImages:(0,m.useMemo)(function(){var t=F.map(function(t){return e.allImages.find(function(e){return e.hash===t})}).reduce(tL.iy,[]),n=t.length>1?[]:(0,t4.S)(e,l).reduce(tL.iy,[]),r=t.length+n.length>1?[]:(0,$._)(e.allImages).map(tG.YZ).sort((0,tG.PM)(l.sortBy)).map(tG.lt).reduce(tL.iy,[]),a=t5([t.shift(),n.shift(),r.shift(),r.pop(),n.pop(),t.pop()].reduce(tL.iy,[]));return[a.shift(),a.pop()].reduce(tL.iy,[]).map(function(e){return e.hash})},[l,F,e])}},t7=function(e){var t=e.palette,F=t8().previewImages;return(0,o.jsx)(c.A,{direction:"row",gap:2,component:"ul",justifyContent:"space-around",children:F.map(function(e){return(0,o.jsx)(eI.A,{component:"li",sx:{flex:"160px 0 0"},children:(0,o.jsx)(tB.A,{hash:e,overrides:{palette:t,framePalette:t}})},e)})})};var t6=function(){var e=(0,V.c3)("useEditPalette"),t=(0,tN.A)(),F=t.editPalette,n=t.cancelEditPalette,r=(0,eq.h)(),a=r.palettes,o=r.addPalettes,l=(0,tP.g)().updateLastSyncLocalNow,s=(null==F?void 0:F.shortName)||"",c=(null==F?void 0:F.palette)||[],u=(null==F?void 0:F.name)||"",d=(0,m.useCallback)(function(e){return!!e.match(/^[a-z]+[a-z0-9]*$/gi)&&-1===a.findIndex(function(t){return t.shortName===e})},[a]),h=s===tb.mI,f=(0,i._)((0,m.useState)(u),2),p=f[0],g=f[1],v=(0,i._)((0,m.useState)(c),2),x=v[0],A=v[1],b=(0,i._)((0,m.useState)(h?"":s),2),j=b[0],y=b[1],C=(0,m.useMemo)(function(){return(!h||d(j))&&p.length>0},[p,h,j,d]),I=(0,m.useCallback)(function(){o([{shortName:h?j:s,name:p,palette:x,origin:e("paletteOrigin"),isPredefined:!1}]),l(),n()},[o,h,n,p,j,x,s,l,e]);return(0,m.useEffect)(function(){var e=function(e){"Enter"===e.key&&e.ctrlKey&&C&&I()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),{canConfirm:C,canEditShortName:h,newName:p,newShortName:j,palette:x,shortName:s,setNewName:g,setNewShortName:y,setPalette:A,save:I,cancelEditPalette:n}};let t9=function(){var e=(0,V.c3)("EditPalette"),t=t6(),F=t.canConfirm,n=t.canEditShortName,r=t.newName,a=t.newShortName,i=t.palette,l=t.shortName,s=t.setNewName,u=t.setNewShortName,d=t.setPalette,h=t.save,f=t.cancelEditPalette,p=(0,m.useCallback)(function(e){s(e.target.value)},[s]),g=(0,m.useCallback)(function(e){u(e.target.value)},[u]),v=(0,m.useCallback)(function(e){u(e.target.value.toLowerCase())},[u]),x=(0,m.useCallback)(function(e,t){var F=(0,$._)(i);F[e]=t,d(F)},[i,d]);return l?(0,o.jsx)(eA.A,{confirm:h,canConfirm:F,deny:f,header:e("dialogHeader",{name:r?'"'.concat(r,'"'):""}),closeOnOverlayClick:!1,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(ef.A,{label:e("editTitle"),size:"small",type:"text",placeholder:e("addTitle"),value:r,onChange:p}),(0,o.jsx)(ef.A,{label:e("idShortName"),size:"small",type:"text",value:a,disabled:!n,onChange:g,onBlur:v,required:!0}),(0,o.jsx)(t7,{palette:i}),i.map(function(t,F){return(0,o.jsx)(t3,{label:e("colorIndex",{index:F+1}),value:t,onChange:function(e){return x(F,e)}},"color-".concat(F))})]})}):null};var Fe=F(50533),Ft=F(30612),FF=F(80637),Fn=F(53e3),Fr=F(92920),Fa=F(32081),Fi=F(24627),Fo=F(27347),Fl=F(15719);let Fs=function(e){var t=e.rgbnHashes,F=(0,i._)((0,m.useState)(null),2),n=F[0],r=F[1],a=(0,eq.h)(),l=a.frames,s=a.images,c=(0,m.useCallback)(function(e){return(0,e7._)(function(){return(0,e6.YH)(this,function(t){switch(t.label){case 0:return[4,(0,tz.T)(s,l)("",void 0,void 0,e)];case 1:return[2,t.sent()]}})})()},[s,l]);return((0,m.useEffect)(function(){var e=window.setTimeout(function(){return(0,e7._)(function(){return(0,e6.YH)(this,function(e){switch(e.label){case 0:return[4,c(t)];case 1:return r.apply(void 0,[e.sent()]),[2]}})})()},1);return function(){return window.clearTimeout(e)}}),n)?(0,o.jsx)(eI.A,{component:"li",children:(0,o.jsx)(Fo.A,{palette:Fl.YP,tiles:n,imageStartLine:2})}):null};var Fc=F(49137),Fu=F(32252),Fd=function(e){switch(e){case"r":return"#ff0000";case"g":return"#00aa00";case"b":return"#0000ff";default:return"#444444"}};let Fm=function(e){var t=e.isR,F=e.isG,n=e.isB,r=e.isN,a=e.toggleChannel,i=(0,m.useMemo)(function(){return[{value:t,updateKey:"r"},{value:F,updateKey:"g"},{value:n,updateKey:"b"},{value:r,updateKey:"n"}]},[n,F,r,t]);return(0,o.jsx)(tF.A,{onChange:function(e,t){return a(t)},fullWidth:!0,sx:{".MuiToggleButton-root":{padding:"1px",border:"none"}},children:i.map(function(e){var t=e.value,F=e.updateKey;return(0,o.jsx)(tt.A,{value:F,sx:{"& svg":{color:Fd(F)}},children:t?(0,o.jsx)(Fc.A,{}):(0,o.jsx)(Fu.A,{})},F)})})};var Fh=F(79452),Ff=F.n(Fh),Fp=F(4599),Fg=F(72183);let Fv=function(){var e=(0,tR.A)().setImageSelection,t=(0,tP.g)().addImages;return{saveRGBNImage:(0,m.useCallback)(function(n){return(0,e7._)(function(){var r,a,i;return(0,e6.YH)(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(F.t.bind(F,79452,23))];case 1:return r=o.sent().default,a=Date.now(),t(i=n.map(function(e,t){return{palette:Fl.YP,hashes:e,hash:r(e),created:(0,tl.J)(a+t),title:"",tags:[]}})),e(i.map(function(e){return e.hash})),[2]}})})()},[t,e])}};var Fx=F(14217),FA=function(e){return e.BY_COLOR="BY_COLOR",e.BY_IMAGE="BY_IMAGE",e.MANUAL="MANUAL",e}({}),Fb=function(){var e,t,F,n=(0,V.c3)("useEditRGBNImages"),o=(0,Fp.g)().navigateToGroup,l=(0,X.Z)().view,s=Fv().saveRGBNImage,c=(0,Q.A)(),u=c.createGroup,d=c.setCreateGroup,h=(0,tR.A)().sortBy,f=(0,tN.A)(),p=f.editRGBNImages,g=f.cancelEditRGBNImages,v=f.cancelEditImageGroup,x=(0,eq.h)().addImageGroup,A=(0,i._)((0,m.useState)(p.length>5&&u),2),b=A[0],j=A[1];(0,m.useEffect)(function(){d(b)},[b,d]);var y=h.split("_")[1],C=(0,m.useMemo)(function(){var e=(0,t4.S)(l,{filtersTags:[],filtersFrames:[],filtersPalettes:[],sortBy:h,recentImports:[]});return"desc"===y&&e.reverse(),e.reduce(tL.iy,[]).reduce(function(e,t){return p.includes(t.hash)?(0,$._)(e).concat([t]):e},[])},[p,y,l,h]),I=(0,i._)((0,m.useState)(["r","g","b","s","n"]),2),E=I[0],w=I[1],S=(0,i._)((0,m.useState)(C.length<=4?"MANUAL":"BY_COLOR"),2),_=S[0],D=S[1],k=(0,i._)((0,m.useState)({r:(null==(e=C[0])?void 0:e.hash)||void 0,g:(null==(t=C[Math.floor(C.length/3)])?void 0:t.hash)||void 0,b:(null==(F=C[2*Math.floor(C.length/3)])?void 0:F.hash)||void 0}),2),T=k[0],B=k[1],M=E.findIndex(function(e){return"s"===e}),P=Math.ceil(p.length/M),N=M*P!==p.length,R=(0,m.useMemo)(function(){if("MANUAL"===_)return Object.keys(T).length?[T]:[];var e=E.slice(0,M),t=Array(P).fill("").map(function(t,F){return e.reduce(function(e,t,n){var i,o=null==(i=C["BY_COLOR"===_?F+P*n:n+M*F])?void 0:i.hash;return o?(0,a._)((0,r._)({},e),(0,et._)({},t,o)):e},{})});return"desc"===y&&t.reverse(),t},[P,y,_,T,E,C,M]),O=(0,Fg.N)().formatter,L=(0,m.useCallback)(function(){return(0,e7._)(function(){var e,t,F,r;return(0,e6.YH)(this,function(a){switch(a.label){case 0:return g(),[4,s(R)];case 1:return a.sent(),b&&(e=n("rgbNewGroupTitle",{date:O(new Date)}),t=(0,t$.BF)(e),F=R.map(function(e){return Ff()(e)}),v(),x({id:r=(0,Fx.z)(),slug:t,title:e,created:(0,tl.J)(),coverImage:F[0],images:F,groups:[]},l.id),o(r,0)),[2]}})})()},[n,x,v,g,b,O,o,R,s,l.id]),G="MANUAL"===_;return{order:E,grouping:_,canConfirm:G?R.length>0:E.length>1,lengthWarning:!G&&N,rgbnHashes:R,sortedImages:C,createGroup:b,updateOrder:function(e,t){if(!(t<0)&&!(t>E.length)){var F=E.filter(function(t){return t!==e});F.splice(t,0,e).filter(Boolean),w(F)}},toggleSingleChannel:function(e,t){var F=(0,r._)({},T);F[e]===t?delete F[e]:F[e]=t,B(F)},setGrouping:D,save:L,setCreateGroup:j,cancelEditRGBNImages:g}};let Fj=function(){var e=(0,V.c3)("EditRGBN"),t=Fb(),F=t.canConfirm,n=t.order,r=t.grouping,a=t.lengthWarning,i=t.rgbnHashes,l=t.sortedImages,s=t.createGroup,u=t.updateOrder,m=t.toggleSingleChannel,h=t.setGrouping,f=t.setCreateGroup,p=t.save,v=t.cancelEditRGBNImages,x=(0,eH.A)(),b=(0,d.A)(x.breakpoints.up("sm"));return(0,o.jsx)(eA.A,{confirm:p,deny:v,closeOnOverlayClick:!1,canConfirm:F&&!a,header:e("dialogHeader"),contentWidth:"576px",children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsxs)(ef.A,{label:e("groupingLabel"),select:!0,size:"small",value:r,onChange:function(e){return h(e.target.value)},children:[(0,o.jsx)(em.A,{value:FA.BY_COLOR,children:e("groupByColor")}),(0,o.jsx)(em.A,{value:FA.BY_IMAGE,children:e("groupByImage")}),(0,o.jsx)(em.A,{value:FA.MANUAL,children:e("manualChannelSelection")})]}),r===FA.MANUAL?(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{variant:"body2",children:e("manualChannelInstructions")}),(0,o.jsx)(c.A,{direction:"row",gap:2,component:"ul",justifyContent:"center",alignItems:"center",flexWrap:"wrap",sx:{"& .MuiCardContent-root":{padding:1}},children:l.map(function(e){var t,F,n,r,a,l,s,c,u=e.hash,d=(null==(a=i[0])?void 0:a.r)===u,h=(null==(l=i[0])?void 0:l.g)===u,f=(null==(s=i[0])?void 0:s.b)===u,p=(null==(c=i[0])?void 0:c.n)===u,g=(t=255*!!d,F=255*!!h,n=255*!!f,r=function(e,t,F,n){var r=function(e,t){return Math.floor(e*t).toString(16).padStart(2,"0")};return"#".concat(r(e,n)).concat(r(t,n)).concat(r(F,n))},d||h||f?[r(t,F,n,1),r(t,F,n,.66),r(t,F,n,.33),"#000000"]:p?["#ffffff","#aaaaaa","#555555","#000000"]:["#b2b2b2","#949494","#737373","#606060"]);return(0,o.jsxs)(Fr.A,{className:"edit-rgbn__single-image-list-entry",variant:"outlined",children:[(0,o.jsx)(Fi.A,{sx:{".gameboy-image":{width:"80px",margin:"0 auto",imageRendering:"auto"}},children:(0,o.jsx)(tB.A,{hash:u,overrides:{palette:g,lockFrame:!1,invertPalette:!1}})}),(0,o.jsx)(Fa.A,{children:(0,o.jsx)(Fm,{isR:d,isG:h,isB:f,isN:p,toggleChannel:function(e){return m(e,u)}})})]},u)})})]}):(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{variant:"body2",children:e("channelOrderInstructions")}),(0,o.jsx)(c.A,{direction:{xs:"column",sm:"row"},gap:{xs:1,sm:2},component:"ul",justifyContent:"center",alignItems:"center",children:n.map(function(e,t){return"s"===e?(0,o.jsx)(P.A,{orientation:b?"vertical":"horizontal",variant:"middle",flexItem:!0},e):(0,o.jsxs)(M.A,{component:"li",size:"small",sx:{backgroundColor:Fd(e)},children:[(0,o.jsx)(B.A,{onClick:function(){return u(e,t-1)},sx:{svg:{color:"#ffffff"}},children:b?(0,o.jsx)(Ft.A,{}):(0,o.jsx)(Fn.A,{})}),(0,o.jsx)(B.A,{onClick:function(){return u(e,t+1)},sx:{svg:{color:"#ffffff"}},children:b?(0,o.jsx)(FF.A,{}):(0,o.jsx)(Fe.A,{})})]},e)})}),a?(0,o.jsx)(g.A,{variant:"filled",severity:"error",children:e("channelDistributionError")}):null]}),(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{variant:"body2",children:e("imagePreview")}),(0,o.jsx)(c.A,{direction:"row",component:"ul",sx:{overflowX:"auto","& > *":{flex:"160px 0 0",margin:"0 auto"}},gap:1,children:i.map(function(e,t){return(0,o.jsx)(Fs,{rgbnHashes:e},t)})})]}),(0,o.jsx)(ed.A,{label:e("createGroupLabel"),control:(0,o.jsx)(eh.A,{checked:s,onChange:function(e){f(e.target.checked)}})})]})})};var Fy=F(33314),FC=F(86586),FI=F(30986),FE=function(e){return e.ADD="add",e.REMOVE="remove",e}({}),Fw=(0,FI.A)("usage",FI.U.DESC),FS=function(){var e=(0,tR.A)(),t=e.filtersTags,F=e.filtersFrames,n=e.filtersPalettes,r=e.filtersVisible,a=e.setFiltersVisible,o=e.setFilters,l=(0,eq.h)(),s=l.frames,c=l.images,u=l.palettes,d=(0,i._)((0,m.useState)(t),2),h=d[0],f=d[1],p=(0,i._)((0,m.useState)(F),2),g=p[0],v=p[1],x=(0,i._)((0,m.useState)(n),2),A=x[0],b=x[1],j=tw().availableTags,y=(0,m.useMemo)(function(){return Fw(s.map(function(e){var t=c.filter(function(t){return t.frame===e.id}).length;return{frame:e,usage:t}}).filter(function(e){var t=e.frame;return e.usage>0||g.includes(t.id)}))},[g,s,c]);(0,m.useEffect)(function(){f(t),v(F),b(n)},[F,n,t]);var C=(0,m.useCallback)(function(e,t){f("add"===t?(0,tC.A)((0,$._)(h).concat([e])):h.filter(function(t){return t!==e}))},[h]),I=(0,m.useCallback)(function(e,t){b("add"===t?(0,tC.A)((0,$._)(A).concat([e])):A.filter(function(t){return t!==e}))},[A]),E=(0,m.useCallback)(function(e,t){v("add"===t?(0,tC.A)((0,$._)(g).concat([e])):g.filter(function(t){return t!==e}))},[g]);return{visible:r,availableTags:j,availableFrames:y,availablePalettes:u,activeTags:h,activeFrames:g,activePalettes:A,updateActiveTags:C,updateActivePalettes:I,updateActiveFrames:E,applyClearTags:function(){return o([],[],[])},clearTags:function(){return f([])},clearPalettes:function(){return b([])},clearFrames:function(){return v([])},confirm:function(){return o(h,A,g)},cancel:function(){return a(!1)}}},F_=F(41175),FD=Array(20).fill(e4.BM);let Fk=function(e){var t=e.frameActive,F=e.toggleFrame,n=e.frame,r=e.usage,a=e.palette,l=(0,i._)((0,m.useState)([]),2),s=l[0],u=l[1];(0,m.useEffect)(function(){var e=setTimeout(function(){return(0,e7._)(function(){var e,t;return(0,e6.YH)(this,function(F){switch(F.label){case 0:return[4,(0,F_.mZ)(n.hash)];case 1:if(!(e=F.sent()))return u([]),[2];return t=function(t){return(0,$._)(e.left[t]).concat((0,$._)(FD.slice(0,16)),(0,$._)(e.right[t]))},u((0,$._)(e.upper).concat((0,$._)(t(0)),(0,$._)(t(1)),(0,$._)(FD),(0,$._)(t(e.left.length-2)),(0,$._)(t(e.left.length-1)),(0,$._)(e.lower))),[2]}})})()},1);return function(){clearTimeout(e)}},[n.hash]);var d=(0,V.c3)("FilterFormFrame");return(0,o.jsx)(B.A,{title:d(t?"removeFrame":"selectFrame",{name:n.name}),onClick:function(){return F(t?FE.REMOVE:FE.ADD)},variant:t?"contained":"outlined",color:"tertiary",children:(0,o.jsxs)(c.A,{direction:"column",justifyContent:"flex-start",gap:1,sx:{height:"100%"},children:[(0,o.jsx)(eI.A,{sx:{width:"160px",minHeight:"72px"},children:(0,o.jsx)(Fo.A,{tiles:s,palette:a,imageStartLine:0})}),(0,o.jsxs)(c.A,{direction:"column",children:[(0,o.jsx)(A.A,{variant:"body1",children:n.name}),(0,o.jsx)(A.A,{variant:"caption",children:d("usage",{usage:r})})]})]})})},FT=function(e){var t=e.paletteActive,F=e.togglePalette,n=e.palette,r=(0,V.c3)("FilterFormPalette"),a=(0,eH.A)();return(0,o.jsx)("button",{title:r(t?"removePalette":"selectPalette",{name:n.name}),onClick:function(){return F(t?FE.REMOVE:FE.ADD)},style:{background:t?a.palette.tertiary.main:"transparent"},children:(0,o.jsx)(tm,{palette:n.palette})})},FB=function(e){var t=e.children;return e.hidden?null:(0,o.jsx)(c.A,{direction:"column",gap:4,role:"tabpanel",sx:{pt:4},children:t})},FM=function(e){var t=e.tagActive,F=e.toggleTag,n=e.title,r=(0,V.c3)("FilterFormTag");return(0,o.jsx)(tA.A,{label:n,title:r(t?"removeTag":"selectTag",{title:n}),size:"small",onClick:function(){return F(t?FE.REMOVE:FE.ADD)},color:t?"tertiary":"default"})};var FP=function(e){return e.TAGS="tabTags",e.PALETTES="tabPalettes",e.FRAMES="tabFrames",e}(FP||{}),FN=(0,FI.A)("count",FI.U.ASC);let FR=function(){var e=(0,V.c3)("FilterForm"),t=(0,V.c3)("FilterForm.filterTabs"),F=(0,i._)((0,m.useState)(null),2),n=F[0],r=F[1],a=FS(),l=a.availableTags,s=a.activeTags,u=a.updateActiveTags,d=a.availablePalettes,h=a.activePalettes,f=a.updateActivePalettes,p=a.availableFrames,g=a.activeFrames,v=a.updateActiveFrames,b=a.visible,j=a.applyClearTags,y=a.clearTags,C=a.clearPalettes,I=a.clearFrames,E=a.confirm,w=a.cancel;(0,m.useEffect)(function(){n||r(FN([{tab:"tabFrames",count:g.length},{tab:"tabPalettes",count:h.length},{tab:"tabTags",count:s.length}])[2].tab)},[g.length,h.length,s.length,n]);var S=(0,eq.h)().palettes,_=(0,Q.A)().activePalette,D=(0,m.useMemo)(function(){return S.find(function(e){return e.shortName===_})||S[0]},[_,S]),k=(0,m.useCallback)(function(){switch(n){case"tabTags":y();break;case"tabPalettes":C();break;case"tabFrames":I()}},[I,C,y,n]);if(!b||!n)return null;var T=!!(s.length+h.length+g.length);return(0,o.jsxs)(eA.A,{confirm:E,deny:w,header:e("dialogHeader"),contentWidth:"auto",contentHeight:"75vh",actionButtons:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(B.A,{disabled:!T,title:e("clearFiltersTitle"),color:"secondary",variant:"outlined",onClick:y,children:e("clear")}),(0,o.jsx)(B.A,{disabled:!T,title:e("clearFiltersAndApplyTitle"),color:"secondary",variant:"outlined",onClick:j,children:e("clearAndApply")})]}),children:[(0,o.jsxs)(c.A,{direction:"row",justifyContent:"space-between",children:[(0,o.jsxs)(FC.A,{value:n,onChange:function(e,t){return r(t)},children:[(0,o.jsx)(eY.A,{label:t("tabTags",{count:s.length}),value:"tabTags"}),(0,o.jsx)(eY.A,{label:t("tabPalettes",{count:h.length}),value:"tabPalettes"}),(0,o.jsx)(eY.A,{label:t("tabFrames",{count:g.length}),value:"tabFrames"})]}),(0,o.jsx)(eI.A,{children:(0,o.jsx)(x.A,{onClick:k,title:e("clearTab",{tab:n}),children:(0,o.jsx)(Fy.A,{})})})]}),(0,o.jsx)(FB,{hidden:"tabTags"!==n,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{component:"span",variant:"body2",children:e("allMustBeMet")}),(0,o.jsxs)(c.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:[(0,o.jsx)(FM,{title:e("untagged"),tagActive:s.includes(tb.X3.FILTER_UNTAGGED),toggleTag:function(e){return u(tb.X3.FILTER_UNTAGGED,e)}}),(0,o.jsx)(FM,{title:e("favourite"),tagActive:s.includes(tb.X3.FILTER_FAVOURITE),toggleTag:function(e){return u(tb.X3.FILTER_FAVOURITE,e)}}),(0,o.jsx)(FM,{title:e("new"),tagActive:s.includes(tb.X3.FILTER_NEW),toggleTag:function(e){return u(tb.X3.FILTER_NEW,e)}}),(0,o.jsx)(FM,{title:e("monochrome"),tagActive:s.includes(tb.X3.FILTER_MONOCHROME),toggleTag:function(e){return u(tb.X3.FILTER_MONOCHROME,e)}}),(0,o.jsx)(FM,{title:e("rgb"),tagActive:s.includes(tb.X3.FILTER_RGB),toggleTag:function(e){return u(tb.X3.FILTER_RGB,e)}}),(0,o.jsx)(FM,{title:e("recentImports"),tagActive:s.includes(tb.X3.FILTER_RECENT),toggleTag:function(e){return u(tb.X3.FILTER_RECENT,e)}}),(0,o.jsx)(FM,{title:e("imageHasComments"),tagActive:s.includes(tb.X3.FILTER_COMMENTS),toggleTag:function(e){return u(tb.X3.FILTER_COMMENTS,e)}}),(0,o.jsx)(FM,{title:e("imageHasUsername"),tagActive:s.includes(tb.X3.FILTER_USERNAME),toggleTag:function(e){return u(tb.X3.FILTER_USERNAME,e)}})]})]}),(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,o.jsx)(c.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:l.map(function(e){return(0,o.jsx)(FM,{title:e,tagActive:s.includes(e),toggleTag:function(t){return u(e,t)}},e)})})]})]})}),(0,o.jsx)(FB,{hidden:"tabPalettes"!==n,children:(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,o.jsx)(c.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"},button:{padding:0,cursor:"pointer",width:"2.5rem",height:"2.5rem",border:"none",borderRadius:"50%"}},children:d.map(function(e){return(0,o.jsx)(FT,{palette:e,paletteActive:h.includes(e.shortName),togglePalette:function(t){return f(e.shortName,t)}},e.shortName)})})]})}),(0,o.jsx)(FB,{hidden:"tabFrames"!==n,children:(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,o.jsx)(c.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"stretch",justifyContent:"center",sx:{".MuiButton-root":{width:"180px"}},children:p.map(function(e){var t=e.frame,F=e.usage;return(0,o.jsx)(Fk,{usage:F,frame:t,palette:D.palette,frameActive:g.includes(t.id),toggleFrame:function(e){return v(t.id,e)}},t.id)})})]})})]})};var FO=["FFFF8080BFBFA0A0A0A0A0A0A0A0A0A0","FFFF0000FFFF00000000010103030707","FFFF0000FFFF7F7FFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFEFEFFFFFFFFFFFFFFFF","FFFF0000FFFF000000008080C0C0E0E0","FFFF0101FDFD05050505050505050505","A0A0A0A0A0A0A0A0A0A0A1A1A3A3A7A7","070703030101000000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","E0E0C0C0808000000000010103030707","050505050505050505058585C5C5E5E5","AFAFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000001018383C7C7EFEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","E0E0C0C0808000008080C1C1E3E3F7F7","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","F5F5FDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFF0F0F0F0F0F0F0F0","FFFFFFFFFFFFFFFF3F3F3F3F3F3F3F3F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","42214000000040206020602060206020","85C3800101000140C140C140C140C140","FCF0D0E0E0C080C181C1C181C181FEFC","1F0F0307070382038003800380030003","C4828000000004020602060206020602","0F070F070F060E060C060C060C060C06","A1C08000000008040804080400000000","FF7F5F3F3F1F0F1F1F0F1F0F1F0F1F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","60206020602060206020602060206020","C140C140C140C140C140C140C140C140","E8F0E0C081C080C1C181C18180C180C0","00030003800380038003810381030103","0602060206020602060000008000C482","0C060C060C060C060C060C060E060F06","00000F070C040C040C040C0408040000","1F0FFFFF1F0F1F0F1F0F1F0F0F1F3F1F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0FFFFFFFFFFFFFFFFFFFFFFFF","30303030FFFFFFFFFFFFFFFFFFFFFFFF","60206020FFFFFFFFFFFFFFFFFFFFFFFF","C140C140FFFFFFFFFFFFFFFFFFFFFFFF","C0C0D1E0FFFFFFFFFFFFFFFFFFFFFFFF","01030083FFFFFFFFFFFFFFFFFFFFFFFF","FEFE040200008000A0C0FFFFFFFFFFFF","0F070F07070F0F1F5F3FFFFFFFFFFFFF","8000A0C0FFFFFFFFFFFFFFFFFFFFFFFF","1F3FFF7FFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFAFAF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","EFEFC7C7838301010000010103030707","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F7F7E3E3C1C1808000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FDFDFDFDFDFDFDFDFDFDFDFDFDFDF5F5","A7A7A3A3A1A1A0A0A0A0A0A0A0A0A0A0","E0E0C0C0808000000000010103030707","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000000008080C0C0E0E0","E5E5C5C5858505050505050505050505","A0A0A0A0A0A0A0A0A0A0BFBF8080FFFF","07070303010100000000FFFF0000FFFF","FFFFFFFFFFFFFFFF7F7FFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFEFEFFFF0000FFFF","E0E0C0C0808000000000FFFF0000FFFF","05050505050505050505FDFD0101FFFF"];let FL=function(e){var t,F=e.tiles,n=e.startLine,r=e.setStartLine,a=(0,V.c3)("EditFrameStartLine"),i=(0,Q.A)().activePalette,l=null==(t=(0,eq.h)().palettes.find(function(e){return e.shortName===i}))?void 0:t.palette,s=(0,m.useMemo)(function(){var e=[];e.push.apply(e,(0,$._)(F.slice(0,20*n)));for(var t=0;t<14;t+=1){var r=(t+n)*20,a=r+18,i=16*t;e.push.apply(e,(0,$._)(F.slice(r,r+2)).concat((0,$._)(FO.slice(i,i+16)),(0,$._)(F.slice(a,a+2))))}return e.push.apply(e,(0,$._)(F.slice((n+14)*20))),e},[F,n]);return(0,o.jsxs)(c.A,{direction:"row",gap:3,justifyContent:"center",children:[(0,o.jsx)(Fo.A,{tiles:s,palette:l,imageStartLine:n}),(0,o.jsx)(c.A,{direction:"column",justifyContent:"center",children:(0,o.jsxs)(M.A,{orientation:"vertical",variant:"contained",size:"large",color:"tertiary",fullWidth:!0,children:[(0,o.jsx)(B.A,{onClick:function(){return r(n-1)},disabled:n<=0,endIcon:(0,o.jsx)(Fn.A,{}),children:a("moveUp")}),(0,o.jsx)(B.A,{onClick:function(){return r(n+1)},disabled:n>=F.length/20-14,endIcon:(0,o.jsx)(Fe.A,{}),children:a("moveDown")})]})})]})},FG=function(){var e=(0,V.c3)("FrameQueue"),t=(0,eB.A)().dismissDialog,F=(0,ej.A)(),n=F.frameQueue,r=F.frameQueueCancelOne,a=F.importQueueCancelOne,l=(0,tP.g)().updateLastSyncLocalNow,s=(0,eq.h)(),c=s.addFrames,u=s.updateFrameGroups,d=n[0],h=(0,i._)((0,m.useState)(""),2),f=h[0],p=h[1],g=(0,i._)((0,m.useState)(Math.floor((d.tiles.length-280)/40)),2),v=g[0],x=g[1],A=tK({id:"",hash:"",name:d.fileName,lines:d.tiles.length}),b=A.fullId,j=A.formValid,y=A.frameGroups,C=A.frameGroup,I=A.frameIndex,E=A.setFrameIndex,w=A.frameName,S=A.setFrameGroup,_=A.setFrameName,D=A.idValid,k=A.groupIdValid,T=A.frameIndexValid;return(0,o.jsx)(eA.A,{header:e("dialogHeader",{id:b}),canConfirm:j,confirm:function(){return(0,e7._)(function(){var e;return(0,e6.YH)(this,function(F){switch(F.label){case 0:return[4,(0,F_.R_)(d.tiles,v)];case 1:return e=F.sent(),t(0),d.tempId&&(a(d.tempId),r(d.tempId)),c([{id:b,name:w,hash:e,lines:d.tiles.length}]),(null==f?void 0:f.trim())&&u([{id:C,name:f}]),l(),[2]}})})()},deny:function(){return r(d.tempId)},children:(0,o.jsx)(tZ,{frameIndex:I,setFrameGroup:S,frameName:w,frameGroup:C,setFrameName:_,groupIdValid:k,idValid:D,frameIndexValid:T,setFrameIndex:E,groups:y,fullId:b,frameGroupName:f,setFrameGroupName:p,extraFields:(0,o.jsx)(FL,{tiles:d.tiles,startLine:v,setStartLine:x})})})};var FH=F(88584),FU=F(21860),Fz=F.n(FU),FV=F(15680),FW=F(10941),FX=(0,FI.A)("fileName");let FY=function(){var e=(0,Q.A)(),t=e.importPad,F=e.setActivePalette,n=e.activePalette,o=e.createGroup,l=e.setCreateGroup,s=(0,tN.A)().cancelEditImageGroup,c=(0,eq.h)(),u=c.addImageGroup,d=c.palettes,h=c.images,f=(0,tR.A)().setImageSelection,p=(0,ej.A)(),g=p.importQueue,v=p.importQueueSet,x=p.frameQueueAdd,A=p.importQueueCancelOne,b=(0,tP.g)(),j=b.addImages,y=b.importQueueCancel,C=(0,X.Z)().view,I=(0,Fp.g)().navigateToGroup,E=(0,V.c3)("useRunImport"),w=(0,i._)((0,m.useState)(""),2),S=w[0],_=w[1],D=(0,i._)((0,m.useState)(g.length>3&&o),2),k=D[0],T=D[1];(0,m.useEffect)(function(){l(k)},[k,l]);var B=(0,i._)((0,m.useState)({initial:[],add:[],remove:[]}),2),M=B[0],P=B[1],N=(0,m.useCallback)(function(e){x(ej.A.getState().importQueue.filter(function(t){return t.tempId===e}))},[x]),R=(0,m.useCallback)(function(e){A(e)},[A]),O=(0,Fg.N)().formatter,L=(0,m.useCallback)(function(){P(function(e){return{initial:e.initial,add:[],remove:[]}})},[]),G=(0,m.useCallback)(function(){return(0,e7._)(function(){var e,F,r,a,i,o,l,c;return(0,e6.YH)(this,function(d){switch(d.label){case 0:return e=ej.A.getState().importQueue,F=new(Fz())(1,1/0),r=Date.now(),[4,Promise.all(FX(e).map(function(e,a){var i=e.tiles,o=e.fileName,l=e.meta,s=e.lastModified,c=M.add,u=s||r;return F.add(function(){return(0,FW.A)({lines:t?(0,FV.A)(i):i,filename:o,palette:n,frame:S,tags:c,created:(0,tl.J)(u+a),meta:l})})}))];case 1:return i=(a=d.sent()).map(function(e){return e.hash}),j(a),k&&(o=E("importGroupTitle",{date:O(new Date)}),l=(0,t$.BF)(o),s(),u({id:c=(0,Fx.z)(),slug:l,title:o,created:(0,tl.J)(),coverImage:a[0].hash,images:i,groups:[]},C.id),I(c,0)),f(i),[2]}})})()},[E,n,u,j,s,k,O,S,t,I,f,M,C.id]),H=(0,m.useMemo)(function(){return d.find(function(e){return e.shortName===n})||Fl.Fv},[n,d]),U=(0,m.useMemo)(function(){return new Map(h.map(function(e){return[e.hash,e]}))},[h]),z=(0,m.useMemo)(function(){var e=new Set;return g.map(function(t){var F=U.get(t.imageHash)||null,n=e.has(t.imageHash);return e.add(t.imageHash),(0,a._)((0,r._)({},t),{isDuplicateInQueue:n,alreadyImported:F})})},[g,U]),W=(0,m.useMemo)(function(){return g.filter(function(e){return -1!==e.fileName.indexOf("[last seen]")}).length},[g]),Y=(0,m.useMemo)(function(){return g.filter(function(e){return -1!==e.fileName.indexOf("[deleted]")}).length},[g]),K=(0,m.useMemo)(function(){return z.filter(function(e){return e.isDuplicateInQueue}).length},[z]),Z=(0,m.useMemo)(function(){return z.filter(function(e){return e.alreadyImported}).length},[z]),q=(0,m.useCallback)(function(){v(g.filter(function(e){return -1===e.fileName.indexOf("[last seen]")}))},[v,g]),J=(0,m.useCallback)(function(){v(g.filter(function(e){return -1===e.fileName.indexOf("[deleted]")}))},[v,g]),$=(0,m.useCallback)(function(){var e=new Set;v(g.filter(function(t){var F=e.has(t.imageHash);return e.add(t.imageHash),!F}))},[v,g]);return{importQueue:z,importPad:t,palette:H,activePalette:n,frame:S,tagChanges:M,createGroup:k,updateTagChanges:P,resetTagChanges:L,setFrame:_,setCreateGroup:T,runImport:G,cancelImport:y,importAsFrame:N,cancelItemImport:R,setActivePalette:F,lastSeenCount:W,importedDuplicatesCount:Z,queueDuplicatesCount:K,deletedCount:Y,removeLastSeen:q,removeDeleted:J,removeImportedDuplicates:(0,m.useCallback)(function(){v(g.filter(function(e){return!U.has(e.imageHash)}))},[v,g,U]),removeQueueDuplicates:$}};var FQ=F(77481);let FK=(0,m.memo)(function(e){var t=e.importItem,F=e.palette,n=e.importAsFrame,i=e.cancelItemImport,l=e.windowStyle,s=(0,V.c3)("ImportRow"),u=t.tiles,d=t.fileName,h=t.lastModified,f=t.alreadyImported,p=t.isDuplicateInQueue,g=(0,m.useMemo)(function(){return p?{color:"error",title:s("duplicateInQueue"),badgeContent:"D"}:f?{color:"warning",title:s("alreadyImported",{title:f.title||"NO_TITLE"}),badgeContent:"I"}:{}},[f,p,s]),v=(0,Fg.N)().formatter;return(0,o.jsxs)(c.A,{direction:"row",gap:1,alignItems:"stretch",justifyContent:"left",sx:l,children:[(0,o.jsx)(eI.A,{sx:{flex:"160px 0 0"},children:(0,o.jsx)(Fo.A,{tiles:u,invertPalette:!1,lockFrame:!1,palette:null==F?void 0:F.palette,imageStartLine:2,asThumb:!0})}),(0,o.jsxs)(c.A,{sx:{flex:"auto 1 1",my:1},direction:"column",gap:2,justifyContent:"space-between",alignContent:"space-between",children:[(0,o.jsxs)(M.A,{fullWidth:!0,sx:{justifyContent:"flex-end",display:"flex"},children:[(0,o.jsx)(x.A,{title:s("importAsFrame"),disabled:u.length/20<14,onClick:n,children:(0,o.jsx)(FQ.A,{})}),(0,o.jsx)(T.A,(0,a._)((0,r._)({},g),{anchorOrigin:{vertical:"bottom",horizontal:"left"},overlap:"circular",children:(0,o.jsx)(x.A,{title:s("removeFromQueue"),onClick:function(){return setTimeout(i,1)},children:(0,o.jsx)(I.A,{})})}))]}),(0,o.jsxs)(c.A,{sx:{pr:1},gap:1,direction:"column",children:[(0,o.jsx)(A.A,{variant:"caption",component:"p",sx:{wordBreak:"break-word"},children:d}),h&&h>0&&(0,o.jsx)(A.A,{variant:"caption",component:"p",children:v(h)})]})]})]})}),FZ=function(){var e=(0,V.c3)("ImportQueue"),t=FY(),F=t.frame,n=t.palette,a=t.activePalette,i=t.importQueue,l=t.tagChanges,s=t.createGroup,u=t.setFrame,d=t.setActivePalette,m=t.setCreateGroup,h=t.updateTagChanges,f=t.resetTagChanges,p=t.runImport,g=t.cancelImport,v=t.importAsFrame,x=t.cancelItemImport,A=t.lastSeenCount,b=t.importedDuplicatesCount,j=t.queueDuplicatesCount,y=t.deletedCount,C=t.removeLastSeen,I=t.removeDeleted,E=t.removeImportedDuplicates,w=t.removeQueueDuplicates,S=(0,tU.h)().height;return(0,o.jsx)(eA.A,{header:e("dialogHeader",{count:i.length}),confirm:p,deny:g,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(FH.Y1,{height:Math.min(152*i.length,S/2),itemCount:i.length,itemSize:152,overscanCount:5,width:"100%",children:function(e){var t=e.index,F=e.style;return(0,o.jsx)(FK,{windowStyle:F,palette:n,importItem:i[t],importAsFrame:function(){return v(i[t].tempId)},cancelItemImport:function(){return x(i[t].tempId)}})}}),(0,o.jsxs)(M.A,{variant:"contained",color:"secondary",fullWidth:!0,children:[(0,o.jsx)(B.A,{disabled:!A,onClick:C,title:e("removeLastSeenTitle"),children:e("removeLastSeen",{count:A||0})}),(0,o.jsx)(B.A,{disabled:!y,onClick:I,title:e("removeDeletedTitle"),children:e("removeDeleted",{count:y||0})}),(0,o.jsx)(B.A,{disabled:!j,onClick:w,title:e("removeDuplicatesInQueueTitle"),children:e("removeDuplicatesInQueue",{count:j||0})}),(0,o.jsx)(B.A,{disabled:!b,onClick:E,title:e("removeAlreadyImportedTitle"),children:e("removeAlreadyImported",{count:b||0})})]}),(0,o.jsx)(tf,{noFancy:!0,value:a,onChange:d}),(0,o.jsx)(e$,{selectLabel:e("modifyFrame"),frame:F,lockFrame:!1,noFrameOption:e("noFrameOption"),updateFrame:u}),(0,o.jsx)(t_,{tags:l,resetTags:f,updateTags:function(e,t){h((0,r._)({},l,ty(l,{mode:e,tag:t})))}}),(0,o.jsx)(ed.A,{label:e("createGroupLabel"),control:(0,o.jsx)(eh.A,{checked:s,onChange:function(e){m(e.target.checked)}})})]})})};var Fq=F(65016),FJ=F(25216);let F$=function(e){var t=e.hash,F=e.visible;return(0,o.jsx)(c.A,{direction:"column",tabIndex:0,sx:{flex:"0 0 auto",width:F?"100%":"0"},justifyContent:"center",children:(0,o.jsx)(eI.A,{sx:{maxHeight:"100%"},children:(0,o.jsx)(tB.A,{hash:t})})},t)};var F0=F(44344),F1=F(7766),F2=F(80068),F3=function(){var e=(0,tR.A)(),t=(0,F1.A)().sendEvent,F=(0,X.Z)(),n=F.view,r=F.covers,a=(0,h.A)(),o=a.isFullscreen,l=a.setIsFullscreen,s=a.setLightboxImage,c=a.lightboxImage,u=(0,m.useMemo)(function(){return console.log("filteredImagesUpdate"),(0,t4.S)(n,e).filter(function(e){var t=e.hash;return!r.includes(t)})},[r,e,n]),d=(0,m.useMemo)(function(){return u.map(function(e){return e.hash})},[u]),f=(0,i._)((0,m.useState)(null),2),p=f[0],g=f[1],v=(0,m.useCallback)(function(e){var t=u[e];return t?{title:t.title,created:t.created,index:e}:null},[u]);(0,m.useEffect)(function(){g(function(e){return null===c?null:(e||t("lightBox",{imageCount:(0,F2.y)(d.length)}),v(c))})},[v,d.length,c,t]);var x=(0,m.useCallback)(function(){g(function(e){if(null===e)return null;var t=u.length;return v(Math.min(e.index+1,t-1))})},[v,u]),A=(0,m.useCallback)(function(){g(function(e){return null===e?null:v(Math.max(e.index-1,0))})},[v]),b=(0,m.useCallback)(function(e){g(function(t){return null===t?null:v(e)})},[v]),j=(0,m.useCallback)(function(){s(null)},[s]);(0,m.useEffect)(function(){var e=function(){l(!!F0.A.element)},t=function(e){switch(e.key){case"Esc":case"Escape":j(),e.preventDefault();break;case"Right":case"ArrowRight":case"d":x(),e.preventDefault();break;case"Left":case"ArrowLeft":case"a":A(),e.preventDefault();break;case"Home":b(0),e.preventDefault();break;case"End":b(u.length-1),e.preventDefault()}};return document.addEventListener("keydown",t),F0.A.isEnabled&&F0.A.on("change",e),function(){document.removeEventListener("keydown",t),F0.A.isEnabled&&F0.A.off("change",e)}},[u.length,l,x,A,j,v,b]);var y=(0,m.useCallback)(function(){F0.A.isEnabled&&(F0.A.element?F0.A.exit():F0.A.request(document.body))},[]),C=(0,m.useMemo)(function(){return null!==p&&p.index>0},[p]),I=(0,m.useMemo)(function(){return null!==p&&p.index<u.length-1},[p,u.length]),E=(0,m.useMemo)(function(){if(!p)return[];var e=p.index,t=d[p.index];return d.slice(Math.max(0,e-1),e+2).map(function(e){return{hash:e,visible:e===t}})},[d,p]);return{currentInfo:p,renderHashes:E,isFullscreen:o,size:d.length,canPrev:C,canNext:I,close:j,prev:A,next:x,handleFullscreen:y}};let F4=function(){var e=(0,V.c3)("LightboxImage"),t=F3(),F=t.currentInfo,n=t.size,r=t.renderHashes,a=t.isFullscreen,i=t.canPrev,l=t.canNext,s=t.prev,u=t.next,d=t.handleFullscreen,m=t.close,h=(0,Fg.N)().formatter;return n&&F?(0,o.jsx)(eA.A,{header:F.title,deny:m,contentWidth:"100%",contentHeight:"100%",fullSize:!0,headerActionButtons:(0,o.jsx)(x.A,{color:"inherit",onClick:d,title:e(a?"leaveFullscreen":"enterFullscreen"),children:a?(0,o.jsx)(FJ.A,{}):(0,o.jsx)(Fq.A,{})}),children:(0,o.jsxs)(c.A,{direction:"column",gap:2,sx:{width:"100%",height:"100%"},children:[(0,o.jsxs)(c.A,{direction:"row",gap:1,alignItems:"center",justifyContent:"center",sx:{height:"100%",overflow:"hidden",position:"relative","& > .MuiBox-root":{flexGrow:1}},children:[(0,o.jsx)(x.A,{size:"large",onClick:s,disabled:!i,children:(0,o.jsx)(Ft.A,{})}),F&&(0,o.jsx)(c.A,{direction:"row",gap:0,sx:{width:"100%",height:"100%",flexBasis:"100%",flexGrow:1,overflowX:"auto",WebkitOverflowScrolling:"touch",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},"&>.MuiBox-root":{outline:"none"}},children:r.map(function(e){var t=e.hash,F=e.visible;return(0,o.jsx)(F$,{hash:t,visible:F},t)})}),(0,o.jsx)(x.A,{size:"large",onClick:u,disabled:!l,children:(0,o.jsx)(FF.A,{})})]}),(0,o.jsxs)(c.A,{direction:"row",gap:{xs:4,md:12},alignItems:"center",justifyContent:"center",children:[(0,o.jsx)(A.A,{variant:"body2",children:e("imageCounter",{current:F.index+1,total:n})}),F.created&&(0,o.jsx)(A.A,{variant:"body2",children:h(F.created)})]})]})}):null};var F5=F(42271),F8=F(36925),F7=F(53749);let F6=function(){var e=(0,V.c3)("PickColors"),t=(0,tN.A)(),F=t.pickColors,n=t.setEditPalette,r=t.cancelEditPalette,a=t.cancelPickColors,l=(0,i._)((0,m.useState)([0,3,6,9]),2),s=l[0],u=l[1],d=(0,m.useMemo)(function(){return F?[,,,,].fill(null).map(function(e,t){var n=s[t],r=F.colors[n];return r?(0,F7.E)(r):"#000000"}):[]},[F,s]),h=(0,m.useCallback)(function(){a(),r()},[r,a]);return((0,m.useEffect)(function(){var e=((null==F?void 0:F.colors.length)||1)-1;if(e<3)return void h();u([0,Math.round(.33*e),Math.round(.66*e),e])},[h,F]),F)?(0,o.jsx)(eA.A,{confirm:function(){n({name:e("newPaletteNameFromFile",{fileName:F.fileName}),shortName:tb.mI,palette:d,origin:"generated from file",isPredefined:!1})},canConfirm:4===s.length,deny:h,header:e("dialogHeader",{fileName:F.fileName}),contentWidth:"auto",children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(t7,{palette:d}),(0,o.jsx)(tF.A,{value:s,onChange:function(e,t){return u((0,$._)(t).sort())},sx:{display:"flex",justifyContent:"space-around",gap:0},children:F.colors.map(function(e,t){return(0,o.jsx)(tt.A,{value:t,sx:{"--palette-color":"rgb(".concat(e.join(","),")"),color:"var(--palette-color)",borderRadius:0,width:48,height:48,padding:0,border:"none","&&.Mui-selected":{border:"none",background:"none",color:"var(--palette-color)"},"& > svg":{width:"inherit",height:"inherit"}},children:s.includes(t)?(0,o.jsx)(F5.A,{}):(0,o.jsx)(F8.A,{})},t)})}),(0,o.jsx)(c.A,{direction:"row",gap:0,sx:{"& > .MuiBox-root":{height:"32px",flexGrow:1}},children:d.map(function(e,t){return(0,o.jsx)(eI.A,{title:e,sx:{backgroundColor:e}},t)})})]})}):null};var F9=F(26213);let ne=function(){var e=(0,V.c3)("ProgressBox"),t=(0,F9.A)().progress;return(0,o.jsx)(eA.A,{header:e("dialogHeader"),children:(0,o.jsx)(c.A,{direction:"column",gap:2,children:t.map(function(e){return(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(A.A,{children:e.label}),(0,o.jsx)(ez.A,{variant:"determinate",value:100*e.value,color:"secondary"})]},e.id)})})})};var nt=F(52122),nF=F(79282),nn=F.n(nF),nr=function(){var e=(0,F9.A)(),t=e.progressLog,F=e.resetProgressLog,n=(0,K.A)(),r=n.gitStorage,a=n.dropboxStorage;return{git:{messages:t.git||[],repoUrl:"https://github.com/".concat(r.owner,"/").concat(r.repo,"/tree/").concat(r.branch),repo:r.repo,branch:r.branch},dropbox:{messages:t.dropbox||[],path:a.path||""},confirm:F}};to().extend(nn());let na=function(){var e=nr(),t=e.git,F=t.messages,n=t.repoUrl,r=t.repo,a=t.branch,l=e.dropbox,s=l.messages,u=l.path,d=e.confirm,h=(0,V.c3)("ProgressLogBox"),f=(0,i._)((0,m.useState)(!0),2),p=f[0],g=f[1],v=F.length>0,x=s.length>0,b=(F[F.length-1]||{}).timestamp,j=F[0]||{},y=j.timestamp,C=j.message,I=(s[s.length-1]||{}).timestamp,E=s[0]||{},w=E.timestamp,S=E.message,_="."===C||"."===S,D=v?b:I,k=v?y:w,T=(0,m.useMemo)(function(){return(0,$._)(F).concat((0,$._)(s)).filter(function(e){return e.type!==F9.F.DONE})},[s,F]),M=(0,m.useMemo)(function(){return T.filter(function(e,t){return!p||t<15})},[p,T]),P=(0,m.useMemo)(function(){var e={repo:v?"".concat(r,"/").concat(a):"NO_REPO"};return _?h(T.some(function(e){return e.type===F9.F.ERROR})?"dialogHeaderError":"dialogHeaderDone",e):h("dialogHeaderUpdating",e)},[a,_,v,T,r,h]);return F.length||s.length?(0,o.jsx)(eA.A,{header:P,confirm:_?d:void 0,children:(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsx)(eI.A,{component:"ul",sx:{overflowX:"auto",overflowY:"auto",maxHeight:"30vh","& > .MuiTypography-root":{whiteSpace:"nowrap"}},children:M.map(function(e,t){var F=e.message,n=e.timestamp,r=e.type;return(0,o.jsx)(A.A,{variant:"caption",component:"li",title:to().unix(n).format("HH:mm:ss"),color:r===F9.F.ERROR?"error":void 0,children:F},t)})}),T.length>15&&(0,o.jsx)(B.A,{variant:"outlined",color:"secondary",onClick:function(){return g(!p)},endIcon:p?(0,o.jsx)(Fe.A,{}):(0,o.jsx)(Fn.A,{}),children:p?h("showAllMessages",{count:T.length}):h("reduceMessages")}),(0,o.jsxs)(c.A,{direction:"column",gap:0,children:[(0,o.jsx)(A.A,{variant:"caption",children:h("startedAt",{time:to().unix(D).format("HH:mm:ss")})}),(0,o.jsx)(A.A,{variant:"caption",children:h(_?"finishedAfter":"runningFor",{duration:to().duration(k-D,"seconds").format("HH:mm:ss")})})]}),v&&(0,o.jsx)(B.A,{variant:"outlined",component:"a",color:"secondary",startIcon:(0,o.jsx)(nt.A,{}),title:n,href:n,target:"_blank",rel:"noreferrer",children:h("openGitHubRepository")}),x&&(0,o.jsx)(B.A,{variant:"outlined",component:"a",color:"secondary",title:h("openDropboxFolderTitle",{path:"https://www.dropbox.com".concat("/home/Apps/GameBoyPrinter/").concat(u)}),href:"https://www.dropbox.com".concat("/home/Apps/GameBoyPrinter/").concat(u),target:"_blank",rel:"noreferrer",children:h("openDropboxFolder")})]})}):null};var ni=F(88676);let no=function(){var e=(0,V.c3)("Serials"),t=(0,h.A)().setShowSerials;return(0,o.jsx)(eA.A,{header:e("dialogHeader"),deny:function(){return t(!1)},children:(0,o.jsx)(ni.A,{})})};var nl=function(){var e=(0,tR.A)(),t=e.setSortBy,F=e.setSortOptionsVisible,n=e.sortOptionsVisible,r=e.sortBy,a=(0,i._)(r.split("_"),2),o=a[0],l=a[1];return{visible:n,sortBy:void 0===o?"":o,sortOrder:void 0===l?"":l,setSortBy:t,hideSortForm:function(){return F(!1)}}};let ns=function(){var e=(0,V.c3)("SortForm"),t=nl(),F=t.visible,n=t.sortBy,r=t.sortOrder,a=t.setSortBy,l=t.hideSortForm,s=(0,i._)((0,m.useState)(n),2),u=s[0],d=s[1],h=(0,i._)((0,m.useState)(r),2),f=h[0],p=h[1];if((0,m.useEffect)(function(){d(n),p(r)},[d,p,F,n,r]),!F)return null;var g=[{title:e("titleOption"),key:"title"},{title:e("dateOption"),key:"created"},{title:e("paletteOption"),key:"palette"}],v=g.find(function(e){return e.key===u})||g[0],x=e(f===FI.U.ASC?"ascending":"descending");return(0,o.jsx)(eA.A,{header:e("dialogHeader",{sortBy:v.title,order:x}),confirm:function(){return a("".concat(u,"_").concat(f))},deny:l,children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(ef.A,{label:e("sortByLabel"),size:"small",select:!0,value:u,onChange:function(e){return d(e.target.value)},children:g.map(function(e){var t=e.key,F=e.title;return(0,o.jsx)(em.A,{value:t,children:F},t)})}),(0,o.jsxs)(ef.A,{label:e("sortDirectionLabel"),size:"small",select:!0,value:f,onChange:function(e){return p(e.target.value)},children:[(0,o.jsx)(em.A,{value:FI.U.ASC,children:e("ascending")}),(0,o.jsx)(em.A,{value:FI.U.DESC,children:e("descending")})]})]})})};var nc=F(96002),nu=F(68370),nd=F(83231),nm=F(34808),nh=function(e){var t,r,a,i,o,l,s=function(){return(0,e7._)(function(){var t,r,a;return(0,e6.YH)(this,function(i){switch(i.label){case 0:if(n)return[3,2];return[4,Promise.all([F.e(9268),F.e(9579),F.e(1575)]).then(F.bind(F,81457))];case 1:r=(t=i.sent()).init,a=t.gitSyncTool,r(),n=n||a(e),i.label=2;case 2:return[2,n]}})})()};return r=(t=K.A.getState().gitStorage).use,a=t.owner,i=t.repo,o=t.branch,l=t.token,r&&a&&i&&o&&l&&s(),{startSyncData:function(e){return(0,e7._)(function(){return(0,e6.YH)(this,function(t){switch(t.label){case 0:return[4,s()];case 1:return[2,t.sent().startSyncData(e)]}})})()},updateSettings:function(e){return(0,e7._)(function(){return(0,e6.YH)(this,function(t){switch(t.label){case 0:return[4,s()];case 1:return[2,t.sent().updateSettings(e)]}})})()}}},nf=function(){var e=(0,tP.g)(),t=(0,nd.W)().remoteImport,F=(0,h.A)().setSyncSelect,n=(0,K.A)(),r=n.gitStorage,a=n.dropboxStorage,i=n.syncLastUpdate;return{repoUrl:"https://github.com/".concat(r.owner,"/").concat(r.repo,"/tree/").concat(r.branch),dropboxActive:!!(a.use&&a.accessToken),gitActive:!!(r.use&&r.owner&&r.repo&&r.branch&&r.throttle&&r.token),autoDropboxSync:a.autoDropboxSync||!1,syncLastUpdate:i,startSync:function(F,n){switch(F){case nu.e.DROPBOX:(0,nm.E)(e,t).startSyncData(n);break;case nu.e.DROPBOXIMAGES:(0,nm.E)(e,t).startSyncImages();break;case nu.e.GIT:nh(t).startSyncData(n)}},cancelSync:function(){return F(!1)}}},np=function(e,t){return e&&t?"error":"secondary"};let ng=function(){var e=(0,V.c3)("SyncSelect"),t=nf(),F=t.repoUrl,n=t.dropboxActive,r=t.gitActive,a=t.syncLastUpdate,i=t.autoDropboxSync,l=t.startSync,s=t.cancelSync,u=i&&a.local!==a.dropbox;return(0,o.jsx)(eA.A,{deny:s,header:e("dialogHeader"),children:(0,o.jsxs)(c.A,{direction:"column",gap:4,sx:{"& .MuiButton-endIcon svg":{fontSize:32}},children:[r&&(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsx)(B.A,{variant:"contained",color:"secondary",startIcon:(0,o.jsx)(nt.A,{}),endIcon:(0,o.jsx)(eL.A,{}),title:e("syncToGitHubTitle",{repoUrl:F}),onClick:function(){l(nu.e.GIT,nu.p.UP)},children:e("syncToGitHub")}),(0,o.jsx)(B.A,{variant:"contained",color:"secondary",startIcon:(0,o.jsx)(nt.A,{}),endIcon:(0,o.jsx)(nc.A,{}),title:e("syncFromGitHubTitle",{repoUrl:F}),onClick:function(){l(nu.e.GIT,nu.p.DOWN)},children:e("syncFromGitHub")})]}),n&&(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(B.A,{variant:"contained",color:np(u,a.local<a.dropbox),endIcon:(0,o.jsx)(eL.A,{}),title:e("syncToDropbox"),onClick:function(){l(nu.e.DROPBOX,nu.p.UP)},children:e("syncToDropbox")}),u&&a.local<a.dropbox&&(0,o.jsx)(A.A,{variant:"caption",children:e("pendingRemoteChangesWarning")})]}),(0,o.jsxs)(c.A,{direction:"column",gap:1,children:[(0,o.jsx)(B.A,{variant:"contained",color:np(u,a.local>a.dropbox),endIcon:(0,o.jsx)(nc.A,{}),title:e("syncFromDropbox"),onClick:function(){l(nu.e.DROPBOX,nu.p.DOWN)},children:e("syncFromDropbox")}),u&&a.local>a.dropbox&&(0,o.jsx)(A.A,{variant:"caption",children:e("pendingLocalChangesWarning")})]}),(0,o.jsx)(B.A,{variant:"contained",color:"secondary",endIcon:(0,o.jsx)(eL.A,{}),title:e("syncImagesToDropbox"),onClick:function(){l(nu.e.DROPBOXIMAGES,nu.p.UP)},children:e("syncImagesToDropbox")})]})]})})};var nv=F(9120),nx=F(91071),nA=F(11496),nb=F(76871);function nj(){var e=(0,F1.A)(),t=e.showPopup,n=e.trackingAvailable,r=e.setConsent,a=(0,Q.A)().preferredLocale,l=(0,V.c3)("TrackingConsent"),s=(0,i._)((0,m.useState)(nb.default),2),c=s[0],u=s[1];return((0,m.useEffect)(function(){(0,e7._)(function(){var e;return(0,e6.YH)(this,function(t){switch(t.label){case 0:e=a.split("-")[0],nA.Gw.includes(e)||(e="en"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,F(43301)("./".concat(e,".md"))];case 2:return u.apply(void 0,[t.sent().default]),[3,4];case 3:return t.sent(),u(nb.default),[3,4];case 4:return[2]}})})()},[a]),t&&n)?(0,o.jsx)(eA.A,{confirm:function(){return r(F1.E.ACCEPTED)},deny:function(){return r(F1.E.DENIED)},header:l("title"),confirmMessage:l("confirm"),denyMessage:l("deny"),closeOnOverlayClick:!1,contentWidth:600,children:(0,o.jsx)(nv.Ay,{options:{wrapper:nx.A},children:c})}):null}var ny=F(60300);let nC=function(){var e=(0,V.c3)("Trashbin"),t=(0,ny.A)(),F=t.showTrashCount,n=t.purgeTrash,r=t.downloadImages,a=t.downloadFrames,i=t.trashCount,l=i.frames+i.images;return(0,o.jsx)(eA.A,{deny:function(){F(!1)},header:e("dialogHeader",{count:l}),contentWidth:"auto",actionButtons:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(B.A,{variant:"contained",color:"secondary",title:e("downloadFrames",{count:0}),disabled:0===i.frames,onClick:a,children:e("downloadFrames",{count:i.frames})}),(0,o.jsx)(B.A,{variant:"contained",color:"secondary",title:e("downloadImages",{count:0}),disabled:0===i.images,onClick:r,children:e("downloadImages",{count:i.images})}),(0,o.jsx)(B.A,{variant:"contained",color:"error",title:e("purgeAll",{count:0}),disabled:0===l,onClick:n,children:e("purgeAll",{count:l})})]}),children:(0,o.jsxs)(c.A,{direction:"column",gap:2,children:[(0,o.jsx)(A.A,{variant:"body2",children:e("deletedFrames",{count:i.frames})}),(0,o.jsx)(A.A,{variant:"body2",children:e("deletedImages",{count:i.images})})]})})};var nI=F(62384),nE=F(51638),nw=F.n(nE),nS=F(20097),n_=F(18983),nD=F(7451),nk=F(99353),nT=F(17654),nB=F(26490),nM=F(35797),nP=function(e){var t=e.gifWriter,F=e.queue,n=e.frameRate,r=e.total,a=e.setProgress;return function(e,o){return F.add(function(){return new Promise(function(F,l){var s=e.getContext("2d");if(!s)throw Error("missing context");for(var c=s.getImageData(0,0,e.width,e.height).data,u=nw()(c,4).reduce(function(e,t){var F=(0,i._)(t,3),n=(F[0]<<16)+(F[1]<<8)+F[2],r=e.palette.findIndex(function(e){return e===n});return -1===r&&(r=e.palette.length,e.palette.push(n)),e.pixels.push(r),e},{pixels:[],palette:[]}),d=u.palette,m=u.pixels;d.length<256;)d.push(0);try{a((o+1)/r),window.requestAnimationFrame(function(){t.addFrame(0,0,e.width,e.height,m,{delay:Math.round(100/n),palette:d}),F(null)})}catch(e){l(e)}})})}},nN=function(e){return{scaleFactor:e.scaleFactor||4,frameRate:e.frameRate||12,yoyo:e.yoyo||!1,reverse:e.reverse||!1,frame:e.frame||"",lockFrame:e.lockFrame||!1,invertPalette:e.invertPalette||!1,palette:e.palette||"",exportFrameMode:e.exportFrameMode||e4.H.FRAMEMODE_KEEP}},nR=function(){var e=(0,Q.A)(),t=e.videoParams,F=e.setVideoParams,n=(0,h.A)(),i=n.videoSelection,o=n.setVideoSelection,l=nN(t);return{imageCount:i.length||0,videoParams:l,update:F,cancel:function(){o([])},animate:function(){(0,e7._)(function(){var e,t,F,n,i,o,l,s,c,u,d,m,f,p,g,v,x,A,b,j,y,C,I,E,w,S,_,D,k,T,B,M,P,N,R,O,L,G;return(0,e6.YH)(this,function(H){switch(H.label){case 0:return t=(e=h.A.getState()).setError,F=e.videoSelection,i=(n=F9.A.getState()).startProgress,o=n.setProgress,l=n.stopProgress,c=(s=eq.h.getState()).frames,u=s.palettes,d=s.images,f=(m=Q.A.getState()).videoParams,p=m.fileNameStyle,g=i("Creating Animation"),[4,(0,nD.c)(10)];case 1:if(H.sent(),x=(v=nN(f)).scaleFactor,A=v.frameRate,b=v.yoyo,j=v.reverse,y=v.frame,C=v.lockFrame,I=v.invertPalette,E=v.palette,w=v.exportFrameMode,!F.length)return[2];return _=(S=F.map(function(e){return d.find(function(t){return t.hash===e})}).reduce(el.N,[])).reduce(function(e,t){if(!t)return e;var F=(0,tL.pl)(t)?(0,a._)((0,r._)({},t),{frame:y||t.frame}):(0,a._)((0,r._)({},t),{palette:E||t.palette});return(0,$._)(e).concat([F])},[]),D=(0,tz.T)(S,c),[4,Promise.all(_.map(function(e){return(0,e7._)(function(){var t,F,n,i,o,l,s,d,m,h,f,p,g,v,A,b,j,y,E;return(0,e6.YH)(this,function(S){switch(S.label){case 0:return[4,D(e.hash)];case 1:if(t=S.sent(),F=C||e.lockFrame||!1,n=e.rotation||0,o=(i=(0,nT.s)(u,(0,a._)((0,r._)({},e),{lockFrame:F}))).palette,l=i.framePalette,!(s=c.find(function(t){return t.id===e.frame})))return[3,3];return[4,(0,F_.mZ)(s.hash)];case 2:return m=S.sent(),[3,4];case 3:m=null,S.label=4;case 4:if(h=(d=m)?d.upper.length/20:2,!t||!o)throw Error("missing tiles or palette");if(!(0,tL.pl)(e))return[3,6];return[4,(0,e4.y1)({tiles:t,palette:o,lockFrame:F,imageStartLine:h,rotation:n,scaleFactor:x,handleExportFrame:w},"image/png")];case 5:return f=S.sent(),[3,8];case 6:return p=(null==o?void 0:o.palette)||e4.CU,g=(null==l?void 0:l.palette)||e4.CU,A=(v=(0,nM.f)(e)).invertPalette,b=v.invertFramePalette,j=(0,nB.C)({imagePalette:p,invertPalette:I||A,framePalette:F?g:p,invertFramePalette:I||b}),[4,(0,e4.Yn)((0,r._)({tiles:t,imageStartLine:h,rotation:n,scaleFactor:x,handleExportFrame:w},j),"image/png")];case 7:f=S.sent(),S.label=8;case 8:return[4,createImageBitmap(f)];case 9:return y=S.sent(),(E=document.createElement("canvas")).width=y.width,E.height=y.height,E.getContext("2d").drawImage(y,0,0),[2,E]}})})()}))];case 2:if(k=H.sent(),1!==(0,tC.A)(k.map(function(e){return"".concat(e.width,"*").concat(e.height)})).length)return l(g),t(Error("All images need to have same dimensions")),[2];return T=[],B=new(Fz())(1,1/0),M=new n_.e(T,k[0].width,k[0].height,{loop:65535}),b&&((N=(0,$._)(k).reverse()).shift(),N.pop(),(P=k).push.apply(P,(0,$._)(N))),j&&k.reverse(),R=nP({frameRate:A,gifWriter:M,queue:B,total:k.length,setProgress:function(e){console.log(e),o(g,e)}}),[4,Promise.all(k.map(R))];case 3:H.sent(),O=(0,nk.A)({useCurrentDate:!0,exportScaleFactor:x,frameRate:A,altTitle:"animated",frameName:y,paletteShort:E,fileNameStyle:p}),L=M.end();try{G=new File([new Uint8Array(T.slice(0,L)).buffer],"".concat(O,".gif"),{type:"image/gif"})}catch(e){G=new Blob([new Uint8Array(T.slice(0,L)).buffer])}return(0,nS.saveAs)(G,"".concat(O,".gif")),l(g),[2]}})})(),o([])}}};let nO=function(){var e=(0,V.c3)("VideoParamsForm"),t=nR(),F=t.update,n=t.cancel,r=t.imageCount,a=t.animate,i=t.videoParams;return r?(0,o.jsx)(eA.A,{confirm:a,deny:n,header:e("dialogHeader",{count:r}),children:(0,o.jsxs)(c.A,{direction:"column",gap:4,children:[(0,o.jsx)(ef.A,{label:e("frameRate"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:120}},value:i.frameRate,onChange:function(e){F({frameRate:parseInt(e.target.value,10)})}}),(0,o.jsx)(ef.A,{label:e("scaleGif"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:12}},value:i.scaleFactor,onChange:function(e){F({scaleFactor:parseInt(e.target.value,10)})}}),(0,o.jsx)(ed.A,{label:e("enableYoyo"),control:(0,o.jsx)(eh.A,{checked:i.yoyo,onChange:function(e){F({yoyo:e.target.checked})}})}),(0,o.jsx)(ed.A,{label:e("reverseDirection"),control:(0,o.jsx)(eh.A,{checked:i.reverse,onChange:function(e){F({reverse:e.target.checked})}})}),(0,o.jsx)(tf,{noFancy:!0,allowEmpty:!0,value:i.palette||"",invertPalette:i.invertPalette,onChange:function(e){F({palette:e})},updateInvertPalette:function(e){F({invertPalette:e})}}),(0,o.jsx)(ef.A,{label:e("handleFrames"),size:"small",select:!0,value:i.exportFrameMode,onChange:function(e){F({exportFrameMode:e.target.value})},children:nI.A.map(function(t){var F=t.id,n=t.name;return(0,o.jsx)(em.A,{value:F,children:e(n)},F)})}),"crop"===i.exportFrameMode?null:(0,o.jsx)(e$,{frame:i.frame||"",lockFrame:i.lockFrame,noFrameOption:e("noFrameOption"),updateFrame:function(e){F({frame:e})},updateFrameLock:function(e){F({lockFrame:e})}})]})}):null},nL=function(){var e,t=(0,F1.A)(),F=t.showPopup,n=t.trackingAvailable,r=(0,Q.A)().useSerials,a=!!(0,eB.A)().dialogs.length,i=(0,tN.A)(),l=i.editFrame,s=i.editImageGroup,c=i.editImages,u=i.editPalette,d=i.editRGBNImages,m=i.pickColors,f=!!(null==c||null==(e=c.batch)?void 0:e.length),p=d.length>0,g=(0,tR.A)(),v=g.filtersVisible,x=g.sortOptionsVisible,A=(0,ej.A)(),b=A.bitmapQueue,j=A.importQueue,y=A.frameQueue,C=!!b.length,I=!!j.length,E=!!y.length,w=(0,h.A)(),S=w.lightboxImage,_=w.dragover,D=w.trashCount.show,k=w.syncSelect,T=w.videoSelection,B=w.showSerials,M=w.downloadHashes,P=(0,F9.A)(),N=P.progress,R=P.progressLog,O=!!M.length,L=!!R.git.length||!!R.dropbox.length,G=!!N.length,H=!!(null==T?void 0:T.length);switch(!0){case F&&n:return(0,o.jsx)(nj,{});case a:return(0,o.jsx)(eP,{});case E:return(0,o.jsx)(FG,{});case C:return(0,o.jsx)(eC,{});case I:return(0,o.jsx)(FZ,{});case f:return(0,o.jsx)(tY,{});case!!s:return(0,o.jsx)(t0,{});case!!l:return(0,o.jsx)(tq,{});case!!u:return(0,o.jsx)(t9,{});case p:return(0,o.jsx)(Fj,{});case H:return(0,o.jsx)(nO,{});case!!m:return(0,o.jsx)(F6,{});case null!==S:return(0,o.jsx)(F4,{});case v:return(0,o.jsx)(FR,{});case x:return(0,o.jsx)(ns,{});case k:return(0,o.jsx)(ng,{});case D:return(0,o.jsx)(nC,{});case B&&r:return(0,o.jsx)(no,{});case O:return(0,o.jsx)(eO,{});case _:return(0,o.jsx)(eU,{});case L:return(0,o.jsx)(na,{});case G:return(0,o.jsx)(ne,{});default:return null}};function nG(e){var t=e.children,F=(0,Q.A)().themeName,n=(0,tU.h)(),h=(0,i._)((0,m.useState)({}),2),f=h[0],p=h[1];(0,m.useEffect)(function(){p({"--ddpx":n.ddpx})},[n]),(0,m.useEffect)(function(){var e,t=null==(e=document.querySelector("html"))?void 0:e.classList;t&&[W.V.BRIGHT,W.V.DARK].forEach(function(e){e===F?t.add(F):t.remove(e)})},[F]);var g=(0,m.useMemo)(function(){return F===W.V.DARK?ei:eo},[F]),v=(0,d.A)(g.breakpoints.down("md"));return(0,o.jsxs)(u.A,{theme:g,children:[(0,o.jsx)(s.Ay,{}),(0,o.jsx)(m.Suspense,{fallback:(0,o.jsx)(eu,{}),children:(0,o.jsx)(ec,{})}),(0,o.jsx)(l.A,{maxWidth:"xl",sx:(0,a._)((0,r._)({},f),{p:v?2:3,minHeight:"calc(100dvh - var(--navigation-height))",display:"flex",flexDirection:"column"}),children:(0,o.jsx)(c.A,{direction:"column",gap:2,sx:{flexGrow:1},children:t})}),(0,o.jsx)(nL,{}),(0,o.jsx)(y,{})]})}},4599:(e,t,F)=>{"use strict";F.d(t,{NavigationToolsProvider:()=>h,g:()=>f});var n=F(95155),r=F(12115),a=F(22043),i=F(20063),o=F(89386),l=F(57203),s=F(15431),c=F(86539),u=F(84470),d=function(){var e=(0,i.useRouter)(),t=(0,o.Z)(),F=t.paths,n=t.root,d=t.isWorking,m=t.path,h=t.getUrl,f=(0,a._)((0,r.useState)(!1),2),p=f[0],g=f[1],v=(0,l.A)(),x=v.sortBy,A=v.filtersTags,b=v.filtersFrames,j=v.filtersPalettes,y=v.recentImports,C=(0,s.A)().pageSize,I=(0,r.useCallback)(function(e){return(0,u.S)(e,{filtersTags:A,filtersFrames:b,filtersPalettes:j,sortBy:x,recentImports:y})},[b,j,A,y,x]),E=(0,r.useCallback)(function(e,t){return Math.floor(I(t).findIndex(function(t){return t.hash===e})/C)},[I,C]),w=(0,r.useCallback)(function(e,t){var n;return e===c.t?h({pageIndex:t,group:""}):h({pageIndex:t,group:(null==(n=F.find(function(t){return e===t.group.id}))?void 0:n.absolutePath)||""})},[h,F]),S=(0,r.useMemo)(function(){var e;return(null==(e=F.find(function(e){return e.absolutePath===m}))?void 0:e.group)||n},[m,F,n]),_=(0,r.useCallback)(function(e){var t=F.find(function(t){return t.group.images.map(function(e){return e.hash}).includes(e)}),r=(null==t?void 0:t.absolutePath)||"";return h({pageIndex:E(e,(null==t?void 0:t.group)||n),group:r})},[E,h,F,n]),D=(0,r.useCallback)(function(e,t){d||window.setTimeout(function(){g({group:{id:e,pageIndex:t}})},1)},[d]),k=(0,r.useCallback)(function(e){window.setTimeout(function(){g({imageHash:e})},1)},[]);return(0,r.useEffect)(function(){if(!d&&p){var t=window.setTimeout(function(){p.imageHash?(e.push(_(p.imageHash)),g(!1)):p.group&&(e.push(w(p.group.id,p.group.pageIndex)),g(!1))},1);return function(){window.clearTimeout(t)}}},[w,_,d,e,p]),{currentGroup:S,getGroupPath:w,getImagePageIndexInGroup:E,navigateToGroup:D,navigateToImage:k}},m=(0,r.createContext)(null);function h(e){var t=e.children,F=d();return(0,n.jsx)(m.Provider,{value:F,children:t})}var f=function(){var e=(0,r.useContext)(m);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},7451:(e,t,F)=>{"use strict";F.d(t,{c:()=>a});var n=F(61975),r=F(71450),a=function(e){return(0,n._)(function(){return(0,r.YH)(this,function(t){return[2,new Promise(function(t){self.setTimeout(t,e)})]})})()}},10941:(e,t,F)=>{"use strict";F.d(t,{A:()=>o});var n=F(61975),r=F(71450),a=F(75036),i=F(71667);let o=function(e){var t=e.lines,F=e.filename,o=e.palette,l=e.frame,s=e.tags,c=void 0===s?[]:s,u=e.meta,d=e.created,m=void 0===d?(0,i.J)():d;return(0,n._)(function(){return(0,r.YH)(this,function(e){switch(e.label){case 0:return[4,(0,a.UN)(t)];case 1:return[2,{hash:e.sent(),created:m,title:F||"",lines:t.length,tags:c,palette:o,framePalette:o,invertFramePalette:!1,invertPalette:!1,frame:l,meta:u}]}})})()}},15680:(e,t,F)=>{"use strict";F.d(t,{A:()=>a});var n=F(45377),r="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF";let a=function(e){for(;e.length%20;)e.push(r);for(var t=Array(20).fill(r);e.length<360;)e.push.apply(e,(0,n._)(t)),e.length<360&&e.unshift.apply(e,(0,n._)(t));return e}},18097:()=>{},19357:(e,t,F)=>{"use strict";F.d(t,{A:()=>a,Z:()=>r});var n=F(15376).Buffer,r=function(e){return e.UINT8_ARRAY="uint8array",e.TEXT="text",e.DATA_URL="dataURL",e}({});let a=function(e,t){return new Promise(function(F,r){var a=new FileReader;switch(a.onload=function(e){var a=e.target;if(null==a?void 0:a.result)return"uint8array"===t?void F(n.from(a.result)):void F(a.result);r(Error("Filereader has no result"))},a.onerror=function(e){r(e)},t){case"uint8array":a.readAsArrayBuffer(e);break;case"text":a.readAsText(e);break;case"dataURL":a.readAsDataURL(e);break;default:r(Error('readAs param missing or unknown type "'.concat(t,'"')))}})}},21014:(e,t,F)=>{"use strict";F.d(t,{A:()=>y});var n=F(22043),r=F(45377),a=F(95155),i=F(41574),o=F(62995),l=F(7291),s=F(68060),c=F(23405),u=F(49571),d=F(13802),m=F(35497),h=F(71583),f=F(80317),p=F(18955),g=F(12115),v=F(62384),x=F(89922),A=F(15431),b={},j=function(e){if("undefined"==typeof document)return!1;if(void 0!==b[e])return b[e];var t=document.createElement("canvas");t.width=2,t.height=2;var F=t.toDataURL("image/".concat(e));return b[e]=0===F.indexOf("data:image/".concat(e,";base64")),b[e]};let y=function(e){var t=e.inDialog,F=(0,p.c3)("DownloadOptionsForm"),b=(0,A.A)(),y=b.alwaysShowDownloadDialog,C=b.exportFileTypes,I=b.exportScaleFactors,E=b.fileNameStyle,w=b.handleExportFrame,S=b.setAlwaysShowDownloadDialog,_=b.setExportFileTypes,D=b.setExportScaleFactors,k=b.setFileNameStyle,T=b.setHandleExportFrame,B=(0,n._)((0,g.useState)(["txt","pgm"]),2),M=B[0],P=B[1];return(0,g.useEffect)(function(){P((0,r._)(["jpeg","jpg","png","webp","bmp","gif"].filter(function(e){return j(e)})).concat(["txt","pgm"]))},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.A,{children:[(0,a.jsx)(s.A,{shrink:!0,children:F("exportDimensions")}),(0,a.jsx)(h.A,{fullWidth:!0,value:I,onChange:function(e,t){D(t)},children:[1,2,3,4,5,6,8,10].map(function(e){return(0,a.jsx)(m.A,{value:e,title:"".concat(160*e,"\xd7").concat(144*e),children:"".concat(e,"\xd7")},e)})})]}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(s.A,{shrink:!0,children:F("exportFiletypes")}),(0,a.jsx)(h.A,{fullWidth:!0,value:C,onChange:function(e,t){_(t)},children:M.map(function(e){return(0,a.jsx)(m.A,{value:e,title:e,children:e},e)})})]}),(0,a.jsx)(d.A,{value:w,label:F("exportHandleFrame"),select:!0,onChange:function(e){T(e.target.value)},children:v.A.map(function(e){var t=e.id,n=e.name;return(0,a.jsx)(c.A,{value:t,children:F(n)},t)})}),(0,a.jsx)(d.A,{value:E,label:F("filenameStyle"),select:!0,onChange:function(e){k(e.target.value)},children:x.y.map(function(e){var t=e.id,n=e.name;return(0,a.jsx)(c.A,{value:t,children:F(n)},t)})}),(0,a.jsxs)(i.A,{children:[(0,a.jsx)(l.A,{label:F(t?"alwaysShowDownloadDialogInDialog":"alwaysShowDownloadDialogInForm"),control:(0,a.jsx)(u.A,{checked:y,onChange:function(e){S(e.target.checked)}})}),t&&(0,a.jsx)(f.A,{variant:"caption",component:"p",children:F("alwaysShowDownloadDialogHelper")})]})]})}},24849:(e,t,F)=>{"use strict";F.d(t,{T:()=>o,p:()=>l});var n=F(61975),r=F(71450),a=F(17403),i=F(75036),o=function(e,t,F){var o=function(l,s,c,u){return(0,n._)(function(){var n,d,m,h,f,p,g,v,x,A,b,j;return(0,r.YH)(this,function(r){switch(r.label){case 0:if(d=e.find(function(e){return l===e.hash}),m=("string"==typeof c?c:null==d?void 0:d.frame)||void 0,h=null==(n=t.find(function(e){return e.id===m}))?void 0:n.hash,u||!(!d||!(0,a.pl)(d)))return[3,2];return[4,(0,i.Hh)(l,h,s,F)];case 1:return[2,r.sent()||[]];case 2:if(!(f=u||d.hashes).r)return[3,4];return[4,o(f.r,s,m)];case 3:return g=r.sent(),[3,5];case 4:g=[],r.label=5;case 5:if(p=g,!f.g)return[3,7];return[4,o(f.g,s,m)];case 6:return x=r.sent(),[3,8];case 7:x=[],r.label=8;case 8:if(v=x,!f.b)return[3,10];return[4,o(f.b,s,m)];case 9:return b=r.sent(),[3,11];case 10:b=[],r.label=11;case 11:if(A=b,!f.n)return[3,13];return[4,o(f.n,s,m)];case 12:return j=r.sent(),[3,14];case 13:j=[],r.label=14;case 14:return[2,{r:p,g:v,b:A,n:j}]}})})()};return o},l=function(e,t){var F=o(e,t);return function(e){return(0,n._)(function(){var t,n,a,i,o;return(0,r.YH)(this,function(r){switch(r.label){case 0:return[4,F(e,!0,"")];case 1:if(t=r.sent())return[2,(null==t?void 0:t.length)||(null==(n=t.r)?void 0:n.length)||(null==(a=t.g)?void 0:a.length)||(null==(i=t.b)?void 0:i.length)||(null==(o=t.n)?void 0:o.length)||0];return[2,0]}})})()}}},25969:(e,t,F)=>{"use strict";F.d(t,{j:()=>i});var n=F(22043),r=F(20063),a=F(12115),i=function(){var e=(0,r.usePathname)(),t=(0,n._)((0,a.useState)(window.location.search),2),F=t[0],i=t[1],o=(0,a.useMemo)(function(){return new URLSearchParams(F)},[F]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){i(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var t=history.pushState,F=history.replaceState;return history.pushState=function(){for(var F=arguments.length,n=Array(F),r=0;r<F;r++)n[r]=arguments[r];t.apply(this,n),e()},history.replaceState=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];F.apply(this,n),e()},function(){window.removeEventListener("popstate",e),history.pushState=t,history.replaceState=F}},[o,e]);var l=(0,a.useMemo)(function(){return o.toString()},[o]);return{fullPath:(0,a.useMemo)(function(){return l?"".concat(e,"?").concat(l):e},[e,l]),pathname:e,query:l,searchParams:o}}},39234:(e,t,F)=>{var n={"./af.js":[89082,9082],"./am.js":[89671,9671],"./ar-dz.js":[72347,2347],"./ar-iq.js":[82915,2915],"./ar-kw.js":[25195,5195],"./ar-ly.js":[94398,4398],"./ar-ma.js":[59031,9031],"./ar-sa.js":[61149,1149],"./ar-tn.js":[84335,4335],"./ar.js":[79990,9990],"./az.js":[10430,430],"./be.js":[53952,3952],"./bg.js":[86462,6462],"./bi.js":[30396,396],"./bm.js":[23864,3864],"./bn-bd.js":[34978,4978],"./bn.js":[14321,4321],"./bo.js":[56022,6022],"./br.js":[41373,1373],"./bs.js":[52738,2738],"./ca.js":[29917,9917],"./cs.js":[99927,9927],"./cv.js":[26528,6528],"./cy.js":[97989,7989],"./da.js":[91006,1006],"./de-at.js":[60288,288],"./de-ch.js":[19494,9494],"./de.js":[22354,2354],"./dv.js":[44455,6836],"./el.js":[82752,2752],"./en-au.js":[8871,8871],"./en-ca.js":[27509,7509],"./en-gb.js":[85712,5712],"./en-ie.js":[11647,1647],"./en-il.js":[43764,3764],"./en-in.js":[26786,6786],"./en-nz.js":[75673,5673],"./en-sg.js":[39835,9835],"./en-tt.js":[96581,6581],"./en.js":[34430,4430],"./eo.js":[48697,8697],"./es-do.js":[32921,2921],"./es-mx.js":[1417,1417],"./es-pr.js":[82982,2982],"./es-us.js":[68064,8064],"./es.js":[78709,8709],"./et.js":[18504,8504],"./eu.js":[27083,7083],"./fa.js":[69256,9256],"./fi.js":[57936,7936],"./fo.js":[58498,8498],"./fr-ca.js":[99296,9296],"./fr-ch.js":[86587,6587],"./fr.js":[34737,4737],"./fy.js":[39712,9712],"./ga.js":[10769,769],"./gd.js":[13162,3162],"./gl.js":[32018,2018],"./gom-latn.js":[84008,4008],"./gu.js":[39125,9125],"./he.js":[55534,5534],"./hi.js":[3386,3386],"./hr.js":[97207,7207],"./ht.js":[9209,9209],"./hu.js":[8382,8382],"./hy-am.js":[12435,2435],"./id.js":[13988,3988],"./is.js":[55785,5785],"./it-ch.js":[81680,1680],"./it.js":[13844,3844],"./ja.js":[82396,2396],"./jv.js":[30561,561],"./ka.js":[629,629],"./kk.js":[46151,6151],"./km.js":[14729,4729],"./kn.js":[3440,3440],"./ko.js":[16768,4387],"./ku.js":[87217,7217],"./ky.js":[99277,9277],"./lb.js":[31291,1291],"./lo.js":[74404,4404],"./lt.js":[93013,3013],"./lv.js":[33471,3471],"./me.js":[54195,4195],"./mi.js":[2143,2143],"./mk.js":[61045,1045],"./ml.js":[67208,7208],"./mn.js":[61318,1318],"./mr.js":[53938,3938],"./ms-my.js":[5606,5606],"./ms.js":[97978,5597],"./mt.js":[37664,7664],"./my.js":[86031,6031],"./nb.js":[23001,3001],"./ne.js":[16100,6100],"./nl-be.js":[96371,6371],"./nl.js":[62063,2063],"./nn.js":[65989,5989],"./oc-lnc.js":[43710,1329],"./pa-in.js":[50854,854],"./pl.js":[31593,1593],"./pt-br.js":[60960,960],"./pt.js":[31441,1441],"./rn.js":[77473,7473],"./ro.js":[89574,9574],"./ru.js":[2624,2624],"./rw.js":[54302,4302],"./sd.js":[30334,334],"./se.js":[60953,953],"./si.js":[83589,3589],"./sk.js":[49135,9135],"./sl.js":[86582,6582],"./sq.js":[4445,4445],"./sr-cyrl.js":[59541,9541],"./sr.js":[88756,8756],"./ss.js":[36487,6487],"./sv-fi.js":[41322,1322],"./sv.js":[77424,7424],"./sw.js":[68371,8371],"./ta.js":[28014,8014],"./te.js":[54402,4402],"./tet.js":[45142,5142],"./tg.js":[44628,4628],"./th.js":[20673,673],"./tk.js":[65160,5160],"./tl-ph.js":[32128,2128],"./tlh.js":[95260,2879],"./tr.js":[14243,4243],"./tzl.js":[50517,517],"./tzm-latn.js":[35060,5060],"./tzm.js":[58394,8394],"./ug-cn.js":[66517,6517],"./uk.js":[83165,3165],"./ur.js":[75018,5018],"./uz-latn.js":[57420,7420],"./uz.js":[33842,1461],"./vi.js":[88128,8128],"./x-pseudo.js":[52272,2272],"./yo.js":[12885,2885],"./zh-cn.js":[28223,8223],"./zh-hk.js":[99291,9291],"./zh-tw.js":[67203,7203],"./zh.js":[30471,471]};function r(e){if(!F.o(n,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return F.e(t[1]).then(()=>F.t(r,23))}r.keys=()=>Object.keys(n),r.id=39234,e.exports=r},42485:(e,t,F)=>{"use strict";F.d(t,{A:()=>r});var n=F(45073);let r=function(e){return function(t){var F=e.filter(function(e){return![n.X3.FILTER_MONOCHROME,n.X3.FILTER_NEW,n.X3.FILTER_RGB,n.X3.FILTER_UNTAGGED,n.X3.FILTER_RECENT,n.X3.FILTER_FAVOURITE,n.X3.FILTER_COMMENTS,n.X3.FILTER_USERNAME].includes(e)});return!F.length||!!t.tags.find(function(e){return F.includes(e)})}}},43301:(e,t,F)=>{var n={"./de.md":[83167,3167],"./en.md":[76871],"./fr.md":[32356,2356]};function r(e){if(!F.o(n,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return Promise.all(t.slice(1).map(F.e)).then(()=>F(r))}r.keys=()=>Object.keys(n),r.id=43301,e.exports=r},53749:(e,t,F)=>{"use strict";F.d(t,{A:()=>v,E:()=>p});var n=F(61975),r=F(22043),a=F(45377),i=F(71450),o=F(51638),l=F.n(o),s=F(20649),c=F(61251),u=F.n(c),d=F(12115),m=F(86072),h=F(50751),f=F(1108),p=function(e){var t=(0,r._)(e,3),F=t[0],n=t[1],a=t[2];return"#"+Math.min(255,Math.max(0,F)).toString(16).padStart(2,"0")+Math.min(255,Math.max(0,n)).toString(16).padStart(2,"0")+Math.min(255,Math.max(0,a)).toString(16).padStart(2,"0")},g=function(e,t){var F=.299*e[0]+.587*e[1]+.114*e[2],n=.299*t[0]+.587*t[1]+.114*t[2];return F>n?-1:+(F<n)};let v=function(){var e=(0,r._)((0,d.useState)(!1),2),t=e[0],F=e[1],o=(0,h.A)().setError,c=(0,m.A)(),p=c.setPickColors,v=c.cancelPickColors;return{onInputChange:function(e){var t=e.target;return(0,n._)(function(){var e,n,c,d,m;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(!(null==(e=t.files)?void 0:e[0]))return[3,2];return F(!0),[4,(0,f.A)(t.files[0],!0)];case 1:c=(n=i.sent()).imageData,d=n.fileName,m=l()(c.data,4).map(function(e){var t=(0,r._)(e,3);return[t[0],t[1],t[2]]}),s.clusterize(m,{k:6},function(e,t){if(e)o(e);else{var n=u()(m,4),i=(0,a._)(n?n.palette():[]).concat((0,a._)(t?t.map(function(e){var t=(0,r._)(e.centroid,3);return[Math.round(t[0]),Math.round(t[1]),Math.round(t[2])]}):[])).filter(function(e,t,F){return F.findIndex(function(t){return t.join(",")===e.join(",")})===t}).sort(g);i.length<4?(o(Error("Not enough colors to pick from!")),v()):p({colors:i,fileName:d})}F(!1)}),i.label=2;case 2:return t.value="",[2]}})})()},busy:t}}},53776:(e,t,F)=>{"use strict";F.d(t,{y:()=>n});var n={htmlInput:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1},inputLabel:{shrink:!0},fullWidth:!0,size:"small"}},60300:(e,t,F)=>{"use strict";F.d(t,{A:()=>E});var n=F(61975),r=F(82732),a=F(22043),i=F(45377),o=F(71450),l=F(20097),s=F(18955),c=F(12115),u=F(50751),d=F(72879),m=F(7451),h=F(94468),f=F(75036),p=function(e,t){return!!t.find(function(t){var F=t.hashes;return!!F&&Object.values(F).includes(e)})},g=function(e,t){return!!t.find(function(t){return t.hash===e})},v=function(e){var t=e.images,F=e.frames;return(0,n._)(function(){return(0,o.YH)(this,function(e){switch(e.label){case 0:return[4,(0,h.ZU)()];case 1:return e.sent(),[4,h.mU.keys()];case 2:return e.sent().forEach(function(e){p(e,t)||g(e,t)||(0,f.yH)(e)}),[4,h.Uv.keys()];case 3:return e.sent().forEach(function(e){F.find(function(t){return t.hash===e})||(0,f.t9)(e)}),[2]}})})()},x=function(e){return(0,n._)(function(){var t,F,n,r,a;return(0,o.YH)(this,function(i){switch(i.label){case 0:return[4,(0,h.ZU)()];case 1:return i.sent(),[4,h.mU.keys()];case 2:t=i.sent(),F=function(t){return!p(t,e)&&!g(t,e)},n=[],r=0,i.label=3;case 3:if(!(r<t.length))return[3,6];if(!(a=t[r]).startsWith("dummy")&&F(a)&&n.push(a),r%20!=0)return[3,5];return[4,(0,m.c)(0)];case 4:i.sent(),i.label=5;case 5:return r++,[3,3];case 6:return[2,n]}})})()},A=function(e){return(0,n._)(function(){var t,F,n,r,a;return(0,o.YH)(this,function(i){switch(i.label){case 0:return[4,(0,h.ZU)()];case 1:return i.sent(),[4,h.Uv.keys()];case 2:t=i.sent(),F=function(t){return!e.find(function(e){return e.hash===t})},n=[],r=0,i.label=3;case 3:if(!(r<t.length))return[3,6];if(!(a=t[r]).startsWith("dummy")&&F(a)&&n.push(a),r%20!=0)return[3,5];return[4,(0,m.c)(0)];case 4:i.sent(),i.label=5;case 5:return r++,[3,3];case 6:return[2,n]}})})()},b=F(17403),j=F(98050),y=F(81200),C=F(71667),I=function(e,t){return(0,n._)(function(){return(0,o.YH)(this,function(F){switch(F.label){case 0:return[4,(0,h.ZU)()];case 1:return F.sent(),[4,Promise.all(e.map(function(e){return(0,n._)(function(){var F;return(0,o.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,t.getItem(e)];case 1:if(!(F=n.sent()))return[2,null];return[4,(0,j.U)(F)];case 2:return[2,{hash:e,lines:n.sent().split("\n"),binary:F}];case 3:return n.sent(),[2,null];case 4:return[2]}})})()}))];case 2:return[2,F.sent().reduce(y.N,[])]}})})()};let E=function(){var e=(0,u.A)(),t=e.trashCount,F=e.showTrashCount,m=(0,d.h)(),f=m.frames,p=m.images,g=(0,u.A)(),j=g.updateTrashCount,E=g.setTrashBusy,w=(0,s.c3)("useTrashbin"),S=(0,c.useCallback)(function(){return(0,n._)(function(){var e,t,F;return(0,o.YH)(this,function(n){switch(n.label){case 0:return[4,x(p)];case 1:return[4,I(n.sent(),h.mU)];case 2:return e=n.sent(),t={},F={state:{images:e.map(function(e){try{return t[e.hash]=e.binary,{hash:e.hash,created:(0,C.J)(),title:w("backupExportImage",{hash:e.hash}),lines:e.lines.length,tags:["backup"],palette:"bw",framePalette:"bw",invertPalette:!1,invertFramePalette:!1,frame:""}}catch(e){return null}}).reduce(b.iy,[]),lastUpdateUTC:Math.floor(new Date().getTime()/1e3),version:d.A}},(0,l.saveAs)(new Blob((0,i._)(JSON.stringify((0,r._)({},F,t),null,2))),"backup_images.json"),[2]}})})()},[p,w]),_=(0,c.useCallback)(function(){return(0,n._)(function(){var e,t,F;return(0,o.YH)(this,function(n){switch(n.label){case 0:return[4,A(f)];case 1:return[4,I(n.sent(),h.Uv)];case 2:return e=n.sent(),t={},F={state:{frames:e.map(function(e,F){try{t["frame-".concat(e.hash)]=e.binary;var n=JSON.parse(e.lines[0]),r=n.upper.length+20*n.left.length+n.lower.length;return{hash:e.hash,lines:r,name:w("backupExportFrame",{hash:e.hash}),id:"bak".concat(F.toString(10).padStart(2,"0"))}}catch(e){return null}}).reduce(y.N,[]),frameGroups:[{id:"bak",name:w("reImportedTrashFrames")}],lastUpdateUTC:Math.floor(new Date().getTime()/1e3),version:d.A}},(0,l.saveAs)(new Blob((0,i._)(JSON.stringify((0,r._)({},F,t),null,2))),"backup_frames.json"),[2]}})})()},[w,f]),D=(0,c.useCallback)(function(){return(0,n._)(function(){var e,t,F;return(0,o.YH)(this,function(n){switch(n.label){case 0:return E(!0),[4,Promise.all([A(f),x(p)])];case 1:return t=(e=a._.apply(void 0,[n.sent(),2]))[0],F=e[1],j(t.length,F.length),E(!1),[2]}})})()},[f,p,E,j]),k=(0,c.useCallback)(function(){return(0,n._)(function(){return(0,o.YH)(this,function(e){switch(e.label){case 0:return[4,v({images:p,frames:f})];case 1:return e.sent(),F(!1),window.requestAnimationFrame(function(){D()}),[2]}})})()},[D,f,p,F]);return{showTrashCount:F,purgeTrash:k,downloadImages:S,downloadFrames:_,checkUpdateTrashCount:D,trashCount:t}}},62384:(e,t,F)=>{"use strict";F.d(t,{A:()=>r});var n=F(96569);let r=[{id:n.H.FRAMEMODE_KEEP,name:"frameModes.keepFrame"},{id:n.H.FRAMEMODE_CROP,name:"frameModes.cropFrame"},{id:n.H.FRAMEMODE_SQUARE_BLACK,name:"frameModes.squareBlack"},{id:n.H.FRAMEMODE_SQUARE_WHITE,name:"frameModes.squareWhite"}]},62431:(e,t,F)=>{"use strict";F.d(t,{A:()=>m});var n=F(87922),r=F(82732),a=F(45849),i=F(22043),o=F(18955),l=F(12115),s=F(73204),c=F(72879),u=F(15431),d=F(17403);let m=function(){var e=(0,u.A)(),t=e.sortPalettes,F=e.setSortPalettes,m=(0,c.h)().images,h=(0,o.c3)("usePaletteSort"),f=(0,l.useMemo)(function(){return[{label:h("defaultAsc"),value:s.V.DEFAULT_ASC},{label:h("defaultDesc"),value:s.V.DEFAULT_DESC},{label:h("usageAsc"),value:s.V.USAGE_ASC},{label:h("usageDesc"),value:s.V.USAGE_DESC},{label:h("nameAsc"),value:s.V.NAME_ASC},{label:h("nameDesc"),value:s.V.NAME_DESC}]},[h]),p=(0,l.useMemo)(function(){return m.reduce(function(e,t){return(0,d.pl)(t)?e:(0,a._)((0,r._)({},e),(0,n._)({},t.palette,(e[t.palette]||0)+1))},{})},[m]),g=(0,l.useCallback)(function(e,F){var n=(0,i._)(t.split("_"),2),r=n[0],a="asc"===n[1]?1:-1;switch(r){case"usage":var o=p[e.shortName]||0,l=p[F.shortName]||0;if(o<l)return -1*a;if(o>l)return a;return 0;case"name":return e.name.localeCompare(F.name)*a;default:return a}},[p,t]);return{sortPalettes:t,setSortPalettes:F,paletteSortOptions:f,paletteUsages:p,sortFn:g}}},66375:(e,t,F)=>{"use strict";F.d(t,{A:()=>l});var n=F(45377),r=F(36117),a=F.n(r),i=F(45073),o=F(17403);let l=function(e,t,F,r,l){var s=function(l){var s,c,u=e.reduce(function(e,t){return[i.X3.FILTER_MONOCHROME,i.X3.FILTER_NEW,i.X3.FILTER_RGB,i.X3.FILTER_UNTAGGED,i.X3.FILTER_RECENT,i.X3.FILTER_FAVOURITE,i.X3.FILTER_COMMENTS,i.X3.FILTER_USERNAME].includes(t)?(0,n._)(e).concat([t]):e},[]);if(u.length&&(u.includes(i.X3.FILTER_UNTAGGED)&&0!==l.tags.length||u.includes(i.X3.FILTER_NEW)&&a()(new Date(l.created)).unix()<=a()().subtract(1,"day").unix()||u.includes(i.X3.FILTER_RECENT)&&!r.map(function(e){return e.hash}).includes(l.hash)||u.includes(i.X3.FILTER_RGB)&&!(0,o.pl)(l)||u.includes(i.X3.FILTER_MONOCHROME)&&(0,o.pl)(l)||u.includes(i.X3.FILTER_FAVOURITE)&&!l.tags.includes(i.X3.FILTER_FAVOURITE)||u.includes(i.X3.FILTER_COMMENTS)&&!(null==(s=l.meta)?void 0:s.comment)||u.includes(i.X3.FILTER_USERNAME)&&!(null==(c=l.meta)?void 0:c.userName)))return!1;return(!F.length||"string"==typeof l.palette&&!!F.includes(l.palette))&&(!t.length||!!l.frame&&!!t.includes(l.frame))};return function(e){if(s(e))return!0;var t=l.find(function(t){return t.coverImage===e.hash})||null;return!!t&&t.allImages.some(s)}}},66803:(e,t,F)=>{"use strict";F.d(t,{d:()=>r});var n=F(45377),r=function(e,t){return e.reduce(function(e,F){var r,a;return t===(null==(a=RegExp("^(?<group>[a-z]+)(?<id>[0-9]+)","g").exec(F.id))||null==(r=a.groups)?void 0:r.group)?(0,n._)(e).concat([F]):e},[])}},68111:()=>{},68370:(e,t,F)=>{"use strict";F.d(t,{e:()=>r,p:()=>n});var n=function(e){return e.UP="up",e.DOWN="down",e}({}),r=function(e){return e.GIT="git",e.DROPBOX="dropbox",e.DROPBOXIMAGES="dropboximages",e}({})},74282:(e,t,F)=>{"use strict";F.d(t,{h:()=>r,O:()=>a});var n=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");var F=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),r=parseInt(t.slice(4,6),16);return"".concat(F,", ").concat(n,", ").concat(r)},r=function(e){return e.HARD="HARD",e.SMOOTH="SMOOTH",e.CONIC="CONIC",e}({}),a=function(e,t){var F=n(e[0]||"#000000"),r=n(e[1]||"#000000"),a=n(e[2]||"#000000"),i=n(e[3]||"#000000");switch(t){case"SMOOTH":return{backgroundImage:"linear-gradient(to right,\n          rgba(".concat(F,", ").concat(.25,") 0%,\n          rgba(").concat(r,", ").concat(.25,") 33.3%,\n          rgba(").concat(a,", ").concat(.25,") 66.6%,\n          rgba(").concat(i,", ").concat(.25,") 100%\n      )")};case"HARD":return{backgroundImage:"linear-gradient(to right,\n          rgb(".concat(F,") 0% 25%,\n          rgb(").concat(r,") 25% 50%,\n          rgb(").concat(a,") 50% 75%,\n          rgb(").concat(i,") 75% 100%\n        )")};case"CONIC":return{background:"conic-gradient(\n          rgb(".concat(F,") 0% 25%,\n          rgb(").concat(r,") 25% 50%,\n          rgb(").concat(a,") 50% 75%,\n          rgb(").concat(i,") 75% 100%\n        )")};default:return{}}}},76871:(e,t,F)=>{"use strict";F.r(t),F.d(t,{default:()=>n});let n="I could use your help to make this tool better!\n\nTo understand how people use it, I’d like to _collect anonymous usage statistics_ like:\n* how often the app is used\n* how many images are approximately stored\n* selected settings and their effects\n* where things might be slowing down.\n\nI’d also like to gather anonymous error reports, so if something goes wrong, I can spot common issues and fix them faster.\n\nNone of this data includes _any personal information_ or even the actual _content of your images_.  \nI just need some general info to help improve performance and reliability.\n\nWould you be okay with that? (_You can change your opinion later in the settings_)\n"},80904:(e,t,F)=>{"use strict";F.d(t,{_:()=>c});var n=F(61975),r=F(71450),a=F(90148),i=F(14217),o=F(75036),l=[0,256,1,257],s=function(e){for(var t=[],F=0;F<8;F+=1){for(var n=0,r=0;r<8;r+=1)n+=l[e[8*F+r]]<<7-r;t.push((n>>8).toString(16).padStart(2,"0"),(255&n).toString(16).padStart(2,"0"))}return t.join(" ").toUpperCase()},c=function(e){var t=e.bitmapQueue,F=e.dither,l=e.contrastBaseValues,c=e.importQueueAdd;t.forEach(function(e){var t=e.imageData,u=e.height,d=e.fileName,m=e.lastModified;return(0,n._)(function(){var e,n,h,f;return(0,r.YH)(this,function(r){switch(r.label){case 0:return e=Array.from((0,a.$)({imageData:t,contrastBaseValues:l,dither:F,colors:[{r:0,g:0,b:0},{r:1,g:0,b:0},{r:2,g:0,b:0},{r:3,g:0,b:0}]}).data).filter(function(e,t){return!(t%4)}),n=20*Math.ceil(u/8),h=function(t){var F=Math.floor(t/20),n=t%20*8,r=8*F;return Array(8).fill(null).map(function(t,F){return e.slice(n+(r+F)*160).slice(0,8)}).flat(1)},f=Array(n).fill(null).map(function(e,t){return h(t)}).map(s),[4,(0,o.cg)(f)];case 1:return c([{fileName:d,imageHash:r.sent().dataHash,tiles:f,lastModified:m,tempId:(0,i.z)()}]),[2]}})})()})}},81200:(e,t,F)=>{"use strict";F.d(t,{N:()=>r});var n=F(45377),r=function(e,t){return t?(0,n._)(e).concat([t]):e}},84470:(e,t,F)=>{"use strict";F.d(t,{S:()=>o});var n=F(45377),r=F(85773),a=F(66375),i=F(42485),o=function(e,t){var F=e.images,o=e.groups,l=t.filtersTags,s=t.filtersFrames,c=t.filtersPalettes,u=t.sortBy,d=t.recentImports;return(0,n._)(F).map(r.YZ).sort((0,r.PM)(u)).map(r.lt).filter((0,a.A)(l,s,c,d,o)).filter((0,i.A)(l))}},85773:(e,t,F)=>{"use strict";F.d(t,{PM:()=>l,YZ:()=>i,lt:()=>o});var n=F(82732),r=F(45849),a=F(22043),i=function(e,t){return(0,r._)((0,n._)({},e),{sortIndex:t})},o=function(e){return(0,r._)((0,n._)({},e),{sortIndex:void 0})},l=function(e){return function(t,F){if(!e)return 0;var n=(0,a._)(e.split("_"),2),r=n[0],i=n[1],o=t[r],l=F[r],s="desc"===i?-1:1;return o&&l?o>l?s:o<l?-s:t.sortIndex<F.sortIndex?s:-s:0}}},86539:(e,t,F)=>{"use strict";F.d(t,{t:()=>n,z:()=>r});var n="ROOT",r=function(e){return{id:n,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[],allImages:e}}},88676:(e,t,F)=>{"use strict";F.d(t,{A:()=>C});var n,r=F(87922),a=F(22043),i=F(45377),o=F(95155),l=F(90335),s=F(930),c=F(37941),u=F(64647),d=F(24288),m=F(41942),h=F(80317),f=F(18955),p=F(79452),g=F.n(p),v=F(12115),x=F(34731),A=F(15015),b=F(34476),j=F(15431),y=(n={},(0,r._)(n,A._Y.INACTIVE,"portDeviceTypes.inactiveDevice"),(0,r._)(n,A._Y.PACKET_CAPTURE,"portDeviceTypes.arduinoGameboyPrinterEmulator"),(0,r._)(n,A._Y.SUPER_PRINTER_INTERFACE,"portDeviceTypes.superPrinterInterface"),(0,r._)(n,A._Y.GBXCART,"portDeviceTypes.cartridgeReader"),n);let C=function(e){var t=e.inline,F=(0,b.Z)(),n=F.connectedDevices,r=F.webUSBEnabled,p=F.openWebUSB,C=F.webSerialEnabled,I=F.openWebSerial,E=F.unknownDeviceResponse,w=F.hasInactiveDevices,S=(0,j.A)().enableDebug,_=(0,f.c3)("ConnectSerial"),D=(0,a._)((0,v.useState)(!1),2),k=D[0],T=D[1],B=(0,v.useMemo)(function(){if(!E||!E.length)return[];var e=(0,i._)(E).some(function(e){return e<32&&9!==e&&10!==e&&13!==e});return[E.byteLength<50?(0,i._)(E).join(","):"",e?"":new TextDecoder().decode(E),g()((0,i._)(E))].filter(Boolean)},[E]);return(0,o.jsxs)(m.A,{direction:"column",gap:4,children:[(0,o.jsxs)(m.A,{direction:{xs:"column",md:t?"row":"column"},gap:4,sx:{"& > *":{flex:1}},children:[(0,o.jsx)(m.A,{direction:"column",gap:1,children:(0,o.jsx)(u.A,{title:_("openWebUSB"),onClick:p,disabled:!r,loadingPosition:"start",variant:"contained",color:"secondary",children:_("openWebUSB")})}),(0,o.jsx)(m.A,{direction:"column",gap:1,children:(0,o.jsx)(u.A,{title:_("openWebSerial"),onClick:I,disabled:!C,loadingPosition:"start",variant:"contained",color:"secondary",children:_("openWebSerial")})})]}),(0,o.jsx)(h.A,{variant:"body2",children:_("connectedDevices",{deviceCount:n.length})}),(0,o.jsx)(m.A,{component:"ul",direction:"column",gap:2,children:n.map(function(e){var F=e.id,n=e.portType,r=e.portDeviceType,a=e.description,i=n===A.qt.SERIAL?s.A:c.A;return(0,o.jsxs)(m.A,{gap:1,direction:"row",alignItems:"center",children:[(0,o.jsx)(i,{}),(0,o.jsxs)(m.A,{component:"li",direction:t?"row":"column",gap:2*!!t,alignItems:"baseline",children:[(0,o.jsx)(h.A,{variant:"body1",component:"span",children:_(y[r])}),(0,o.jsx)(h.A,{variant:"caption",component:"span",children:S?"".concat(a," - ").concat(F):a})]})]},F)})}),(0,o.jsx)(u.A,{title:_("showUnknownResponse"),onClick:function(){E&&T(!0)},disabled:!(w&&E),variant:"contained",color:"error",children:_("showUnknownResponse")}),(0,o.jsx)(x.A,{header:_("unknownDeviceInfo"),deny:function(){return T(!1)},open:k&&!!(null==E?void 0:E.length),children:(0,o.jsx)(m.A,{direction:"column",gap:2,children:B.map(function(e,t){return(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsx)(h.A,{children:e}),(0,o.jsx)(d.A,{onClick:function(){return navigator.clipboard.writeText(e)},title:_("copyToClipboard"),children:(0,o.jsx)(l.A,{})})]},t)})})})]})}},89386:(e,t,F)=>{"use strict";F.d(t,{Z:()=>a});var n=F(12115),r=F(96471),a=function(){return(0,n.useContext)(r.K)}},90148:(e,t,F)=>{"use strict";F.d(t,{q:()=>c,$:()=>s});let n=function(e,t){var F=(t-e)/16;return Array(16).fill(null).map(function(t,n){return Math.floor(e+F*n)})},r=function(e){var t="number"==typeof e[0]?e[0]:0,F="number"==typeof e[1]?e[1]:85,r="number"==typeof e[2]?e[2]:170,a="number"==typeof e[3]?e[3]:255;return[n(t,F),n(F,r),n(r,a)]},a=function(e){for(var t=e.baseValues,F=e.orderPatterns,n=[],r=0;r<4;r+=1){var a=[];n.push(a);for(var i=0;i<4;i+=1){var o=[];a.push(o);for(var l=0;l<3;l+=1)o.push(t[l][F[l][4*r+i]])}}return n};var i=[0,12,3,15,8,4,11,7,2,14,1,13,10,6,9,5],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,s=function(e){for(var t=e.imageData,F=e.contrastBaseValues,n=e.dither,s=e.colors,c=new ImageData(t.width,t.height),u=a({baseValues:r(F),orderPatterns:[n?i:o,n?i:o,n?i:o]}),d=t.width,m=t.data,h=0;h<m.length;h+=4){var f=l%d%4,p=Math.ceil(l/d)%4,g=m[h],v=void 0,x=u[f][p];v=g<=x[0]?s[3]:g<=x[1]?s[2]:g<=x[2]?s[1]:s[0],c.data[h]=v.r,c.data[h+1]=v.g,c.data[h+2]=v.b,c.data[h+3]=255,l+=1}return c},c=function(e){var t=e.targetCanvas,F=e.originalCanvas,n=e.imageData,r=e.palette,a=e.dither,i=e.contrastBaseValues,o=r.map(function(e){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}}),l=t.getContext("2d"),c=F.getContext("2d");if(!l||!c)return void console.error("canvas context is missing");l.putImageData(s({imageData:n,contrastBaseValues:i,dither:a,colors:o}),0,0),c.putImageData(n,0,0)}},91071:(e,t,F)=>{"use strict";F.d(t,{A:()=>a});var n=F(95155),r=F(41942);function a(e){var t=e.children;return(0,n.jsx)(r.A,{direction:"column",gap:1,sx:function(e){return{a:{color:e.palette.secondary.light,textDecorationColor:"currentColor","&:hover":{color:e.palette.secondary.main}},code:{fontFamily:"monospace"},ul:{listStyleType:"disc",paddingInlineStart:e.spacing(2)},em:{fontStyle:"italic"},"h1,h2,h3,h4,h5,h6,p":{mb:"0.25em"},"h1,h2,h3,h4,h5,h6":{mt:"1.25em"},"& > :first-child":{mt:0}}},children:t})}},96396:(e,t,F)=>{Promise.resolve().then(F.bind(F,3027))},96471:(e,t,F)=>{"use strict";F.d(t,{GalleryTreeContext:()=>h,K:()=>m});var n=F(22043),r=F(95155),a=F(81863),i=F(12115),o=F(25969),l=F(50751),s=F(72879),c=F(15431),u=F(86539),d="/gallery/",m=(0,i.createContext)({root:(0,u.z)([]),view:(0,u.z)([]),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(d,"?page=1")}});function h(e){var t=e.children,h=(0,s.h)(),f=h.imageGroups,p=h.images,g=h.setImageGroups,v=(0,n._)((0,i.useState)(!0),2),x=v[0],A=v[1],b=(0,n._)((0,i.useState)((0,u.z)(p)),2),j=b[0],y=b[1],C=(0,n._)((0,i.useState)([]),2),I=C[0],E=C[1],w=(0,n._)((0,i.useState)([]),2),S=w[0],_=w[1],D=(0,o.j)(),k=D.searchParams,T=D.pathname,B=(0,n._)((0,i.useState)(""),2),M=B[0],P=B[1],N=(0,c.A)().enableDebug,R=(0,l.A)().setError;(0,i.useEffect)(function(){var e=new Worker(F.tu(new URL(F.p+F.u(5647),F.b)),{type:void 0}),t=(0,a.LV)(e),n=[],r=(0,a.BX)(function(e){n.push(e)});return A(!0),t.calculate({imageGroups:f,stateImages:p},r).then(function(e){if(y(e.root),E(e.paths),_(e.pathsOptions),n.length&&R(Error(n.join("\n"))),f.length>e.paths.length){var t=e.paths.map(function(e){return e.group.id});g(f.filter(function(e){var F=e.id;return t.includes(F)}))}N&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),R(e)}).finally(function(){A(!1),e.terminate()}),function(){e.terminate(),A(!1)}},[N,f,R,g,p]);var O=(0,i.useMemo)(function(){var e;return parseInt(null!=(e=k.get("page"))?e:"1",10)-1},[k]),L=(0,i.useMemo)(function(){return k.get("group")||""},[k]),G=(0,i.useCallback)(function(e){var t="number"==typeof e.pageIndex?e.pageIndex:O,F="string"==typeof e.group?e.group:L,n="".concat(d,"?page=").concat(t+1);return F.length&&(n="".concat(n,"&group=").concat(encodeURIComponent(F))),n},[O,L]);(0,i.useEffect)(function(){T===d&&P(G({pageIndex:O,group:L}))},[L,O,T,G]);var H=(0,i.useMemo)(function(){var e,t=(null==(e=I.find(function(e){return e.absolutePath===L}))?void 0:e.group)||j,F=t.groups.map(function(e){return e.coverImage}),n=t.images.filter(function(e){return!F.includes(e.hash)});return{view:t,covers:F,paths:I,images:n,pathsOptions:S,root:j,isWorking:x,pageIndex:O,path:L,lastGalleryLink:M,getUrl:G}},[I,j,S,x,O,L,M,G]);return(0,r.jsx)(m.Provider,{value:H,children:t})}}},e=>{e.O(0,[6154,5867,8955,3632,317,2545,4120,9832,9452,5513,1703,4647,3683,3802,7164,2968,4615,9144,8428,7161,1870,7922,4455,1156,6685,8558,7182,5374,2781,2517,8883,8441,9342,1255,7358],()=>e(e.s=96396)),_N_E=e.O()}]);