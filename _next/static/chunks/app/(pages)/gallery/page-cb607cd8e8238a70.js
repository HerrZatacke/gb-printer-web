(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5991],{933:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var r,i=n(97004),a=n(39249),o=n(24463),s=function(e,t){var s,l,u,c,d=(s=(0,i._)(function(){var i;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(r)return[3,2];return[4,Promise.all([n.e(9268),n.e(7431),n.e(1575)]).then(n.bind(n,94979))];case 1:i=a.sent().dropBoxSyncTool,r=r||i(e,t),a.label=2;case 2:return[2,r]}})}),function(){return s.apply(this,arguments)});return o.A.getState().dropboxStorage.use&&d(),{recoverImageData:(l=(0,i._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().recoverImageData(e)]}})}),function(e){return l.apply(this,arguments)}),startAuth:(0,i._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return[2,e.sent().startAuth()]}})}),startSyncData:(u=(0,i._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().startSyncData(e)]}})}),function(e){return u.apply(this,arguments)}),startSyncImages:(0,i._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return[2,e.sent().startSyncImages()]}})}),updateSettings:(c=(0,i._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().updateSettings(e)]}})}),function(e){return c.apply(this,arguments)}),subscribe:function(){var e;return o.A.subscribe(function(e){return e.dropboxStorage},(e=(0,i._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return t.sent().updateSettings(e),[2]}})}),function(t){return e.apply(this,arguments)}))}}}},4021:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tC});var r=n(95155),i=n(700),a=n(17652),o=n(71803),s=n(12115),l=n(78538),u=n(28890),c=n(99125),d=n(78107),h=n(10431),f=n(3127),g=n(31960),p=n(6874),m=n.n(p),x=n(87025),v=n(4420),A=n(16324),I=n(26076),E=n(29890),j=n(15821),b=n(95939),w=n(7119),_=function(){var e=(0,b.Z)(),t=e.path,n=e.getUrl,r=e.root,i=e.paths,a=(0,w.g)(),o=a.getImagePageIndexInGroup,l=a.navigateToGroup;return{segments:(0,s.useMemo)(function(){var e=[""].concat((0,x._)(t.split("/").filter(Boolean))),a=e.reduce(function(t,n,r){return(0,x._)(t).concat([e.slice(1,r+1).join("/").concat("/")])},[]),s=a.reduce(function(e,t){var n;return(n="/"===t?{absolutePath:"",group:r}:i.find(function(e){return e.absolutePath===t}))?(0,x._)(e).concat([n]):e},[]),u=s.map(function(e,t){var r=s[t+1],i=0;return r&&(i=o(r.group.coverImage,e.group)),{group:e.group,link:n({pageIndex:i,group:e.absolutePath})}});return a.length!==u.length&&l(u[u.length-1].group.id,0),u},[t,r,i,n,o,l])}},C=n(55685);function y(e){var t=e.group,n=e.onClick,i=(0,w.g)().getGroupPath;return(0,r.jsx)(E.y,{itemId:t.id,label:(0,r.jsx)(g.A,{component:m(),href:i(t.id,0),onClick:n,sx:{display:"block"},children:t.title}),sx:function(e){return{"& > .MuiTreeItem-content.Mui-selected":{backgroundColor:(0,v.X4)(e.palette.secondary.main,.8),color:e.palette.secondary.contrastText,"&:hover,&.Mui-focused":{backgroundColor:e.palette.secondary.main}}}},children:t.groups.map(function(e){return(0,r.jsx)(y,{group:e,onClick:n},e.id)})})}let T=function(e){var t=e.open,n=e.onClose,i=(0,a.c3)("FolderTreeDialog"),o=(0,b.Z)(),u=o.pathsOptions,c=o.root,d=(0,w.g)().currentGroup,h=(0,A.A)(),f=_().segments,g=(0,l._)((0,s.useState)([]),2),p=g[0],m=g[1];return((0,s.useEffect)(function(){m(function(e){var t=f.map(function(e){return e.group.id});return(0,C.A)((0,x._)(t).concat((0,x._)(e)))})},[f]),u.length<2)?null:(0,r.jsx)(j.A,{contentHeight:"60vh",contentWidth:"auto",deny:n,open:t,header:i("dialogHeader"),keepMounted:!1,children:(0,r.jsx)(I.G,{expansionTrigger:"iconContainer",expandedItems:p,onExpandedItemsChange:function(e,t){return m(t)},selectedItems:d.id,sx:{width:h.breakpoints.values.sm,height:"60vh"},children:(0,r.jsx)(y,{group:c,onClick:n})})})};var P=n(3381);let S=function(){var e=(0,a.c3)("FolderBreadcrumb"),t=(0,b.Z)().pathsOptions,n=(0,P.A)().setEditImageGroup,i=_().segments,p=(0,l._)((0,s.useState)(!1),2),x=p[0],v=p[1];return t.length<2?null:(0,r.jsxs)(o.A,{direction:"row",gap:2,justifyContent:"space-between",alignItems:"center",children:[(0,r.jsx)(h.A,{children:i.map(function(t,i){var a,s=t.group,l=t.link;return(0,r.jsxs)(o.A,{direction:"row",gap:.5,alignItems:"center",children:[i>0?(0,r.jsx)(g.A,{component:m(),title:s.title,href:l,children:i?(a=s.title,a.length<30?a:"".concat(a.slice(0,30),"…")):(0,r.jsx)(c.A,{fontSize:"small"})}):(0,r.jsx)(f.A,{component:m(),title:s.title,href:l,sx:{fontSize:16},children:(0,r.jsx)(c.A,{fontSize:"inherit"})}),i>0&&(0,r.jsx)(f.A,{onClick:function(){return n({groupId:s.id})},title:e("editGroup",{title:s.title}),sx:{fontSize:16},children:(0,r.jsx)(u.A,{fontSize:"inherit"})})]},s.id)})}),(0,r.jsx)(f.A,{title:e("openNavigation"),onClick:function(){return v(!0)},children:(0,r.jsx)(d.A,{})}),(0,r.jsx)(T,{open:x,onClose:function(){return v(!1)}})]})};var k=n(84131),L=n(54581),G=n(78921),M=n(74666),F=n(19505),R=n(39489),D=n(85222),N=n(79710),W=n(76380),Y=n(61564);let V=function(e){var t=e.groupId,n=e.menuAnchor,i=e.onClose,o=(0,a.c3)("GalleryGroupContextMenu"),s=(0,Y.t)(),l=s.deleteGroup,c=s.editGroup;return n?(0,r.jsxs)(N.A,{open:!!n,anchorEl:n,onClose:i,onClick:function(e){e.stopPropagation(),i()},children:[(0,r.jsxs)(W.A,{onClick:function(){return c(t)},title:o("edit"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(u.A,{})}),(0,r.jsx)(D.A,{children:o("edit")})]}),(0,r.jsxs)(W.A,{onClick:function(){return l(t)},title:o("delete"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(F.A,{})}),(0,r.jsx)(D.A,{children:o("delete")})]})]}):null};var O=n(40082),B=n(41101),H=n(19864),X=function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())};let z=function(e){var t,n=e.tags,i=e.fromGroup,s=(0,a.c3)("TagsList"),l=[];if(i){var u=n.sort(X).filter(function(e){return!H.rx.includes(e)});t=u.slice(0,3),l=u.slice(3,-1)}else t=n;var c=i?"secondary":"tertiary";return(0,r.jsxs)(o.A,{component:"ul",direction:"row",gap:.66,flexWrap:"wrap",sx:function(e){return{"& .MuiChip-root":{fontSize:"0.75rem",height:e.spacing(2.5),padding:0}}},children:[t.sort(X).map(function(e){return(0,r.jsx)(B.A,{title:e===H.X3.FILTER_FAVOURITE?s("favourite"):e,label:e===H.X3.FILTER_FAVOURITE?"❤️":e,size:"small",color:c},e)}),l.length>0&&(0,r.jsx)(B.A,{variant:"outlined",title:s("moreTags",{count:l.length,tags:l.join("\n")}),label:s("moreTagsLabel",{count:l.length}),size:"small"})]})};var U=n(4862),Z=function(e){var t,n=(0,b.Z)(),r=n.paths,i=n.view.groups.find(function(t){return t.coverImage===e})||null,a=(null==(t=r.find(function(e){return e.group.id===(null==i?void 0:i.id)}))?void 0:t.absolutePath)||null;return{group:i,path:a}},K=n(5432),q=n(71620),$=n(11760),Q=n(52166),J=n(66785),ee=n(18335),et=n(86964),en=n(55364),er=function(e){var t=(0,P.A)().setEditImages,n=(0,Q.A)().pageSize,r=(0,q.A)(),i=r.filtersTags,a=r.filtersFrames,o=r.filtersPalettes,l=r.sortBy,u=r.recentImports,c=r.imageSelection,d=r.updateImageSelection,h=r.lastSelectedImage,f=r.setImageSelection,g=(0,$.h)(),p=g.palettes,m=g.images,x=c.indexOf(e),v=(0,s.useMemo)(function(){var t,n=m.find(function(t){return t.hash===e}),r=[];if(n){var i=(0,ee.s)(p,n),a=i.palette,o=i.framePalette,s=(0,et.f)(n),l=s.invertPalette,u=s.invertFramePalette;if(!a)throw Error("Palette missing?");return(0,en.pl)(n)?t=a:(t=(a||K.Fv).palette,r=(o||K.Fv).palette),{title:n.title,created:n.created,frame:n.frame,hashes:n.hashes||void 0,tags:n.tags,palette:t,framePalette:r,lockFrame:n.lockFrame,invertPalette:l,invertFramePalette:u,rotation:n.rotation,selectionIndex:x}}},[e,x,p,m]),A=(0,b.Z)(),I=A.view,E=A.covers;return{galleryImageData:v,updateImageSelection:(0,s.useCallback)(function(t,r,s){if(r){var c=(0,J.S)(I,{filtersTags:i,filtersFrames:a,filtersPalettes:o,sortBy:l,recentImports:u}).filter(function(e){return!E.includes(e.hash)}),g=c.findIndex(function(t){return t.hash===e}),p=c.findIndex(function(e){return e.hash===h});-1===p&&(p=s*n);var m=Math.min(p,g),x=Math.max(p,g);f(c.slice(m,x+1).map(function(e){return e.hash}))}else d(t,[e])},[E,a,o,i,e,h,n,u,f,l,d,I]),editImage:function(n){t({tags:n,batch:[e]})}}};let ei=function(e){var t=e.hash,n=(0,a.c3)("GalleryGroup"),i=(0,b.Z)().getUrl,o=Z(t),s=o.group,l=o.path,u=er(t).galleryImageData,c=(0,Q.A)().galleryView,d=[U.j.GALLERY_VIEW_SMALL,U.j.GALLERY_VIEW_1X].includes(c);if(!u||!s)return null;var h=u.hashes,f=u.palette,g=u.invertPalette,p=u.framePalette,x=u.frame,A=u.lockFrame,I=u.rotation;return(0,r.jsx)(M.A,{selectionText:"",title:s.title,subheader:n("itemCount",{count:s.allImages.length}),wrapperProps:{component:m(),href:i({group:l||"",pageIndex:0}),sx:{textDecoration:"none"}},contextMenuComponent:V,contextMenuProps:{groupId:s.id},media:(0,r.jsxs)(L.A,{sx:{position:"relative",margin:"0 auto","& > .MuiBox-root":{position:"absolute",top:0,img:{transform:"scale(0.5)"}}},children:[(0,r.jsx)(G.A,{viewBox:"0 0 24 21",color:"secondary",sx:function(e){return{width:"100%",height:"100%",fill:(0,v.au)(e.palette.secondary.main,e.palette.fgtext.main,.25)}},children:(0,r.jsx)("path",{d:"M 10,2 H 4 C 2.9,2 2.01,2.9 2.01,4 L 2,16 c 0,1.1 0.9,2 2,2 h 16 c 1.1,0 2,-0.9 2,-2 V 6 C 22,4.9 21.1,4 20,4 h -8 z"})}),(0,r.jsx)(O.A,{lockFrame:A,invertPalette:g,framePalette:p,palette:f,frameId:x,hash:t,hashes:h,rotation:I,asThumb:d})]}),content:s.tags.length>0&&(0,r.jsx)(z,{tags:s.tags,fromGroup:!0})})};var ea=n(693),eo=n(41387),es=n(40510),el=n(19983),eu=n(94059),ec=n(77904),ed=n(99901),eh=n(72478),ef=n(97482),eg=n(7642),ep=n(61487),em=n(70978),ex=n(14426),ev=n(6617);let eA=function(e){var t=e.pluginAnchor,n=e.hash,i=e.onClose,o=(0,a.c3)("PluginSelect"),s=(0,$.h)().plugins,l=(0,q.A)().imageSelection,u=(0,ev.h)(),c=u.runWithImage,d=u.runWithImages,h=function(e){n?c(e,n):d(e,l)};return(0,r.jsx)(N.A,{open:!!t,anchorEl:t,onClose:i,children:s.map(function(e){var t=e.url,n=e.name,a=e.description,s=e.loading,l=e.error;return(0,r.jsxs)(W.A,{disabled:!!(s||l),title:o("pluginTooltip",{description:l||a||"",url:t}),onClick:function(){i(),h(t)},children:[l&&(0,r.jsx)(em.A,{color:"warning"}),s&&(0,r.jsx)(ex.A,{color:"secondary",size:22}),n||t]},t)})})};var eI=n(75097),eE=n(97004),ej=n(39249),eb=n(53982),ew=n(5415),e_=n(28952),eC=n(5847);let ey=function(){var e,t,n=(0,Q.A)(),r=n.exportScaleFactors,i=n.exportFileTypes,a=n.handleExportFrame,o=n.fileNameStyle,l=(0,$.h)(),u=l.frames,c=l.palettes,d=l.images,h=(0,ew.j)(r,i,a,c,o);return{downloadSingleImage:(0,s.useCallback)((e=(0,eE._)(function(e){var t,n,r,i,a,s,l,f,g;return(0,ej.YH)(this,function(p){switch(p.label){case 0:if(!(t=d.find(function(t){return t.hash===e})))throw Error("image not found");if(n=u.find(function(e){return e.id===t.frame}),!(r=(0,ee.s)(c,t).palette))throw Error("imagePalette not found");return i=(0,e_.A)({image:t,palette:r,fileNameStyle:o}),[4,(0,eC.T)(d,u)(t.hash)];case 1:if(a=p.sent(),!n)return[3,3];return[4,(0,eb.mZ)(null==n?void 0:n.hash)];case 2:return l=p.sent(),[3,4];case 3:l=null,p.label=4;case 4:if(f=(s=l)?s.upper.length/20:2,!a)throw Error("no tiles");return[4,h(t)(a,f)];case 5:return g=p.sent(),[2,(0,ew.R)(i)(g)]}})}),function(t){return e.apply(this,arguments)}),[o,u,d,c,h]),downloadImageCollection:(0,s.useCallback)((t=(0,eE._)(function(e){var t,n;return(0,ej.YH)(this,function(r){switch(r.label){case 0:var i;return t=(0,e_.A)({altTitle:"gameboy-printer-gallery",useCurrentDate:!0,fileNameStyle:o}),[4,Promise.all(e.map((i=(0,eE._)(function(e){var t,n,r,i,a,o;return(0,ej.YH)(this,function(s){switch(s.label){case 0:if(!(t=d.find(function(t){return t.hash===e})))throw Error("image not found");return n=u.find(function(e){return e.id===t.frame}),[4,(0,eC.T)(d,u)(t.hash)];case 1:if(r=s.sent(),!n)return[3,3];return[4,(0,eb.mZ)(null==n?void 0:n.hash)];case 2:return a=s.sent(),[3,4];case 3:a=null,s.label=4;case 4:return o=(i=a)?i.upper.length/20:2,[2,h(t)(r||[],o)]}})}),function(e){return i.apply(this,arguments)})))];case 1:return n=r.sent(),(0,ew.R)(t)(n.flat()),[2]}})}),function(e){return t.apply(this,arguments)}),[o,u,d,h])}};var eT=n(633),eP=n(41186),eS=n(46498);let ek=function(e){var t=(0,a.c3)("useBatchButtons"),n=(0,q.A)(),r=n.imageSelection,i=n.sortBy,o=n.filtersTags,l=n.filtersPalettes,u=n.filtersFrames,c=n.recentImports,d=n.setFiltersVisible,h=n.setSortOptionsVisible,f=n.setImageSelection,g=(0,$.h)(),p=g.plugins,m=g.images,v=(0,Q.A)().pageSize,A=(0,P.A)(),I=A.setEditImages,E=A.setEditRGBNImages,j=(0,eP.A)(),w=j.dismissDialog,_=j.setDialog,y=(0,eS.A)().setVideoSelection,T=ey().downloadImageCollection,S=(0,eT.g)().deleteImages,k=(0,b.Z)(),L=k.view,G=k.covers,M=e*v,F=(0,s.useMemo)(function(){return(0,J.S)(L,{sortBy:i,filtersTags:o,filtersFrames:u,filtersPalettes:l,recentImports:c}).splice(M,v||1/0).filter(function(e){return!G.includes(e.hash)})},[G,u,l,o,M,v,c,i,L]),R=(0,s.useMemo)(function(){return F.filter(function(e){var t=e.hash;return r.includes(t)})},[F,r]),D=R.reduce(en.iy,[]),N=(0,s.useMemo)(function(){return r.reduce(function(e,t){var n=m.find(function(e){return e.hash===t});return n?[n].concat((0,x._)(e)):e},[])},[r,m]),W=r.length,Y=R.length>0;return{hasPlugins:!!p.length,batchEnabled:!!r.length,monochromeBatchEnabled:R.length>1&&D.length===R.length,activeFilters:o.length+l.length+u.length,selectedImageCount:W,hasSelected:Y,batchTask:function(e){if(r.length)switch(e){case eI.x6.DELETE:_({message:t("deleteConfirmation",{count:r.length}),confirm:(0,eE._)(function(){return(0,ej.YH)(this,function(e){return S(r),[2]})}),deny:(0,eE._)(function(){return(0,ej.YH)(this,function(e){return[2,w(0)]})})});break;case eI.x6.ANIMATE:y(r);break;case eI.x6.DOWNLOAD:T(r);break;case eI.x6.EDIT:I({tags:(0,C.A)(N.map(function(e){return e.tags}).flat()),batch:N.map(function(e){return e.hash})});break;case eI.x6.RGB:E(N.reduce(en.iy,[]).map(function(e){return e.hash}))}},checkAll:function(){f(F.map(function(e){return e.hash}))},unCheckAll:function(){return f([])},filter:function(){return d(!0)},showSortOptions:function(){return h(!0)}}};var eL=[eI.x6.DOWNLOAD,eI.x6.DELETE,eI.x6.EDIT,eI.x6.ANIMATE],eG=[eI.x6.RGB],eM=function(e){switch(e){case eI.x6.DELETE:return"batchActions.delete";case eI.x6.ANIMATE:return"batchActions.animate";case eI.x6.DOWNLOAD:return"batchActions.download";case eI.x6.EDIT:return"batchActions.edit";case eI.x6.RGB:return"batchActions.rgb";default:return""}},eF=function(e){switch(e){case eI.x6.DELETE:return(0,r.jsx)(F.A,{});case eI.x6.ANIMATE:return(0,r.jsx)(ec.A,{});case eI.x6.DOWNLOAD:return(0,r.jsx)(es.A,{});case eI.x6.EDIT:return(0,r.jsx)(u.A,{});case eI.x6.RGB:return(0,r.jsx)(ed.A,{});default:return null}};let eR=function(e){var t=e.page,n=(0,a.c3)("BatchButtons"),i=ek(t),o=i.hasPlugins,u=i.batchEnabled,c=i.monochromeBatchEnabled,d=i.activeFilters,h=i.selectedImageCount,f=i.hasSelected,g=i.batchTask,p=i.checkAll,m=i.unCheckAll,x=i.filter,v=i.showSortOptions,A=(0,l._)((0,s.useState)(null),2),I=A[0],E=A[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ep.A,{color:"tertiary",variant:"contained",sx:{"& .MuiButton-root":{width:40,height:40}},disableElevation:!0,children:[(0,r.jsx)(eg.A,{onClick:v,title:n("manageSorting"),children:(0,r.jsx)(eh.A,{})}),(0,r.jsx)(eg.A,{onClick:x,title:n("manageFilters"),children:(0,r.jsx)(ef.A,{badgeContent:d,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(eu.A,{})})}),(0,r.jsx)(eg.A,{onClick:f?m:p,title:f?n("uncheckAll"):n("checkAll"),children:(0,r.jsx)(ef.A,{badgeContent:h,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(eo.A,{})})}),eL.map(function(e){return(0,r.jsx)(eg.A,{disabled:!u,onClick:function(){return g(e)},title:n(eM(e)),children:eF(e)},e)}),eG.map(function(e){return(0,r.jsx)(eg.A,{disabled:!c,onClick:function(){return g(e)},title:n(eM(e)),children:eF(e)},e)}),o?(0,r.jsx)(eg.A,{onClick:function(e){E(e.target)},title:n("usePlugin"),children:(0,r.jsx)(el.A,{})}):null]}),(0,r.jsx)(eA,{pluginAnchor:I,onClose:function(){return E(null)}})]})};var eD=n(53664);let eN=function(e){var t=e.isBottom,n=e.page,i=e.isSticky;return(0,r.jsxs)(o.A,{direction:{xs:"column",md:"row"},alignItems:"center",gap:2,justifyContent:"space-between",sx:function(e){return(0,ea._)({zIndex:20,backgroundColor:e.palette.background.default},i?{position:"sticky",top:"var(--navigation-height)",py:1,mx:-1}:{},t?{"@media (max-height: 900px)":{display:"none"}}:{})},children:[(0,r.jsx)(eD.A,{}),(0,r.jsx)(eR,{page:n})]})};var eW=n(30832),eY=n.n(eW),eV=n(99124),eO=n.n(eV),eB=n(31936),eH=n(71495),eX=n(6295),ez=n(21740),eU=n(51746),eZ=n(52260),eK=n(82170),eq=n(27013),e$=n(16481),eQ=n(39630);let eJ=function(){var e,t=(0,Q.A)(),n=t.exportScaleFactors,r=t.exportFileTypes,i=t.handleExportFrame,a=t.fileNameStyle,o=(0,$.h)(),l=o.frames,u=o.palettes,c=o.images;return{shareImage:(0,s.useCallback)((e=(0,eE._)(function(e){var t,o,s,d,h,f,g,p,m,v,A,I,E;return(0,ej.YH)(this,function(j){switch(j.label){case 0:if(!(t=c.find(function(t){return e===t.hash})))throw Error("image not found");return o=l.find(function(e){return e.id===t.frame}),s=(0,x._)(n).pop()||4,d=(0,x._)(r).pop()||"png",h=(0,ew.j)([s],[d],i,u,a),[4,(0,eC.T)(c,l)(t.hash)];case 1:if(f=j.sent(),!o)return[3,3];return[4,(0,eb.mZ)(null==o?void 0:o.hash)];case 2:return p=j.sent(),[3,4];case 3:p=null,j.label=4;case 4:return m=(g=p)?g.upper.length/20:2,[4,h(t)(f||[],m)];case 5:return A=(v=j.sent()[0]).blob,I=v.filename,E=v.title,window.navigator.share&&window.navigator.share({files:[new File([A],I,{type:"image/png",lastModified:Date.now()})],title:E}).catch(function(){return"\xaf\\_(ツ)_/\xaf"}),[2]}})}),function(t){return e.apply(this,arguments)}),[r,n,a,l,i,c,u])}};var e0=null,e1=function(){if(null===e0)try{e0=window.navigator.canShare({files:[new File([new Blob(["t","e","s","t"])],"test.txt",{type:"text/plain",lastModified:Date.now()})]})}catch(e){e0=!1}return e0||!1},e2=function(e){var t=(0,a.c3)("useGalleryImageContext"),n=(0,q.A)(),r=n.imageSelection,i=n.updateImageSelection,o=n.filtersTags,l=n.filtersFrames,u=n.filtersPalettes,c=n.sortBy,d=n.recentImports,h=(0,eS.A)().setLightboxImage,f=(0,$.h)(),g=f.plugins,p=f.updateImageFavouriteTag,m=(0,b.Z)(),x=m.view,v=m.covers,A=(0,P.A)().setEditImages,I=(0,eP.A)(),E=I.dismissDialog,j=I.setDialog,w=(0,eT.g)(),_=w.updateLastSyncLocalNow,C=w.deleteImages,y=ey().downloadSingleImage,T=eJ().shareImage,S=(0,$.h)().images,k=(0,s.useMemo)(function(){return S.find(function(t){return t.hash===e})},[e,S]),L=r.includes(e);return{hasPlugins:!!g.length,isSelected:L,hasHashes:!!(null==k?void 0:k.hashes),isFavourite:(null==k?void 0:k.tags.includes(H.X3.FILTER_FAVOURITE))||!1,hasMeta:!!(null==k?void 0:k.meta),canShare:e1(),startDownload:function(){return y(e)},deleteImage:function(){j({message:t("deleteImage",{title:(null==k?void 0:k.title)||"NO_TITLE"}),confirm:(0,eE._)(function(){return(0,ej.YH)(this,function(t){return C([e]),[2]})}),deny:(0,eE._)(function(){return(0,ej.YH)(this,function(e){return[2,E(0)]})})})},shareImage:function(){return T(e)},showMetadata:function(){j({message:t("metaInfo",{title:(null==k?void 0:k.title)||"NO_TITLE"}),questions:function(){return[{key:"meta",type:eQ.V.META,label:"",meta:{hash:e,hashes:(null==k?void 0:k.hashes)||void 0,meta:(null==k?void 0:k.meta)||void 0}}]},confirm:(0,eE._)(function(){return(0,ej.YH)(this,function(e){return[2,E(0)]})})})},updateImageToSelection:function(t){i(t,[e])},setLightboxImage:function(){h((0,J.S)(x,{filtersTags:o,filtersFrames:l,filtersPalettes:u,sortBy:c,recentImports:d}).filter(function(e){return!v.includes(e.hash)}).findIndex(function(t){return e===t.hash}))},updateFavouriteTag:function(t){p(t,e),_()},editImage:function(){A({tags:(null==k?void 0:k.tags)||[],batch:[e]})}}},e5=n(7062),e3=n(9718),e4=n(32521),e6=n(41476),e9=function(){var e,t,n=(0,e4.Z)().connectedDevices,r=(0,$.h)(),i=r.images,a=r.frames,o=(0,eS.A)().setError,l=(0,e6.A)(),u=l.setProgress,c=l.startProgress,d=l.stopProgress,h=(0,s.useCallback)((e=(0,eE._)(function(e){var t;return(0,ej.YH)(this,function(n){switch(n.label){case 0:return[4,(0,eC.T)(i,a)(e,!0)];case 1:if((t=n.sent()).length)return[2,t];return[2,[]]}})}),function(t){return e.apply(this,arguments)}),[a,i]),f=(0,s.useMemo)(function(){var e=n.find(function(e){return e.portDeviceType===e3._Y.SUPER_PRINTER_INTERFACE});return e?e.device:null},[n]),g=(0,s.useMemo)(function(){return!!f},[f]),p=(0,s.useCallback)((t=(0,eE._)(function(e){var t;return(0,ej.YH)(this,function(n){switch(n.label){case 0:if(!g||!f)return[2];return[4,h(e)];case 1:var r;return t=n.sent(),[4,f.setup((0,e5.BX)({setProgress:u,startProgress:(r=(0,eE._)(function(e){return(0,ej.YH)(this,function(t){return[2,c(e)]})}),function(e){return r.apply(this,arguments)}),stopProgress:d,setError:function(e){o(Error(e))}}))];case 2:return n.sent(),[4,f.printImage(t)];case 3:return n.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),[g,h,f,o,u,c,d]);return{canPrint:g,print:p}};let e7=function(e){var t=e.hash,n=e.menuAnchor,i=e.onClose,o=(0,a.c3)("GalleryImageContextMenu"),c=(0,l._)((0,s.useState)(null),2),d=c[0],h=c[1],f=e2(t),g=f.canShare,p=f.isSelected,m=f.hasPlugins,x=f.isFavourite,v=f.hasMeta,A=f.hasHashes,I=f.deleteImage,E=f.setLightboxImage,j=f.shareImage,b=f.startDownload,w=f.showMetadata,_=f.updateImageToSelection,C=f.updateFavouriteTag,y=f.editImage,T=e9(),P=T.canPrint,S=T.print,k=(0,Y.t)().createGroup;return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(N.A,{open:!!n,anchorEl:n,onClose:i,onClick:function(e){e.stopPropagation()},children:[(0,r.jsxs)(W.A,{onClick:function(){y(),i()},title:o("edit"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(u.A,{})}),(0,r.jsx)(D.A,{children:o("edit")})]}),(0,r.jsxs)(W.A,{onClick:function(){b(),i()},title:o("download"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(es.A,{})}),(0,r.jsx)(D.A,{children:o("download")})]}),(0,r.jsxs)(W.A,{onClick:function(){I(),i()},title:o("delete"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(F.A,{})}),(0,r.jsx)(D.A,{children:o("delete")})]}),(0,r.jsxs)(W.A,{onClick:function(){E(),i()},title:o("viewInLightbox"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(eK.A,{})}),(0,r.jsx)(D.A,{children:o("viewInLightbox")})]}),P&&(0,r.jsxs)(W.A,{onClick:function(){S(t),i()},title:o("printViaSuperPrinter"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(eq.A,{})}),(0,r.jsx)(D.A,{children:o("printViaSuperPrinter")})]}),m?(0,r.jsxs)(W.A,{onClick:function(e){h(e.target)},title:o("usePlugin"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(el.A,{})}),(0,r.jsx)(D.A,{children:o("usePlugin")})]}):null,g?(0,r.jsxs)(W.A,{onClick:function(){j(),i()},title:o("share"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(e$.A,{})}),(0,r.jsx)(D.A,{children:o("share")})]}):null,(0,r.jsxs)(W.A,{onClick:function(){C(!x),i()},title:o(x?"removeFromFavourites":"addToFavourites"),children:[(0,r.jsx)(R.A,{children:x?(0,r.jsx)(eZ.A,{}):(0,r.jsx)(eU.A,{})}),(0,r.jsx)(D.A,{children:o(x?"removeFromFavourites":"addToFavourites")})]}),(0,r.jsxs)(W.A,{onClick:function(){_(p?q.N.REMOVE:q.N.ADD),i()},title:o(p?"removeFromSelection":"addToSelection"),children:[(0,r.jsx)(R.A,{children:p?(0,r.jsx)(eH.A,{}):(0,r.jsx)(eo.A,{})}),(0,r.jsx)(D.A,{children:o(p?"removeFromSelection":"addToSelection")})]}),(v||A)&&(0,r.jsxs)(W.A,{onClick:function(){w(),i()},title:o("showMetadata"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(eX.A,{})}),(0,r.jsx)(D.A,{children:o("showMetadata")})]}),p&&(0,r.jsxs)(W.A,{onClick:function(){k(t),i()},title:o("createGroup"),children:[(0,r.jsx)(R.A,{children:(0,r.jsx)(ez.A,{})}),(0,r.jsx)(D.A,{children:o("createGroup")})]})]}),(0,r.jsx)(eA,{pluginAnchor:d,hash:t,onClose:function(){h(null),i()}})]}):null};var e8=n(80498),te=n(85812);eY().extend(eO());let tt=function(e){var t=e.page,n=e.hash,i=(0,Q.A)(),a=i.enableDebug,o=i.galleryClickAction,l=er(n),u=l.galleryImageData,c=l.updateImageSelection,d=e2(n),h=d.setLightboxImage,f=d.editImage,g=(0,te.N)().formatterGallery,p=(0,s.useMemo)(function(){return[n].concat((0,x._)((null==u?void 0:u.hashes)?Object.keys(u.hashes).map(function(e){var t;return"".concat(e.toUpperCase(),": ").concat(null==(t=u.hashes)?void 0:t[e])}):[])).filter(Boolean).join("\n")},[u,n]),m=(0,s.useCallback)(function(e){c((null==u?void 0:u.selectionIndex)!==-1?q.N.REMOVE:q.N.ADD,e,t)},[u,t,c]),v=(0,s.useCallback)(function(e){if(e.preventDefault(),e.ctrlKey||e.shiftKey)return void m(e.shiftKey);switch(o){case e8.n.VIEW:h();break;case e8.n.EDIT:f();break;case e8.n.SELECT:default:m(e.shiftKey)}},[f,o,h,m]);if(!u)return null;var A=u.created,I=u.hashes,E=u.palette,j=u.invertPalette,b=u.invertFramePalette,w=u.framePalette,_=u.frame,C=u.lockFrame,y=u.title,T=u.tags,P=u.selectionIndex,S=u.rotation;return(0,r.jsx)(M.A,{selectionText:-1!==P?(P+1).toString(10):"",title:y,subheader:g(A),wrapperProps:{onClick:v,disableRipple:!0,sx:{display:"block",width:"100%",textAlign:"left"}},contextMenuComponent:e7,contextMenuProps:{hash:n},media:(0,r.jsx)(O.A,{lockFrame:C,invertPalette:j,palette:E,framePalette:w,invertFramePalette:b,frameId:_,hash:n,hashes:I,rotation:S}),content:(T.length>0||p&&a)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{tags:T}),(0,r.jsx)(eB.A,{text:p})]})})},tn=function(e){var t=(0,a.c3)("GalleryNumbers"),n=[t("imageCount",{count:e.imageCount})];return e.filteredCount&&n.push(t("filteredCount",{count:e.filteredCount})),e.selectedCount&&n.push(t("selectedCount",{count:e.selectedCount})),(0,r.jsx)(i.A,{component:"h2",variant:"caption",children:n.join(t("separator"))})};var tr=n(79543),ti=n(7585),ta=n(19690),to=n(78442),ts=n(93595),tl=n(78321);let tu=function(e){var t=(0,a.c3)("PaginationButton"),n=(0,b.Z)().getUrl;return(0,r.jsx)(eg.A,{component:e.disabled?"span":m(),disabled:e.disabled,href:n({pageIndex:e.page}),title:t("toPage",{page:e.page+1}),children:e.children})},tc=function(e){var t=e.page,n=e.maxPageIndex,s=(0,a.c3)("Pagination");if(0===n)return null;var l=[{icon:(0,r.jsx)(ti.A,{}),pageIndex:t-1,disabled:t<1},null,{icon:(0,r.jsx)(ta.A,{}),pageIndex:t+1,disabled:n<t+1}];return n>5&&(l.unshift({icon:(0,r.jsx)(to.A,{}),pageIndex:t-5,disabled:t<5}),l.push({icon:(0,r.jsx)(ts.A,{}),pageIndex:t+5,disabled:n<t+5})),n>1&&(l.unshift({icon:(0,r.jsx)(tr.A,{}),pageIndex:0,disabled:0===t}),l.push({icon:(0,r.jsx)(tl.A,{}),pageIndex:n,disabled:t===n})),(0,r.jsx)(o.A,{direction:"row",justifyContent:"space-around",children:(0,r.jsx)(ep.A,{color:"tertiary",variant:"contained",disableElevation:!0,sx:{"& .MuiButton-root":{width:40,height:40}},children:l.map(function(e){if(!e)return(0,r.jsx)(i.A,{component:"span",variant:"body1",sx:{px:2,display:"flex",alignItems:"center"},children:s("pageCount",{current:t+1,total:n+1})},"current");var a=e.icon,o=e.pageIndex,l=e.disabled;return(0,r.jsx)(tu,{page:o,disabled:l,children:a},o)})})})};var td=n(77262),th=n(64101),tf=n.n(th),tg=n(87031),tp=(0,tg.A)("percentage",tg.U.DESC),tm=function(){var e=0;for(var t in localStorage)if(localStorage.hasOwnProperty(t)){var n=localStorage.getItem(t);null!==n&&(e+=t.length+n.length)}return e},tx=function(){var e="__test_localStorage_limit__",t=0,n=0xf00000,r=0;try{for(;t<=n;){var i=Math.floor((t+n)/2),a="A".repeat(i);try{localStorage.setItem(e,a),r=i,t=i+1}catch(e){n=i-1}}}finally{localStorage.removeItem(e)}return r},tv=function(){var e=(0,l._)((0,s.useState)([]),2),t=e[0],n=e[1];return(0,s.useEffect)(function(){window.setTimeout((0,eE._)(function(){var e,t,r,i;return(0,ej.YH)(this,function(a){switch(a.label){case 0:return[4,null==(e=navigator.storage)?void 0:e.estimate()];case 1:return t=a.sent()||null,n([{type:"localStorage",total:i=(r=tm())+tx(),used:r,percentage:Math.ceil(r/i*100)},{type:"indexedDB",total:(null==t?void 0:t.quota)||0,used:(null==t?void 0:t.usage)||0,percentage:Math.ceil(i?((null==t?void 0:t.usage)||0)/((null==t?void 0:t.quota)||1)*100:100)}]),[2]}})}),10)},[]),{storageEstimate:tp(t.filter(function(e){return e.percentage>75}))[0]||null}};let tA=function(){var e=(0,a.c3)("StorageWarning"),t=tv().storageEstimate;if(!t)return null;var n=e("storageTypes.".concat(t.type));return(0,r.jsxs)(L.A,{title:e("usageTooltip",{used:tf()(t.used)||"",total:tf()(t.total)||""}),sx:{position:"relative"},children:[(0,r.jsx)(td.A,{variant:"determinate",value:t.percentage,sx:{width:"100%",height:"34px"},color:"error"}),(0,r.jsx)(i.A,{variant:"body2",color:"fgtext",sx:{position:"absolute",p:1,top:0},children:e("usageWarning",{percentage:t.percentage,type:n})})]})};var tI=n(35695),tE=n(77840),tj=n(12360);let tb=function(e,t,n,r,i){var a=e.images,o=e.groups;return(0,x._)(a).filter((0,tE.A)(t,n,r,i,o)).filter((0,tj.A)(t)).length};var tw=function(){var e=(0,b.Z)(),t=e.pageIndex,n=e.getUrl,r=e.view,i=e.covers,a=e.isWorking,o=(0,Q.A)().pageSize,l=(0,q.A)(),u=l.imageSelection,c=l.filtersTags,d=l.filtersPalettes,h=l.filtersFrames,f=l.recentImports,g=l.sortBy,p=(0,$.h)().images.length,m=tb(r,c,h,d,f),x=o?Math.ceil(r.images.length/o):1,v=Math.max(0,Math.min(t,Math.max(0,x-1)));x>0&&v!==t&&(0,tI.redirect)(n({pageIndex:v}));var A=v*o,I=u.length,E=(0,s.useMemo)(function(){return(0,J.S)(r,{filtersTags:c,filtersFrames:h,filtersPalettes:d,recentImports:f,sortBy:g}).splice(A,o||1/0)},[h,d,c,A,o,f,g,r]);return{totalImageCount:p,selectedCount:I,filteredCount:m,page:v,maxPageIndex:(0,s.useMemo)(function(){return o?Math.ceil(tb(r,c,h,d,f)/o)-1:0},[h,d,c,o,f,r]),images:E,covers:i,isWorking:a}};let t_=function(){var e=tw(),t=e.totalImageCount,n=e.selectedCount,i=e.filteredCount,a=e.page,s=e.maxPageIndex,l=e.images,u=e.covers,c=e.isWorking;return(0,r.jsxs)(o.A,{direction:"column",gap:2,children:[(0,r.jsx)(tA,{}),(0,r.jsx)(tn,{imageCount:t,selectedCount:n,filteredCount:i}),(0,r.jsx)(S,{}),(0,r.jsx)(eN,{page:a,isSticky:!0}),s>0&&(0,r.jsx)(tc,{page:a,maxPageIndex:s}),(0,r.jsx)(k.A,{showLoader:c,children:l.map(function(e){return u.includes(e.hash)?(0,r.jsx)(ei,{hash:e.hash},e.hash):(0,r.jsx)(tt,{hash:e.hash,page:a},e.hash)})}),l.length>=3&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tc,{page:a,maxPageIndex:s}),(0,r.jsx)(eN,{page:a,isBottom:!0})]})]})};function tC(){var e=(0,a.c3)("Navigation");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{component:"h1",variant:"h1",children:e("gallery")}),(0,r.jsx)(t_,{})]})}},6617:(e,t,n)=>{"use strict";n.d(t,{h:()=>s,i:()=>o});var r=n(97004),i=n(39249),a=n(12115),o=(0,a.createContext)({runWithImage:(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})}),runWithImages:(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})}),validateAndAddPlugin:(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})})}),s=function(){return(0,a.useContext)(o)}},9718:(e,t,n)=>{"use strict";n.d(t,{_Y:()=>i,k4:()=>a,qt:()=>r});var r=function(e){return e.USB="USB",e.SERIAL="SERIAL",e}({}),i=function(e){return e.INACTIVE="inactive",e.PACKET_CAPTURE="packet_capture",e.SUPER_PRINTER_INTERFACE="super_printer_interface",e.GBXCART="gbxcart",e}({}),a=[{vendorId:9025,productId:32822},{vendorId:9025,productId:32823},{vendorId:9025,productId:32845},{vendorId:9025,productId:32846},{vendorId:9025,productId:32847},{vendorId:9025,productId:32848},{vendorId:9025,productId:32850},{vendorId:9025,productId:32851},{vendorId:9025,productId:32852},{vendorId:9025,productId:32853},{vendorId:9025,productId:32854},{vendorId:9025,productId:32855},{vendorId:9114}]},15821:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var r=n(78538),i=n(44054),a=n(95155),o=n(69242),s=n(54581),l=n(7642),u=n(36114),c=n(71977),d=n(99927),h=n(54492),f=n(3127),g=n(16324),p=n(27943),m=n(17652),x=n(12115);let v=function(e){var t=e.confirm,n=e.canConfirm,r=e.deny;(0,x.useEffect)(function(){var e=function(e){"Escape"===e.key&&r&&r(),"Enter"===e.key&&e.ctrlKey&&t&&n&&t()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,n,r])};var A=function(e,t,n,r){var a={};if(r?(a.padding="8px !important",a.overflowX="hidden",a.overflowY="hidden"):(a.scrollbarGutter="stable",a.overflowY="scroll"),n)return a;switch(void 0===t?"undefined":(0,i._)(t)){case"string":a.height=t;break;case"number":a.height="".concat(t,"px")}switch(void 0===e?"undefined":(0,i._)(e)){case"string":a.width=e;break;case"number":a.width="".concat(e,"px");break;default:a.width="440px"}return a};let I=function(e){var t=e.contentHeight,n=e.contentWidth,i=e.header,I=e.closeTitle,E=e.children,j=e.confirm,b=e.deny,w=e.canConfirm,_=e.headerOnly,C=e.fullSize,y=e.open,T=e.keepMounted,P=e.closeOnOverlayClick,S=e.headerActionButtons,k=e.actionButtons,L=(0,m.c3)("Lightbox"),G=(0,r._)((0,x.useState)(),2),M=G[0],F=G[1];v({confirm:j,canConfirm:w||!1,deny:b}),(0,x.useEffect)(function(){F(document.body)},[]);var R=(0,g.A)(),D=(0,p.A)(R.breakpoints.down("md")),N=A(n,t,D,C),W=L(j?"cancel":"close"),Y=L("ok");return(0,a.jsxs)(u.A,{container:M,fullScreen:D||C,maxWidth:"lg",open:"boolean"!=typeof y||y,onClose:b,"aria-label":"string"==typeof i?i:void 0,keepMounted:"boolean"!=typeof T||T,disableEscapeKeyDown:!("boolean"!=typeof P||P),sx:{paddingRight:"10px"},children:[(0,a.jsxs)(h.A,{sx:{display:"flex",justifyContent:"space-between",gap:2,maxWidth:N.width},children:[(0,a.jsx)(s.A,{sx:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},title:i,children:i}),(0,a.jsxs)(s.A,{sx:{my:-.5,mr:-2},children:[S,b?(0,a.jsx)(f.A,{title:I||L("closeWithHeader",{header:"string"==typeof i?i:""}),color:"inherit",onClick:b,children:(0,a.jsx)(o.A,{})}):null]})]}),!_&&(0,a.jsx)(d.A,{sx:N,children:E}),(0,a.jsxs)(c.A,{children:[k,b?(0,a.jsx)(l.A,{onClick:b,color:"primary",variant:"outlined",children:W}):null,j?(0,a.jsx)(l.A,{disabled:!1===w,color:"primary",variant:"contained",onClick:j,children:Y}):null]})]})}},23747:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>I,BF:()=>x,Ll:()=>m});var r=n(97004),i=n(693),a=n(60376),o=n(78538),s=n(39249),l=n(12115),u=n(95939),c=n(7119),d=n(3381),h=n(71620),f=n(11760),g=n(80360),p=n(46594),m="NEW_GROUP",x=function(e){return e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase()},v=function(e,t){return e.find(function(e){return e.group.groups.find(function(e){return e.id===t})})||null},A=function(e){return e.CREATE_NEW="CREATE_NEW",e.EDIT_EXISTING="EDIT_EXISTING",e.NOT_EDITING="NOT_EDITING",e}(A||{});let I=function(){var e,t=(0,h.A)().imageSelection,n=(0,d.A)(),A=n.editImageGroup,I=n.cancelEditImageGroup,E=(0,f.h)(),j=E.imageGroups,b=E.addImageGroup,w=E.updateImageGroup,_=E.groupImagesAdd,C=E.ungroupImages,y=(0,c.g)(),T=y.navigateToGroup,P=y.navigateToImage,S=(0,u.Z)(),k=S.path,L=S.view,G=S.paths,M=S.pathsOptions,F=t.length,R=(null==A?void 0:A.groupId)?A.groupId===m?"CREATE_NEW":"EDIT_EXISTING":"NOT_EDITING",D=(0,l.useMemo)(function(){switch(R){case"CREATE_NEW":var e=(null==A?void 0:A.newGroupTitle)||"";return{imageGroup:null,parentPathMap:G.find(function(e){return e.group.id===L.id})||null,title:e,slug:x(e),slugTouched:!1};case"EDIT_EXISTING":var t=j.find(function(e){return e.id===(null==A?void 0:A.groupId)})||null;return{imageGroup:t,parentPathMap:(null==A?void 0:A.groupId)?v(G,A.groupId):null,title:(null==t?void 0:t.title)||"",slug:(null==t?void 0:t.slug)||"",slugTouched:!0};default:return{imageGroup:null,parentPathMap:null,title:"",slug:"",slugTouched:!1}}},[A,R,j,G,L]),N=(0,o._)((0,l.useState)(D.title),2),W=N[0],Y=N[1],V=(0,o._)((0,l.useState)(D.slug),2),O=V[0],B=V[1],H=(0,o._)((0,l.useState)(D.slugTouched),2),X=H[0],z=H[1],U=(0,o._)((0,l.useState)((null==(e=D.parentPathMap)?void 0:e.absolutePath)||""),2),Z=U[0],K=U[1],q=(0,l.useMemo)(function(){if(!(null==A?void 0:A.groupId))return"";if((null==A?void 0:A.groupId)===m)return"".concat(k).concat(O,"/");var e=v(G,A.groupId),t=(null==e?void 0:e.absolutePath)||"";return"".concat(t).concat(O,"/")},[A,G,k,O]),$=(0,l.useMemo)(function(){return!!G.find(function(e){return e.absolutePath===q})},[q,G]),Q=(0,l.useMemo)(function(){var e;return O!==(null==(e=D.imageGroup)?void 0:e.slug)},[D,O]),J=(0,l.useMemo)(function(){return!!O&&("CREATE_NEW"===R?!$:"EDIT_EXISTING"===R&&(!Q||!$))},[R,O,$,Q]),ee=(0,l.useMemo)(function(){var e,t,n=(null==(e=G.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"";return((null==(t=D.parentPathMap)?void 0:t.group.id)||"")!==n},[D,Z,G]),et=(0,l.useMemo)(function(){switch(R){case"EDIT_EXISTING":var e,t=(null==(e=G.find(function(e){return e.group.id===(null==A?void 0:A.groupId)}))?void 0:e.absolutePath)||"";return M.filter(function(e){var n=e.value;return!n.startsWith(q)&&n!==t});case"CREATE_NEW":return M;default:return[]}},[q,A,R,G,M]);return{editId:(null==A?void 0:A.groupId)||null,absoluteSlug:q,possibleParents:et,slug:O,title:W,canConfirm:J,canMove:ee,slugIsInUse:$,slugWasChanged:Q,parentSlug:Z,selectionCount:F,setSlug:function(e){B(e),z(!0)},setTitle:function(e){Y(e),(e.length<2||!X)&&(z(!1),B(x(e)))},setParentSlug:K,confirm:function(){if(I(),J&&A){var e,n=(null==(e=G.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"";if(A.groupId===m){if(!A.newGroupCover)return;var r=(0,g.z)();b({id:r,slug:O,title:W,created:(0,p.J)(),coverImage:A.newGroupCover,images:t,groups:[]},n),T(r,0)}else{if(!D.imageGroup)return;w((0,a._)((0,i._)({},D.imageGroup),{slug:O,title:W}),n),T(A.groupId,0)}}},move:(0,r._)(function(){var e,n;return(0,s.YH)(this,function(r){return I(),ee&&((n=(null==(e=G.find(function(e){return e.absolutePath===Z}))?void 0:e.group.id)||"")?_(n,t):C(t),P(t[0])),[2]})}),cancelEditImageGroup:I}}},27299:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(693),i=function(e,t){return(0,r._)({flexGrow:0,flexShrink:1,wordBreak:"break-all",whiteSpace:"no-wrap",overflow:"hidden",width:"100%",borderRadius:"3px"},t)}},31936:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(95155),i=n(700);n(12115);var a=n(52166),o=n(27299);let s=function(e){var t=e.text;return(0,a.A)().enableDebug?(0,r.jsx)(i.A,{title:t,variant:"caption",fontFamily:"monospace",component:"pre",sx:function(e){return(0,o.E)(e,{px:.5,py:0,mt:1,mb:0,backgroundColor:e.palette.warning[e.palette.mode]})},children:t}):null}},32521:(e,t,n)=>{"use strict";n.d(t,{U:()=>i,Z:()=>a});var r=n(12115),i=(0,r.createContext)({connectedDevices:[],isReceiving:!1,webSerialEnabled:!1,openWebSerial:function(){throw Error("PortsContext is missing")},webUSBEnabled:!1,openWebUSB:function(){throw Error("PortsContext is missing")},unknownDeviceResponse:null,hasInactiveDevices:!1}),a=function(){return(0,r.useContext)(i)}},39630:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info",e.IMAGE="image",e.META="meta",e}({})},40082:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(95155),i=n(12115),a=n(97004),o=n(78538),s=n(39249),l=n(5432),u=n(83936),c=n(633),d=n(11760),h=n(53982),f=n(933),g=n(5847),p=function(e){var t,n=e.hash,r=e.hashes,p=e.palette,m=e.invertPalette,x=e.framePalette,v=e.invertFramePalette,A=e.lockFrame,I=e.frameId,E=e.rotation,j=(0,o._)((0,i.useState)(null),2),b=j[0],w=j[1],_=(0,c.g)(),C=(0,u.W)().remoteImport,y=(0,d.h)(),T=y.frames,P=y.palettes,S=y.images,k=null==(t=T.find(function(e){return e.id===I}))?void 0:t.hash,L=(0,i.useCallback)(function(e,t,n){return(0,g.T)(S,T,function(){(0,f.E)(_,C).recoverImageData(e)})(e,t,n,r)},[S,T,r,_,C]),G=(0,i.useMemo)(function(){return"string"==typeof p?(P.find(function(e){return e.shortName===p})||l.Fv).palette:p},[P,p]);return(0,i.useEffect)(function(){var e,t=!1;return n||w(null),(e=(0,a._)(function(){var e,r,i,a;return(0,s.YH)(this,function(o){switch(o.label){case 0:if(t)return[2];return[4,L(n,!1,I)];case 1:if(e=o.sent(),!k)return[3,3];return[4,(0,h.mZ)(k)];case 2:return i=o.sent(),[3,4];case 3:i=null,o.label=4;case 4:if(a=(r=i)?r.upper.length/20:2,t)return[2];return e&&w({tiles:e,palette:G,invertPalette:m,imageStartLine:a,lockFrame:A,rotation:E,framePalette:A?x:p,invertFramePalette:A?v:m}),[2]}})}),function(){return e.apply(this,arguments)})(),function(){t=!0}},[L,n,I,p,m,A,E,G,k,x,v]),{gbImageProps:b}},m=n(93370),x=n(66564);let v=function(e){var t=e.hash,n=e.hashes,i=e.frameId,a=e.lockFrame,o=e.invertPalette,s=e.invertFramePalette,l=e.palette,u=e.framePalette,c=e.rotation,d=e.asThumb,h=p({hash:t,hashes:n,frameId:i,lockFrame:a,invertPalette:o,invertFramePalette:s,palette:l,framePalette:u,rotation:c}).gbImageProps;return h?(0,r.jsx)(m.A,{lockFrame:h.lockFrame,invertPalette:h.invertPalette,invertFramePalette:h.invertFramePalette,tiles:h.tiles,palette:h.palette,framePalette:h.framePalette,imageStartLine:h.imageStartLine,rotation:h.rotation,asThumb:d}):(0,r.jsx)(x.A,{})}},41476:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(86447),i=n(693),a=n(60376),o=n(87025),s=n(51368);let l=(0,n(65453).v)(function(e,t){return{progress:[],progressLog:{git:[],dropbox:[]},resetProgressLog:function(){return e({progressLog:{git:[],dropbox:[]}})},startProgress:function(t){var n={id:(0,s.A)(),label:t,value:0};return e(function(e){var t=e.progress;return{progress:(0,o._)(t).concat([n])}}),n.id},setProgress:function(t,n){e(function(e){return{progress:e.progress.map(function(e){return e.id!==t?e:(0,a._)((0,i._)({},e),{value:n})})}})},stopProgress:function(t){e(function(e){return{progress:e.progress.filter(function(e){return e.id!==t})}})},setProgressLog:function(n,s){var l=t().progressLog;e({progressLog:(0,a._)((0,i._)({},l),(0,r._)({},n,[s].concat((0,o._)(l[n]))))})}}})},53664:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var r=n(95155),i=n(61046),a=n(87741),o=n(70340),s=n(84585),l=n(97644),u=n(3856),c=n(17652);n(12115);var d=n(4862),h=n(98250),f=n(52166),g=function(e){switch(e){case d.j.GALLERY_VIEW_SMALL:return"viewNames.smallest";case d.j.GALLERY_VIEW_1X:return"viewNames.originalSize";case d.j.GALLERY_VIEW_2X:return"viewNames.doubleSize";case d.j.GALLERY_VIEW_MAX:return"viewNames.maximumSize";default:return""}},p=function(e){switch(e){case d.j.GALLERY_VIEW_SMALL:return(0,r.jsx)(o.A,{});case d.j.GALLERY_VIEW_1X:return(0,r.jsx)(i.A,{});case d.j.GALLERY_VIEW_2X:return(0,r.jsx)(s.A,{});case d.j.GALLERY_VIEW_MAX:default:return(0,r.jsx)(a.A,{})}};let m=function(){var e=(0,c.c3)("GalleryViewSelect"),t=(0,f.A)(),n=t.galleryView,i=t.setGalleryView,a=(0,h.h)().ddpx>1?[d.j.GALLERY_VIEW_SMALL,d.j.GALLERY_VIEW_1X,d.j.GALLERY_VIEW_2X,d.j.GALLERY_VIEW_MAX]:[d.j.GALLERY_VIEW_1X,d.j.GALLERY_VIEW_2X,d.j.GALLERY_VIEW_MAX];return(0,r.jsx)(u.A,{value:n,exclusive:!0,onChange:function(e,t){t&&i(t)},sx:{"& .MuiToggleButton-root":{width:40,height:40}},children:a.map(function(t){return(0,r.jsx)(l.A,{value:t,title:e(g(t)),children:p(t)},t)})})}},61564:(e,t,n)=>{"use strict";n.d(t,{t:()=>p});var r=n(97004),i=n(39249),a=n(17652),o=n(12115),s=n(33236),l=n(39630),u=n(95939),c=n(23747),d=n(41186),h=n(3381),f=n(71620),g=n(11760),p=function(){var e=(0,a.c3)("useImageGroups"),t=(0,u.Z)().view,n=(0,d.A)(),p=n.dismissDialog,m=n.setDialog,x=(0,h.A)().setEditImageGroup,v=(0,g.h)(),A=v.deleteImageGroup,I=v.setImageGroups,E=v.images,j=(0,f.A)().imageSelection,b=(0,o.useMemo)(function(){if(!j.length)return"";var t,n=E.filter(function(e){var t=e.hash;return j.includes(t)}).map(function(e){return e.title}).filter(function(e){return e.length>3}),r=null==(t=(0,s.Hg)(n).filter(function(e){return e.length>3})[0])?void 0:t.trim();return r?r.replace(/[_-]/g," ").replace(/^\s*\d+\s+|\s+\d+\s*$/g,"").trim():e("newGroupDefault")},[j,E,e]);return{resetGroups:function(){m({message:e("resetGroupsMessage"),questions:function(){return[{key:"info",type:l.V.INFO,label:e("resetGroupsInfo")}]},confirm:(0,r._)(function(){return(0,i.YH)(this,function(e){return p(0),I([]),[2]})}),deny:(0,r._)(function(){return(0,i.YH)(this,function(e){return p(0),[2]})})})},createGroup:function(e){x({groupId:c.Ll,newGroupCover:e,newGroupTitle:b})},editGroup:function(e){x({groupId:e})},deleteGroup:function(n){var a=t.groups.find(function(e){return e.id===n});a&&m({message:e("deleteGroupMessage"),questions:function(){return[{key:"info",type:l.V.INFO,label:e("deleteGroupInfo",{groupTitle:a.title||a.slug})}]},confirm:(0,r._)(function(){return(0,i.YH)(this,function(e){return p(0),A(n),[2]})}),deny:(0,r._)(function(){return(0,i.YH)(this,function(e){return p(0),[2]})})})}}}},66564:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(95155),i=n(54581),a=n(14426);n(12115);let o=function(){return(0,r.jsx)(i.A,{sx:{width:"100%",paddingTop:"90%",height:0,display:"block",background:"transparent",position:"relative"},children:(0,r.jsx)(i.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,r.jsx)(a.A,{color:"primary",size:40})})})}},74666:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var r=n(693),i=n(60376),a=n(78538),o=n(95155),s=n(69008),l=n(4420),u=n(54581),c=n(41218),d=n(59710),h=n(16632),f=n(65221),g=n(60785),p=n(3127),m=n(71803),x=n(16324),v=n(12115);let A=function(e){var t=e.selectionText,n=e.title,A=e.titleIcon,I=e.subheader,E=e.wrapperProps,j=e.media,b=e.content,w=e.contextMenuComponent,_=e.contextMenuProps,C=(0,x.A)(),y=(0,a._)((0,v.useState)(null),2),T=y[0],P=y[1],S=(0,v.useMemo)(function(){var e={"@media (any-hover: hover)":{"&:hover":{backgroundColor:(0,l.au)(C.palette.tertiary.main,C.palette.background.paper,.33)}},transition:"background-color 0.15s ease-in-out"};return t?(0,i._)((0,r._)({},e),{backgroundColor:(0,l.au)(C.palette.info.main,C.palette.background.paper,.75)}):e},[t,C]),k=[n,I].filter(Boolean).join("\n");return(0,o.jsxs)(m.A,{component:"li",direction:"column",justifyContent:"stretch",sx:{position:"relative","& > *":{flexGrow:1}},children:[t&&(0,o.jsx)(u.A,{sx:{position:"absolute",display:"block",width:"1.8em",height:"1.8em",top:"-0.53em",left:"-0.53em",zIndex:15,fontSize:"0.85rem",lineHeight:"1.8em",textAlign:"center",backgroundColor:C.palette.info.main,color:C.palette.info.contrastText,borderRadius:"50%",pointerEvents:"none"},children:t}),(0,o.jsxs)(c.A,{sx:S,children:[(0,o.jsxs)(d.A,(0,i._)((0,r._)({},E),{component:E.component||"span",tabIndex:E.component?void 0:-1,children:[(0,o.jsx)(f.A,{title:A?(0,o.jsxs)(m.A,{direction:"row",gap:.5,alignItems:"center",children:[A,n]}):n,subheader:I,action:(0,o.jsx)(p.A,{onClick:function(e){e.preventDefault(),e.stopPropagation(),P(e.target)},children:(0,o.jsx)(s.A,{})}),slotProps:{title:{title:k,variant:"body1",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},subheader:{title:k,variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}},sx:{gap:1,backgroundColor:(0,l.X4)(C.palette.fgtext.main,.1),p:1,".MuiCardHeader-content":{minWidth:0}}}),(0,o.jsx)(g.A,{children:j}),b&&(0,o.jsx)(h.A,{sx:{p:1,flexGrow:1,justifyContent:"space-between",display:"flex",flexDirection:"column",padding:1,"&:last-child":{padding:1}},children:b})]})),(0,o.jsx)(w,(0,r._)({menuAnchor:T,onClose:function(){return P(null)}},_))]})]})}},75097:(e,t,n)=>{"use strict";n.d(t,{No:()=>i,Q3:()=>a,RQ:()=>o,x6:()=>r});var r=function(e){return e.DELETE="delete",e.ANIMATE="animate",e.DOWNLOAD="download",e.EDIT="edit",e.RGB="rgb",e}({}),i=function(e){return e.LOCK_FRAME="lockFrame",e.FRAME="frame",e.PALETTE="palette",e.TITLE="title",e.TAGS="tags",e.CREATED="created",e.ROTATION="rotation",e}({}),a=function(e){return e.INVERT_PALETTE="invertPalette",e.FRAME_PALETTE="framePalette",e.INVERT_FRAME_PALETTE="invertFramePalette",e}({}),o=["lockFrame","frame","title","tags","created","rotation","palette","invertPalette","framePalette","invertFramePalette"]},80360:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=n(51368).A},84131:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(95155),i=n(54581),a=n(77262),o=n(12115),s=n(4862),l=n(98250),u=n(52166);let c=function(e){var t=e.fixedView,n=e.showLoader,c=e.children,d=(0,l.h)().ddpx,h=(0,u.A)().galleryView,f=t||h,g=(0,o.useMemo)(function(){var e="",t="";switch(f===s.j.GALLERY_VIEW_SMALL&&1===d?s.j.GALLERY_VIEW_1X:f){case s.j.GALLERY_VIEW_SMALL:e="".concat(160/d,"px"),t="".concat(8/d,"px");break;case s.j.PALETTE_VIEW:e="minmax(270px, 1fr)",t="32px";break;case s.j.GALLERY_VIEW_1X:e="160px",t="16px";break;case s.j.GALLERY_VIEW_2X:e="320px",t="32px";break;case s.j.GALLERY_VIEW_MAX:e="100%",t="32px"}return{gap:t,display:"grid",justifyContent:"center",gridTemplateColumns:"repeat(auto-fill, ".concat(e,")")}},[f,d]);return(0,r.jsxs)(i.A,{component:"ul",sx:g,position:"relative",children:[n&&(0,r.jsx)(a.A,{color:"secondary",variant:"indeterminate",sx:{position:"absolute",top:-4,left:0,right:0,zIndex:1}}),c]})}},84300:(e,t,n)=>{Promise.resolve().then(n.bind(n,4021))},85812:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var r=n(17652),i=n(12115),a=n(52166),o=function(){var e=(0,a.A)().hideDates,t=(0,r.kc)(),n=(0,i.useCallback)(function(e){var n=new Date(e);return"string"==typeof e&&isNaN(n.getTime())&&(n=new Date(e.replace(/(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2}):(\d{3})/,"$1T$2.$3"))),t.dateTime(n,"short")},[t]);return{formatterGallery:(0,i.useCallback)(function(t){return e||!t?null:n(t)},[n,e]),formatter:n}}},93370:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(97004),i=n(693),a=n(78538),o=n(39249),s=n(95155),l=n(54581),u=n(15905),c=n(12115),d=n(77683);let h=function(e){var t=e.palette,n=e.tiles,h=e.imageStartLine,f=e.lockFrame,g=e.invertPalette,p=e.framePalette,m=e.invertFramePalette,x=e.asThumb,v=void 0!==x&&x,A=e.rotation,I=void 0===A?u.pL.DEG_0:A,E=!(t instanceof Array),j=(0,a._)((0,c.useState)(null),2),b=j[0],w=j[1],_=(0,a._)((0,c.useState)(""),2),C=_[0],y=_[1];(0,c.useEffect)(function(){if(t&&n){var e=setTimeout((0,r._)(function(){var e;return(0,o.YH)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,5,,6]),!E)return[3,2];return[4,(0,u.uL)({tiles:n,palette:t,lockFrame:f||!1,rotation:I})];case 1:return w.apply(void 0,[r.sent()]),[3,4];case 2:if(!(null==n?void 0:n.length))return[3,4];return[4,(0,u.qO)((0,i._)({tiles:n,imageStartLine:h,rotation:I},(0,d.C)({imagePalette:t,framePalette:p,invertPalette:g,invertFramePalette:m})))];case 3:w.apply(void 0,[r.sent()]),r.label=4;case 4:return y(""),[3,6];case 5:return(e=r.sent())instanceof Error&&(console.error(e),y(e.message)),[3,6];case 6:return[2]}})}),1);return function(){clearTimeout(e)}}},[n,t,f,g,I,E,h,p,m]);var T=(0,c.useMemo)(function(){var e=I===u.pL.DEG_90||I===u.pL.DEG_270,t=(E?(0,u.EK)(n):n.length)<=360,r=e&&t;return{display:"block",imageRendering:v?"auto":"pixelated",margin:r?"0 5%":0,width:r?"90%":"100%",maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}},[v,E,I,n]);return(0,s.jsx)(l.A,{className:"gameboy-image",sx:{display:"flex",width:"100%",height:"100%"},children:!C&&b&&(0,s.jsx)(l.A,{component:"img",width:160,src:b,sx:T,alt:""})})}},98250:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var r=n(78538),i=n(12115),a=function(){var e;return{width:window.innerWidth,height:window.innerHeight,ddpx:window.devicePixelRatio<=2?window.devicePixelRatio:window.devicePixelRatio/2,layoutWidth:(e=window.innerWidth)>1220?1155:e>1025?960:e>830?765:e>635?570:e>440?375:e-40}},o=function(){var e=(0,r._)((0,i.useState)(a()),2),t=e[0],n=e[1];return(0,i.useEffect)(function(){var e=function(){n(a())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[n]),t}}},e=>{var t=t=>e(e.s=t);e.O(0,[7652,4453,700,8250,5232,7271,2491,3701,3127,9710,7642,7890,6672,1487,6874,7857,3611,8578,9447,3236,9882,1760,2973,9194,8441,1684,7358],()=>t(84300)),_N_E=e.O()}]);