(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5991],{4144:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(95155),i=n(41574),o=n(89041),a=n(12115),s=n(94529),l=n(23441),u=n(10022);let c=function(e){var t=e.fixedView,n=e.showLoader,c=e.children,d=(0,l.h)().ddpx,h=(0,u.C$)().galleryView,g=t||h,f=(0,a.useMemo)(function(){var e="",t="";switch(g===s.j.GALLERY_VIEW_SMALL&&1===d?s.j.GALLERY_VIEW_1X:g){case s.j.GALLERY_VIEW_SMALL:e="".concat(160/d,"px"),t="".concat(8/d,"px");break;case s.j.PALETTE_VIEW:e="minmax(270px, 1fr)",t="32px";break;case s.j.GALLERY_VIEW_1X:e="160px",t="16px";break;case s.j.GALLERY_VIEW_2X:e="320px",t="32px";break;case s.j.GALLERY_VIEW_MAX:e="100%",t="32px"}return{gap:t,display:"grid",justifyContent:"center",gridTemplateColumns:"repeat(auto-fill, ".concat(e,")")}},[g,d]);return(0,r.jsxs)(i.A,{component:"ul",sx:f,position:"relative",children:[n&&(0,r.jsx)(o.A,{color:"secondary",variant:"indeterminate",sx:{position:"absolute",top:-4,left:0,right:0,zIndex:1}}),c]})}},6840:(e,t,n)=>{"use strict";n.d(t,{h:()=>s,i:()=>a});var r=n(61975),i=n(71450),o=n(12115),a=(0,o.createContext)({runWithImage:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})})()},runWithImages:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})})()},validateAndAddPlugin:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){throw Error("Plugin Context is missing")})})()}}),s=function(){return(0,o.useContext)(a)}},18891:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var r=n(22043),i=n(95155),o=n(39241),a=n(24942),s=n(77621),l=n(1135),u=n(35497),c=n(71583),d=n(18955),h=n(12115),g=n(94529),f=n(23441),p=n(10022),x=function(e){switch(e){case g.j.GALLERY_VIEW_SMALL:return"viewNames.smallest";case g.j.GALLERY_VIEW_1X:return"viewNames.originalSize";case g.j.GALLERY_VIEW_2X:return"viewNames.doubleSize";case g.j.GALLERY_VIEW_MAX:return"viewNames.maximumSize";default:return""}},m=function(e){switch(e){case g.j.GALLERY_VIEW_SMALL:return(0,i.jsx)(s.A,{});case g.j.GALLERY_VIEW_1X:return(0,i.jsx)(o.A,{});case g.j.GALLERY_VIEW_2X:return(0,i.jsx)(l.A,{});case g.j.GALLERY_VIEW_MAX:default:return(0,i.jsx)(a.A,{})}};let A=function(){var e=(0,d.c)("GalleryViewSelect"),t=(0,p.C$)(),n=t.galleryView,o=t.setGalleryView,a=(0,f.h)().ddpx,s=(0,r._)((0,h.useState)([]),2),l=s[0],A=s[1];return(0,h.useEffect)(function(){A(a>1?[g.j.GALLERY_VIEW_SMALL,g.j.GALLERY_VIEW_1X,g.j.GALLERY_VIEW_2X,g.j.GALLERY_VIEW_MAX]:[g.j.GALLERY_VIEW_1X,g.j.GALLERY_VIEW_2X,g.j.GALLERY_VIEW_MAX])},[a]),(0,i.jsx)(c.A,{value:n,exclusive:!0,onChange:function(e,t){t&&o(t)},sx:{"& .MuiToggleButton-root":{width:40,height:40}},children:l.map(function(t){return(0,i.jsx)(u.A,{value:t,title:e(x(t)),children:m(t)},t)})})}},40433:(e,t,n)=>{"use strict";n.d(t,{j:()=>d});var r=n(61975),i=n(22043),o=n(71450),a=n(12115),s=n(30986),l=(0,s.A)("percentage",s.U.DESC),u=function(){var e=0;for(var t in localStorage)if(localStorage.hasOwnProperty(t)){var n=localStorage.getItem(t);null!==n&&(e+=t.length+n.length)}return e},c=function(){var e="__test_localStorage_limit__",t=0,n=0xf00000,r=0;try{for(;t<=n;){var i=Math.floor((t+n)/2),o="A".repeat(i);try{localStorage.setItem(e,o),r=i,t=i+1}catch(e){n=i-1}}}finally{localStorage.removeItem(e)}return r},d=function(){var e=(0,i._)((0,a.useState)([]),2),t=e[0],n=e[1];return(0,a.useEffect)(function(){window.setTimeout(function(){return(0,r._)(function(){var e,t,r,i;return(0,o.YH)(this,function(o){switch(o.label){case 0:return[4,null==(e=navigator.storage)?void 0:e.estimate()];case 1:return t=o.sent()||null,n([{type:"localStorage",total:i=(r=u())+c(),used:r,percentage:r/i*100},{type:"indexedDB",total:(null==t?void 0:t.quota)||0,used:(null==t?void 0:t.usage)||0,percentage:i?((null==t?void 0:t.usage)||0)/((null==t?void 0:t.quota)||1)*100:100}]),[2]}})})()},10)},[]),{criticalStorageEstimate:l(t.filter(function(e){return e.percentage>75}))[0]||null,storageEstimate:t}}},63009:(e,t,n)=>{"use strict";n.d(t,{A:()=>j});var r=n(82732),i=n(45849),o=n(22043),a=n(95155),s=n(63951),l=n(53097),u=n(41574),c=n(92920),d=n(81891),h=n(24627),g=n(61294),f=n(24508),p=n(24288),x=n(41942),m=n(25789),A=n(12115);let j=function(e){var t=e.selectionText,n=e.title,j=e.titleIcon,v=e.subheader,I=e.wrapperProps,E=e.media,C=e.content,b=e.contextMenuComponent,_=e.contextMenuProps,w=(0,m.A)(),y=(0,o._)((0,A.useState)(null),2),L=y[0],k=y[1],S=(0,A.useMemo)(function(){var e={"@media (any-hover: hover)":{"&:hover":{backgroundColor:(0,l.au)(w.palette.tertiary.main,w.palette.background.paper,.33)}},transition:"background-color 0.15s ease-in-out"};return t?(0,i._)((0,r._)({},e),{backgroundColor:(0,l.au)(w.palette.info.main,w.palette.background.paper,.75)}):e},[t,w]),T=[n,v].filter(Boolean).join("\n");return(0,a.jsxs)(x.A,{component:"li",direction:"column",justifyContent:"stretch",sx:{position:"relative","& > *":{flexGrow:1}},children:[t&&(0,a.jsx)(u.A,{sx:{position:"absolute",display:"block",width:"1.8em",height:"1.8em",top:"-0.53em",left:"-0.53em",zIndex:15,fontSize:"0.85rem",lineHeight:"1.8em",textAlign:"center",backgroundColor:w.palette.info.main,color:w.palette.info.contrastText,borderRadius:"50%",pointerEvents:"none"},children:t}),(0,a.jsxs)(c.A,{sx:S,children:[(0,a.jsxs)(d.A,(0,i._)((0,r._)({},I),{component:I.component||"span",tabIndex:I.component?void 0:-1,children:[(0,a.jsx)(g.A,{title:j?(0,a.jsxs)(x.A,{direction:"row",gap:.5,alignItems:"center",children:[j,n]}):n,subheader:v,action:(0,a.jsx)(p.A,{onClick:function(e){e.preventDefault(),e.stopPropagation(),k(e.target)},children:(0,a.jsx)(s.A,{})}),slotProps:{title:{title:T,variant:"body1",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},subheader:{title:T,variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}},sx:{gap:1,backgroundColor:(0,l.X4)(w.palette.fgtext.main,.1),p:1,".MuiCardHeader-content":{minWidth:0}}}),(0,a.jsx)(f.A,{children:E}),C&&(0,a.jsx)(h.A,{sx:{p:1,flexGrow:1,justifyContent:"space-between",display:"flex",flexDirection:"column",padding:1,"&:last-child":{padding:1}},children:C})]})),(0,a.jsx)(b,(0,r._)({menuAnchor:L,onClose:function(){return k(null)}},_))]})]})}},65301:(e,t,n)=>{"use strict";n.d(t,{t:()=>h});var r=n(61975),i=n(71450),o=n(18955),a=n(12115),s=n(56265),l=n(11081),u=n(89386),c=n(96112),d=n(10022),h=function(){var e=(0,o.c)("useImageGroups"),t=(0,u.Z)().view,n=(0,d.M2)(),h=n.dismissDialog,g=n.setDialog,f=(0,d.vT)().setEditImageGroup,p=(0,d.Vs)(),x=p.deleteImageGroup,m=p.setImageGroups,A=p.images,j=(0,d.cr)().imageSelection,v=(0,a.useMemo)(function(){if(!j.length)return"";var t,n=A.filter(function(e){var t=e.hash;return j.includes(t)}).map(function(e){return e.title}).filter(function(e){return e.length>3}),r=null==(t=(0,s.Hg)(n).filter(function(e){return e.length>3})[0])?void 0:t.trim();return r?r.replace(/[_-]/g," ").replace(/^\s*\d+\s+|\s+\d+\s*$/g,"").trim():e("newGroupDefault")},[j,A,e]);return{resetGroups:function(){g({message:e("resetGroupsMessage"),questions:function(){return[{key:"info",type:l.V.INFO,label:e("resetGroupsInfo")}]},confirm:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return h(0),m([]),[2]})})()},deny:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return h(0),[2]})})()}})},createGroup:function(e){f({groupId:c.Ll,newGroupCover:e,newGroupTitle:v})},editGroup:function(e){f({groupId:e})},deleteGroup:function(n){var o=t.groups.find(function(e){return e.id===n});o&&g({message:e("deleteGroupMessage"),questions:function(){return[{key:"info",type:l.V.INFO,label:e("deleteGroupInfo",{groupTitle:o.title||o.slug})}]},confirm:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return h(0),x(n),[2]})})()},deny:function(){return(0,r._)(function(){return(0,i.YH)(this,function(e){return h(0),[2]})})()}})}}}},84300:(e,t,n)=>{Promise.resolve().then(n.bind(n,90182))},90182:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tp});var r=n(95155),i=n(80317),o=n(18955),a=n(41942),s=n(12115),l=n(22043),u=n(91665),c=n(53170),d=n(41302),h=n(95941),g=n(24288),f=n(37440),p=n(52619),x=n.n(p),m=n(45377),A=n(53097),j=n(25789),v=n(34309),I=n(27120),E=n(34731),C=n(89386),b=n(4599),_=function(){var e=(0,C.Z)(),t=e.path,n=e.getUrl,r=e.root,i=e.paths,o=(0,b.g)(),a=o.getImagePageIndexInGroup,l=o.navigateToGroup;return{segments:(0,s.useMemo)(function(){var e=[""].concat((0,m._)(t.split("/").filter(Boolean))),o=e.reduce(function(t,n,r){return(0,m._)(t).concat([e.slice(1,r+1).join("/").concat("/")])},[]),s=o.reduce(function(e,t){var n;return(n="/"===t?{absolutePath:"",group:r}:i.find(function(e){return e.absolutePath===t}))?(0,m._)(e).concat([n]):e},[]),u=s.map(function(e,t){var r=s[t+1],i=0;return r&&(i=a(r.group.coverImage,e.group)),{group:e.group,link:n({pageIndex:i,group:e.absolutePath})}});return o.length!==u.length&&l(u[u.length-1].group.id,0),u},[t,r,i,n,a,l])}},w=n(36336);function y(e){var t=e.group,n=e.onClick,i=(0,b.g)().getGroupPath;return(0,r.jsx)(I.y,{itemId:t.id,label:(0,r.jsx)(f.A,{component:x(),href:i(t.id,0),onClick:n,sx:{display:"block"},children:t.title}),sx:function(e){return{"& > .MuiTreeItem-content.Mui-selected":{backgroundColor:(0,A.X4)(e.palette.secondary.main,.8),color:e.palette.secondary.contrastText,"&:hover,&.Mui-focused":{backgroundColor:e.palette.secondary.main}}}},children:t.groups.map(function(e){return(0,r.jsx)(y,{group:e,onClick:n},e.id)})})}let L=function(e){var t=e.open,n=e.onClose,i=(0,o.c)("FolderTreeDialog"),a=(0,C.Z)(),u=a.pathsOptions,c=a.root,d=(0,b.g)().currentGroup,h=(0,j.A)(),g=_().segments,f=(0,l._)((0,s.useState)([]),2),p=f[0],x=f[1];return((0,s.useEffect)(function(){x(function(e){var t=g.map(function(e){return e.group.id});return(0,w.A)((0,m._)(t).concat((0,m._)(e)))})},[g]),u.length<2)?null:(0,r.jsx)(E.A,{contentHeight:"60vh",contentWidth:"auto",deny:n,open:t,header:i("dialogHeader"),keepMounted:!1,children:(0,r.jsx)(v.G,{expansionTrigger:"iconContainer",expandedItems:p,onExpandedItemsChange:function(e,t){return x(t)},selectedItems:d.id,sx:{width:h.breakpoints.values.sm,height:"60vh"},children:(0,r.jsx)(y,{group:c,onClick:n})})})};var k=n(10022);let S=function(){var e=(0,o.c)("FolderBreadcrumb"),t=(0,C.Z)().pathsOptions,n=(0,k.vT)().setEditImageGroup,i=_().segments,p=(0,l._)((0,s.useState)(!1),2),m=p[0],A=p[1];return t.length<2?null:(0,r.jsxs)(a.A,{direction:"row",gap:2,justifyContent:"space-between",alignItems:"center",children:[(0,r.jsx)(h.A,{children:i.map(function(t,i){var o,s=t.group,l=t.link;return(0,r.jsxs)(a.A,{direction:"row",gap:.5,alignItems:"center",children:[i>0?(0,r.jsx)(f.A,{component:x(),title:s.title,href:l,children:i?(o=s.title,o.length<30?o:"".concat(o.slice(0,30),"…")):(0,r.jsx)(c.A,{fontSize:"small"})}):(0,r.jsx)(g.A,{component:x(),title:s.title,href:l,sx:{fontSize:16},children:(0,r.jsx)(c.A,{fontSize:"inherit"})}),i>0&&(0,r.jsx)(g.A,{onClick:function(){return n({groupId:s.id})},title:e("editGroup",{title:s.title}),sx:{fontSize:16},children:(0,r.jsx)(u.A,{fontSize:"inherit"})})]},s.id)})}),(0,r.jsx)(g.A,{title:e("openNavigation"),onClick:function(){return A(!0)},children:(0,r.jsx)(d.A,{})}),(0,r.jsx)(L,{open:m,onClose:function(){return A(!1)}})]})};var T=n(4144),M=n(41574),G=n(70439),P=n(63009),V=n(6170),D=n(45279),F=n(19131),R=n(3683),W=n(23405),Y=n(65301);let B=function(e){var t=e.groupId,n=e.menuAnchor,i=e.onClose,a=(0,o.c)("GalleryGroupContextMenu"),s=(0,Y.t)(),l=s.deleteGroup,c=s.editGroup;return n?(0,r.jsxs)(R.A,{open:!!n,anchorEl:n,onClose:i,onClick:function(e){e.stopPropagation(),i()},children:[(0,r.jsxs)(W.A,{onClick:function(){return c(t)},title:a("edit"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(u.A,{})}),(0,r.jsx)(F.A,{children:a("edit")})]}),(0,r.jsxs)(W.A,{onClick:function(){return l(t)},title:a("delete"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(V.A,{})}),(0,r.jsx)(F.A,{children:a("delete")})]})]}):null};var N=n(18565),O=n(74193),H=n(45073),X=function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())};let z=function(e){var t,n=e.tags,i=e.fromGroup,s=(0,o.c)("TagsList"),l=[];if(i){var u=n.sort(X).filter(function(e){return!H.rx.includes(e)});t=u.slice(0,3),l=u.slice(3,-1)}else t=n;var c=i?"secondary":"tertiary";return(0,r.jsxs)(a.A,{component:"ul",direction:"row",gap:.66,flexWrap:"wrap",sx:function(e){return{"& .MuiChip-root":{fontSize:"0.75rem",height:e.spacing(2.5),padding:0}}},children:[t.sort(X).map(function(e){return(0,r.jsx)(O.A,{title:e===H.X3.FILTER_FAVOURITE?s("favourite"):e,label:e===H.X3.FILTER_FAVOURITE?"❤️":e,size:"small",color:c},e)}),l.length>0&&(0,r.jsx)(O.A,{variant:"outlined",title:s("moreTags",{count:l.length,tags:l.join("\n")}),label:s("moreTagsLabel",{count:l.length}),size:"small"})]})};var Z=n(94529),U=function(e){var t,n=(0,C.Z)(),r=n.paths,i=n.view.groups.find(function(t){return t.coverImage===e})||null,o=(null==(t=r.find(function(e){return e.group.id===(null==i?void 0:i.id)}))?void 0:t.absolutePath)||null;return{group:i,path:o}};let $=function(e){var t=e.hash,n=(0,o.c)("GalleryGroup"),i=(0,C.Z)().getUrl,a=U(t),s=a.group,l=a.path,u=(0,k.C$)().galleryView,c=[Z.j.GALLERY_VIEW_SMALL,Z.j.GALLERY_VIEW_1X].includes(u);return s?(0,r.jsx)(P.A,{selectionText:"",title:s.title,subheader:n("itemCount",{count:s.allImages.length}),wrapperProps:{component:x(),href:i({group:l||"",pageIndex:0}),sx:{textDecoration:"none"}},contextMenuComponent:B,contextMenuProps:{groupId:s.id},media:(0,r.jsxs)(M.A,{sx:{position:"relative",margin:"0 auto","& > .MuiBox-root":{position:"absolute",top:0,img:{transform:"scale(0.5)"}}},children:[(0,r.jsx)(G.A,{viewBox:"0 0 24 21",color:"secondary",sx:function(e){return{width:"100%",height:"100%",fill:(0,A.au)(e.palette.secondary.main,e.palette.fgtext.main,.25)}},children:(0,r.jsx)("path",{d:"M 10,2 H 4 C 2.9,2 2.01,2.9 2.01,4 L 2,16 c 0,1.1 0.9,2 2,2 h 16 c 1.1,0 2,-0.9 2,-2 V 6 C 22,4.9 21.1,4 20,4 h -8 z"})}),(0,r.jsx)(N.A,{hash:t,asThumb:c})]}),content:s.tags.length>0&&(0,r.jsx)(z,{tags:s.tags,fromGroup:!0})}):null};var q=n(82732),K=n(896),J=n(27001),Q=n(22094),ee=n(82414),et=n(46757),en=n(27448),er=n(73209),ei=n(74246),eo=n(64647),ea=n(32968),es=n(33195),el=n(98638),eu=n(6840);let ec=function(e){var t=e.pluginAnchor,n=e.hash,i=e.onClose,a=(0,o.c)("PluginSelect"),s=(0,k.Vs)().plugins,l=(0,k.cr)().imageSelection,u=(0,eu.h)(),c=u.runWithImage,d=u.runWithImages,h=function(e){n?c(e,n):d(e,l)};return(0,r.jsx)(R.A,{open:!!t,anchorEl:t,onClose:i,children:s.map(function(e){var t=e.url,n=e.name,o=e.description,s=e.loading,l=e.error;return(0,r.jsxs)(W.A,{disabled:!!(s||l),title:a("pluginTooltip",{description:l||o||"",url:t}),onClick:function(){i(),h(t)},children:[l&&(0,r.jsx)(es.A,{color:"warning"}),s&&(0,r.jsx)(el.A,{color:"secondary",size:22}),n||t]},t)})})};var ed=n(42086),eh=n(61975),eg=n(71450),ef=n(7766),ep=n(5800),ex=n(55382),em=n(84470),eA=n(17403),ej=n(80068);let ev=function(e){var t=(0,o.c)("useBatchButtons"),n=(0,k.cr)(),r=n.imageSelection,i=n.sortBy,a=n.filtersTags,l=n.filtersPalettes,u=n.filtersFrames,c=n.recentImports,d=n.setFiltersVisible,h=n.setSortOptionsVisible,g=n.setImageSelection,f=(0,k.Vs)(),p=f.plugins,x=f.images,A=(0,k.C$)().pageSize,j=(0,k.vT)(),v=j.setEditImages,I=j.setEditRGBNImages,E=(0,k.M2)(),b=E.dismissDialog,_=E.setDialog,y=(0,k.I0)().setVideoSelection,L=(0,ep.A)().setDownloadImages,S=(0,ex.g)().deleteImages,T=(0,C.Z)(),M=T.view,G=T.covers,P=(0,ef.A)().sendEvent,V=e*A,D=(0,s.useMemo)(function(){return(0,em.S)(M,{sortBy:i,filtersTags:a,filtersFrames:u,filtersPalettes:l,recentImports:c}).splice(V,A||1/0).filter(function(e){return!G.includes(e.hash)})},[G,u,l,a,V,A,c,i,M]),F=(0,s.useMemo)(function(){return D.filter(function(e){var t=e.hash;return r.includes(t)})},[D,r]),R=F.reduce(eA.iy,[]),W=(0,s.useMemo)(function(){return r.reduce(function(e,t){var n=x.find(function(e){return e.hash===t});return n?[n].concat((0,m._)(e)):e},[])},[r,x]),Y=r.length,B=F.length>0;return{hasPlugins:!!p.length,batchEnabled:!!r.length,monochromeBatchEnabled:F.length>1&&R.length===F.length,activeFilters:a.length+l.length+u.length,selectedImageCount:Y,hasSelected:B,batchTask:function(e){if(r.length)switch(e){case ed.x6.DELETE:_({message:t("deleteConfirmation",{count:r.length}),confirm:function(){return(0,eh._)(function(){return(0,eg.YH)(this,function(e){return S(r),[2]})})()},deny:function(){return(0,eh._)(function(){return(0,eg.YH)(this,function(e){return[2,b(0)]})})()}});break;case ed.x6.ANIMATE:y(r);break;case ed.x6.DOWNLOAD:L(r);break;case ed.x6.EDIT:v({tags:(0,w.A)(W.map(function(e){return e.tags}).flat()),batch:W.map(function(e){return e.hash})}),P("editImages",{imageCount:(0,ej.y)(W.length)});break;case ed.x6.RGB:I(W.reduce(eA.iy,[]).map(function(e){return e.hash}))}},checkAll:function(){g(D.map(function(e){return e.hash}))},unCheckAll:function(){return g([])},filter:function(){return d(!0)},showSortOptions:function(){return h(!0)}}};var eI=[ed.x6.DOWNLOAD,ed.x6.DELETE,ed.x6.EDIT,ed.x6.ANIMATE],eE=[ed.x6.RGB],eC=function(e){switch(e){case ed.x6.DELETE:return"batchActions.delete";case ed.x6.ANIMATE:return"batchActions.animate";case ed.x6.DOWNLOAD:return"batchActions.download";case ed.x6.EDIT:return"batchActions.edit";case ed.x6.RGB:return"batchActions.rgb";default:return""}},eb=function(e){switch(e){case ed.x6.DELETE:return(0,r.jsx)(V.A,{});case ed.x6.ANIMATE:return(0,r.jsx)(et.A,{});case ed.x6.DOWNLOAD:return(0,r.jsx)(J.A,{});case ed.x6.EDIT:return(0,r.jsx)(u.A,{});case ed.x6.RGB:return(0,r.jsx)(en.A,{});default:return null}};let e_=function(e){var t=e.page,n=(0,o.c)("BatchButtons"),i=ev(t),a=i.hasPlugins,u=i.batchEnabled,c=i.monochromeBatchEnabled,d=i.activeFilters,h=i.selectedImageCount,g=i.hasSelected,f=i.batchTask,p=i.checkAll,x=i.unCheckAll,m=i.filter,A=i.showSortOptions,j=(0,l._)((0,s.useState)(null),2),v=j[0],I=j[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ea.A,{color:"tertiary",variant:"contained",sx:{"& .MuiButton-root":{width:40,height:40}},disableElevation:!0,children:[(0,r.jsx)(eo.A,{onClick:A,title:n("manageSorting"),children:(0,r.jsx)(er.A,{})}),(0,r.jsx)(eo.A,{onClick:m,title:n("manageFilters"),children:(0,r.jsx)(ei.A,{badgeContent:d,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(ee.A,{})})}),(0,r.jsx)(eo.A,{onClick:g?x:p,title:g?n("uncheckAll"):n("checkAll"),children:(0,r.jsx)(ei.A,{badgeContent:h,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(K.A,{})})}),eI.map(function(e){return(0,r.jsx)(eo.A,{disabled:!u,onClick:function(){return f(e)},title:n(eC(e)),children:eb(e)},e)}),eE.map(function(e){return(0,r.jsx)(eo.A,{disabled:!c,onClick:function(){return f(e)},title:n(eC(e)),children:eb(e)},e)}),a?(0,r.jsx)(eo.A,{disabled:!u,onClick:function(e){I(e.target)},title:n("usePlugin"),children:(0,r.jsx)(Q.A,{})}):null]}),(0,r.jsx)(ec,{pluginAnchor:v,onClose:function(){return I(null)}})]})};var ew=n(18891);let ey=function(e){var t=e.isBottom,n=e.page,i=e.isSticky;return(0,r.jsxs)(a.A,{direction:{xs:"column",md:"row"},alignItems:"center",gap:2,justifyContent:"space-between",sx:function(e){return(0,q._)({zIndex:20,backgroundColor:e.palette.background.default},i?{position:"sticky",top:"var(--navigation-height)",py:1,mx:-1}:{},t?{"@media (max-height: 900px)":{display:"none"}}:{})},children:[(0,r.jsx)(ew.A,{}),(0,r.jsx)(e_,{page:n})]})};var eL=n(36117),ek=n.n(eL),eS=n(46571),eT=n.n(eS),eM=n(14539),eG=n(16664),eP=n(14880),eV=n(12353),eD=n(96021),eF=n(9115),eR=n(50427),eW=n(94808),eY=n(36632),eB=n(11081),eN=n(41175),eO=n(84784),eH=n(24849);let eX=function(){var e=(0,k.C$)(),t=e.exportScaleFactors,n=e.exportFileTypes,r=e.handleExportFrame,i=e.fileNameStyle,o=(0,k.Vs)(),a=o.frames,l=o.palettes,u=o.images,c=(0,ef.A)().sendEvent;return{shareImage:(0,s.useCallback)(function(e){return(0,eh._)(function(){var o,s,d,h,g,f,p,x,A,j,v,I,E;return(0,eg.YH)(this,function(C){switch(C.label){case 0:if(!window.navigator.share)return[2];if(!(o=u.find(function(t){return e===t.hash})))throw Error("image not found");return s=a.find(function(e){return e.id===o.frame}),d=(0,m._)(t).pop()||4,h=(0,m._)(n).pop()||"png",g=(0,eO.j)([d],[h],r,l,i),[4,(0,eH.T)(u,a)(o.hash)];case 1:if(f=C.sent(),!s)return[3,3];return[4,(0,eN.mZ)(null==s?void 0:s.hash)];case 2:return x=C.sent(),[3,4];case 3:x=null,C.label=4;case 4:return A=(p=x)?p.upper.length/20:2,[4,g(o,f||[],A)];case 5:return v=(j=C.sent()[0]).blob,I=j.filename,E=j.title,window.navigator.share({files:[new File([v],I,{type:"image/png",lastModified:Date.now()})],title:E}).catch(function(){return"\xaf\\_(ツ)_/\xaf"}),c("shareImages",{imageCount:1}),[2]}})})()},[n,t,i,a,r,u,l,c])}};var ez=null,eZ=function(){if(null===ez)try{ez=window.navigator.canShare({files:[new File([new Blob(["t","e","s","t"])],"test.txt",{type:"text/plain",lastModified:Date.now()})]})}catch(e){ez=!1}return ez||!1},eU=function(e){var t=(0,o.c)("useGalleryImageContext"),n=(0,k.cr)(),r=n.imageSelection,i=n.updateImageSelection,a=n.filtersTags,l=n.filtersFrames,u=n.filtersPalettes,c=n.sortBy,d=n.recentImports,h=(0,k.I0)().setLightboxImage,g=(0,k.Vs)(),f=g.plugins,p=g.updateImageFavouriteTag,x=(0,C.Z)(),m=x.view,A=x.covers,j=(0,k.vT)().setEditImages,v=(0,k.M2)(),I=v.dismissDialog,E=v.setDialog,b=(0,ex.g)(),_=b.updateLastSyncLocalNow,w=b.deleteImages,y=(0,ep.A)().setDownloadImages,L=eX().shareImage,S=(0,ef.A)().sendEvent,T=(0,k.Vs)().images,M=(0,s.useMemo)(function(){return T.find(function(t){return t.hash===e})},[e,T]),G=r.includes(e);return{hasPlugins:!!f.length,isSelected:G,hasHashes:!!(null==M?void 0:M.hashes),isFavourite:(null==M?void 0:M.tags.includes(H.X3.FILTER_FAVOURITE))||!1,hasMeta:!!(null==M?void 0:M.meta),canShare:eZ(),startDownload:function(){return y([e])},deleteImage:function(){E({message:t("deleteImage",{title:(null==M?void 0:M.title)||"NO_TITLE"}),confirm:function(){return(0,eh._)(function(){return(0,eg.YH)(this,function(t){return w([e]),[2]})})()},deny:function(){return(0,eh._)(function(){return(0,eg.YH)(this,function(e){return[2,I(0)]})})()}})},shareImage:function(){return L(e)},showMetadata:function(){E({message:t("metaInfo",{title:(null==M?void 0:M.title)||"NO_TITLE"}),questions:function(){return[{key:"meta",type:eB.V.META,label:"",meta:{hash:e,hashes:(null==M?void 0:M.hashes)||void 0,meta:(null==M?void 0:M.meta)||void 0}}]},confirm:function(){return(0,eh._)(function(){return(0,eg.YH)(this,function(e){return[2,I(0)]})})()}})},updateImageToSelection:function(t){i(t,[e])},setLightboxImage:function(){h((0,em.S)(m,{filtersTags:a,filtersFrames:l,filtersPalettes:u,sortBy:c,recentImports:d}).filter(function(e){return!A.includes(e.hash)}).findIndex(function(t){return e===t.hash}))},updateFavouriteTag:function(t){p(t,e),_()},editImage:function(){j({tags:(null==M?void 0:M.tags)||[],batch:[e]}),S("editImages",{imageCount:1})}}},e$=n(81863),eq=n(15015),eK=n(34476),eJ=function(){var e=(0,eK.Z)().connectedDevices,t=(0,k.Vs)(),n=t.images,r=t.frames,i=(0,k.I0)().setError,o=(0,k.Ml)(),a=o.setProgress,l=o.startProgress,u=o.stopProgress,c=(0,s.useCallback)(function(e){return(0,eh._)(function(){var t;return(0,eg.YH)(this,function(i){switch(i.label){case 0:return[4,(0,eH.T)(n,r)(e,!0)];case 1:if((t=i.sent()).length)return[2,t];return[2,[]]}})})()},[r,n]),d=(0,s.useMemo)(function(){var t=e.find(function(e){return e.portDeviceType===eq._Y.SUPER_PRINTER_INTERFACE});return t?t.device:null},[e]),h=(0,s.useMemo)(function(){return!!d},[d]),g=(0,s.useCallback)(function(e){return(0,eh._)(function(){var t;return(0,eg.YH)(this,function(n){switch(n.label){case 0:if(!h||!d)return[2];return[4,c(e)];case 1:return t=n.sent(),[4,d.setup((0,e$.BX)({setProgress:a,startProgress:function(e){return(0,eh._)(function(){return(0,eg.YH)(this,function(t){return[2,l(e)]})})()},stopProgress:u,setError:function(e){i(Error(e))}}))];case 2:return n.sent(),[4,d.printImage(t)];case 3:return n.sent(),[2]}})})()},[h,c,d,i,a,l,u]);return{canPrint:h,print:g}},eQ=n(57203);let e0=function(e){var t=e.hash,n=e.menuAnchor,i=e.onClose,a=(0,o.c)("GalleryImageContextMenu"),c=(0,l._)((0,s.useState)(null),2),d=c[0],h=c[1],g=eU(t),f=g.canShare,p=g.isSelected,x=g.hasPlugins,m=g.isFavourite,A=g.hasMeta,j=g.hasHashes,v=g.deleteImage,I=g.setLightboxImage,E=g.shareImage,C=g.startDownload,b=g.showMetadata,_=g.updateImageToSelection,w=g.updateFavouriteTag,y=g.editImage,L=eJ(),k=L.canPrint,S=L.print,T=(0,Y.t)().createGroup;return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(R.A,{open:!!n,anchorEl:n,onClose:i,onClick:function(e){e.stopPropagation()},children:[(0,r.jsxs)(W.A,{onClick:function(){y(),i()},title:a("edit"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(u.A,{})}),(0,r.jsx)(F.A,{children:a("edit")})]}),(0,r.jsxs)(W.A,{onClick:function(){C(),i()},title:a("download"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(J.A,{})}),(0,r.jsx)(F.A,{children:a("download")})]}),(0,r.jsxs)(W.A,{onClick:function(){v(),i()},title:a("delete"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(V.A,{})}),(0,r.jsx)(F.A,{children:a("delete")})]}),(0,r.jsxs)(W.A,{onClick:function(){I(),i()},title:a("viewInLightbox"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(eR.A,{})}),(0,r.jsx)(F.A,{children:a("viewInLightbox")})]}),k&&(0,r.jsxs)(W.A,{onClick:function(){S(t),i()},title:a("printViaSuperPrinter"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(eW.A,{})}),(0,r.jsx)(F.A,{children:a("printViaSuperPrinter")})]}),x?(0,r.jsxs)(W.A,{onClick:function(e){h(e.target)},title:a("usePlugin"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(Q.A,{})}),(0,r.jsx)(F.A,{children:a("usePlugin")})]}):null,f?(0,r.jsxs)(W.A,{onClick:function(){E(),i()},title:a("share"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(eY.A,{})}),(0,r.jsx)(F.A,{children:a("share")})]}):null,(0,r.jsxs)(W.A,{onClick:function(){w(!m),i()},title:a(m?"removeFromFavourites":"addToFavourites"),children:[(0,r.jsx)(D.A,{children:m?(0,r.jsx)(eF.A,{}):(0,r.jsx)(eD.A,{})}),(0,r.jsx)(F.A,{children:a(m?"removeFromFavourites":"addToFavourites")})]}),(0,r.jsxs)(W.A,{onClick:function(){_(p?eQ.N.REMOVE:eQ.N.ADD),i()},title:a(p?"removeFromSelection":"addToSelection"),children:[(0,r.jsx)(D.A,{children:p?(0,r.jsx)(eG.A,{}):(0,r.jsx)(K.A,{})}),(0,r.jsx)(F.A,{children:a(p?"removeFromSelection":"addToSelection")})]}),(A||j)&&(0,r.jsxs)(W.A,{onClick:function(){b(),i()},title:a("showMetadata"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(eP.A,{})}),(0,r.jsx)(F.A,{children:a("showMetadata")})]}),p&&(0,r.jsxs)(W.A,{onClick:function(){T(t),i()},title:a("createGroup"),children:[(0,r.jsx)(D.A,{children:(0,r.jsx)(eV.A,{})}),(0,r.jsx)(F.A,{children:a("createGroup")})]})]}),(0,r.jsx)(ec,{pluginAnchor:d,hash:t,onClose:function(){h(null),i()}})]}):null};var e1=n(45485),e2=n(72183),e4=n(46019);ek().extend(eT());let e5=function(e){var t=e.page,n=e.hash,i=(0,k.C$)(),o=i.enableDebug,a=i.galleryClickAction,l=(0,e4.f)(n),u=l.galleryImageData,c=l.updateImageSelection,d=eU(n),h=d.setLightboxImage,g=d.editImage,f=(0,e2.N)().formatterGallery,p=(0,s.useMemo)(function(){return[n].concat((0,m._)((null==u?void 0:u.hashes)?Object.keys(u.hashes).map(function(e){var t;return"".concat(e.toUpperCase(),": ").concat(null==(t=u.hashes)?void 0:t[e])}):[])).filter(Boolean).join("\n")},[u,n]),x=(0,s.useCallback)(function(e){c((null==u?void 0:u.selectionIndex)!==-1?eQ.N.REMOVE:eQ.N.ADD,e,t)},[u,t,c]),A=(0,s.useCallback)(function(e){if(e.preventDefault(),e.ctrlKey||e.shiftKey)return void x(e.shiftKey);switch(a){case e1.n.VIEW:h();break;case e1.n.EDIT:g();break;case e1.n.SELECT:default:x(e.shiftKey)}},[g,a,h,x]);if(!u)return null;var j=u.created,v=u.title,I=u.tags,E=u.selectionIndex;return(0,r.jsx)(P.A,{selectionText:-1!==E?(E+1).toString(10):"",title:v,subheader:f(j),wrapperProps:{onClick:A,disableRipple:!0,sx:{display:"block",width:"100%",textAlign:"left"}},contextMenuComponent:e0,contextMenuProps:{hash:n},media:(0,r.jsx)(N.A,{hash:n}),content:(I.length>0||p&&o)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{tags:I}),(0,r.jsx)(eM.A,{text:p})]})})},e3=function(e){var t=(0,o.c)("GalleryNumbers"),n=[t("imageCount",{count:e.imageCount})];return e.filteredCount&&n.push(t("filteredCount",{count:e.filteredCount})),e.selectedCount&&n.push(t("selectedCount",{count:e.selectedCount})),(0,r.jsx)(i.A,{component:"h2",variant:"caption",children:n.join(t("separator"))})};var e6=n(2294),e9=n(30612),e8=n(80637),e7=n(53595),te=n(73444),tt=n(5602);let tn=function(e){var t=(0,o.c)("PaginationButton"),n=(0,C.Z)().getUrl;return(0,r.jsx)(eo.A,{component:e.disabled?"span":x(),disabled:e.disabled,href:n({pageIndex:e.page}),title:t("toPage",{page:e.page+1}),children:e.children})},tr=function(e){var t=e.page,n=e.maxPageIndex,s=(0,o.c)("Pagination");if(0===n)return null;var l=[{icon:(0,r.jsx)(e9.A,{}),pageIndex:t-1,disabled:t<1},null,{icon:(0,r.jsx)(e8.A,{}),pageIndex:t+1,disabled:n<t+1}];return n>5&&(l.unshift({icon:(0,r.jsx)(e7.A,{}),pageIndex:t-5,disabled:t<5}),l.push({icon:(0,r.jsx)(te.A,{}),pageIndex:t+5,disabled:n<t+5})),n>1&&(l.unshift({icon:(0,r.jsx)(e6.A,{}),pageIndex:0,disabled:0===t}),l.push({icon:(0,r.jsx)(tt.A,{}),pageIndex:n,disabled:t===n})),(0,r.jsx)(a.A,{direction:"row",justifyContent:"space-around",children:(0,r.jsx)(ea.A,{color:"tertiary",variant:"contained",disableElevation:!0,sx:{"& .MuiButton-root":{width:40,height:40}},children:l.map(function(e){if(!e)return(0,r.jsx)(i.A,{component:"span",variant:"body1",sx:{px:2,display:"flex",alignItems:"center"},children:s("pageCount",{current:t+1,total:n+1})},"current");var o=e.icon,a=e.pageIndex,l=e.disabled;return(0,r.jsx)(tn,{page:a,disabled:l,children:o},a)})})})};var ti=n(89041),to=n(25184),ta=n.n(to),ts=n(40433);let tl=function(){var e=(0,o.c)("StorageWarning"),t=(0,ts.j)().criticalStorageEstimate;if(!t)return null;var n=e("storageTypes.".concat(t.type));return(0,r.jsxs)(M.A,{title:e("usageTooltip",{used:ta()(t.used)||"",total:ta()(t.total)||""}),sx:{position:"relative"},children:[(0,r.jsx)(ti.A,{variant:"determinate",value:t.percentage,sx:{width:"100%",height:"34px"},color:"error"}),(0,r.jsx)(i.A,{variant:"body2",color:"fgtext",sx:{position:"absolute",p:1,top:0},children:e("usageWarning",{percentage:t.percentage.toFixed(2),type:n})})]})};var tu=n(20063),tc=n(66375),td=n(42485);let th=function(e,t,n,r,i){var o=e.images,a=e.groups;return(0,m._)(o).filter((0,tc.A)(t,n,r,i,a)).filter((0,td.A)(t)).length};var tg=function(){var e=(0,C.Z)(),t=e.pageIndex,n=e.getUrl,r=e.view,i=e.covers,o=e.isWorking,a=(0,k.C$)().pageSize,l=(0,k.cr)(),u=l.imageSelection,c=l.filtersTags,d=l.filtersPalettes,h=l.filtersFrames,g=l.recentImports,f=l.sortBy,p=(0,k.Vs)().images.length,x=th(r,c,h,d,g),m=a?Math.ceil(r.images.length/a):1,A=Math.max(0,Math.min(t,Math.max(0,m-1)));m>0&&A!==t&&(0,tu.redirect)(n({pageIndex:A}));var j=A*a,v=u.length,I=(0,s.useMemo)(function(){return(0,em.S)(r,{filtersTags:c,filtersFrames:h,filtersPalettes:d,recentImports:g,sortBy:f}).splice(j,a||1/0)},[h,d,c,j,a,g,f,r]);return{totalImageCount:p,selectedCount:v,filteredCount:x,page:A,maxPageIndex:(0,s.useMemo)(function(){return a?Math.ceil(th(r,c,h,d,g)/a)-1:0},[h,d,c,a,g,r]),images:I,covers:i,isWorking:o}};let tf=function(){var e=tg(),t=e.totalImageCount,n=e.selectedCount,i=e.filteredCount,o=e.page,s=e.maxPageIndex,l=e.images,u=e.covers,c=e.isWorking;return(0,r.jsxs)(a.A,{direction:"column",gap:2,children:[(0,r.jsx)(tl,{}),(0,r.jsx)(e3,{imageCount:t,selectedCount:n,filteredCount:i}),(0,r.jsx)(S,{}),(0,r.jsx)(ey,{page:o,isSticky:!0}),s>0&&(0,r.jsx)(tr,{page:o,maxPageIndex:s}),(0,r.jsx)(T.A,{showLoader:c,children:l.map(function(e){return u.includes(e.hash)?(0,r.jsx)($,{hash:e.hash},e.hash):(0,r.jsx)(e5,{hash:e.hash,page:o},e.hash)})}),l.length>=3&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tr,{page:o,maxPageIndex:s}),(0,r.jsx)(ey,{page:o,isBottom:!0})]})]})};function tp(){var e=(0,o.c)("Navigation");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{component:"h1",variant:"h1",children:e("gallery")}),(0,r.jsx)(tf,{})]})}}},e=>{e.O(0,[5266,7400,8955,3632,317,1346,7115,4688,4647,3683,2968,7164,9144,8428,1870,4455,5668,8558,6265,4246,4468,3231,4599,5999,8441,9342,1255,7358],()=>e(e.s=84300)),_N_E=e.O()}]);