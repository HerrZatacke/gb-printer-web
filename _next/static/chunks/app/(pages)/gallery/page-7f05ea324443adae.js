(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5991],{933:(e,t,n)=>{"use strict";n.d(t,{E:()=>l});var r,a=n(97004),i=n(39249),o=n(24463),l=function(e,t){var l,u,s,c,d=(l=(0,a._)(function(){var a;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(r)return[3,2];return[4,Promise.all([n.e(9268),n.e(5678),n.e(1753),n.e(1575)]).then(n.bind(n,94979))];case 1:a=i.sent().dropBoxSyncTool,r=r||a(e,t),i.label=2;case 2:return[2,r]}})}),function(){return l.apply(this,arguments)});return o.A.getState().dropboxStorage.use&&d(),{recoverImageData:(u=(0,a._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().recoverImageData(e)]}})}),function(e){return u.apply(this,arguments)}),startAuth:(0,a._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return[2,e.sent().startAuth()]}})}),startSyncData:(s=(0,a._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().startSyncData(e)]}})}),function(e){return s.apply(this,arguments)}),startSyncImages:(0,a._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return[2,e.sent().startSyncImages()]}})}),updateSettings:(c=(0,a._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().updateSettings(e)]}})}),function(e){return c.apply(this,arguments)}),subscribe:function(){var e;return o.A.subscribe(function(e){return e.dropboxStorage},(e=(0,a._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return t.sent().updateSettings(e),[2]}})}),function(t){return e.apply(this,arguments)}))}}}},6617:(e,t,n)=>{"use strict";n.d(t,{h:()=>l,i:()=>o});var r=n(97004),a=n(39249),i=n(12115),o=(0,i.createContext)({runWithImage:(0,r._)(function(){return(0,a.YH)(this,function(e){throw Error("Plugin Context is missing")})}),runWithImages:(0,r._)(function(){return(0,a.YH)(this,function(e){throw Error("Plugin Context is missing")})}),validateAndAddPlugin:(0,r._)(function(){return(0,a.YH)(this,function(e){throw Error("Plugin Context is missing")})})}),l=function(){return(0,i.useContext)(o)}},14633:(e,t,n)=>{Promise.resolve().then(n.bind(n,700)),Promise.resolve().then(n.bind(n,79166))},15821:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var r=n(78538),a=n(44054),i=n(95155),o=n(69242),l=n(53267),u=n(7642),s=n(36114),c=n(71977),d=n(99927),f=n(54492),h=n(3127),g=n(16324),p=n(51095),m=n(12115);let x=function(e){var t=e.confirm,n=e.canConfirm,r=e.deny;(0,m.useEffect)(function(){var e=function(e){"Escape"===e.key&&r&&r(),"Enter"===e.key&&e.ctrlKey&&t&&n&&t()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,n,r])};var v=function(e,t,n,r){var i={};if(r?(i.padding="8px !important",i.overflowX="hidden",i.overflowY="hidden"):(i.scrollbarGutter="stable",i.overflowY="scroll"),n)return i;switch(void 0===t?"undefined":(0,a._)(t)){case"string":i.height=t;break;case"number":i.height="".concat(t,"px")}switch(void 0===e?"undefined":(0,a._)(e)){case"string":i.width=e;break;case"number":i.width="".concat(e,"px");break;default:i.width="440px"}return i};let I=function(e){var t=e.contentHeight,n=e.contentWidth,a=e.header,I=e.closeTitle,A=e.children,j=e.confirm,E=e.deny,b=e.canConfirm,C=e.headerOnly,w=e.fullSize,y=e.open,T=e.keepMounted,S=e.closeOnOverlayClick,k=e.headerActionButtons,_=e.actionButtons,P=(0,r._)((0,m.useState)(),2),D=P[0],M=P[1];x({confirm:j,canConfirm:b||!1,deny:E}),(0,m.useEffect)(function(){M(document.body)},[]);var F=(0,g.default)(),G=(0,p.A)(F.breakpoints.down("md")),N=v(n,t,G,w);return(0,i.jsxs)(s.default,{container:D,fullScreen:G||w,maxWidth:"lg",open:"boolean"!=typeof y||y,onClose:E,"aria-label":"string"==typeof a?a:void 0,keepMounted:"boolean"!=typeof T||T,disableEscapeKeyDown:!("boolean"!=typeof S||S),sx:{paddingRight:"10px"},children:[(0,i.jsxs)(f.default,{sx:{display:"flex",justifyContent:"space-between",gap:2,maxWidth:N.width},children:[(0,i.jsx)(l.default,{sx:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:a}),(0,i.jsxs)(l.default,{sx:{my:-.5,mr:-2},children:[k,E?(0,i.jsx)(h.default,{title:I||"Close ".concat("string"==typeof a?a:""),color:"inherit",onClick:E,children:(0,i.jsx)(o.A,{})}):null]})]}),!C&&(0,i.jsx)(d.default,{sx:N,children:A}),(0,i.jsxs)(c.default,{children:[_,E?(0,i.jsx)(u.default,{onClick:E,color:"primary",variant:"outlined",children:"Cancel"}):null,j?(0,i.jsx)(u.default,{disabled:!1===b,color:"primary",variant:"contained",onClick:j,children:"Ok"}):null]})]})}},23747:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>b,BF:()=>A,Ll:()=>I});var r=n(97004),a=n(693),i=n(60376),o=n(78538),l=n(39249),u=n(30832),s=n.n(u),c=n(12115),d=n(5432),f=n(95939),h=n(33782),g=n(45465),p=n(3381),m=n(71620),x=n(11760),v=n(80360),I="NEW_GROUP",A=function(e){return e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase()},j=function(e,t){return e.find(function(e){return e.group.groups.find(function(e){return e.id===t})})||null},E=function(e){return e.CREATE_NEW="CREATE_NEW",e.EDIT_EXISTING="EDIT_EXISTING",e.NOT_EDITING="NOT_EDITING",e}(E||{});let b=function(){var e,t=(0,m.A)().imageSelection,n=(0,p.A)(),u=n.editImageGroup,E=n.cancelEditImageGroup,b=(0,x.h)(),C=b.imageGroups,w=b.addImageGroup,y=b.updateImageGroup,T=b.groupImagesAdd,S=b.ungroupImages,k=(0,h.g)(),_=k.navigateToGroup,P=k.navigateToImage,D=(0,f.Z)(),M=D.view,F=D.paths,G=D.pathsOptions,N=(0,g.Y)().path,L=t.length,O=(null==u?void 0:u.groupId)?u.groupId===I?"CREATE_NEW":"EDIT_EXISTING":"NOT_EDITING",R=(0,c.useMemo)(function(){switch(O){case"CREATE_NEW":var e=(null==u?void 0:u.newGroupTitle)||"";return{imageGroup:null,parentPathMap:F.find(function(e){return e.group.id===M.id})||null,title:e,slug:A(e),slugTouched:!1};case"EDIT_EXISTING":var t=C.find(function(e){return e.id===(null==u?void 0:u.groupId)})||null;return{imageGroup:t,parentPathMap:(null==u?void 0:u.groupId)?j(F,u.groupId):null,title:(null==t?void 0:t.title)||"",slug:(null==t?void 0:t.slug)||"",slugTouched:!0};default:return{imageGroup:null,parentPathMap:null,title:"",slug:"",slugTouched:!1}}},[u,O,C,F,M]),B=(0,o._)((0,c.useState)(R.title),2),Y=B[0],H=B[1],W=(0,o._)((0,c.useState)(R.slug),2),V=W[0],z=W[1],U=(0,o._)((0,c.useState)(R.slugTouched),2),Z=U[0],X=U[1],K=(0,o._)((0,c.useState)((null==(e=R.parentPathMap)?void 0:e.absolutePath)||""),2),q=K[0],$=K[1],Q=(0,c.useMemo)(function(){if(!(null==u?void 0:u.groupId))return"";if((null==u?void 0:u.groupId)===I)return"".concat(N).concat(V,"/");var e=j(F,u.groupId),t=(null==e?void 0:e.absolutePath)||"";return"".concat(t).concat(V,"/")},[u,F,N,V]),J=(0,c.useMemo)(function(){return!!F.find(function(e){return e.absolutePath===Q})},[Q,F]),ee=(0,c.useMemo)(function(){var e;return V!==(null==(e=R.imageGroup)?void 0:e.slug)},[R,V]),et=(0,c.useMemo)(function(){return!!V&&("CREATE_NEW"===O?!J:"EDIT_EXISTING"===O&&(!ee||!J))},[O,V,J,ee]),en=(0,c.useMemo)(function(){var e,t,n=(null==(e=F.find(function(e){return e.absolutePath===q}))?void 0:e.group.id)||"";return((null==(t=R.parentPathMap)?void 0:t.group.id)||"")!==n},[R,q,F]),er=(0,c.useMemo)(function(){switch(O){case"EDIT_EXISTING":var e,t=(null==(e=F.find(function(e){return e.group.id===(null==u?void 0:u.groupId)}))?void 0:e.absolutePath)||"";return G.filter(function(e){var n=e.value;return!n.startsWith(Q)&&n!==t});case"CREATE_NEW":return G;default:return[]}},[Q,u,O,F,G]);return{editId:(null==u?void 0:u.groupId)||null,absoluteSlug:Q,possibleParents:er,slug:V,title:Y,canConfirm:et,canMove:en,slugIsInUse:J,slugWasChanged:ee,parentSlug:q,selectionCount:L,setSlug:function(e){z(e),X(!0)},setTitle:function(e){H(e),(e.length<2||!Z)&&(X(!1),z(A(e)))},setParentSlug:$,confirm:function(){if(E(),et&&u){var e,n=(null==(e=F.find(function(e){return e.absolutePath===q}))?void 0:e.group.id)||"";if(u.groupId===I){if(!u.newGroupCover)return;var r=(0,v.z)();w({id:r,slug:V,title:Y,created:s()(Date.now()).format(d.i$),coverImage:u.newGroupCover,images:t,groups:[]},n),_(r,0)}else{if(!R.imageGroup)return;y((0,i._)((0,a._)({},R.imageGroup),{slug:V,title:Y}),n),_(u.groupId,0)}}},move:(0,r._)(function(){var e,n;return(0,l.YH)(this,function(r){return E(),en&&((n=(null==(e=F.find(function(e){return e.absolutePath===q}))?void 0:e.group.id)||"")?T(n,t):S(t),P(t[0])),[2]})}),cancelEditImageGroup:E}}},39630:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info",e.IMAGE="image",e.META="meta",e}({})},40082:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(95155),a=n(12115),i=n(97004),o=n(78538),l=n(39249),u=n(5432),s=n(83936),c=n(633),d=n(11760),f=n(53982),h=n(933),g=n(5847),p=function(e){var t,n=e.hash,r=e.hashes,p=e.palette,m=e.invertPalette,x=e.framePalette,v=e.invertFramePalette,I=e.lockFrame,A=e.frameId,j=e.rotation,E=(0,o._)((0,a.useState)(null),2),b=E[0],C=E[1],w=(0,c.g)(),y=(0,s.W)().remoteImport,T=(0,d.h)(),S=T.frames,k=T.palettes,_=T.images,P=null==(t=S.find(function(e){return e.id===A}))?void 0:t.hash,D=(0,a.useCallback)(function(e,t,n){return(0,g.T)(_,S,function(){(0,h.E)(w,y).recoverImageData(e)})(e,t,n,r)},[_,S,r,w,y]),M=(0,a.useMemo)(function(){return"string"==typeof p?(k.find(function(e){return e.shortName===p})||u.Fv).palette:p},[k,p]);return(0,a.useEffect)(function(){var e,t=!1;return n||C(null),(e=(0,i._)(function(){var e,r,a,i;return(0,l.YH)(this,function(o){switch(o.label){case 0:if(t)return[2];return[4,D(n,!1,A)];case 1:if(e=o.sent(),!P)return[3,3];return[4,(0,f.mZ)(P)];case 2:return a=o.sent(),[3,4];case 3:a=null,o.label=4;case 4:if(i=(r=a)?r.upper.length/20:2,t)return[2];return e&&C({tiles:e,palette:M,invertPalette:m,imageStartLine:i,lockFrame:I,rotation:j,framePalette:I?x:p,invertFramePalette:I?v:m}),[2]}})}),function(){return e.apply(this,arguments)})(),function(){t=!0}},[D,n,A,p,m,I,j,M,P,x,v]),{gbImageProps:b}},m=n(93370),x=n(66564);let v=function(e){var t=e.hash,n=e.hashes,a=e.frameId,i=e.lockFrame,o=e.invertPalette,l=e.invertFramePalette,u=e.palette,s=e.framePalette,c=e.rotation,d=e.asThumb,f=p({hash:t,hashes:n,frameId:a,lockFrame:i,invertPalette:o,invertFramePalette:l,palette:u,framePalette:s,rotation:c}).gbImageProps;return f?(0,r.jsx)(m.A,{lockFrame:f.lockFrame,invertPalette:f.invertPalette,invertFramePalette:f.invertFramePalette,tiles:f.tiles,palette:f.palette,framePalette:f.framePalette,imageStartLine:f.imageStartLine,rotation:f.rotation,asThumb:d}):(0,r.jsx)(x.A,{})}},61564:(e,t,n)=>{"use strict";n.d(t,{t:()=>g});var r=n(97004),a=n(39249),i=n(12115),o=n(33236),l=n(39630),u=n(95939),s=n(23747),c=n(41186),d=n(3381),f=n(71620),h=n(11760),g=function(){var e=(0,u.Z)().view,t=(0,c.A)(),n=t.dismissDialog,g=t.setDialog,p=(0,d.A)().setEditImageGroup,m=(0,h.h)(),x=m.deleteImageGroup,v=m.setImageGroups,I=m.images,A=(0,f.A)().imageSelection,j=(0,i.useMemo)(function(){if(!A.length)return"";var e,t=I.filter(function(e){var t=e.hash;return A.includes(t)}).map(function(e){return e.title}).filter(function(e){return e.length>3}),n=null==(e=(0,o.Hg)(t).filter(function(e){return e.length>3})[0])?void 0:e.trim();return n?n.replace(/[_-]/g," ").replace(/^\s*\d+\s+|\s+\d+\s*$/g,"").trim():"New Group"},[A,I]);return{resetGroups:function(){g({message:"Reset image groups?",questions:function(){return[{key:"info",type:l.V.INFO,label:"This will remove ALL your created groups and all existing images will be moved to the top level."}]},confirm:(0,r._)(function(){return(0,a.YH)(this,function(e){return n(0),v([]),[2]})}),deny:(0,r._)(function(){return(0,a.YH)(this,function(e){return n(0),[2]})})})},createGroup:function(e){p({groupId:s.Ll,newGroupCover:e,newGroupTitle:j})},editGroup:function(e){p({groupId:e})},deleteGroup:function(t){var i=e.groups.find(function(e){return e.id===t});i&&g({message:"Delete image group?",questions:function(){return[{key:"info",type:l.V.INFO,label:'This will delete this group "'.concat(i.title||i.slug,'" and move all children (images & groups) to the current level.')}]},confirm:(0,r._)(function(){return(0,a.YH)(this,function(e){return n(0),x(t),[2]})}),deny:(0,r._)(function(){return(0,a.YH)(this,function(e){return n(0),[2]})})})}}}},75097:(e,t,n)=>{"use strict";n.d(t,{No:()=>a,Q3:()=>i,RQ:()=>o,x6:()=>r});var r=function(e){return e.DELETE="delete",e.ANIMATE="animate",e.DOWNLOAD="download",e.EDIT="edit",e.RGB="rgb",e}({}),a=function(e){return e.LOCK_FRAME="lockFrame",e.FRAME="frame",e.PALETTE="palette",e.TITLE="title",e.TAGS="tags",e.CREATED="created",e.ROTATION="rotation",e}({}),i=function(e){return e.INVERT_PALETTE="invertPalette",e.FRAME_PALETTE="framePalette",e.INVERT_FRAME_PALETTE="invertFramePalette",e}({}),o=["lockFrame","frame","title","tags","created","rotation","palette","invertPalette","framePalette","invertFramePalette"]},79166:(e,t,n)=>{"use strict";n.d(t,{default:()=>tj});var r=n(95155),a=n(7068),i=n(12115),o=n(78538),l=n(28890),u=n(99125),s=n(78107),c=n(10431),d=n(3127),f=n(31960),h=n(6874),g=n.n(h),p=n(577),m=n(4420),x=n(16324),v=n(26076),I=n(58173),A=n(15821),j=n(95939),E=n(70940),b=n(45465),C=function(){var e=(0,b.Y)(),t=e.path,n=e.getUrl,r=(0,j.Z)(),a=r.root,o=r.paths,l=(0,E.n)(),u=l.getImagePageIndexInGroup,s=l.navigateToGroup;return{segments:(0,i.useMemo)(function(){var e=[""].concat((0,p._)(t.split("/").filter(Boolean))),r=e.reduce(function(t,n,r){return(0,p._)(t).concat([e.slice(1,r+1).join("/").concat("/")])},[]),i=r.reduce(function(e,t){var n;return(n="/"===t?{absolutePath:"",group:a}:o.find(function(e){return e.absolutePath===t}))?(0,p._)(e).concat([n]):e},[]),l=i.map(function(e,t){var r=i[t+1],a=0;return r&&(a=u(r.group.coverImage,e.group)),{group:e.group,link:n({pageIndex:a,group:e.absolutePath})}});return r.length!==l.length&&s(l[l.length-1].group.id,0),l},[t,a,o,n,u,s])}},w=n(55685);function y(e){var t=e.group,n=e.onClick,a=(0,E.n)().getGroupPath;return(0,r.jsx)(I.y,{itemId:t.id,label:(0,r.jsx)(f.default,{component:g(),href:a(t.id,0),onClick:n,sx:{display:"block"},children:t.title}),sx:function(e){return{"& > .MuiTreeItem-content.Mui-selected":{backgroundColor:(0,m.X4)(e.palette.secondary.main,.8),color:e.palette.secondary.contrastText,"&:hover,&.Mui-focused":{backgroundColor:e.palette.secondary.main}}}},children:t.groups.map(function(e){return(0,r.jsx)(y,{group:e,onClick:n},e.id)})})}let T=function(e){var t=e.open,n=e.onClose,a=(0,j.Z)(),l=a.pathsOptions,u=a.root,s=(0,E.n)().currentGroup,c=(0,x.default)(),d=C().segments,f=(0,o._)((0,i.useState)([]),2),h=f[0],g=f[1];return((0,i.useEffect)(function(){g(function(e){var t=d.map(function(e){return e.group.id});return(0,w.A)((0,p._)(t).concat((0,p._)(e)))})},[d]),l.length<2)?null:(0,r.jsx)(A.A,{contentHeight:"60vh",contentWidth:"auto",deny:n,open:t,header:"Gallery Navigation",keepMounted:!1,children:(0,r.jsx)(v.G,{expansionTrigger:"iconContainer",expandedItems:h,onExpandedItemsChange:function(e,t){return g(t)},selectedItems:s.id,sx:{width:c.breakpoints.values.sm,height:"60vh"},children:(0,r.jsx)(y,{group:u,onClick:n})})})};var S=n(3381);let k=function(){var e=(0,j.Z)().pathsOptions,t=(0,S.A)().setEditImageGroup,n=C().segments,h=(0,o._)((0,i.useState)(!1),2),p=h[0],m=h[1];return e.length<2?null:(0,r.jsxs)(a.default,{direction:"row",gap:2,justifyContent:"space-between",alignItems:"center",children:[(0,r.jsx)(c.default,{children:n.map(function(e,n){var i,o=e.group,s=e.link;return(0,r.jsxs)(a.default,{direction:"row",gap:.5,alignItems:"center",children:[n>0?(0,r.jsx)(f.default,{component:g(),title:o.title,href:s,children:n?(i=o.title,i.length<30?i:"".concat(i.slice(0,30),"…")):(0,r.jsx)(u.A,{fontSize:"small"})}):(0,r.jsx)(d.default,{component:g(),title:o.title,href:s,sx:{fontSize:16},children:(0,r.jsx)(u.A,{fontSize:"inherit"})}),n>0&&(0,r.jsx)(d.default,{onClick:function(){return t({groupId:o.id})},title:'Edit group "'.concat(o.title,'"'),sx:{fontSize:16},children:(0,r.jsx)(l.A,{fontSize:"inherit"})})]},o.id)})}),(0,r.jsx)(d.default,{title:"Open Gallery Navigation",onClick:function(){return m(!0)},children:(0,r.jsx)(s.A,{})}),(0,r.jsx)(T,{open:p,onClose:function(){return m(!1)}})]})};var _=n(84131),P=n(53267),D=n(78921),M=n(74666),F=n(19505),G=n(39489),N=n(85222),L=n(13313),O=n(76380),R=n(61564);let B=function(e){var t=e.groupId,n=e.menuAnchor,a=e.onClose,i=(0,R.t)(),o=i.deleteGroup,u=i.editGroup;return n?(0,r.jsxs)(L.default,{open:!!n,anchorEl:n,onClose:a,onClick:function(e){e.stopPropagation(),a()},children:[(0,r.jsxs)(O.default,{onClick:function(){return u(t)},title:"Edit",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(l.A,{})}),(0,r.jsx)(N.default,{children:"Edit"})]}),(0,r.jsxs)(O.default,{onClick:function(){return o(t)},title:"Delete",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(F.A,{})}),(0,r.jsx)(N.default,{children:"Delete"})]})]}):null};var Y=n(40082),H=n(41101),W=n(19864),V=function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())};let z=function(e){var t,n=e.tags,i=e.fromGroup,o=[];if(i){var l=n.sort(V).filter(function(e){return!W.rx.includes(e)});t=l.slice(0,3),o=l.slice(3,-1)}else t=n;var u=i?"secondary":"tertiary";return(0,r.jsxs)(a.default,{component:"ul",direction:"row",gap:.66,flexWrap:"wrap",sx:function(e){return{"& .MuiChip-root":{fontSize:"0.75rem",height:e.spacing(2.5),padding:0}}},children:[t.sort(V).map(function(e){return(0,r.jsx)(H.default,{title:e===W.X3.FILTER_FAVOURITE?"Favourite":e,label:e===W.X3.FILTER_FAVOURITE?"❤️":e,size:"small",color:u},e)}),o.length>0&&(0,r.jsx)(H.default,{variant:"outlined",title:"+".concat(o.length," more tags:\n").concat(o.join("\n")),label:"+".concat(o.length," more"),size:"small"})]})};var U=n(4862),Z=function(e){var t,n=(0,j.Z)(),r=n.paths,a=n.view.groups.find(function(t){return t.coverImage===e})||null,i=(null==(t=r.find(function(e){return e.group.id===(null==a?void 0:a.id)}))?void 0:t.absolutePath)||null;return{group:a,path:i}},X=n(5432),K=n(71620),q=n(11760),$=n(52166),Q=n(66785),J=n(18335),ee=n(86964),et=n(55364),en=function(e){var t=(0,S.A)().setEditImages,n=(0,$.A)().pageSize,r=(0,K.A)(),a=r.filtersActiveTags,o=r.sortBy,l=r.recentImports,u=r.imageSelection,s=r.updateImageSelection,c=r.lastSelectedImage,d=r.setImageSelection,f=(0,q.h)(),h=f.palettes,g=f.images,p=u.indexOf(e),m=(0,i.useMemo)(function(){var t,n=g.find(function(t){return t.hash===e}),r=[];if(n){var a=(0,J.s)(h,n),i=a.palette,o=a.framePalette,l=(0,ee.f)(n),u=l.invertPalette,s=l.invertFramePalette;if(!i)throw Error("Palette missing?");return(0,et.pl)(n)?t=i:(t=(i||X.Fv).palette,r=(o||X.Fv).palette),{title:n.title,created:n.created,frame:n.frame,hashes:n.hashes||void 0,tags:n.tags,palette:t,framePalette:r,lockFrame:n.lockFrame,invertPalette:u,invertFramePalette:s,rotation:n.rotation,selectionIndex:p}}},[e,p,h,g]),x=(0,j.Z)().images;return{galleryImageData:m,updateImageSelection:function(t,r,i){if(r){var u=(0,Q.S)(x,{filtersActiveTags:a,sortBy:o,recentImports:l}),f=u.findIndex(function(t){return t.hash===e}),h=u.findIndex(function(e){return e.hash===c});-1===h&&(h=i*n);var g=Math.min(h,f),p=Math.max(h,f);d(u.slice(g,p+1).map(function(e){return e.hash}))}else s(t,[e])},editImage:function(n){t({tags:n,batch:[e]})}}};let er=function(e){var t=e.hash,n=(0,b.Y)().getUrl,a=Z(t),i=a.group,o=a.path,l=en(t).galleryImageData,u=(0,$.A)().galleryView,s=[U.j.GALLERY_VIEW_SMALL,U.j.GALLERY_VIEW_1X].includes(u);if(!l||!i)return null;var c=l.hashes,d=l.palette,f=l.invertPalette,h=l.framePalette,p=l.frame,x=l.lockFrame,v=l.rotation;return(0,r.jsx)(M.A,{selectionText:"",title:i.title,subheader:"".concat(i.images.length," items"),wrapperProps:{component:g(),href:n({group:o||"",pageIndex:0}),sx:{textDecoration:"none"}},contextMenuComponent:B,contextMenuProps:{groupId:i.id},media:(0,r.jsxs)(P.default,{sx:{position:"relative",margin:"0 auto","& > .MuiBox-root":{position:"absolute",top:0,img:{transform:"scale(0.5)"}}},children:[(0,r.jsx)(D.default,{viewBox:"0 0 24 21",color:"secondary",sx:function(e){return{width:"100%",height:"100%",fill:(0,m.au)(e.palette.secondary.main,e.palette.fgtext.main,.25)}},children:(0,r.jsx)("path",{d:"M 10,2 H 4 C 2.9,2 2.01,2.9 2.01,4 L 2,16 c 0,1.1 0.9,2 2,2 h 16 c 1.1,0 2,-0.9 2,-2 V 6 C 22,4.9 21.1,4 20,4 h -8 z"})}),(0,r.jsx)(Y.A,{lockFrame:x,invertPalette:f,framePalette:h,palette:d,frameId:p,hash:t,hashes:c,rotation:v,asThumb:s})]}),content:i.tags.length>0&&(0,r.jsx)(z,{tags:i.tags,fromGroup:!0})})};var ea=n(693),ei=n(41387),eo=n(40510),el=n(19983),eu=n(94059),es=n(77904),ec=n(99901),ed=n(72478),ef=n(97482),eh=n(7642),eg=n(61487),ep=n(70978),em=n(14426),ex=n(6617);let ev=function(e){var t=e.pluginAnchor,n=e.hash,a=e.onClose,i=(0,q.h)().plugins,o=(0,K.A)().imageSelection,l=(0,ex.h)(),u=l.runWithImage,s=l.runWithImages,c=function(e){n?u(e,n):s(e,o)};return(0,r.jsx)(L.default,{open:!!t,anchorEl:t,onClose:a,children:i.map(function(e){var t=e.url,n=e.name,i=e.description,o=e.loading,l=e.error;return(0,r.jsxs)(O.default,{disabled:!!(o||l),title:"".concat(l||i||"","\n").concat(t),onClick:function(){a(),c(t)},children:[l&&(0,r.jsx)(ep.A,{color:"warning"}),o&&(0,r.jsx)(em.default,{color:"secondary",size:22}),n||t]},t)})})};var eI=n(75097),eA=n(97004),ej=n(39249),eE=n(53982),eb=n(5415),eC=n(28952),ew=n(5847);let ey=function(){var e,t,n=(0,$.A)(),r=n.exportScaleFactors,a=n.exportFileTypes,o=n.handleExportFrame,l=n.fileNameStyle,u=(0,q.h)(),s=u.frames,c=u.palettes,d=u.images,f=(0,eb.j)(r,a,o,c,l);return{downloadSingleImage:(0,i.useCallback)((e=(0,eA._)(function(e){var t,n,r,a,i,o,u,h,g;return(0,ej.YH)(this,function(p){switch(p.label){case 0:if(!(t=d.find(function(t){return t.hash===e})))throw Error("image not found");if(n=s.find(function(e){return e.id===t.frame}),!(r=(0,J.s)(c,t).palette))throw Error("imagePalette not found");return a=(0,eC.A)({image:t,palette:r,fileNameStyle:l}),[4,(0,ew.T)(d,s)(t.hash)];case 1:if(i=p.sent(),!n)return[3,3];return[4,(0,eE.mZ)(null==n?void 0:n.hash)];case 2:return u=p.sent(),[3,4];case 3:u=null,p.label=4;case 4:if(h=(o=u)?o.upper.length/20:2,!i)throw Error("no tiles");return[4,f(t)(i,h)];case 5:return g=p.sent(),[2,(0,eb.R)(a)(g)]}})}),function(t){return e.apply(this,arguments)}),[l,s,d,c,f]),downloadImageCollection:(0,i.useCallback)((t=(0,eA._)(function(e){var t,n;return(0,ej.YH)(this,function(r){switch(r.label){case 0:var a;return t=(0,eC.A)({altTitle:"gameboy-printer-gallery",useCurrentDate:!0,fileNameStyle:l}),[4,Promise.all(e.map((a=(0,eA._)(function(e){var t,n,r,a,i,o;return(0,ej.YH)(this,function(l){switch(l.label){case 0:if(!(t=d.find(function(t){return t.hash===e})))throw Error("image not found");return n=s.find(function(e){return e.id===t.frame}),[4,(0,ew.T)(d,s)(t.hash)];case 1:if(r=l.sent(),!n)return[3,3];return[4,(0,eE.mZ)(null==n?void 0:n.hash)];case 2:return i=l.sent(),[3,4];case 3:i=null,l.label=4;case 4:return o=(a=i)?a.upper.length/20:2,[2,f(t)(r||[],o)]}})}),function(e){return a.apply(this,arguments)})))];case 1:return n=r.sent(),(0,eb.R)(t)(n.flat()),[2]}})}),function(e){return t.apply(this,arguments)}),[l,s,d,f])}};var eT=n(633),eS=n(41186),ek=n(46498);let e_=function(e){var t=(0,K.A)(),n=t.imageSelection,r=t.sortBy,a=t.filtersActiveTags,o=t.recentImports,l=t.setFiltersVisible,u=t.setSortOptionsVisible,s=t.setImageSelection,c=(0,q.h)(),d=c.plugins,f=c.images,h=(0,$.A)().pageSize,g=(0,S.A)(),m=g.setEditImages,x=g.setEditRGBNImages,v=(0,eS.A)(),I=v.dismissDialog,A=v.setDialog,E=(0,ek.A)().setVideoSelection,b=ey().downloadImageCollection,C=(0,eT.g)().deleteImages,y=(0,j.Z)(),T=y.view,k=y.covers,_=(0,Q.S)(T.images,{sortBy:r,filtersActiveTags:a,recentImports:o}).splice(e*h,h||1/0).filter(function(e){return!k.includes(e.hash)}).filter(function(e){var t=e.hash;return n.includes(t)}),P=_.reduce(et.iy,[]),D=(0,i.useMemo)(function(){return n.reduce(function(e,t){var n=f.find(function(e){return e.hash===t});return n?[n].concat((0,p._)(e)):e},[])},[n,f]),M=n.length,F=_.length>0;return{hasPlugins:!!d.length,batchEnabled:!!n.length,monochromeBatchEnabled:_.length>1&&P.length===_.length,activeFilters:a.length||0,selectedImageCount:M,hasSelected:F,batchTask:function(e){if(n.length)switch(e){case eI.x6.DELETE:A({message:"Delete ".concat(n.length," images?"),confirm:(0,eA._)(function(){return(0,ej.YH)(this,function(e){return C(n),[2]})}),deny:(0,eA._)(function(){return(0,ej.YH)(this,function(e){return[2,I(0)]})})});break;case eI.x6.ANIMATE:E(n);break;case eI.x6.DOWNLOAD:b(n);break;case eI.x6.EDIT:m({tags:(0,w.A)(D.map(function(e){return e.tags}).flat()),batch:D.map(function(e){return e.hash})});break;case eI.x6.RGB:x(D.reduce(et.iy,[]).map(function(e){return e.hash}))}},checkAll:function(){s((0,Q.S)(T.images,{filtersActiveTags:a,sortBy:r,recentImports:o}).slice(e*h,(e+1)*h||void 0).map(function(e){return e.hash}))},unCheckAll:function(){return s([])},filter:function(){return l(!0)},showSortOptions:function(){return u(!0)}}};var eP=[eI.x6.DOWNLOAD,eI.x6.DELETE,eI.x6.EDIT,eI.x6.ANIMATE],eD=[eI.x6.RGB],eM=function(e){switch(e){case eI.x6.DELETE:return"Delete";case eI.x6.ANIMATE:return"Animate";case eI.x6.DOWNLOAD:return"Download";case eI.x6.EDIT:return"Edit";case eI.x6.RGB:return"Create RGB Images";default:return""}},eF=function(e){switch(e){case eI.x6.DELETE:return(0,r.jsx)(F.A,{});case eI.x6.ANIMATE:return(0,r.jsx)(es.A,{});case eI.x6.DOWNLOAD:return(0,r.jsx)(eo.A,{});case eI.x6.EDIT:return(0,r.jsx)(l.A,{});case eI.x6.RGB:return(0,r.jsx)(ec.A,{});default:return null}};let eG=function(e){var t=e_(e.page),n=t.hasPlugins,a=t.batchEnabled,l=t.monochromeBatchEnabled,u=t.activeFilters,s=t.selectedImageCount,c=t.hasSelected,d=t.batchTask,f=t.checkAll,h=t.unCheckAll,g=t.filter,p=t.showSortOptions,m=(0,o._)((0,i.useState)(null),2),x=m[0],v=m[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eg.default,{color:"tertiary",variant:"contained",sx:{"& .MuiButton-root":{width:40,height:40}},disableElevation:!0,children:[(0,r.jsx)(eh.default,{onClick:p,title:"Manage Sorting",children:(0,r.jsx)(ed.A,{})}),(0,r.jsx)(eh.default,{onClick:g,title:"Manage Filters",children:(0,r.jsx)(ef.default,{badgeContent:u,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(eu.A,{})})}),(0,r.jsx)(eh.default,{onClick:c?h:f,title:c?"Uncheck All":"Check All",children:(0,r.jsx)(ef.default,{badgeContent:s,color:"info",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(ei.A,{})})}),eP.map(function(e){return(0,r.jsx)(eh.default,{disabled:!a,onClick:function(){return d(e)},title:eM(e),children:eF(e)},e)}),eD.map(function(e){return(0,r.jsx)(eh.default,{disabled:!l,onClick:function(){return d(e)},title:eM(e),children:eF(e)},e)}),n?(0,r.jsx)(eh.default,{onClick:function(e){v(e.target)},title:"Use Plugin",children:(0,r.jsx)(el.A,{})}):null]}),(0,r.jsx)(ev,{pluginAnchor:x,onClose:function(){return v(null)}})]})};var eN=n(53664);let eL=function(e){var t=e.isBottom,n=e.page,i=e.isSticky;return(0,r.jsxs)(a.default,{direction:{xs:"column",md:"row"},alignItems:"center",gap:2,justifyContent:"space-between",sx:function(e){return(0,ea._)({zIndex:20,backgroundColor:e.palette.background.default},i?{position:"sticky",top:"var(--navigation-height)",py:1,mx:-1}:{},t?{"@media (max-height: 900px)":{display:"none"}}:{})},children:[(0,r.jsx)(eN.A,{}),(0,r.jsx)(eG,{page:n})]})};var eO=n(30832),eR=n.n(eO),eB=n(99124),eY=n.n(eB),eH=n(31936),eW=n(71495),eV=n(6295),ez=n(21740),eU=n(51746),eZ=n(52260),eX=n(82170),eK=n(16481),eq=n(39630);let e$=function(){var e,t=(0,$.A)(),n=t.exportScaleFactors,r=t.exportFileTypes,a=t.handleExportFrame,o=t.fileNameStyle,l=(0,q.h)(),u=l.frames,s=l.palettes,c=l.images;return{shareImage:(0,i.useCallback)((e=(0,eA._)(function(e){var t,i,l,d,f,h,g,m,x,v,I,A,j;return(0,ej.YH)(this,function(E){switch(E.label){case 0:if(!(t=c.find(function(t){return e===t.hash})))throw Error("image not found");return i=u.find(function(e){return e.id===t.frame}),l=(0,p._)(n).pop()||4,d=(0,p._)(r).pop()||"png",f=(0,eb.j)([l],[d],a,s,o),[4,(0,ew.T)(c,u)(t.hash)];case 1:if(h=E.sent(),!i)return[3,3];return[4,(0,eE.mZ)(null==i?void 0:i.hash)];case 2:return m=E.sent(),[3,4];case 3:m=null,E.label=4;case 4:return x=(g=m)?g.upper.length/20:2,[4,f(t)(h||[],x)];case 5:return I=(v=E.sent()[0]).blob,A=v.filename,j=v.title,window.navigator.share&&window.navigator.share({files:[new File([I],A,{type:"image/png",lastModified:Date.now()})],title:j}).catch(function(){return"\xaf\\_(ツ)_/\xaf"}),[2]}})}),function(t){return e.apply(this,arguments)}),[r,n,o,u,a,c,s])}};var eQ=null,eJ=function(){if(null===eQ)try{eQ=window.navigator.canShare({files:[new File([new Blob(["t","e","s","t"])],"test.txt",{type:"text/plain",lastModified:Date.now()})]})}catch(e){eQ=!1}return eQ||!1},e0=function(e){var t=(0,K.A)(),n=t.imageSelection,r=t.updateImageSelection,a=t.filtersActiveTags,o=t.sortBy,l=t.recentImports,u=(0,ek.A)().setLightboxImage,s=(0,q.h)(),c=s.plugins,d=s.updateImageFavouriteTag,f=(0,j.Z)(),h=f.view,g=f.covers,p=(0,S.A)().setEditImages,m=(0,eS.A)(),x=m.dismissDialog,v=m.setDialog,I=(0,eT.g)(),A=I.updateLastSyncLocalNow,E=I.deleteImages,b=ey().downloadSingleImage,C=e$().shareImage,w=(0,q.h)().images,y=(0,i.useMemo)(function(){return w.find(function(t){return t.hash===e})},[e,w]),T=n.includes(e);return{hasPlugins:!!c.length,isSelected:T,hasHashes:!!(null==y?void 0:y.hashes),isFavourite:(null==y?void 0:y.tags.includes(W.X3.FILTER_FAVOURITE))||!1,hasMeta:!!(null==y?void 0:y.meta),canShare:eJ(),startDownload:function(){return b(e)},deleteImage:function(){v({message:(null==y?void 0:y.title)?'Delete image "'.concat(y.title,'"?'):"Delete this image?",confirm:(0,eA._)(function(){return(0,ej.YH)(this,function(t){return E([e]),[2]})}),deny:(0,eA._)(function(){return(0,ej.YH)(this,function(e){return[2,x(0)]})})})},shareImage:function(){return C(e)},showMetadata:function(){v({message:(null==y?void 0:y.title)?'Meta-Info for "'.concat(y.title,'"'):"Meta-Info",questions:function(){return[{key:"meta",type:eq.V.META,label:"",meta:{hash:e,hashes:(null==y?void 0:y.hashes)||void 0,meta:(null==y?void 0:y.meta)||void 0}}]},confirm:(0,eA._)(function(){return(0,ej.YH)(this,function(e){return[2,x(0)]})})})},updateImageToSelection:function(t){r(t,[e])},setLightboxImage:function(){u((0,Q.S)(h.images,{filtersActiveTags:a,sortBy:o,recentImports:l}).filter(function(e){return!g.includes(e.hash)}).findIndex(function(t){return e===t.hash}))},updateFavouriteTag:function(t){d(t,e),A()},editImage:function(){p({tags:(null==y?void 0:y.tags)||[],batch:[e]})}}};eR().extend(eY());let e1=function(e){var t=e.hash,n=e.menuAnchor,a=e.onClose,u=(0,o._)((0,i.useState)(null),2),s=u[0],c=u[1],d=(0,$.A)().enableImageGroups,f=e0(t),h=f.canShare,g=f.isSelected,p=f.hasPlugins,m=f.isFavourite,x=f.hasMeta,v=f.hasHashes,I=f.deleteImage,A=f.setLightboxImage,j=f.shareImage,E=f.startDownload,b=f.showMetadata,C=f.updateImageToSelection,w=f.updateFavouriteTag,y=f.editImage,T=(0,R.t)().createGroup;return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(L.default,{open:!!n,anchorEl:n,onClose:a,onClick:function(e){e.stopPropagation()},children:[(0,r.jsxs)(O.default,{onClick:function(){y(),a()},title:"Edit",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(l.A,{})}),(0,r.jsx)(N.default,{children:"Edit"})]}),(0,r.jsxs)(O.default,{onClick:function(){E(),a()},title:"Download",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(eo.A,{})}),(0,r.jsx)(N.default,{children:"Download"})]}),(0,r.jsxs)(O.default,{onClick:function(){I(),a()},title:"Delete",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(F.A,{})}),(0,r.jsx)(N.default,{children:"Delete"})]}),(0,r.jsxs)(O.default,{onClick:function(){A(),a()},title:"View in Lightbox",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(eX.A,{})}),(0,r.jsx)(N.default,{children:"View in Lightbox"})]}),p?(0,r.jsxs)(O.default,{onClick:function(e){c(e.target)},title:"Use Plugin",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(el.A,{})}),(0,r.jsx)(N.default,{children:"Use Plugin"})]}):null,h?(0,r.jsxs)(O.default,{onClick:function(){j(),a()},title:"Share",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(eK.A,{})}),(0,r.jsx)(N.default,{children:"Share"})]}):null,(0,r.jsxs)(O.default,{onClick:function(){w(!m),a()},title:m?"Remove from favourites":"Add to favourites",children:[(0,r.jsx)(G.default,{children:m?(0,r.jsx)(eZ.A,{}):(0,r.jsx)(eU.A,{})}),(0,r.jsx)(N.default,{children:m?"Remove from favourites":"Add to favourites"})]}),(0,r.jsxs)(O.default,{onClick:function(){C(g?K.N.REMOVE:K.N.ADD),a()},title:g?"Remove from selection":"Add to selection",children:[(0,r.jsx)(G.default,{children:g?(0,r.jsx)(eW.A,{}):(0,r.jsx)(ei.A,{})}),(0,r.jsx)(N.default,{children:g?"Remove from selection":"Add to selection"})]}),(x||v)&&(0,r.jsxs)(O.default,{onClick:function(){b(),a()},title:"Show Metadata",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(eV.A,{})}),(0,r.jsx)(N.default,{children:"Show Metadata"})]}),g&&d&&(0,r.jsxs)(O.default,{onClick:function(){T(t),a()},title:"Create Group",children:[(0,r.jsx)(G.default,{children:(0,r.jsx)(ez.A,{})}),(0,r.jsx)(N.default,{children:"Create Group"})]})]}),(0,r.jsx)(ev,{pluginAnchor:s,hash:t,onClose:function(){c(null),a()}})]}):null};var e2=n(80498),e4=n(49967),e3=function(){var e=(0,$.A)(),t=e.hideDates,n=e.preferredLocale;return{formatter:(0,i.useCallback)(function(e){return t||!e?null:(0,e4.A)(eR()(e,X.i$),n)},[t,n])}};eR().extend(eY());let e6=function(e){var t=e.page,n=e.hash,a=(0,$.A)(),o=a.enableDebug,l=a.galleryClickAction,u=en(n),s=u.galleryImageData,c=u.updateImageSelection,d=e0(n),f=d.setLightboxImage,h=d.editImage,g=e3().formatter,m=(0,i.useMemo)(function(){return[n].concat((0,p._)((null==s?void 0:s.hashes)?Object.keys(s.hashes).map(function(e){var t;return"".concat(e.toUpperCase(),": ").concat(null==(t=s.hashes)?void 0:t[e])}):[])).filter(Boolean).join("\n")},[s,n]),x=(0,i.useCallback)(function(e){c((null==s?void 0:s.selectionIndex)!==-1?K.N.REMOVE:K.N.ADD,e,t)},[s,t,c]),v=(0,i.useCallback)(function(e){if(e.preventDefault(),e.ctrlKey||e.shiftKey)return void x(e.shiftKey);switch(l){case e2.n.VIEW:f();break;case e2.n.EDIT:h();break;case e2.n.SELECT:default:x(e.shiftKey)}},[h,l,f,x]);if(!s)return null;var I=s.created,A=s.hashes,j=s.palette,E=s.invertPalette,b=s.invertFramePalette,C=s.framePalette,w=s.frame,y=s.lockFrame,T=s.title,S=s.tags,k=s.selectionIndex,_=s.rotation;return(0,r.jsx)(M.A,{selectionText:-1!==k?(k+1).toString(10):"",title:T,subheader:g(I),wrapperProps:{onClick:v,disableRipple:!0,sx:{display:"block",width:"100%",textAlign:"left"}},contextMenuComponent:e1,contextMenuProps:{hash:n},media:(0,r.jsx)(Y.A,{lockFrame:y,invertPalette:E,palette:j,framePalette:C,invertFramePalette:b,frameId:w,hash:n,hashes:A,rotation:_}),content:(S.length>0||m&&o)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{tags:S}),(0,r.jsx)(eH.A,{text:m})]})})};var e9=n(700);let e5=function(e){return(0,r.jsxs)(e9.default,{component:"h2",variant:"caption",children:["".concat(e.imageCount," images"),e.filteredCount?" / ".concat(e.filteredCount," filtered"):null,e.selectedCount?" / ".concat(e.selectedCount," selected"):null]})};var e7=n(79543),e8=n(7585),te=n(19690),tt=n(78442),tn=n(93595),tr=n(78321);let ta=function(e){var t=(0,b.Y)().getUrl;return(0,r.jsx)(eh.default,{component:e.disabled?"span":g(),disabled:e.disabled,href:t({pageIndex:e.page}),title:"To page ".concat(e.page+1),children:e.children})},ti=function(e){var t=e.page,n=e.maxPageIndex;if(0===n)return null;var i=[{icon:(0,r.jsx)(e8.A,{}),pageIndex:t-1,disabled:t<1},null,{icon:(0,r.jsx)(te.A,{}),pageIndex:t+1,disabled:n<t+1}];return n>5&&(i.unshift({icon:(0,r.jsx)(tt.A,{}),pageIndex:t-5,disabled:t<5}),i.push({icon:(0,r.jsx)(tn.A,{}),pageIndex:t+5,disabled:n<t+5})),n>1&&(i.unshift({icon:(0,r.jsx)(e7.A,{}),pageIndex:0,disabled:0===t}),i.push({icon:(0,r.jsx)(tr.A,{}),pageIndex:n,disabled:t===n})),(0,r.jsx)(a.default,{direction:"row",justifyContent:"space-around",children:(0,r.jsx)(eg.default,{color:"tertiary",variant:"contained",disableElevation:!0,sx:{"& .MuiButton-root":{width:40,height:40}},children:i.map(function(e){if(!e)return(0,r.jsx)(e9.default,{component:"span",variant:"body1",sx:{px:2,display:"flex",alignItems:"center"},children:"".concat(t+1,"/").concat(n+1)},"current");var a=e.icon,i=e.pageIndex,o=e.disabled;return(0,r.jsx)(ta,{page:i,disabled:o,children:a},i)})})})};var to=n(77262),tl=n(64101),tu=n.n(tl),ts=n(87031),tc=(0,ts.A)("percentage",ts.U.DESC),td=function(){var e=0;for(var t in localStorage)if(localStorage.hasOwnProperty(t)){var n=localStorage.getItem(t);null!==n&&(e+=t.length+n.length)}return e},tf=function(){var e="__test_localStorage_limit__",t=0,n=0xf00000,r=0;try{for(;t<=n;){var a=Math.floor((t+n)/2),i="A".repeat(a);try{localStorage.setItem(e,i),r=a,t=a+1}catch(e){n=a-1}}}finally{localStorage.removeItem(e)}return r},th=function(){var e=(0,o._)((0,i.useState)([]),2),t=e[0],n=e[1];return(0,i.useEffect)(function(){window.setTimeout((0,eA._)(function(){var e,t,r,a;return(0,ej.YH)(this,function(i){switch(i.label){case 0:return[4,null==(e=navigator.storage)?void 0:e.estimate()];case 1:return t=i.sent()||null,n([{type:"indexedDB",total:a=(r=td())+tf(),used:r,percentage:Math.ceil(r/a*100)},{type:"localStorage",total:(null==t?void 0:t.quota)||0,used:(null==t?void 0:t.usage)||0,percentage:Math.ceil(a?((null==t?void 0:t.usage)||0)/((null==t?void 0:t.quota)||1)*100:100)}]),[2]}})}),10)},[]),{storageEstimate:tc(t.filter(function(e){return e.percentage>75}))[0]||null}},tg=function(e){switch(e){case"indexedDB":return"indexed DB";case"localStorage":return"local storage";default:return e}};let tp=function(){var e=th().storageEstimate;return e?(0,r.jsxs)(P.default,{title:"Using ".concat(tu()(e.used)," of ").concat(tu()(e.total)),sx:{position:"relative"},children:[(0,r.jsx)(to.default,{variant:"determinate",value:e.percentage,sx:{width:"100%",height:"34px"},color:"error"}),(0,r.jsx)(e9.default,{variant:"body2",color:"bg",sx:{position:"absolute",p:1,top:0},children:"You are using ".concat(e.percentage,"% of your browser's ").concat(tg(e.type),". Be aware for now saving images will not be possible once you hit the limit.")})]}):null};var tm=n(35695),tx=n(77840),tv=n(12360);let tI=function(e,t,n){return(0,p._)(e).filter((0,tx.A)(t,n)).filter((0,tv.A)(t)).length};var tA=function(){var e=(0,j.Z)(),t=e.view,n=e.covers,r=e.isWorking,a=(0,$.A)().pageSize,o=(0,K.A)(),l=o.imageSelection,u=o.filtersActiveTags,s=o.recentImports,c=o.sortBy,d=(0,q.h)().images.length,f=tI(t.images,u,s),h=(0,b.Y)(),g=h.pageIndex,p=h.getUrl,m=a?Math.ceil(t.images.length/a):1,x=Math.max(0,Math.min(g,Math.max(0,m-1)));m>0&&x!==g&&(0,tm.redirect)(p({pageIndex:x}));var v=x*a,I=l.length,A=(0,Q.S)(t.images,{filtersActiveTags:u,recentImports:s,sortBy:c}).splice(v,a||1/0);return{totalImageCount:d,selectedCount:I,filteredCount:f,page:x,maxPageIndex:(0,i.useMemo)(function(){return a?Math.ceil(tI(t.images,u,s)/a)-1:0},[u,a,s,t]),images:A,covers:n,isWorking:r}};let tj=function(){var e=tA(),t=e.totalImageCount,n=e.selectedCount,i=e.filteredCount,o=e.page,l=e.maxPageIndex,u=e.images,s=e.covers,c=e.isWorking,d=(0,$.A)().enableImageGroups;return(0,r.jsxs)(a.default,{direction:"column",gap:2,children:[(0,r.jsx)(tp,{}),(0,r.jsx)(e5,{imageCount:t,selectedCount:n,filteredCount:i}),d?(0,r.jsx)(k,{}):null,(0,r.jsx)(eL,{page:o,isSticky:!0}),l>0&&(0,r.jsx)(ti,{page:o,maxPageIndex:l}),(0,r.jsx)(_.A,{showLoader:c,children:u.map(function(e){return s.includes(e.hash)?(0,r.jsx)(er,{hash:e.hash},e.hash):(0,r.jsx)(e6,{hash:e.hash,page:o},e.hash)})}),u.length>=3&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ti,{page:o,maxPageIndex:l}),(0,r.jsx)(eL,{page:o,isBottom:!0})]})]})}},80360:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=n(51368).A}},e=>{var t=t=>e(e.s=t);e.O(0,[4453,700,7859,7271,4831,6139,5394,3313,7642,9758,1487,5123,6874,3611,9740,4766,5849,7266,882,7263,1760,3936,929,3416,8441,1684,7358],()=>t(14633)),_N_E=e.O()}]);