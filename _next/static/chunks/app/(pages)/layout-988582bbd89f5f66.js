(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1760,7133,9194],{806:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var r=n(86447),F=n(693),a=n(60376),i=n(78538),o=n(17652),s=n(12115),l=n(27803),u=n(11760),c=n(52166),d=n(55364);let f=function(){var e=(0,c.A)(),t=e.sortPalettes,n=e.setSortPalettes,f=(0,u.h)().images,m=(0,o.c3)("usePaletteSort"),p=(0,s.useMemo)(function(){return[{label:m("defaultAsc"),value:l.V.DEFAULT_ASC},{label:m("defaultDesc"),value:l.V.DEFAULT_DESC},{label:m("usageAsc"),value:l.V.USAGE_ASC},{label:m("usageDesc"),value:l.V.USAGE_DESC},{label:m("nameAsc"),value:l.V.NAME_ASC},{label:m("nameDesc"),value:l.V.NAME_DESC}]},[m]),h=(0,s.useMemo)(function(){return f.reduce(function(e,t){return(0,d.pl)(t)?e:(0,a._)((0,F._)({},e),(0,r._)({},t.palette,(e[t.palette]||0)+1))},{})},[f]),g=(0,s.useCallback)(function(e,n){var r=(0,i._)(t.split("_"),2),F=r[0],a="asc"===r[1]?1:-1;switch(F){case"usage":var o=h[e.shortName]||0,s=h[n.shortName]||0;if(o<s)return -1*a;if(o>s)return a;return 0;case"name":return e.name.localeCompare(n.name)*a;default:return a}},[h,t]);return{sortPalettes:t,setSortPalettes:n,paletteSortOptions:p,paletteUsages:h,sortFn:g}}},933:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var r,F=n(97004),a=n(39249),i=n(24463),o=function(e,t){var o,s,l,u,c=(o=(0,F._)(function(){var F;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(r)return[3,2];return[4,Promise.all([n.e(9268),n.e(7431),n.e(1575)]).then(n.bind(n,94979))];case 1:F=a.sent().dropBoxSyncTool,r=r||F(e,t),a.label=2;case 2:return[2,r]}})}),function(){return o.apply(this,arguments)});return i.A.getState().dropboxStorage.use&&c(),{recoverImageData:(s=(0,F._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,c()];case 1:return[2,t.sent().recoverImageData(e)]}})}),function(e){return s.apply(this,arguments)}),startAuth:(0,F._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,c()];case 1:return[2,e.sent().startAuth()]}})}),startSyncData:(l=(0,F._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,c()];case 1:return[2,t.sent().startSyncData(e)]}})}),function(e){return l.apply(this,arguments)}),startSyncImages:(0,F._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,c()];case 1:return[2,e.sent().startSyncImages()]}})}),updateSettings:(u=(0,F._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,c()];case 1:return[2,t.sent().updateSettings(e)]}})}),function(e){return u.apply(this,arguments)}),subscribe:function(){var e;return i.A.subscribe(function(e){return e.dropboxStorage},(e=(0,F._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,c()];case 1:return t.sent().updateSettings(e),[2]}})}),function(t){return e.apply(this,arguments)}))}}}},1470:(e,t,n)=>{"use strict";n.d(t,{t:()=>r,z:()=>F});var r="ROOT",F=function(e){return{id:r,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[],allImages:e}}},5432:(e,t,n)=>{"use strict";n.d(t,{Fv:()=>u,R2:()=>o,YP:()=>l,Ys:()=>s,dm:()=>a,g0:()=>i});var r=n(15905),F=[0,85,170,255],a='{"command":"INIT"}',i='{"command":"DATA", "compressed":0, "more":1}',o='{"command":"DATA","compressed":0,"more":0}',s='{"command":"PRNT","sheets":1,"margin_upper":1,"margin_lower":3,"pallet":228,"density":64 }',l={r:F.slice(),g:F.slice(),b:F.slice(),n:F.slice(),blend:r.Nx.MULTIPLY},u={shortName:"-",name:"Missing Palette",palette:["#aaaaaa","#999999","#888888","#777777"],isPredefined:!0,origin:"technical"}},5672:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,Z:()=>F});var r=n(49641).Buffer,F=function(e){return e.UINT8_ARRAY="uint8array",e.TEXT="text",e.DATA_URL="dataURL",e.BINARY_STRING="binaryString",e}({});let a=function(e,t){return new Promise(function(n,F){var a=new FileReader;switch(a.onload=function(e){var a=e.target;if(null==a?void 0:a.result)return"uint8array"===t?void n(r.from(a.result)):void n(a.result);F(Error("Filereader has no result"))},a.onerror=function(e){F(e)},t){case"uint8array":a.readAsArrayBuffer(e);break;case"text":a.readAsText(e);break;case"binaryString":a.readAsBinaryString(e);break;case"dataURL":a.readAsDataURL(e);break;default:F(Error('readAs param missing or unknown type "'.concat(t,'"')))}})}},5847:(e,t,n)=>{"use strict";n.d(t,{T:()=>o,p:()=>s});var r=n(97004),F=n(39249),a=n(55364),i=n(72623),o=function(e,t,n){var o,s=(o=(0,r._)(function(r,o,l,u){var c,d,f,m,p,h,g,v,x,A,b,j;return(0,F.YH)(this,function(F){switch(F.label){case 0:if(d=e.find(function(e){return r===e.hash}),f=("string"==typeof l?l:null==d?void 0:d.frame)||void 0,m=null==(c=t.find(function(e){return e.id===f}))?void 0:c.hash,u||!(!d||!(0,a.pl)(d)))return[3,2];return[4,(0,i.Hh)(r,m,o,n)];case 1:return[2,F.sent()||[]];case 2:if(!(p=u||d.hashes).r)return[3,4];return[4,s(p.r,o,f)];case 3:return g=F.sent(),[3,5];case 4:g=[],F.label=5;case 5:if(h=g,!p.g)return[3,7];return[4,s(p.g,o,f)];case 6:return x=F.sent(),[3,8];case 7:x=[],F.label=8;case 8:if(v=x,!p.b)return[3,10];return[4,s(p.b,o,f)];case 9:return b=F.sent(),[3,11];case 10:b=[],F.label=11;case 11:if(A=b,!p.n)return[3,13];return[4,s(p.n,o,f)];case 12:return j=F.sent(),[3,14];case 13:j=[],F.label=14;case 14:return[2,{r:h,g:v,b:A,n:j}]}})}),function(e,t,n,r){return o.apply(this,arguments)});return s},s=function(e,t){var n,a=o(e,t);return n=(0,r._)(function(e){var t,n,r,i,o;return(0,F.YH)(this,function(F){switch(F.label){case 0:return[4,a(e,!0,"")];case 1:if(t=F.sent())return[2,(null==t?void 0:t.length)||(null==(n=t.r)?void 0:n.length)||(null==(r=t.g)?void 0:r.length)||(null==(i=t.b)?void 0:i.length)||(null==(o=t.n)?void 0:o.length)||0];return[2,0]}})}),function(e){return n.apply(this,arguments)}}},6456:(e,t,n)=>{"use strict";n.d(t,{PM:()=>s,YZ:()=>i,lt:()=>o});var r=n(693),F=n(60376),a=n(78538),i=function(e,t){return(0,F._)((0,r._)({},e),{sortIndex:t})},o=function(e){return(0,F._)((0,r._)({},e),{sortIndex:void 0})},s=function(e){return function(t,n){if(!e)return 0;var r=(0,a._)(e.split("_"),2),F=r[0],i=r[1],o=t[F],s=n[F],l="desc"===i?-1:1;return o&&s?o>s?l:o<s?-l:t.sortIndex<n.sortIndex?l:-l:0}}},7119:(e,t,n)=>{"use strict";n.d(t,{NavigationToolsProvider:()=>m,g:()=>p});var r=n(95155),F=n(12115),a=n(78538),i=n(35695),o=n(95939),s=n(71620),l=n(52166),u=n(1470),c=n(66785),d=function(){var e=(0,i.useRouter)(),t=(0,o.Z)(),n=t.paths,r=t.root,d=t.isWorking,f=t.path,m=t.getUrl,p=(0,a._)((0,F.useState)(!1),2),h=p[0],g=p[1],v=(0,s.A)(),x=v.sortBy,A=v.filtersTags,b=v.filtersFrames,j=v.filtersPalettes,y=v.recentImports,_=(0,l.A)().pageSize,C=(0,F.useCallback)(function(e){return(0,c.S)(e,{filtersTags:A,filtersFrames:b,filtersPalettes:j,sortBy:x,recentImports:y})},[b,j,A,y,x]),I=(0,F.useCallback)(function(e,t){return Math.floor(C(t).findIndex(function(t){return t.hash===e})/_)},[C,_]),E=(0,F.useCallback)(function(e,t){var r;return e===u.t?m({pageIndex:t,group:""}):m({pageIndex:t,group:(null==(r=n.find(function(t){return e===t.group.id}))?void 0:r.absolutePath)||""})},[m,n]),w=(0,F.useMemo)(function(){var e;return(null==(e=n.find(function(e){return e.absolutePath===f}))?void 0:e.group)||r},[f,n,r]),T=(0,F.useCallback)(function(e){var t=n.find(function(t){return t.group.images.map(function(e){return e.hash}).includes(e)}),F=(null==t?void 0:t.absolutePath)||"";return m({pageIndex:I(e,(null==t?void 0:t.group)||r),group:F})},[I,m,n,r]),S=(0,F.useCallback)(function(e,t){d||window.setTimeout(function(){g({group:{id:e,pageIndex:t}})},1)},[d]),P=(0,F.useCallback)(function(e){window.setTimeout(function(){g({imageHash:e})},1)},[]);return(0,F.useEffect)(function(){if(!d&&h){var t=window.setTimeout(function(){h.imageHash?(e.push(T(h.imageHash)),g(!1)):h.group&&(e.push(E(h.group.id,h.group.pageIndex)),g(!1))},1);return function(){window.clearTimeout(t)}}},[E,T,d,e,h]),{currentGroup:w,getGroupPath:E,getImagePageIndexInGroup:I,navigateToGroup:S,navigateToImage:P}},f=(0,F.createContext)(null);function m(e){var t=e.children,n=d();return(0,r.jsx)(f.Provider,{value:n,children:t})}var p=function(){var e=(0,F.useContext)(f);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},9718:(e,t,n)=>{"use strict";n.d(t,{_Y:()=>F,k4:()=>a,qt:()=>r});var r=function(e){return e.USB="USB",e.SERIAL="SERIAL",e}({}),F=function(e){return e.INACTIVE="inactive",e.PACKET_CAPTURE="packet_capture",e.SUPER_PRINTER_INTERFACE="super_printer_interface",e.GBXCART="gbxcart",e}({}),a=[{vendorId:9025,productId:32822},{vendorId:9025,productId:32823},{vendorId:9025,productId:32845},{vendorId:9025,productId:32846},{vendorId:9025,productId:32847},{vendorId:9025,productId:32848},{vendorId:9025,productId:32850},{vendorId:9025,productId:32851},{vendorId:9025,productId:32852},{vendorId:9025,productId:32853},{vendorId:9025,productId:32854},{vendorId:9025,productId:32855},{vendorId:9114}]},10746:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r="gbp-z-web"},11760:(e,t,n)=>{"use strict";n.d(t,{A:()=>_,h:()=>N});var r=n(97004),F=n(86447),a=n(693),i=n(60376),o=n(87025),s=n(39249),l=n(36952),u=n.n(l),c=n(65453),d=n(46786),f=n(19864),m=n(87031),p=n(55685),h=n(85546),g=n(10746),v=n(15905),x=n(5432),A=n(55364),b=n(46594),j=n(52324),y=function(){var e=(0,r._)(function(e){var t,n,r,F,o,l,u,c;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(c={},!(null==(t=(u=e).frames)?void 0:t.length))return[3,2];return[4,(0,j.g)(u.frames)];case 1:c.frames=s.sent(),s.label=2;case 2:return(null==(n=u.frameGroupNames)?void 0:n.length)&&(c.frameGroups=u.frameGroupNames),(null==(r=u.palettes)?void 0:r.length)&&(c.palettes=u.palettes),(null==(F=u.plugins)?void 0:F.length)&&(c.plugins=u.plugins),(null==(o=u.imageGroups)?void 0:o.length)&&(c.imageGroups=u.imageGroups),(null==(l=u.images)?void 0:l.length)&&(c.images=u.images.map(function(e){return(0,i._)((0,a._)({},e),{created:(0,b.J)(e.created)})}).map(function(e){return(0,i._)((0,a._)({},e),{tags:e.tags||[]})}).map(function(e){if((0,A.pl)(e)){var t=(0,a._)({},e);return t.palette||Object.assign(t,{palette:x.YP}),t.palette.blend||Object.assign(t.palette,{blend:v.Nx.MULTIPLY}),t.frame=e.frame||void 0,t}var n=(0,a._)({},e);return void 0===n.framePalette&&(n.lockFrame?n.framePalette="bw":n.framePalette=n.palette),void 0===n.lockFrame&&(n.lockFrame=!1),void 0===n.invertFramePalette&&(n.invertFramePalette=n.invertPalette),n.frame=e.frame||void 0,n})),[2,c]}})});return function(t){return e.apply(this,arguments)}}(),_=1,C=(0,h.A)("id"),I=(0,h.A)("id"),E=(0,h.A)("id"),w=(0,h.A)("url"),T=(0,m.A)("id"),S=(0,h.A)("shortName"),P=(0,m.A)("name"),k=(0,h.A)("hash"),D=function(e){return T(C(e))},B=function(e){return P(w(e))},M=function(e){return S((0,o._)(u().map(function(e){return(0,i._)((0,a._)({},e),{isPredefined:!0})})).concat((0,o._)(e)))};let N=(0,c.v)()((0,d.Zr)(function(e,t){return{frames:[],palettes:[],frameGroups:[],plugins:[],imageGroups:[],images:[],addFrames:function(t){return e(function(e){return{frames:D((0,o._)(t).concat((0,o._)(e.frames)))}})},addPalettes:function(n){var r=t().palettes,F=n.reduce(function(e,t){return r.find(function(e){return e.shortName===t.shortName})?{update:(0,o._)(e.update).concat([t]),add:e.add}:{update:e.update,add:(0,o._)(e.add).concat([t])}},{add:[],update:[]}),a=F.update,i=F.add;e({palettes:S((0,o._)(i).concat((0,o._)(r.map(function(e){return a.find(function(t){return t.shortName===e.shortName})||e}))))})},deleteFrame:function(t){return e(function(e){return{frames:D(e.frames.filter(function(e){return t!==e.id}))}})},deletePalette:function(t){return e(function(e){return{palettes:e.palettes.filter(function(e){return t!==e.shortName})}})},deletePlugin:function(t){return e(function(e){return{plugins:B(e.plugins.filter(function(e){return t!==e.url}))}})},updateFrameGroups:function(t){return e(function(e){return{frameGroups:I((0,o._)(t).concat((0,o._)(e.frameGroups)))}})},updatePluginConfig:function(n,r,o){var s=t().plugins,l=s.find(function(e){return e.url===n});if(!l)throw Error('Plugin "'.concat(n,'" not found'));var u=l,c=(0,i._)((0,a._)({},u.config||{}),(0,F._)({},r,o));return u=(0,i._)((0,a._)({},u),{config:c}),e({plugins:s.map(function(e){return e.url!==n?e:u})}),c},addUpdatePluginProperties:function(n){var r=t().plugins,F=(0,o._)(r);r.find(function(e){var t=e.url;return n.url===t})||F.push(n),e({plugins:B(F.map(function(e){return e.url!==n.url?e:(0,a._)({},e,n)}))})},addImageGroup:function(n,r){var F=t().imageGroups.map(function(e){var t=e.images.filter(function(e){return!n.images.includes(e)}),F=e.id===r?(0,o._)(e.groups).concat([n.id]):e.groups;return(0,i._)((0,a._)({},e),{groups:F,images:t})});e({imageGroups:E((0,o._)(F).concat([n]))})},deleteImageGroup:function(n){var r=t().imageGroups,F=r.find(function(e){return e.id===n});F&&e({imageGroups:r.reduce(function(e,t){return t.id===n?e:t.groups.includes(n)?(0,o._)(e).concat([(0,i._)((0,a._)({},t),{images:(0,o._)(t.images).concat((0,o._)(F.images)),groups:(0,o._)(t.groups).concat((0,o._)(F.groups)).filter(function(e){return e!==F.id})})]):(0,o._)(e).concat([t])},[])})},updateImageGroup:function(n,r){e({imageGroups:t().imageGroups.map(function(e){var t=(0,a._)({},e);return t.groups=t.groups.filter(function(e){return e!==n.id}),r===t.id&&(t.groups=(0,o._)(t.groups).concat([n.id])),t.id===n.id?n:t})})},groupImagesAdd:function(t,n){return e(function(e){return{imageGroups:e.imageGroups.map(function(e){return e.id===t?(0,i._)((0,a._)({},e),{images:(0,o._)(e.images).concat((0,o._)(n))}):(0,i._)((0,a._)({},e),{images:e.images.filter(function(e){return!n.includes(e)})})})}})},ungroupImages:function(t){return e(function(e){return{imageGroups:e.imageGroups.map(function(e){return(0,i._)((0,a._)({},e),{images:e.images.filter(function(e){return!t.includes(e)})})})}})},setImageGroups:function(t){return e({imageGroups:t})},addImages:function(t){return e(function(e){return{images:k((0,o._)(e.images).concat((0,o._)(t)))}})},deleteImages:function(t){return e(function(e){return{images:(0,o._)(e.images.filter(function(e){var n=e.hash;return!t.includes(n)}))}})},updateImageHash:function(t,n){return e(function(e){return{images:e.images.map(function(e){return e.hash===t?n:e})}})},updateImageFavouriteTag:function(t,n){return e(function(e){return{images:e.images.map(function(e){return e.hash===n?(0,i._)((0,a._)({},e),{tags:(0,p.A)(t?[f.X3.FILTER_FAVOURITE].concat((0,o._)(e.tags)):e.tags.filter(function(e){return e!==f.X3.FILTER_FAVOURITE}))}):e})}})},updateImages:function(t){return e(function(e){return{images:e.images.map(function(e){return t.find(function(t){return t.hash===e.hash})||e})}})},setFrames:function(t){return e({frames:C(t)})},setImages:function(t){return e({images:k(t)})},setPalettes:function(t){return e({palettes:M(t)})}}},{name:"".concat(g.z,"-items"),storage:(0,d.KU)(function(){return localStorage}),merge:function(e,t){var n=(0,a._)({},t,e);return(0,i._)((0,a._)({},n),{palettes:M(n.palettes),plugins:n.plugins.map(function(e){return(0,i._)((0,a._)({},e),{loading:!1})})})},partialize:function(e){return{frames:e.frames,frameGroups:e.frameGroups,imageGroups:e.imageGroups,images:e.images,plugins:e.plugins.map(function(e){return(0,i._)((0,a._)({},e),{loading:void 0,error:void 0})}),palettes:e.palettes.filter(function(e){return!e.isPredefined})}},version:_,migrate:function(){var e=(0,r._)(function(e,t){var n;return(0,s.YH)(this,function(r){switch(r.label){case 0:if(0!==t)return[3,2];return[4,y(e)];case 1:n=r.sent(),r.label=2;case 2:return[2,n]}})});return function(t,n){return e.apply(this,arguments)}}()}))},12360:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var r=n(19864);let F=function(e){return function(t){var n=e.filter(function(e){return![r.X3.FILTER_MONOCHROME,r.X3.FILTER_NEW,r.X3.FILTER_RGB,r.X3.FILTER_UNTAGGED,r.X3.FILTER_RECENT,r.X3.FILTER_FAVOURITE,r.X3.FILTER_COMMENTS,r.X3.FILTER_USERNAME].includes(e)});return!n.length||!!t.tags.find(function(e){return n.includes(e)})}}},15821:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var r=n(78538),F=n(44054),a=n(95155),i=n(69242),o=n(54581),s=n(7642),l=n(36114),u=n(71977),c=n(99927),d=n(54492),f=n(3127),m=n(16324),p=n(27943),h=n(17652),g=n(12115);let v=function(e){var t=e.confirm,n=e.canConfirm,r=e.deny;(0,g.useEffect)(function(){var e=function(e){"Escape"===e.key&&r&&r(),"Enter"===e.key&&e.ctrlKey&&t&&n&&t()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,n,r])};var x=function(e,t,n,r){var a={};if(r?(a.padding="8px !important",a.overflowX="hidden",a.overflowY="hidden"):(a.scrollbarGutter="stable",a.overflowY="scroll"),n)return a;switch(void 0===t?"undefined":(0,F._)(t)){case"string":a.height=t;break;case"number":a.height="".concat(t,"px")}switch(void 0===e?"undefined":(0,F._)(e)){case"string":a.width=e;break;case"number":a.width="".concat(e,"px");break;default:a.width="440px"}return a};let A=function(e){var t=e.contentHeight,n=e.contentWidth,F=e.header,A=e.closeTitle,b=e.children,j=e.confirm,y=e.deny,_=e.canConfirm,C=e.headerOnly,I=e.fullSize,E=e.open,w=e.keepMounted,T=e.closeOnOverlayClick,S=e.headerActionButtons,P=e.actionButtons,k=(0,h.c3)("Lightbox"),D=(0,r._)((0,g.useState)(),2),B=D[0],M=D[1];v({confirm:j,canConfirm:_||!1,deny:y}),(0,g.useEffect)(function(){M(document.body)},[]);var N=(0,m.A)(),R=(0,p.A)(N.breakpoints.down("md")),L=x(n,t,R,I),G=k(j?"cancel":"close"),O=k("ok");return(0,a.jsxs)(l.A,{container:B,fullScreen:R||I,maxWidth:"lg",open:"boolean"!=typeof E||E,onClose:y,"aria-label":"string"==typeof F?F:void 0,keepMounted:"boolean"!=typeof w||w,disableEscapeKeyDown:!("boolean"!=typeof T||T),sx:{paddingRight:"10px"},children:[(0,a.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",gap:2,maxWidth:L.width},children:[(0,a.jsx)(o.A,{sx:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},title:F,children:F}),(0,a.jsxs)(o.A,{sx:{my:-.5,mr:-2},children:[S,y?(0,a.jsx)(f.A,{title:A||k("closeWithHeader",{header:"string"==typeof F?F:""}),color:"inherit",onClick:y,children:(0,a.jsx)(i.A,{})}):null]})]}),!C&&(0,a.jsx)(c.A,{sx:L,children:b}),(0,a.jsxs)(u.A,{children:[P,y?(0,a.jsx)(s.A,{onClick:y,color:"primary",variant:"outlined",children:G}):null,j?(0,a.jsx)(s.A,{disabled:!1===_,color:"primary",variant:"contained",onClick:j,children:O}):null]})]})}},16853:(e,t,n)=>{var r={"./af.js":[30639,639],"./am.js":[39218,9218],"./ar-dz.js":[83291,5672],"./ar-iq.js":[64228,4228],"./ar-kw.js":[36568,6568],"./ar-ly.js":[58265,8265],"./ar-ma.js":[9592,9592],"./ar-sa.js":[42562,2562],"./ar-tn.js":[99148,9148],"./ar.js":[82091,4472],"./az.js":[29139,9139],"./be.js":[33821,3821],"./bg.js":[5543,5543],"./bi.js":[1313,1313],"./bm.js":[55989,5989],"./bn-bd.js":[73705,3705],"./bn.js":[21484,1484],"./bo.js":[97087,7087],"./br.js":[32608,2608],"./bs.js":[11235,1235],"./ca.js":[75648,5648],"./cs.js":[67950,7950],"./cv.js":[1437,1437],"./cy.js":[11400,1400],"./da.js":[89315,9315],"./de-at.js":[90575,575],"./de-ch.js":[42321,2321],"./de.js":[65847,5847],"./dv.js":[29474,9474],"./el.js":[3361,3361],"./en-au.js":[81419,3800],"./en-ca.js":[81458,1458],"./en-gb.js":[4472,2091],"./en-ie.js":[36080,6080],"./en-il.js":[12651,2651],"./en-in.js":[78753,8753],"./en-nz.js":[43410,3410],"./en-sg.js":[18704,8704],"./en-tt.js":[21490,1490],"./en.js":[32107,2107],"./eo.js":[64200,4200],"./es-do.js":[35506,5506],"./es-mx.js":[70918,918],"./es-pr.js":[67005,7005],"./es-us.js":[38827,8827],"./es.js":[37060,7060],"./et.js":[43961,3961],"./eu.js":[93566,3566],"./fa.js":[58133,8133],"./fi.js":[46781,6781],"./fo.js":[53107,3107],"./fr-ca.js":[74579,4579],"./fr-ch.js":[67944,7944],"./fr.js":[1308,1308],"./fy.js":[67661,7661],"./ga.js":[47260,7260],"./gd.js":[58107,8107],"./gl.js":[23459,3459],"./gom-latn.js":[76197,6197],"./gu.js":[78600,8600],"./he.js":[29243,9243],"./hi.js":[94871,4871],"./hr.js":[38650,8650],"./ht.js":[24552,4552],"./hu.js":[84139,4139],"./hy-am.js":[23812,3812],"./id.js":[69965,9965],"./is.js":[73968,3968],"./it-ch.js":[25415,5415],"./it.js":[36317,6317],"./ja.js":[60241,241],"./jv.js":[70028,28],"./ka.js":[21064,1064],"./kk.js":[77614,7614],"./km.js":[95412,5412],"./kn.js":[11101,1101],"./ko.js":[39810,9810],"./ku.js":[87804,7804],"./ky.js":[1664,1664],"./lb.js":[44006,4006],"./lo.js":[37917,7917],"./lt.js":[14524,4524],"./lv.js":[17770,7770],"./me.js":[71318,1318],"./mi.js":[66994,6994],"./mk.js":[57092,7092],"./ml.js":[45689,5689],"./mn.js":[78595,8595],"./mr.js":[32511,2511],"./ms-my.js":[60265,265],"./ms.js":[72076,2076],"./mt.js":[54593,4593],"./my.js":[17890,5509],"./nb.js":[18452,8452],"./ne.js":[60393,393],"./nl-be.js":[28672,8672],"./nl.js":[69030,9030],"./nn.js":[64296,4296],"./oc-lnc.js":[82472,2472],"./pa-in.js":[741,741],"./pl.js":[45624,5624],"./pt-br.js":[10683,683],"./pt.js":[63088,3088],"./rn.js":[57468,7468],"./ro.js":[11087,1087],"./ru.js":[68445,8445],"./rw.js":[92775,2775],"./sd.js":[16743,6743],"./se.js":[50580,580],"./si.js":[96424,6424],"./sk.js":[1158,1158],"./sl.js":[58271,8271],"./sq.js":[4992,4992],"./sr-cyrl.js":[74798,4798],"./sr.js":[21977,1977],"./ss.js":[37502,7502],"./sv-fi.js":[12481,2481],"./sv.js":[9709,9709],"./sw.js":[43090,3090],"./ta.js":[49011,9011],"./te.js":[97543,7543],"./tet.js":[35321,5321],"./tg.js":[59037,9037],"./th.js":[42376,2376],"./tk.js":[45377,5377],"./tl-ph.js":[15879,5879],"./tlh.js":[46288,6288],"./tr.js":[27742,7742],"./tzl.js":[80834,834],"./tzm-latn.js":[88893,8893],"./tzm.js":[69469,9469],"./ug-cn.js":[12326,2326],"./uk.js":[59516,9516],"./ur.js":[94823,4823],"./uz-latn.js":[2367,2367],"./uz.js":[19999,9999],"./vi.js":[6477,6477],"./x-pseudo.js":[9217,9217],"./yo.js":[6252,6252],"./zh-cn.js":[38464,8464],"./zh-hk.js":[2068,2068],"./zh-tw.js":[77932,7932],"./zh.js":[70350,350]};function F(e){if(!n.o(r,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],F=t[0];return n.e(t[1]).then(()=>n.t(F,23))}F.keys=()=>Object.keys(r),F.id=16853,e.exports=F},19864:(e,t,n)=>{"use strict";n.d(t,{X3:()=>r,mI:()=>a,rx:()=>F});var r=function(e){return e.FILTER_UNTAGGED="__filter:untagged__",e.FILTER_NEW="__filter:new__",e.FILTER_MONOCHROME="__filter:mono__",e.FILTER_RGB="__filter:rgb__",e.FILTER_RECENT="__filter:recent__",e.FILTER_FAVOURITE="__filter:favourite__",e.FILTER_COMMENTS="__filter:comments__",e.FILTER_USERNAME="__filter:username__",e}({}),F=["__filter:untagged__","__filter:new__","__filter:mono__","__filter:rgb__","__filter:recent__","__filter:favourite__","__filter:comments__","__filter:username__"],a="__new:palette__"},23747:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>A,BF:()=>g,Ll:()=>h});var r=n(97004),F=n(693),a=n(60376),i=n(78538),o=n(39249),s=n(12115),l=n(95939),u=n(7119),c=n(3381),d=n(71620),f=n(11760),m=n(80360),p=n(46594),h="NEW_GROUP",g=function(e){return e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase()},v=function(e,t){return e.find(function(e){return e.group.groups.find(function(e){return e.id===t})})||null},x=function(e){return e.CREATE_NEW="CREATE_NEW",e.EDIT_EXISTING="EDIT_EXISTING",e.NOT_EDITING="NOT_EDITING",e}(x||{});let A=function(){var e,t=(0,d.A)().imageSelection,n=(0,c.A)(),x=n.editImageGroup,A=n.cancelEditImageGroup,b=(0,f.h)(),j=b.imageGroups,y=b.addImageGroup,_=b.updateImageGroup,C=b.groupImagesAdd,I=b.ungroupImages,E=(0,u.g)(),w=E.navigateToGroup,T=E.navigateToImage,S=(0,l.Z)(),P=S.path,k=S.view,D=S.paths,B=S.pathsOptions,M=t.length,N=(null==x?void 0:x.groupId)?x.groupId===h?"CREATE_NEW":"EDIT_EXISTING":"NOT_EDITING",R=(0,s.useMemo)(function(){switch(N){case"CREATE_NEW":var e=(null==x?void 0:x.newGroupTitle)||"";return{imageGroup:null,parentPathMap:D.find(function(e){return e.group.id===k.id})||null,title:e,slug:g(e),slugTouched:!1};case"EDIT_EXISTING":var t=j.find(function(e){return e.id===(null==x?void 0:x.groupId)})||null;return{imageGroup:t,parentPathMap:(null==x?void 0:x.groupId)?v(D,x.groupId):null,title:(null==t?void 0:t.title)||"",slug:(null==t?void 0:t.slug)||"",slugTouched:!0};default:return{imageGroup:null,parentPathMap:null,title:"",slug:"",slugTouched:!1}}},[x,N,j,D,k]),L=(0,i._)((0,s.useState)(R.title),2),G=L[0],O=L[1],H=(0,i._)((0,s.useState)(R.slug),2),U=H[0],z=H[1],V=(0,i._)((0,s.useState)(R.slugTouched),2),W=V[0],Y=V[1],X=(0,i._)((0,s.useState)((null==(e=R.parentPathMap)?void 0:e.absolutePath)||""),2),Q=X[0],K=X[1],Z=(0,s.useMemo)(function(){if(!(null==x?void 0:x.groupId))return"";if((null==x?void 0:x.groupId)===h)return"".concat(P).concat(U,"/");var e=v(D,x.groupId),t=(null==e?void 0:e.absolutePath)||"";return"".concat(t).concat(U,"/")},[x,D,P,U]),q=(0,s.useMemo)(function(){return!!D.find(function(e){return e.absolutePath===Z})},[Z,D]),J=(0,s.useMemo)(function(){var e;return U!==(null==(e=R.imageGroup)?void 0:e.slug)},[R,U]),$=(0,s.useMemo)(function(){return!!U&&("CREATE_NEW"===N?!q:"EDIT_EXISTING"===N&&(!J||!q))},[N,U,q,J]),ee=(0,s.useMemo)(function(){var e,t,n=(null==(e=D.find(function(e){return e.absolutePath===Q}))?void 0:e.group.id)||"";return((null==(t=R.parentPathMap)?void 0:t.group.id)||"")!==n},[R,Q,D]),et=(0,s.useMemo)(function(){switch(N){case"EDIT_EXISTING":var e,t=(null==(e=D.find(function(e){return e.group.id===(null==x?void 0:x.groupId)}))?void 0:e.absolutePath)||"";return B.filter(function(e){var n=e.value;return!n.startsWith(Z)&&n!==t});case"CREATE_NEW":return B;default:return[]}},[Z,x,N,D,B]);return{editId:(null==x?void 0:x.groupId)||null,absoluteSlug:Z,possibleParents:et,slug:U,title:G,canConfirm:$,canMove:ee,slugIsInUse:q,slugWasChanged:J,parentSlug:Q,selectionCount:M,setSlug:function(e){z(e),Y(!0)},setTitle:function(e){O(e),(e.length<2||!W)&&(Y(!1),z(g(e)))},setParentSlug:K,confirm:function(){if(A(),$&&x){var e,n=(null==(e=D.find(function(e){return e.absolutePath===Q}))?void 0:e.group.id)||"";if(x.groupId===h){if(!x.newGroupCover)return;var r=(0,m.z)();y({id:r,slug:U,title:G,created:(0,p.J)(),coverImage:x.newGroupCover,images:t,groups:[]},n),w(r,0)}else{if(!R.imageGroup)return;_((0,a._)((0,F._)({},R.imageGroup),{slug:U,title:G}),n),w(x.groupId,0)}}},move:(0,r._)(function(){var e,n;return(0,o.YH)(this,function(r){return A(),ee&&((n=(null==(e=D.find(function(e){return e.absolutePath===Q}))?void 0:e.group.id)||"")?C(n,t):I(t),T(t[0])),[2]})}),cancelEditImageGroup:A}}},27299:(e,t,n)=>{"use strict";n.d(t,{E:()=>F});var r=n(693),F=function(e,t){return(0,r._)({flexGrow:0,flexShrink:1,wordBreak:"break-all",whiteSpace:"no-wrap",overflow:"hidden",width:"100%",borderRadius:"3px"},t)}},29032:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var r=n(78538),F=n(35695),a=n(12115),i=function(){var e=(0,F.usePathname)(),t=(0,r._)((0,a.useState)(window.location.search),2),n=t[0],i=t[1],o=(0,a.useMemo)(function(){return new URLSearchParams(n)},[n]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){i(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var t=history.pushState,n=history.replaceState;return history.pushState=function(){for(var n=arguments.length,r=Array(n),F=0;F<n;F++)r[F]=arguments[F];t.apply(this,r),e()},history.replaceState=function(){for(var t=arguments.length,r=Array(t),F=0;F<t;F++)r[F]=arguments[F];n.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=t,history.replaceState=n}},[o,e]);var s=(0,a.useMemo)(function(){return o.toString()},[o]);return{fullPath:(0,a.useMemo)(function(){return s?"".concat(e,"?").concat(s):e},[e,s]),pathname:e,query:s,searchParams:o}}},31829:(e,t,n)=>{"use strict";n.d(t,{h:()=>F,O:()=>a});var r=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");var n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),F=parseInt(t.slice(4,6),16);return"".concat(n,", ").concat(r,", ").concat(F)},F=function(e){return e.HARD="HARD",e.SMOOTH="SMOOTH",e.CONIC="CONIC",e}({}),a=function(e,t){var n=r(e[0]||"#000000"),F=r(e[1]||"#000000"),a=r(e[2]||"#000000"),i=r(e[3]||"#000000");switch(t){case"SMOOTH":return{backgroundImage:"linear-gradient(to right,\n          rgba(".concat(n,", ").concat(.25,") 0%,\n          rgba(").concat(F,", ").concat(.25,") 33.3%,\n          rgba(").concat(a,", ").concat(.25,") 66.6%,\n          rgba(").concat(i,", ").concat(.25,") 100%\n      )")};case"HARD":return{backgroundImage:"linear-gradient(to right,\n          rgb(".concat(n,") 0% 25%,\n          rgb(").concat(F,") 25% 50%,\n          rgb(").concat(a,") 50% 75%,\n          rgb(").concat(i,") 75% 100%\n        )")};case"CONIC":return{background:"conic-gradient(\n          rgb(".concat(n,") 0% 25%,\n          rgb(").concat(F,") 25% 50%,\n          rgb(").concat(a,") 50% 75%,\n          rgb(").concat(i,") 75% 100%\n        )")};default:return{}}}},31936:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(95155),F=n(700);n(12115);var a=n(52166),i=n(27299);let o=function(e){var t=e.text;return(0,a.A)().enableDebug?(0,r.jsx)(F.A,{title:t,variant:"caption",fontFamily:"monospace",component:"pre",sx:function(e){return(0,i.E)(e,{px:.5,py:0,mt:1,mb:0,backgroundColor:e.palette.warning[e.palette.mode]})},children:t}):null}},32134:(e,t,n)=>{"use strict";n.d(t,{GalleryTreeContext:()=>m,K:()=>f});var r=n(78538),F=n(95155),a=n(7062),i=n(12115),o=n(29032),s=n(46498),l=n(11760),u=n(52166),c=n(1470),d="/gallery/",f=(0,i.createContext)({root:(0,c.z)([]),view:(0,c.z)([]),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(d,"?page=1")}});function m(e){var t=e.children,m=(0,l.h)(),p=m.imageGroups,h=m.images,g=m.setImageGroups,v=(0,r._)((0,i.useState)(!0),2),x=v[0],A=v[1],b=(0,r._)((0,i.useState)((0,c.z)(h)),2),j=b[0],y=b[1],_=(0,r._)((0,i.useState)([]),2),C=_[0],I=_[1],E=(0,r._)((0,i.useState)([]),2),w=E[0],T=E[1],S=(0,o.j)(),P=S.searchParams,k=S.pathname,D=(0,r._)((0,i.useState)(""),2),B=D[0],M=D[1],N=(0,u.A)().enableDebug,R=(0,s.A)().setError;(0,i.useEffect)(function(){var e=new Worker(n.tu(new URL(n.p+n.u(8274),n.b)),{type:void 0}),t=(0,a.LV)(e),r=[],F=(0,a.BX)(function(e){r.push(e)});return A(!0),t.calculate({imageGroups:p,stateImages:h},F).then(function(e){if(y(e.root),I(e.paths),T(e.pathsOptions),r.length&&R(Error(r.join("\n"))),p.length>e.paths.length){var t=e.paths.map(function(e){return e.group.id});g(p.filter(function(e){var n=e.id;return t.includes(n)}))}N&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),R(e)}).finally(function(){A(!1),e.terminate()}),function(){e.terminate(),A(!1)}},[N,p,R,g,h]);var L=(0,i.useMemo)(function(){var e;return parseInt(null!=(e=P.get("page"))?e:"1",10)-1},[P]),G=(0,i.useMemo)(function(){return P.get("group")||""},[P]),O=(0,i.useCallback)(function(e){var t="number"==typeof e.pageIndex?e.pageIndex:L,n="string"==typeof e.group?e.group:G,r="".concat(d,"?page=").concat(t+1);return n.length&&(r="".concat(r,"&group=").concat(encodeURIComponent(n))),r},[L,G]);(0,i.useEffect)(function(){k===d&&M(O({pageIndex:L,group:G}))},[G,L,k,O]);var H=(0,i.useMemo)(function(){var e,t=(null==(e=C.find(function(e){return e.absolutePath===G}))?void 0:e.group)||j,n=t.groups.map(function(e){return e.coverImage}),r=t.images.filter(function(e){return!n.includes(e.hash)});return{view:t,covers:n,paths:C,images:r,pathsOptions:w,root:j,isWorking:x,pageIndex:L,path:G,lastGalleryLink:B,getUrl:O}},[C,j,w,x,L,G,B,O]);return(0,F.jsx)(f.Provider,{value:H,children:t})}},32521:(e,t,n)=>{"use strict";n.d(t,{U:()=>F,Z:()=>a});var r=n(12115),F=(0,r.createContext)({connectedDevices:[],isReceiving:!1,webSerialEnabled:!1,openWebSerial:function(){throw Error("PortsContext is missing")},webUSBEnabled:!1,openWebUSB:function(){throw Error("PortsContext is missing")},unknownDeviceResponse:null,hasInactiveDevices:!1}),a=function(){return(0,r.useContext)(F)}},34687:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5672),F=function(e){e.fillStyle="#000",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.filter="grayscale(1)",e.imageSmoothingEnabled=!1};let a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(n,a){var i=document.createElement("img"),o=document.createElement("canvas");o.width=160;var s=o.getContext("2d");if(!s)return void a(Error("No canvas context"));i.onerror=a,i.onload=function(){var r,a=i.naturalWidth,l=i.naturalHeight;.875==l/a?(o.height=144,r=i.naturalWidth/128,t||F(s),s.drawImage(i,0,0,a,l,16,16,o.width-32,o.height-32)):(o.height=o.width*l/a,r=a/160,t||F(s),s.drawImage(i,0,0,a,l,0,0,o.width,o.height)),n({imageData:s.getImageData(0,0,o.width,o.height),scaleFactor:r,width:o.width,height:o.height,fileName:e.name,lastModified:e.lastModified||null})},(0,r.A)(e,r.Z.DATA_URL).then(function(e){i.src=e})})}},39141:()=>{},39630:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info",e.IMAGE="image",e.META="meta",e}({})},40082:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(95155),F=n(12115),a=n(97004),i=n(78538),o=n(39249),s=n(5432),l=n(83936),u=n(633),c=n(11760),d=n(53982),f=n(933),m=n(5847),p=function(e){var t,n=e.hash,r=e.hashes,p=e.palette,h=e.invertPalette,g=e.framePalette,v=e.invertFramePalette,x=e.lockFrame,A=e.frameId,b=e.rotation,j=(0,i._)((0,F.useState)(null),2),y=j[0],_=j[1],C=(0,u.g)(),I=(0,l.W)().remoteImport,E=(0,c.h)(),w=E.frames,T=E.palettes,S=E.images,P=null==(t=w.find(function(e){return e.id===A}))?void 0:t.hash,k=(0,F.useCallback)(function(e,t,n){return(0,m.T)(S,w,function(){(0,f.E)(C,I).recoverImageData(e)})(e,t,n,r)},[S,w,r,C,I]),D=(0,F.useMemo)(function(){return"string"==typeof p?(T.find(function(e){return e.shortName===p})||s.Fv).palette:p},[T,p]);return(0,F.useEffect)(function(){var e,t=!1;return n||_(null),(e=(0,a._)(function(){var e,r,F,a;return(0,o.YH)(this,function(i){switch(i.label){case 0:if(t)return[2];return[4,k(n,!1,A)];case 1:if(e=i.sent(),!P)return[3,3];return[4,(0,d.mZ)(P)];case 2:return F=i.sent(),[3,4];case 3:F=null,i.label=4;case 4:if(a=(r=F)?r.upper.length/20:2,t)return[2];return e&&_({tiles:e,palette:D,invertPalette:h,imageStartLine:a,lockFrame:x,rotation:b,framePalette:x?g:p,invertFramePalette:x?v:h}),[2]}})}),function(){return e.apply(this,arguments)})(),function(){t=!0}},[k,n,A,p,h,x,b,D,P,g,v]),{gbImageProps:y}},h=n(93370),g=n(66564);let v=function(e){var t=e.hash,n=e.hashes,F=e.frameId,a=e.lockFrame,i=e.invertPalette,o=e.invertFramePalette,s=e.palette,l=e.framePalette,u=e.rotation,c=e.asThumb,d=p({hash:t,hashes:n,frameId:F,lockFrame:a,invertPalette:i,invertFramePalette:o,palette:s,framePalette:l,rotation:u}).gbImageProps;return d?(0,r.jsx)(h.A,{lockFrame:d.lockFrame,invertPalette:d.invertPalette,invertFramePalette:d.invertFramePalette,tiles:d.tiles,palette:d.palette,framePalette:d.framePalette,imageStartLine:d.imageStartLine,rotation:d.rotation,asThumb:c}):(0,r.jsx)(g.A,{})}},41476:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(86447),F=n(693),a=n(60376),i=n(87025),o=n(51368);let s=(0,n(65453).v)(function(e,t){return{progress:[],progressLog:{git:[],dropbox:[]},resetProgressLog:function(){return e({progressLog:{git:[],dropbox:[]}})},startProgress:function(t){var n={id:(0,o.A)(),label:t,value:0};return e(function(e){var t=e.progress;return{progress:(0,i._)(t).concat([n])}}),n.id},setProgress:function(t,n){e(function(e){return{progress:e.progress.map(function(e){return e.id!==t?e:(0,a._)((0,F._)({},e),{value:n})})}})},stopProgress:function(t){e(function(e){return{progress:e.progress.filter(function(e){return e.id!==t})}})},setProgressLog:function(n,o){var s=t().progressLog;e({progressLog:(0,a._)((0,F._)({},s),(0,r._)({},n,[o].concat((0,i._)(s[n]))))})}}})},44116:(e,t,n)=>{"use strict";n.d(t,{d:()=>F});var r=n(87025),F=function(e,t){return e.reduce(function(e,n){var F,a;return t===(null==(a=RegExp("^(?<group>[a-z]+)(?<id>[0-9]+)","g").exec(n.id))||null==(F=a.groups)?void 0:F.group)?(0,r._)(e).concat([n]):e},[])}},46594:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var r=function(e){var t=e?new Date(e):new Date,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")};return[t.getFullYear(),"-",n(t.getMonth()+1),"-",n(t.getDate())," ",n(t.getHours()),":",n(t.getMinutes()),":",n(t.getSeconds()),":",n(t.getMilliseconds(),3)].join("")}},47457:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var r=n(97004),F=n(693),a=n(87025),i=n(39249),o=n(91540),s=n(17652),l=n(12115),u=n(46498),c=n(11760),d=n(75380),f=n(72623),m=function(e,t){return!!t.find(function(t){var n=t.hashes;return!!n&&Object.values(n).includes(e)})},p=function(e,t){return!!t.find(function(t){return t.hash===e})},h=function(){var e=(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(r){var F,a;switch(r.label){case 0:return t=e.images,n=e.frames,[4,(0,d.ZU)()];case 1:return r.sent(),[4,d.mU.keys()];case 2:return r.sent().forEach((F=t,function(e){m(e,F)||p(e,F)||(0,f.yH)(e)})),[4,d.Uv.keys()];case 3:return r.sent().forEach((a=n,function(e){a.find(function(t){return t.hash===e})||(0,f.t9)(e)})),[2]}})});return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,r._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,(0,d.ZU)()];case 1:return t.sent(),[4,d.mU.keys()];case 2:return[2,t.sent().filter(function(e){return!e.startsWith("dummy")}).filter(function(t){return!m(t,e)&&!p(t,e)})]}})});return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,r._)(function(e){return(0,i.YH)(this,function(t){switch(t.label){case 0:return[4,(0,d.ZU)()];case 1:return t.sent(),[4,d.Uv.keys()];case 2:return[2,t.sent().filter(function(e){return!e.startsWith("dummy")}).filter(function(t){return!e.find(function(e){return e.hash===t})})]}})});return function(t){return e.apply(this,arguments)}}(),x=n(55364),A=n(50263),b=n(99451),j=n(46594),y=function(){var e=(0,r._)(function(e,t){return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,(0,d.ZU)()];case 1:var F;return n.sent(),[4,Promise.all(e.map((F=(0,r._)(function(e){var n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,t.getItem(e)];case 1:if(!(n=r.sent()))return[2,null];return[4,(0,A.U)(n)];case 2:return[2,{hash:e,lines:r.sent().split("\n"),binary:n}];case 3:return r.sent(),[2,null];case 4:return[2]}})}),function(e){return F.apply(this,arguments)})))];case 2:return[2,n.sent().reduce(b.N,[])]}})});return function(t,n){return e.apply(this,arguments)}}();let _=function(){var e=(0,u.A)(),t=e.trashCount,n=e.showTrashCount,f=(0,c.h)(),m=f.frames,p=f.images,A=(0,u.A)().updateTrashCount,_=(0,s.c3)("useTrashbin"),C=(0,l.useCallback)((0,r._)(function(){var e,t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return[4,g(p)];case 1:return[4,y(r.sent(),d.mU)];case 2:return e=r.sent(),t={},n={state:{images:e.map(function(e){try{return t[e.hash]=e.binary,{hash:e.hash,created:(0,j.J)(),title:_("backupExportImage",{hash:e.hash}),lines:e.lines.length,tags:["backup"],palette:"bw",framePalette:"bw",invertPalette:!1,invertFramePalette:!1,frame:""}}catch(e){return null}}).reduce(x.iy,[]),lastUpdateUTC:Math.floor(new Date().getTime()/1e3),version:c.A}},(0,o.saveAs)(new Blob((0,a._)(JSON.stringify((0,F._)({},n,t),null,2))),"backup_images.json"),[2]}})}),[p,_]),I=(0,l.useCallback)((0,r._)(function(){var e,t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:return[4,v(m)];case 1:return[4,y(r.sent(),d.Uv)];case 2:return e=r.sent(),t={},n={state:{frames:e.map(function(e,n){try{return t["frame-".concat(e.hash)]=e.binary,{hash:e.hash,name:_("backupExportFrame",{hash:e.hash}),id:"bak".concat(n.toString(10).padStart(2,"0"))}}catch(e){return null}}).reduce(b.N,[]),frameGroups:[{id:"bak",name:_("reImportedTrashFrames")}],lastUpdateUTC:Math.floor(new Date().getTime()/1e3),version:c.A}},(0,o.saveAs)(new Blob((0,a._)(JSON.stringify((0,F._)({},n,t),null,2))),"backup_frames.json"),[2]}})}),[_,m]),E=(0,l.useCallback)((0,r._)(function(){var e,t;return(0,i.YH)(this,function(n){switch(n.label){case 0:return[4,v(m)];case 1:return e=n.sent().length,[4,g(p)];case 2:return t=n.sent().length,A(e,t),[2]}})}),[m,p,A]),w=(0,l.useCallback)((0,r._)(function(){return(0,i.YH)(this,function(e){switch(e.label){case 0:return[4,h({images:p,frames:m})];case 1:return e.sent(),n(!1),window.requestAnimationFrame(function(){E()}),[2]}})}),[E,m,p,n]);return{showTrashCount:n,purgeTrash:w,downloadImages:C,downloadFrames:I,checkUpdateTrashCount:E,trashCount:t}}},49231:()=>{},52324:(e,t,n)=>{"use strict";n.d(t,{g:()=>c,i:()=>d});var r=n(97004),F=n(693),a=n(60376),i=n(39249),o=n(52491),s=n.n(o),l=n(75380),u=function(e){return!!e.find(function(e){return!e.hash})},c=function(){var e=(0,r._)(function(e){return(0,i.YH)(this,function(t){var n;return u(e)?[2,Promise.all(e.map((n=(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(r){switch(r.label){case 0:if(e.hash)return[2,e];return[4,l.Uv.getItem(e.id)];case 1:if(!(t=r.sent()))return console.warn("could not load frame data for hashing"),[2,e];return n=s()(t),[4,l.Uv.removeItem(e.id)];case 2:return r.sent(),[4,l.Uv.setItem(n,t)];case 3:return r.sent(),[2,(0,a._)((0,F._)({},e),{hash:n})]}})}),function(e){return n.apply(this,arguments)})))]:[2,e]})});return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,r._)(function(e){var t,n;return(0,i.YH)(this,function(o){switch(o.label){case 0:var l;if(!(t=e).state.frames||!u(t.state.frames))return[2,e];return[4,Promise.all(t.state.frames.map((l=(0,r._)(function(e){var n,r,o;return(0,i.YH)(this,function(i){return e.hash?[2,e]:(r=t[n="frame-".concat(e.id)])?(o=s()(r),delete t[n],t["frame-".concat(o)]=r,[2,(0,a._)((0,F._)({},e),{hash:o})]):(console.warn("could not load ".concat(n," from json import")),[2,e])})}),function(e){return l.apply(this,arguments)})))];case 1:return n=o.sent(),[2,(0,a._)((0,F._)({},t),{state:(0,a._)((0,F._)({},t.state),{frames:n})})]}})});return function(t){return e.apply(this,arguments)}}()},53081:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var r,F=n(86447),a=n(78538),i=n(87025),o=n(95155),s=n(62170),l=n(11279),u=n(44516),c=n(7642),d=n(3127),f=n(71803),m=n(700),p=n(17652),h=n(52491),g=n.n(h),v=n(12115),x=n(15821),A=n(9718),b=n(32521),j=n(52166),y=(r={},(0,F._)(r,A._Y.INACTIVE,"portDeviceTypes.inactiveDevice"),(0,F._)(r,A._Y.PACKET_CAPTURE,"portDeviceTypes.arduinoGameboyPrinterEmulator"),(0,F._)(r,A._Y.SUPER_PRINTER_INTERFACE,"portDeviceTypes.superPrinterInterface"),(0,F._)(r,A._Y.GBXCART,"portDeviceTypes.cartridgeReader"),r);let _=function(e){var t=e.inline,n=(0,b.Z)(),r=n.connectedDevices,F=n.webUSBEnabled,h=n.openWebUSB,_=n.webSerialEnabled,C=n.openWebSerial,I=n.unknownDeviceResponse,E=n.hasInactiveDevices,w=(0,j.A)().enableDebug,T=(0,p.c3)("ConnectSerial"),S=(0,a._)((0,v.useState)(!1),2),P=S[0],k=S[1],D=(0,v.useMemo)(function(){if(!I||!I.length)return[];var e=(0,i._)(I).some(function(e){return e<32&&9!==e&&10!==e&&13!==e});return[I.byteLength<50?(0,i._)(I).join(","):"",e?"":new TextDecoder().decode(I),g()((0,i._)(I))].filter(Boolean)},[I]);return(0,o.jsxs)(f.A,{direction:"column",gap:4,children:[(0,o.jsxs)(f.A,{direction:{xs:"column",md:t?"row":"column"},gap:4,sx:{"& > *":{flex:1}},children:[(0,o.jsx)(f.A,{direction:"column",gap:1,children:(0,o.jsx)(c.A,{title:T("openWebUSB"),onClick:h,disabled:!F,loadingPosition:"start",variant:"contained",color:"secondary",children:T("openWebUSB")})}),(0,o.jsx)(f.A,{direction:"column",gap:1,children:(0,o.jsx)(c.A,{title:T("openWebSerial"),onClick:C,disabled:!_,loadingPosition:"start",variant:"contained",color:"secondary",children:T("openWebSerial")})})]}),(0,o.jsx)(m.A,{variant:"body2",children:T("connectedDevices",{deviceCount:r.length})}),(0,o.jsx)(f.A,{component:"ul",direction:"column",gap:2,children:r.map(function(e){var n=e.id,r=e.portType,F=e.portDeviceType,a=e.description,i=r===A.qt.SERIAL?l.A:u.A;return(0,o.jsxs)(f.A,{gap:1,direction:"row",alignItems:"center",children:[(0,o.jsx)(i,{}),(0,o.jsxs)(f.A,{component:"li",direction:t?"row":"column",gap:2*!!t,alignItems:"baseline",children:[(0,o.jsx)(m.A,{variant:"body1",component:"span",children:T(y[F])}),(0,o.jsx)(m.A,{variant:"caption",component:"span",children:w?"".concat(a," - ").concat(n):a})]})]},n)})}),(0,o.jsx)(c.A,{title:T("showUnknownResponse"),onClick:function(){I&&k(!0)},disabled:!(E&&I),variant:"contained",color:"error",children:T("showUnknownResponse")}),(0,o.jsx)(x.A,{header:T("unknownDeviceInfo"),deny:function(){return k(!1)},open:P&&!!(null==I?void 0:I.length),children:(0,o.jsx)(f.A,{direction:"column",gap:2,children:D.map(function(e,t){return(0,o.jsxs)(f.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsx)(m.A,{children:e}),(0,o.jsx)(d.A,{onClick:function(){return navigator.clipboard.writeText(e)},title:T("copyToClipboard"),children:(0,o.jsx)(s.A,{})})]},t)})})})]})}},55364:(e,t,n)=>{"use strict";n.d(t,{iy:()=>a,pl:()=>F});var r=n(87025),F=function(e){return!!(e.hasOwnProperty("hashes")&&e.hashes)},a=function(e,t){return!t||F(t)?e:(0,r._)(e).concat([t])}},55685:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=function(e){return Array.from(new Set(e))}},56277:(e,t,n)=>{"use strict";n.d(t,{e:()=>F,p:()=>r});var r=function(e){return e.UP="up",e.DOWN="down",e}({}),F=function(e){return e.GIT="git",e.DROPBOX="dropbox",e.DROPBOXIMAGES="dropboximages",e}({})},62412:(e,t,n)=>{"use strict";n.d(t,{A:()=>v,E:()=>h});var r=n(97004),F=n(78538),a=n(87025),i=n(39249),o=n(3899),s=n.n(o),l=n(27576),u=n(88274),c=n.n(u),d=n(12115),f=n(3381),m=n(46498),p=n(34687),h=function(e){var t=(0,F._)(e,3),n=t[0],r=t[1],a=t[2];return["#",Math.min(255,Math.max(0,n)).toString(16).padStart(2,"0"),Math.min(255,Math.max(0,r)).toString(16).padStart(2,"0"),Math.min(255,Math.max(0,a)).toString(16).padStart(2,"0")].join("")},g=function(e,t){var n=.299*e[0]+.587*e[1]+.114*e[2],r=.299*t[0]+.587*t[1]+.114*t[2];return n>r?-1:+(n<r)};let v=function(){var e,t=(0,F._)((0,d.useState)(!1),2),n=t[0],o=t[1],u=(0,m.A)().setError,h=(0,f.A)(),v=h.setPickColors,x=h.cancelPickColors;return{onInputChange:(e=(0,r._)(function(e){var t,n,r,d,f,m;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(!(null==(n=(t=e.target).files)?void 0:n[0]))return[3,2];return o(!0),[4,(0,p.A)(t.files[0],!0)];case 1:d=(r=i.sent()).imageData,f=r.fileName,m=s()(d.data,4).map(function(e){var t=(0,F._)(e,3);return[t[0],t[1],t[2]]}),l.clusterize(m,{k:6},function(e,t){if(e)u(e);else{var n=c()(m,4),r=(0,a._)(n?n.palette():[]).concat((0,a._)(t?t.map(function(e){var t=(0,F._)(e.centroid,3);return[Math.round(t[0]),Math.round(t[1]),Math.round(t[2])]}):[])).filter(function(e,t,n){return n.findIndex(function(t){return t.join(",")===e.join(",")})===t}).sort(g);r.length<4?(u(Error("Not enough colors to pick from!")),x()):v({colors:r,fileName:f})}o(!1)}),i.label=2;case 2:return t.value="",[2]}})}),function(t){return e.apply(this,arguments)}),busy:n}}},66564:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(95155),F=n(54581),a=n(14426);n(12115);let i=function(){return(0,r.jsx)(F.A,{sx:{width:"100%",paddingTop:"90%",height:0,display:"block",background:"transparent",position:"relative"},children:(0,r.jsx)(F.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,r.jsx)(a.A,{color:"primary",size:40})})})}},66785:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var r=n(87025),F=n(6456),a=n(77840),i=n(12360),o=function(e,t){var n=e.images,o=e.groups,s=t.filtersTags,l=t.filtersFrames,u=t.filtersPalettes,c=t.sortBy,d=t.recentImports;return(0,r._)(n).map(F.YZ).sort((0,F.PM)(c)).map(F.lt).filter((0,a.A)(s,l,u,d,o)).filter((0,i.A)(s))}},67069:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var r={htmlInput:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1},inputLabel:{shrink:!0},fullWidth:!0,size:"small"}},70661:(e,t,n)=>{"use strict";n.d(t,{q:()=>u,$:()=>l});let r=function(e,t){var n=(t-e)/16;return Array(16).fill(null).map(function(t,r){return Math.floor(e+n*r)})},F=function(e){var t="number"==typeof e[0]?e[0]:0,n="number"==typeof e[1]?e[1]:85,F="number"==typeof e[2]?e[2]:170,a="number"==typeof e[3]?e[3]:255;return[r(t,n),r(n,F),r(F,a)]},a=function(e){for(var t=e.baseValues,n=e.orderPatterns,r=[],F=0;F<4;F+=1){var a=[];r.push(a);for(var i=0;i<4;i+=1){var o=[];a.push(o);for(var s=0;s<3;s+=1)o.push(t[s][n[s][4*F+i]])}}return r};var i=[0,12,3,15,8,4,11,7,2,14,1,13,10,6,9,5],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0,l=function(e){for(var t=e.imageData,n=e.contrastBaseValues,r=e.dither,l=e.colors,u=new ImageData(t.width,t.height),c=a({baseValues:F(n),orderPatterns:[r?i:o,r?i:o,r?i:o]}),d=t.width,f=t.data,m=0;m<f.length;m+=4){var p=s%d%4,h=Math.ceil(s/d)%4,g=f[m],v=void 0,x=c[p][h];v=g<=x[0]?l[3]:g<=x[1]?l[2]:g<=x[2]?l[1]:l[0],u.data[m]=v.r,u.data[m+1]=v.g,u.data[m+2]=v.b,u.data[m+3]=255,s+=1}return u},u=function(e){var t=e.targetCanvas,n=e.originalCanvas,r=e.imageData,F=e.palette,a=e.dither,i=e.contrastBaseValues,o=F.map(function(e){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}}),s=t.getContext("2d"),u=n.getContext("2d");if(!s||!u)return void console.error("canvas context is missing");s.putImageData(l({imageData:r,contrastBaseValues:i,dither:a,colors:o}),0,0),u.putImageData(r,0,0)}},74335:(e,t,n)=>{"use strict";n.d(t,{c:()=>a});var r=n(97004),F=n(39249),a=function(){var e=(0,r._)(function(e){return(0,F.YH)(this,function(t){return[2,new Promise(function(t){self.setTimeout(t,e)})]})});return function(t){return e.apply(this,arguments)}}()},75097:(e,t,n)=>{"use strict";n.d(t,{No:()=>F,Q3:()=>a,RQ:()=>i,x6:()=>r});var r=function(e){return e.DELETE="delete",e.ANIMATE="animate",e.DOWNLOAD="download",e.EDIT="edit",e.RGB="rgb",e}({}),F=function(e){return e.LOCK_FRAME="lockFrame",e.FRAME="frame",e.PALETTE="palette",e.TITLE="title",e.TAGS="tags",e.CREATED="created",e.ROTATION="rotation",e}({}),a=function(e){return e.INVERT_PALETTE="invertPalette",e.FRAME_PALETTE="framePalette",e.INVERT_FRAME_PALETTE="invertFramePalette",e}({}),i=["lockFrame","frame","title","tags","created","rotation","palette","invertPalette","framePalette","invertFramePalette"]},75380:(e,t,n)=>{"use strict";n.d(t,{Uv:()=>u,mU:()=>l,ZU:()=>c});var r=n(97004),F=n(39249),a=n(77271),i=n.n(a),o="dummy".concat(new Date().getTime());let s=function(e){var t,n,a,s,l=i().createInstance(e),u=(t=(0,r._)(function(){return(0,F.YH)(this,function(e){switch(e.label){case 0:return[4,l.setItem(o,o)];case 1:return e.sent(),[4,l.removeItem(o)];case 2:return e.sent(),[2]}})}),function(){return t.apply(this,arguments)});return{ready:(0,r._)(function(){var t;return(0,F.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,l.ready()];case 1:return n.sent(),[2,u()];case 2:throw t=n.sent(),l=i().createInstance(e),t;case 3:return[2]}})}),keys:(0,r._)(function(){return(0,F.YH)(this,function(t){try{return[2,l.keys()]}catch(t){throw l=i().createInstance(e),t}})}),driver:(0,r._)(function(){var t;return(0,F.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,l.driver()];case 1:return[2,n.sent()];case 2:throw t=n.sent(),l=i().createInstance(e),t;case 3:return[2]}})}),setItem:(n=(0,r._)(function(t,n){var r;return(0,F.YH)(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),[4,l.setItem(t,n)];case 1:return[2,F.sent()];case 2:throw r=F.sent(),l=i().createInstance(e),r;case 3:return[2]}})}),function(e,t){return n.apply(this,arguments)}),getItem:(a=(0,r._)(function(t){var n;return(0,F.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l.getItem(t)];case 1:return[2,r.sent()];case 2:throw n=r.sent(),l=i().createInstance(e),n;case 3:return[2]}})}),function(e){return a.apply(this,arguments)}),removeItem:(s=(0,r._)(function(t){var n;return(0,F.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l.removeItem(t)];case 1:return[2,r.sent()];case 2:throw n=r.sent(),l=i().createInstance(e),n;case 3:return[2]}})}),function(e){return s.apply(this,arguments)})}};var l=s({name:"GB Printer Web",storeName:"gb-printer-web-images"}),u=s({name:"GB Printer Web",storeName:"gb-printer-web-frames"});window.lfi=l,window.lff=u;var c=function(){var e=(0,r._)(function(){return(0,F.YH)(this,function(e){switch(e.label){case 0:return[4,u.ready()];case 1:return e.sent(),[4,l.ready()];case 2:return e.sent(),[4,new Promise(function(e){window.setTimeout(e,5)})];case 3:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}()},77840:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(87025),F=n(30832),a=n.n(F),i=n(19864),o=n(55364);let s=function(e,t,n,F,s){var l=function(s){var l,u,c=e.reduce(function(e,t){return[i.X3.FILTER_MONOCHROME,i.X3.FILTER_NEW,i.X3.FILTER_RGB,i.X3.FILTER_UNTAGGED,i.X3.FILTER_RECENT,i.X3.FILTER_FAVOURITE,i.X3.FILTER_COMMENTS,i.X3.FILTER_USERNAME].includes(t)?(0,r._)(e).concat([t]):e},[]);if(c.length&&(c.includes(i.X3.FILTER_UNTAGGED)&&0!==s.tags.length||c.includes(i.X3.FILTER_NEW)&&a()(new Date(s.created)).unix()<=a()().subtract(1,"day").unix()||c.includes(i.X3.FILTER_RECENT)&&!F.map(function(e){return e.hash}).includes(s.hash)||c.includes(i.X3.FILTER_RGB)&&!(0,o.pl)(s)||c.includes(i.X3.FILTER_MONOCHROME)&&(0,o.pl)(s)||c.includes(i.X3.FILTER_FAVOURITE)&&!s.tags.includes(i.X3.FILTER_FAVOURITE)||c.includes(i.X3.FILTER_COMMENTS)&&!(null==(l=s.meta)?void 0:l.comment)||c.includes(i.X3.FILTER_USERNAME)&&!(null==(u=s.meta)?void 0:u.userName)))return!1;return(!n.length||"string"==typeof s.palette&&!!n.includes(s.palette))&&(!t.length||!!s.frame&&!!t.includes(s.frame))};return function(e){if(l(e))return!0;var t=s.find(function(t){return t.coverImage===e.hash})||null;return!!t&&t.allImages.some(l)}}},80360:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=n(51368).A},81543:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var r=n(15905);let F=[{id:r.H.FRAMEMODE_KEEP,name:"frameModes.keepFrame"},{id:r.H.FRAMEMODE_CROP,name:"frameModes.cropFrame"},{id:r.H.FRAMEMODE_SQUARE_BLACK,name:"frameModes.squareBlack"},{id:r.H.FRAMEMODE_SQUARE_WHITE,name:"frameModes.squareWhite"}]},85539:(e,t,n)=>{"use strict";n.d(t,{_:()=>u});var r=n(97004),F=n(39249),a=n(70661),i=n(80360),o=n(72623),s=[0,256,1,257],l=function(e){for(var t=[],n=0;n<8;n+=1){for(var r=0,F=0;F<8;F+=1)r+=s[e[8*n+F]]<<7-F;t.push((r>>8).toString(16).padStart(2,"0"),(255&r).toString(16).padStart(2,"0"))}return t.join(" ").toUpperCase()},u=function(e){var t,n=e.bitmapQueue,s=e.dither,u=e.contrastBaseValues,c=e.importQueueAdd;n.forEach((t=(0,r._)(function(e){var t,n,r,d,f,m,p,h,g;return(0,F.YH)(this,function(F){switch(F.label){case 0:return t=e.imageData,n=e.height,r=e.fileName,d=e.lastModified,f=Array.from((0,a.$)({imageData:t,contrastBaseValues:u,dither:s,colors:[{r:0,g:0,b:0},{r:1,g:0,b:0},{r:2,g:0,b:0},{r:3,g:0,b:0}]}).data).filter(function(e,t){return!(t%4)}),m=20*Math.ceil(n/8),p=function(e){var t=Math.floor(e/20),n=e%20*8,r=8*t;return Array(8).fill(null).map(function(e,t){return f.slice(n+(r+t)*160).slice(0,8)}).flat(1)},h=Array(m).fill(null).map(function(e,t){return p(t)}).map(l),[4,(0,o.cg)(h)];case 1:return g=F.sent().dataHash,c([{fileName:r,imageHash:g,tiles:h,lastModified:d,tempId:(0,i.z)()}]),[2]}})}),function(e){return t.apply(this,arguments)}))}},85546:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=function(e){return function(t){var n=new Set;return t.filter(function(t){var r=t[e];return!n.has(r)&&(n.add(r),!0)})}}},85812:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(17652),F=n(12115),a=n(52166),i=function(){var e=(0,a.A)().hideDates,t=(0,r.kc)(),n=(0,F.useCallback)(function(e){var n=new Date(e);return"string"==typeof e&&isNaN(n.getTime())&&(n=new Date(e.replace(/(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2}):(\d{3})/,"$1T$2.$3"))),t.dateTime(n,"short")},[t]);return{formatterGallery:(0,F.useCallback)(function(t){return e||!t?null:n(t)},[n,e]),formatter:n}}},87031:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,U:()=>F});var r=n(87025),F=function(e){return e.ASC="asc",e.DESC="desc",e}({});let a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(n){var F="desc"===t?-1:1;return(0,r._)(n).sort(function(t,n){return"string"==typeof t[e]?t[e].localeCompare(n[e]):t[e]>n[e]?F:t[e]<n[e]?-F:0})}}},92756:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>rS});var r,F=n(693),a=n(60376),i=n(95155);n(40284),n(39141),n(49231);var o=n(67217),s=n(22548),l=n(71803),u=n(18254),c=n(27943),d=n(12115),f=n(46498),m=n(78538),p=n(69242),h=n(31747),g=n(9665),v=n(89880),x=n(3127),A=n(700),b=n(27299);let j=function(e){var t=e.dismiss,n=e.errorMessage,r=(0,m._)((0,d.useState)(!1),2),F=r[0],a=r[1];return(0,i.jsxs)(g.A,{severity:"error",variant:"filled",sx:{minWidth:300},action:(0,i.jsxs)(i.Fragment,{children:[n.error.stack&&!F&&(0,i.jsx)(x.A,{size:"small",title:"Show error stack","aria-label":"close",color:"inherit",onClick:function(){return a(!0)},children:(0,i.jsx)(h.A,{fontSize:"small"})}),(0,i.jsx)(x.A,{size:"small","aria-label":"close",color:"inherit",onClick:function(e,n){"clickaway"!==n&&t()},children:(0,i.jsx)(p.A,{fontSize:"small"})})]}),children:[(0,i.jsx)(v.A,{sx:{color:"inherit",whiteSpace:"pre"},children:n.error.message}),F&&(0,i.jsx)(A.A,{variant:"caption",fontFamily:"monospace",component:"pre",sx:function(e){return(0,b.E)(e,{backgroundColor:"#FFFFFF22",maxHeight:"200px",overflow:"auto",p:1})},children:n.error.stack})]})},y=function(){var e=(0,f.A)(),t=e.errors,n=e.dismissError;return(0,i.jsx)(l.A,{direction:"column",gap:4,sx:function(e){return{position:"fixed",top:e.spacing(10),right:e.spacing(2),zIndex:30}},children:t.map(function(e,t){return(0,i.jsx)(j,{dismiss:function(){return n(t)},errorMessage:e},e.id)})})};var _=n(96253),C=n(19505),I=n(40117),E=n(44389),w=n(37713),T=n(44516),S=n(4420),P=n(71169),k=n(97482),D=n(7642),B=n(61487),M=n(74964),N=n(12939),R=n(63148),L=n(65528),G=n(22376),O=n(85222),H=n(30529),U=n(6874),z=n.n(U),V=n(17652),W=n(99999),Y=n(95939),X=n(32521),Q=n(52166),K=n(24463);let Z=function(){var e=(0,K.A)(),t=e.gitStorage,n=e.dropboxStorage,r=n.autoDropboxSync||!1,F=!!(n.use||t.use&&t.owner&&t.repo&&t.branch&&t.throttle&&t.token),a=(0,f.A)(),i=a.syncBusy,o=a.setSyncSelect,s=a.setShowSerials,l=(0,Q.A)().useSerials,u=(0,K.A)().syncLastUpdate,c=(0,X.Z)(),d=c.webUSBEnabled,m=c.webSerialEnabled,p=c.hasInactiveDevices,h=c.unknownDeviceResponse;return{disableSerials:!d&&!m,serialWarning:!!(p&&h),portCount:c.connectedDevices.length,syncBusy:i,useSync:F,useSerials:l,syncLastUpdate:u,autoDropboxSync:r,selectSync:function(){return o(!0)},setShowSerials:function(){return s(!0)}}};var q=n(29032),J=n(69077),$=n(87025),ee=n(67069),et=n(86447),en=function(e){var t;return{styleOverrides:{root:(t={},(0,et._)(t,e.breakpoints.up("xs"),{minHeight:"var(--navigation-height)"}),(0,et._)(t,"justifyContent","end"),(0,et._)(t,"& .MuiButton-root",{height:"var(--navigation-height)",padding:"0 20px",fontSize:e.typography.body1.fontSize}),(0,et._)(t,"& .MuiButtonGroup-horizontal",{paddingRight:"8px"}),(0,et._)(t,"& .MuiSvgIcon-root",{fontSize:"1.8rem"}),t)}}},er=function(e){return{MuiAppBar:{variants:(0,$._)(["primary","secondary"].map(function(t){return{props:{color:t},style:{"--AppBar-background":e.palette[t].dark,"--AppBar-color":e.palette[t].contrastText,"& .MuiButton-root.active":{backgroundColor:e.palette["primary"===t?"secondary":"primary"].main},"& .MuiButton-root:hover":{backgroundColor:e.palette[t].light,color:e.palette[t].contrastText},"& .MuiIconButton-root:hover":{backgroundColor:e.palette[t].light,color:e.palette[t].contrastText}}}}))},MuiButton:{styleOverrides:{root:{fontSize:"13px",textTransform:"none",minHeight:"40px"}},variants:(0,$._)(["primary","secondary","tertiary"].map(function(t){return{props:{color:t},style:{"&.MuiButton-outlined":{color:e.palette[t].light,borderColor:e.palette[t].light,"&:hover":{backgroundColor:(0,S.X4)(e.palette[t].main,.25)},"&.Mui-disabled":{backgroundColor:(0,S.X4)(e.palette.fgtext.main,.33),color:e.palette.fgtext.main,borderColor:e.palette.fgtext.main,opacity:.4}}}}}))},MuiCardActionArea:{styleOverrides:{root:{height:"100%",".MuiCardActionArea-focusHighlight":{background:"transparent"}}}},MuiCardContent:{styleOverrides:{root:{padding:"24px 16px"}}},MuiDialogTitle:{styleOverrides:{root:{backgroundColor:e.palette.primary[e.palette.mode],color:e.palette.primary.contrastText,"&& + .MuiDialogContent-root":{padding:e.spacing(2)}}}},MuiFormControl:{styleOverrides:{root:{paddingTop:16,".MuiStack-root &:first-of-type":{marginTop:12}}}},MuiInputLabel:{styleOverrides:{root:{transform:"translate(14px, 25px) scale(1)","&.MuiInputLabel-shrink":{transform:"translate(2px, -12px) scale(1)"}}}},MuiLink:{styleOverrides:{root:{color:"inherit"}}},MuiList:{styleOverrides:{root:{".MuiListSubheader-root":{display:"flex",".MuiListItemIcon-root":{minWidth:32,flexDirection:"column",justifyContent:"center"}}}}},MuiMenuItem:{styleOverrides:{root:{"&.Mui-selected":{backgroundColor:(0,S.X4)(e.palette.secondary.main,.8),color:e.palette.secondary.contrastText,"&:hover,&.Mui-focusVisible":{backgroundColor:e.palette.secondary.main}}}}},MuiOutlinedInput:{styleOverrides:{root:{background:"dark"===e.palette.mode?"#000000":"#ffffff",color:"dark"===e.palette.mode?"#ffffff":"#000000",".MuiInputBase-inputMultiline":{fontSize:"13px",lineHeight:"16px",fontFamily:"monospace"},".MuiOutlinedInput-notchedOutline legend span":{display:"none"}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none"}}},MuiSelect:{styleOverrides:{select:{display:"flex",".MuiListItemIcon-root":{minWidth:32,flexDirection:"column",justifyContent:"center"}}},defaultProps:{displayEmpty:!0}},MuiSwitch:{defaultProps:{color:"tertiary"}},MuiTab:{styleOverrides:{root:{fontSize:16,textTransform:"none",minHeight:60,"&.Mui-selected":{backgroundColor:(0,S.X4)(e.palette.primary.main,.2),color:"inherit"},"&:hover":{backgroundColor:(0,S.X4)(e.palette.secondary.main,.35)}}}},MuiTabs:{styleOverrides:{root:{"&~.MuiTabPanel-root":{padding:0,marginTop:e.spacing(2)},"& .MuiTabScrollButton-root.Mui-disabled":{opacity:.25}}},defaultProps:{scrollButtons:"auto",indicatorColor:"secondary",variant:"scrollable"}},MuiTextField:{defaultProps:{color:"tertiary",slotProps:ee.y}},MuiToggleButtonGroup:{styleOverrides:{grouped:{variants:(0,$._)(["primary","secondary","tertiary"].map(function(t){return{props:{color:t},style:{"&.Mui-selected":{background:e.palette[t].main,color:e.palette[t].contrastText,"&:hover":{backgroundColor:(0,S.X4)(e.palette[t].main,.7)}},"&:hover":{backgroundColor:(0,S.X4)(e.palette[t].main,.4)}}}}))}},defaultProps:{color:"tertiary"}},MuiToolbar:en(e)}},eF=function(e){var t=e.mode,n=e.colorPrimary,r=e.colorSecondary,F=e.colorTertiary,a=e.colorSuccess,i=e.colorWarn,o=e.colorError,s=e.colorPageBackground,l=e.colorText,u=(0,J.A)({shape:{borderRadius:0},breakpoints:{values:{xs:0,sm:570,md:768,lg:1024,xl:1264}},typography:{fontFamily:'"Trebuchet MS", Helvetica, sans-serif',body1:{fontSize:16},body2:{fontSize:13},h1:{fontSize:30,fontWeight:"bold"},h2:{fontSize:24,fontWeight:"bold"},h3:{fontSize:20,fontWeight:"bold"},h4:{fontSize:18,fontWeight:"bold"}},palette:{mode:t,primary:{main:n},secondary:{main:r},success:{main:a},warning:{main:i},error:{main:o},background:{default:s,paper:(0,S.a)(s,"light"===t?.6:.02)}}}),c=(0,J.A)(u,{palette:{tertiary:u.palette.augmentColor({color:{main:F},name:"tertiary"}),fgtext:u.palette.augmentColor({color:{main:l},name:"fgtext"}),bg:u.palette.augmentColor({color:{main:s},name:"bg"}),text:{primary:l,secondary:l}}}),d=(0,S.au)(c.palette.primary.main,l,.7);return(0,J.A)(c,{typography:{fontFamily:'"Trebuchet MS", Helvetica, sans-serif',body1:{color:l},body2:{color:l},h1:{color:d},h2:{color:d},h3:{color:d},h4:{color:d}},components:er(c)})},ea={colorInfo:"#3f769e",colorSuccess:"#3f9e7c",colorWarn:"#8b7b2c",colorError:"#cb0003",colorPrimary:"#503281",colorSecondary:"#455c63",colorTertiary:"#4a6959"},ei=eF((0,F._)({mode:"dark",colorPageBackground:"#2a292b",colorText:"#b2b2b2"},ea)),eo=eF((0,F._)({mode:"light",colorPageBackground:"#d6d3dc",colorText:"#333333"},ea)),es=n(99451),el=function(e){return e.ERROR="error",e.INFO="info",e.DEFAULT="default",e}(el||{});let eu=function(){var e=(0,V.c3)("Navigation"),t=(0,m._)((0,d.useState)(!1),2),n=t[0],r=t[1],F=(0,m._)((0,d.useState)(void 0),2),a=F[0],s=F[1],l=(0,q.j)().fullPath,c=(0,Q.A)(),h=c.themeName,g=c.setThemeName,v=(0,f.A)(),A=v.showTrashCount,b=v.trashCount,j=(0,Y.Z)(),y=j.lastGalleryLink,U=j.getUrl,K=(0,m._)((0,d.useState)(U({pageIndex:0,group:""})),2),J=K[0],$=K[1];(0,d.useEffect)(function(){$(y&&l!==y?y:U({pageIndex:0,group:""}))},[l,U,y]),(0,d.useEffect)(function(){s(document.body)},[]);var ee=Z(),et=ee.disableSerials,en=ee.serialWarning,er=ee.portCount,eF=ee.syncBusy,ea=ee.useSync,ei=ee.useSerials,el=ee.syncLastUpdate,eu=ee.autoDropboxSync,ec=ee.selectSync,ed=ee.setShowSerials,ef=(0,X.Z)().isReceiving,em=(0,d.useMemo)(function(){return b.frames+b.images},[b]),ep=(0,d.useMemo)(function(){return eu&&el.local!==el.dropbox},[eu,el]),eh=(0,d.useMemo)(function(){return[{label:e("home"),route:"/",prefetch:!1},{label:e("gallery"),route:J,prefetch:!0},{label:e("import"),route:"/import",prefetch:!1},{label:e("palettes"),route:"/palettes",prefetch:!0},{label:e("frames"),route:"/frames",prefetch:!0},{label:e("settings"),route:"/settings/generic",prefetch:!1}].reduce(es.N,[])},[J,e]),eg=(0,d.useMemo)(function(){return[{title:e("trash"),icon:(0,i.jsx)(C.A,{}),badgeContent:em>0?em.toString(10):null,badgeColor:"error",disabled:!1,isBusy:!1,onClick:function(){return A(!0)}},ea?{title:e("syncRemote"),icon:(0,i.jsx)(w.A,{}),badgeContent:ep?"!":null,badgeColor:"error",disabled:eF,isBusy:!1,onClick:ec}:null,{title:h===W.V.BRIGHT?e("switchToDark"):e("switchToBright"),icon:h===W.V.BRIGHT?(0,i.jsx)(I.A,{}):(0,i.jsx)(_.A,{}),badgeContent:null,badgeColor:"default",disabled:!1,isBusy:!1,onClick:function(){return g(h===W.V.BRIGHT?W.V.DARK:W.V.BRIGHT)}},ei?{title:et?e("usbDisabled"):e("usbDevices"),icon:(0,i.jsx)(T.A,{}),badgeContent:en&&"!"||er&&er.toString(10)||null,badgeColor:en?"error":"info",disabled:et,isBusy:ef,onClick:ed}:null].reduce(es.N,[])},[et,er,ec,en,ed,g,A,eF,ep,e,h,em,ei,ea,ef]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{theme:eo,children:(0,i.jsx)(P.A,{color:"primary",enableColorOnDark:!0,position:"sticky",children:(0,i.jsx)(o.A,{maxWidth:"xl",disableGutters:!0,children:(0,i.jsxs)(H.A,{disableGutters:!0,children:[(0,i.jsx)(B.A,{variant:"text",component:"nav",role:"navigation","aria-label":e("mainNavAriaLabel"),sx:{display:{xs:"none",md:"inline-flex"},width:"100%"},children:eh.map(function(e){var t=e.route,n=e.label,F=e.prefetch;return(0,i.jsx)(D.A,{href:t,prefetch:F,component:z(),color:"inherit",onClick:function(){return r(!1)},children:n},t)})}),(0,i.jsxs)(B.A,{variant:"text",role:"navigation","aria-label":e("utilityNavAriaLabel"),children:[eg.map(function(e){var t=e.title,n=e.icon,r=e.onClick,F=e.badgeContent,a=e.badgeColor,o=e.isBusy;return(0,i.jsx)(x.A,{color:"inherit",title:t,onClick:r,sx:o?{animation:"pulse-bg 600ms infinite"}:void 0,children:(0,i.jsx)(k.A,{badgeContent:F,color:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:n})},t)}),(0,i.jsx)(x.A,{color:"inherit",title:e("openMainNav"),onClick:function(){return r(!0)},sx:{display:{md:"none"}},children:(0,i.jsx)(E.A,{})})]})]})})})}),(0,i.jsxs)(N.Ay,{container:a,variant:"temporary",open:n,onClose:function(){return r(!1)},ModalProps:{keepMounted:!0},sx:function(e){return{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{width:{xs:"100%",sm:e.breakpoints.values.sm}}}},children:[(0,i.jsx)(H.A,{disableGutters:!0,children:(0,i.jsx)(B.A,{variant:"text",sx:{display:{md:"none"}},children:(0,i.jsx)(x.A,{color:"inherit",title:e("closeMainNav"),onClick:function(){return r(!1)},children:(0,i.jsx)(p.A,{})})})}),(0,i.jsx)(M.A,{}),(0,i.jsx)(R.A,{children:eh.map(function(e){var t=e.route,n=e.label;return(0,i.jsx)(L.Ay,{disablePadding:!0,children:(0,i.jsx)(G.A,{href:t,component:z(),onClick:function(){return r(!1)},sx:function(e){return{"&.active":{background:e.palette.secondary.light,color:e.palette.secondary.contrastText},"&:hover":{background:(0,S.X4)(e.palette.primary.main,.3)}}},children:(0,i.jsx)(O.A,{primary:n})})},t)})})]})]})},ec=function(){return(0,i.jsx)(u.A,{theme:eo,children:(0,i.jsx)(P.A,{color:"primary",enableColorOnDark:!0,position:"sticky",children:(0,i.jsx)(o.A,{maxWidth:"xl",disableGutters:!0,children:(0,i.jsx)(H.A,{disableGutters:!0})})})})};var ed=n(4915),ef=n(76380),em=n(90835),ep=n(34991),eh=n(55864),eg=n(70661);let ev=function(e){return Math.floor(e)===e&&!!(e&&!(e&e-1))},ex=function(e){var t=e.imageData,n=e.scaleFactor,r=e.width,F=e.height,a=e.fileName,o=e.palette,s=e.dither,u=e.contrastBaseValues,c=(0,d.useRef)(null),f=(0,d.useRef)(null),m=(0,V.c3)("ImportPreviewImage");return(0,d.useEffect)(function(){c.current&&f.current&&(null==u?void 0:u.length)&&(0,eg.q)({targetCanvas:c.current,originalCanvas:f.current,imageData:t,palette:o,dither:s,contrastBaseValues:u})}),(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsxs)(l.A,{title:"".concat(a," - ").concat(n,"x"),direction:"row",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,i.jsx)("canvas",{width:r,height:F,ref:f}),(0,i.jsx)(eh.A,{fontSize:"large"}),(0,i.jsx)("canvas",{width:r,height:F,ref:c})]}),ev(n)?null:(0,i.jsx)(g.A,{severity:"warning",variant:"filled",children:m("scaleFactorWarning",{scaleFactor:n.toPrecision(3)})})]})};var eA=n(15821),eb=n(39893),ej=n(48675),ey=n(85539);let e_=function(){var e=(0,V.c3)("BitmapQueue"),t=(0,ej.A)(),n=t.bitmapQueue,r=t.bitmapQueueCancel,F=t.importQueueAdd,a=(0,Q.A)(),o=a.bitmapQueueDither,s=a.bitmapQueueSetting,u=a.setBitmapQueueDither,c=a.setBitmapQueueSetting,f=(0,d.useMemo)(function(){return(eb.C.find(function(e){return e.value===s})||eb.C[0]).baseValues},[s]);return(0,i.jsx)(eA.A,{header:e("dialogHeader"),confirm:function(){(0,ey._)({bitmapQueue:n,dither:o,contrastBaseValues:f,importQueueAdd:F})},deny:r,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[n.map(function(e,t){return(0,i.jsx)(ex,{imageData:e.imageData,scaleFactor:e.scaleFactor,width:e.width,height:e.height,fileName:e.fileName,dither:o,contrastBaseValues:f,palette:["#ffffff","#aaaaaa","#555555","#000000"]},t)}),(0,i.jsx)(ed.A,{label:e("enableDither"),control:(0,i.jsx)(em.A,{checked:o,onChange:function(e){u(e.target.checked)}})}),(0,i.jsx)(ep.A,{value:s,label:e("contrastPreset"),select:!0,size:"small",onChange:function(e){c(e.target.value)},children:eb.C.map(function(t){var n=t.value,r=t.translationKey;return(0,i.jsx)(ef.A,{value:n,children:e(r)},n)})})]})})};var eC=n(54581),eI=n(17976),eE=n(99776),ew=n(64263),eT=n(44296),eS=n(90404);let eP=function(e){var t=e.hash,n=e.hashes,r=e.meta,o=(0,V.c3)("MetaTable"),s=(0,a._)((0,F._)({},r),{hash:t}),l=Object.keys(s).reduce(function(e,t){var n="number"!=typeof s[t]&&"string"!=typeof s[t]?JSON.stringify(s[t]):s[t];return(0,$._)(e).concat([{key:t,value:n}])},[]);if(n){var u=Object.keys(n).reduce(function(e,t){var r={key:o("hashChannel",{channel:t}),value:n[t]};return(0,$._)(e).concat([r])},[]);l.push.apply(l,(0,$._)(u))}return(0,i.jsx)(eT.A,{children:(0,i.jsx)(eI.A,{padding:"none",sx:{fontFamily:"monospace"},children:(0,i.jsx)(eE.A,{children:l.map(function(e){var t=e.key,n=e.value;return(0,i.jsxs)(eS.A,{children:[(0,i.jsx)(ew.A,{component:"th",scope:"row",children:t}),(0,i.jsx)(ew.A,{align:"right",children:n})]},t)})})})})};var ek=n(39630),eD=n(41186);let eB=function(){var e=(0,eD.A)().dialogs[0],t=e.questions,n=(0,m._)((0,d.useState)(t?t({}).reduce(function(e,t){var n,r,i,o=t.key;switch(t.type){case ek.V.SELECT:n=(null==(i=(0,F._)({},t).options)||null==(r=i.find(function(e){return e.selected}))?void 0:r.value)||"";break;case ek.V.CHECKBOX:n=!1;break;case ek.V.TEXT:n=t.initialValue||"";break;case ek.V.NUMBER:n=0;break;case ek.V.INFO:default:return e}return(0,a._)((0,F._)({},e),(0,et._)({},o,n))},{}):{}),2),r=n[0],i=n[1];return{message:e.message,confirm:function(){return e.confirm(r)},deny:e.deny,questions:t?t(r):[],values:r,setSelected:function(e){i((0,F._)({},r,e))}}},eM=function(){var e=eB(),t=e.message,n=e.questions,r=e.values,F=e.setSelected,a=e.confirm,o=e.deny;return(0,i.jsx)(eA.A,{confirm:a,deny:o,header:t,headerOnly:!n.length,children:(0,i.jsx)(l.A,{direction:"column",gap:2,children:n.map(function(e){switch(e.type){case ek.V.SELECT:var t=e.label,n=e.key,a=e.options,o=e.disabled;return(0,i.jsx)(ep.A,{select:!0,disabled:void 0!==o&&o,size:"small",value:r[n]||"",label:t,onChange:function(e){return F((0,et._)({},n,e.target.value))},children:a.map(function(e){var t=e.value,n=e.name;return(0,i.jsx)(ef.A,{value:t,children:n},t)})},n);case ek.V.TEXT:var s=e.label,l=e.key,u=e.disabled;return(0,i.jsx)(ep.A,{disabled:void 0!==u&&u,size:"small",value:r[l]||"",label:s,onChange:function(e){return F((0,et._)({},l,e.target.value))}},l);case ek.V.NUMBER:var c=e.label,d=e.key,f=e.min,m=e.max,p=e.disabled;return(0,i.jsx)(ep.A,{disabled:void 0!==p&&p,size:"small",value:r[d]||"",type:"number",label:c,slotProps:{htmlInput:{min:f,max:m}},onChange:function(e){return F((0,et._)({},d,e.target.value))}},d);case ek.V.CHECKBOX:var h=e.label,v=e.key,x=e.disabled;return(0,i.jsx)(ed.A,{disabled:void 0!==x&&x,label:h,control:(0,i.jsx)(em.A,{checked:r[v],onChange:function(e){var t=e.target;F((0,et._)({},v,t.checked))}})},v);case ek.V.INFO:var b=e.label,j=e.key,y=e.severity;return y?(0,i.jsx)(g.A,{severity:y,variant:"filled",children:b},j):(0,i.jsx)(A.A,{children:b},j);case ek.V.IMAGE:var _=e.label,C=e.key,I=e.src;return(0,i.jsx)(eC.A,{component:"img",src:I,alt:_,title:_,sx:{imageRendering:"pixelated"}},C);case ek.V.META:var E=e.key,w=e.meta;return(0,i.jsx)(eP,{hash:w.hash,meta:null==w?void 0:w.meta,hashes:null==w?void 0:w.hashes},E);default:return null}})})})};var eN=n(50086),eR=n(18407),eL=n(16324);let eG=function(){var e=(0,eL.A)(),t=(0,V.c3)("DragOver");return(0,i.jsx)(l.A,{justifyContent:"center",alignItems:"center",sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:30,background:(0,S.X4)(e.palette.background.paper,.6),backdropFilter:"blur(6px)"},children:(0,i.jsx)(eR.A,{elevation:12,sx:{px:{xs:6,md:10},py:{xs:4,md:9}},children:(0,i.jsxs)(l.A,{direction:"column",gap:4,alignItems:"center",color:e.palette.tertiary.main,children:[(0,i.jsx)(eN.A,{sx:{fontSize:64}}),(0,i.jsx)(A.A,{variant:"h5",fontWeight:"bold",children:t("dropFilesHere")}),(0,i.jsx)(A.A,{variant:"body2",sx:{maxWidth:"70vw"},textAlign:"center",children:t("supportedFileTypes")})]})})})};var eO=n(55734),eH=n(78868),eU=n(82691),ez=n(18096),eV=n(35478),eW=n(39489),eY=n(74641),eX=n(11760),eQ=n(44116);let eK=function(e){var t=e.frame,n=e.updateFrame,r=e.noFrameOption,F=e.updateFrameLock,a=e.lockFrame,o=e.selectLabel,s=(0,V.c3)("FrameSelect"),u=(0,eX.h)(),c=u.frames,f=u.frameGroups,m=(0,d.useMemo)(function(){return f.map(function(e){var t=(0,eQ.d)(c,e.id);return 0===t.length?[]:[{id:e.id,name:e.name,isGroup:!0}].concat((0,$._)(t.map(function(e){return{id:e.id,name:e.name,isGroup:!1}})))}).flat()},[f,c]);return(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsxs)(ep.A,{label:o||s("frameLabel"),select:!0,size:"small",value:t,onChange:function(e){n(e.target.value)},children:[(0,i.jsx)(ef.A,{value:"",children:r||s("noFrameOption")}),m.map(function(e){var t=e.id,n=e.name;return e.isGroup?(0,i.jsxs)(eY.A,{children:[(0,i.jsx)(eW.A,{children:(0,i.jsx)(eV.A,{})}),(0,i.jsx)(O.A,{children:"".concat(n," (").concat(t,")")})]},t):(0,i.jsx)(ef.A,{value:t,children:n},t)})]}),"function"==typeof F?(0,i.jsx)(ed.A,{label:s("separateColorSettings"),control:(0,i.jsx)(em.A,{checked:a,onChange:function(e){F(e.target.checked)}})}):null]})};var eZ=n(23912),eq=n(14596),eJ=n(75602);let e$=function(e){var t=e.color,n=e.onChange,r=e.values,F=(0,d.useMemo)(function(){switch(t){case"r":return"#ff0000";case"g":return"#00dd00";case"b":return"#0000ff";default:return"#888888"}},[t]);return(0,i.jsxs)(l.A,{direction:"row",gap:2,alignItems:"center",sx:{pr:2},children:[(0,i.jsx)(x.A,{title:"Reset",onClick:function(){n([0,85,170,255])},children:(0,i.jsx)(eq.A,{})}),(0,i.jsx)(eJ.Ay,{min:0,max:255,value:r,sx:{color:F},defaultValue:[0,85,170,255],onChange:function(e,t){n(t)},disableSwap:!0})]})};var e0=n(15905),e1=[{id:e0.Nx.NORMAL,translationKey:"blendModes.normal"},{id:e0.Nx.NORMAL_S,translationKey:"blendModes.normalS"},{id:e0.Nx.LIGHTEN,translationKey:"blendModes.lighten"},{id:e0.Nx.SCREEN,translationKey:"blendModes.screen"},{id:e0.Nx.DODGE,translationKey:"blendModes.dodge"},{id:e0.Nx.ADDITION,translationKey:"blendModes.addition"},{id:e0.Nx.DARKEN,translationKey:"blendModes.darken"},{id:e0.Nx.MULTIPLY,translationKey:"blendModes.multiply"},{id:e0.Nx.BURN,translationKey:"blendModes.burn"},{id:e0.Nx.OVERLAY,translationKey:"blendModes.overlay"},{id:e0.Nx.SOFTLIGHT,translationKey:"blendModes.softLight"},{id:e0.Nx.HARDLIGHT,translationKey:"blendModes.hardLight"},{id:e0.Nx.DIFFERENCE,translationKey:"blendModes.difference"},{id:e0.Nx.EXCLUSION,translationKey:"blendModes.exclusion"}];let e2=function(e){var t=(0,V.c3)("GreySelect"),n=(0,m._)((0,d.useState)(e.values),2),r=n[0],o=n[1],s=(0,eZ.A)(function(t){e.onChange(t,!0)},150,{leading:!0,trailing:!0}),u=function(e,t){var n=(0,a._)((0,F._)({},r),(0,et._)({},e,t));o(n),s.callback(n)},c=["r","g","b","n"].reduce(function(t,n){return e.useChannels[n]?(0,$._)(t).concat([n]):t},[]);return(0,i.jsx)(l.A,{direction:"column",gap:3,children:c.map(function(e){return(0,i.jsxs)(l.A,{direction:"column",gap:0,children:["n"===e?(0,i.jsx)(ep.A,{value:r.blend,label:t("neutralLayerBlendmode"),select:!0,size:"small",onChange:function(e){u("blend",e.target.value)},children:e1.map(function(e){var n=e.id,r=e.translationKey;return(0,i.jsx)(ef.A,{value:n,children:t(r)},n)})}):null,(0,i.jsx)(e$,{color:e,values:r[e],onChange:function(t){u(e,t)}})]},"slider-".concat(e))})})};var e3=n(97004),e5=n(39249),e4=n(27088),e6=n(17348),e7=n(97644),e8=n(3856),e9=n(77952),te=n(28706),tt=n(9952),tn=n(30832),tr=n.n(tn),tF=n(46594);let ta=function(e){var t=e.children,n=(0,eL.A)(),r=(0,d.useMemo)(function(){if(!(null==(e=n.components)?void 0:e.MuiTextField))return n;var e,t,r,i=(0,F._)({},n.components.MuiTextField);return(null==(r=i.defaultProps)||null==(t=r.slotProps)?void 0:t.htmlInput)&&delete i.defaultProps.slotProps.htmlInput,(0,a._)((0,F._)({},n),{components:(0,a._)((0,F._)({},n.components),{MuiTextField:i})})},[n]);return(0,i.jsx)(u.A,{theme:r,children:t})};var ti=[e0.pL.DEG_0,e0.pL.DEG_90,e0.pL.DEG_180,e0.pL.DEG_270];let to=function(e){var t=e.created,r=e.hash,F=e.hashes,a=e.updateCreated,o=e.meta,s=e.rotation,u=e.updateRotation,c=(0,Q.A)().preferredLocale,f=(0,V.c3)("ImageMeta"),p=(0,m._)((0,d.useState)(void 0),2),h=p[0],g=p[1];return(0,d.useEffect)(function(){(0,e3._)(function(){var e,t;return(0,e5.YH)(this,function(r){switch(r.label){case 0:e=c.toLowerCase(),r.label=1;case 1:return r.trys.push([1,3,,8]),[4,n(16853)("./".concat(e,".js"))];case 2:return r.sent(),g(e),[3,8];case 3:r.sent(),r.label=4;case 4:return r.trys.push([4,6,,7]),t=e.split("-")[0],[4,n(16853)("./".concat(t,".js"))];case 5:return r.sent(),g(t),[3,7];case 6:return r.sent(),g(void 0),[3,7];case 7:return[3,8];case 8:return[2]}})})()},[c]),(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(ta,{children:(0,i.jsx)(e9.$,{dateAdapter:tt.R,adapterLocale:h,children:(0,i.jsx)(te.K,{label:f("dateTime"),closeOnSelect:!1,views:["year","month","day","hours","minutes","seconds"],value:tr()(t),onChange:function(e){e&&a((0,tF.J)(e.toDate()))}})})}),(0,i.jsxs)(e4.A,{children:[(0,i.jsx)(e6.A,{shrink:!0,children:f("editRotation")}),(0,i.jsx)(e8.A,{exclusive:!0,fullWidth:!0,value:s||e0.pL.DEG_0,onChange:function(e,t){u(t)},children:ti.map(function(e){return(0,i.jsx)(e7.A,{value:e,children:"".concat(90*e,"\xb0")},e)})})]}),(0,i.jsx)(eP,{meta:o,hash:r,hashes:F})]})};var ts=n(31829);let tl=function(e){var t=e.palette,n=e.fontSize;return(0,i.jsx)(eC.A,{sx:(0,a._)((0,F._)({display:"inline-block",fontSize:n||"2rem",width:"1em",height:"1em",lineHeight:"1em",verticalAlign:"middle",borderRadius:"50%"},(0,ts.O)(t,ts.h.CONIC)),{"&:hover":{animation:"spin 800ms infinite linear"}})})};var tu=n(806);let tc=function(e){var t=e.value,n=e.allowEmpty,r=e.invertPalette,F=e.noFancy,a=e.onChange,o=e.updateInvertPalette,s=(0,V.c3)("PaletteSelect"),u=(0,m._)((0,d.useState)(t),2),c=u[0],f=u[1],p=(0,eX.h)().palettes,h=(0,eL.A)(),g=(0,tu.A)().sortFn,v=(0,$._)(p).sort(g);return n&&v.unshift({shortName:"",name:s("asSelectedPerImage"),palette:[],isPredefined:!1,origin:""}),(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsx)(ep.A,{value:t,label:s("palette"),size:"small",select:!0,onChange:function(e){a(e.target.value,!0),f(e.target.value)},children:v.map(function(e){var t=e.shortName,n=e.name,r=e.palette;return(0,i.jsxs)(ef.A,{value:t,children:[(0,i.jsx)(eW.A,{children:(0,i.jsx)(tl,{palette:r,fontSize:"1.5rem"})}),(0,i.jsx)(O.A,{children:n})]},t)})}),o?(0,i.jsx)(ed.A,{label:s("invertPalette"),control:(0,i.jsx)(em.A,{checked:r,onChange:function(e){o(e.target.checked)}})}):null,F?null:(0,i.jsx)(eC.A,{component:"ul",sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 2.5rem)",justifyContent:"center",gap:.25,button:{padding:0,cursor:"pointer",width:"2.5rem",height:"2.5rem",border:"none",borderRadius:"50%"}},children:v.map(function(e){var t=e.shortName,n=e.name,r=e.palette;return(0,i.jsx)(eC.A,{component:"li",children:(0,i.jsx)("button",{type:"button",title:n,style:{background:t===c?h.palette.tertiary.main:"transparent"},onMouseEnter:function(){a(t,!1)},onMouseLeave:function(){a(c,!1)},onClick:function(){a(t,!0),f(t)},children:(0,i.jsx)(tl,{palette:r})})},t)})})]})};var td=n(40857),tf=n(72502),tm=n(30576),tp=n(25466),th=n(41101),tg=n(19864),tv=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let tx=function(e,t){var n=t.mode,r=t.tag;switch(n){case"add":return{add:(0,$._)(e.add).concat([r]),remove:(0,$._)(e.remove.filter(function(e){return e!==r}))};case"remove":return{remove:(0,$._)(e.remove).concat([r]),add:(0,$._)(e.add.filter(function(e){return e!==r}))};default:return e}};var tA=n(55685),tb=n(47402),tj=function(e){var t=new Set,n=!0,r=!1,F=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var o=a.value.tags,s=!0,l=!1,u=void 0;try{for(var c,d=o[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;f!==tg.X3.FILTER_FAVOURITE&&t.add(f)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}}catch(e){r=!0,F=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw F}}return Array.from(t).sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})},ty=function(){var e=(0,eX.h)().images,t=(0,m._)((0,d.useState)(tj(e)),2),n=t[0],r=t[1];return(0,d.useEffect)(function(){r(tj(e))},[e]),{availableTags:n}};let t_=function(e){var t=e.updateTags,n=e.selectedTags,r=(0,V.c3)("InputNewTag"),o=ty().availableTags.filter(function(e){return!n.includes(e)}),s=(0,m._)((0,d.useState)(""),2),l=s[0],u=s[1];return(0,i.jsx)(ta,{children:(0,i.jsx)(tb.A,{options:o,fullWidth:!0,size:"small",inputValue:l,renderInput:function(e){return(0,i.jsx)(ep.A,(0,a._)((0,F._)({},e),{label:r("tagsLabel")}))},clearOnBlur:!0,clearOnEscape:!0,freeSolo:!0,onInputChange:function(e,t,n){switch(n){case"input":u(t||"");break;case"reset":case"clear":case"blur":u("")}},onChange:function(e,n,r){switch(r){case"createOption":case"selectOption":t(tv.ADD,(n||"").trim())}}})})},tC=function(e){var t=e.tags,n=e.updateTags,r=e.resetTags,F=(0,V.c3)("TagsSelect"),a=(0,tA.A)((0,$._)(t.initial).concat((0,$._)(t.add)));return(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsx)(t_,{updateTags:n,selectedTags:a}),a.length>0&&(0,i.jsxs)(l.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:[a.map(function(e){var r,F=t.add.includes(e),a=t.remove.includes(e);return r=F?"success":a?"error":"default",(0,i.jsx)(th.A,{label:(0,i.jsxs)(l.A,{direction:"row",gap:1,alignItems:"center",children:[e===tg.X3.FILTER_FAVOURITE?"❤️":e,(0,i.jsxs)(l.A,{direction:"row",gap:0,sx:{mr:-1,".MuiButtonBase-root":{opacity:.4,borderRadius:"50%","&:hover":{opacity:1},"&:focus-visible":{opacity:1,background:"color-mix(in srgb, currentColor 20%, transparent)"}}},children:[(0,i.jsx)(tp.A,{onClick:function(){return n(tv.ADD,e)},children:(0,i.jsx)(td.A,{})}),(0,i.jsx)(tp.A,{onClick:function(){return n(tv.REMOVE,e)},children:(0,i.jsx)(tf.A,{})})]})]}),color:r,variant:"filled"},e)}),t.add.length+t.remove.length>0&&(0,i.jsx)(x.A,{onClick:r,title:F("resetTags"),size:"small",children:(0,i.jsx)(tm.A,{})})]})]})};var tI=function(e){return e.PALETTE="pal",e.FRAME="frame",e.TAGS="tags",e.MISC="misc",e}(tI||{}),tE=function(e,t){switch(e){case"frame":return"tabTypes.frame";case"misc":return"tabTypes.misc";case"pal":return t?"tabTypes.colors":"tabTypes.palette";case"tags":return"tabTypes.tags";default:return""}};let tw=function(e){var t,n,r,F,a=(0,V.c3)("EditImageTabs"),o=(0,d.useMemo)(function(){var t=[];return e.mixedTypes||t.push("pal"),e.regularImage&&t.push("frame"),t.push("tags","misc"),t},[e.mixedTypes,e.regularImage]),s=(0,m._)((0,d.useState)(null),2),u=s[0],c=s[1];return(0,d.useEffect)(function(){c(o[0])},[o]),(0,i.jsx)(l.A,{direction:"column",spacing:1,children:(0,i.jsxs)(eO.Ay,{value:u||o[0],children:[(0,i.jsx)(eH.A,{variant:"fullWidth",indicatorColor:"secondary",allowScrollButtonsMobile:!1,children:o.map(function(t){return(0,i.jsx)(ez.A,{label:a(tE(t,!!e.paletteRGBN)),value:t,onClick:function(){return c(t)}},t)})}),(0,i.jsx)(eU.A,{value:"pal",children:e.paletteRGBN?(0,i.jsx)(e2,{values:e.paletteRGBN,onChange:e.updatePalette,useChannels:{r:!!(null==(t=e.hashes)?void 0:t.r),g:!!(null==(n=e.hashes)?void 0:n.g),b:!!(null==(r=e.hashes)?void 0:r.b),n:!!(null==(F=e.hashes)?void 0:F.n)}}):(0,i.jsx)(tc,{value:e.paletteShort||"",invertPalette:e.invertPalette,onChange:e.updatePalette,updateInvertPalette:e.updateInvertPalette})}),(0,i.jsxs)(eU.A,{value:"frame",children:[(0,i.jsx)(eK,{updateFrame:e.updateFrame,updateFrameLock:e.updateFrameLock,frame:e.frame||"",lockFrame:e.lockFrame}),e.lockFrame&&!e.paletteRGBN?(0,i.jsx)(tc,{value:e.framePaletteShort||"",invertPalette:e.invertFramePalette,onChange:e.updateFramePalette,updateInvertPalette:e.updateInvertFramePalette}):null]}),(0,i.jsx)(eU.A,{value:"tags",children:(0,i.jsx)(tC,{updateTags:e.updateTags,resetTags:e.resetTags,tags:e.tags})}),(0,i.jsx)(eU.A,{value:"misc",children:(0,i.jsx)(to,{created:e.created,hash:e.hash,hashes:e.hashes,updateCreated:e.updateCreated,meta:e.meta,rotation:e.rotation,updateRotation:e.updateRotation})})]})})};var tT=n(40082),tS=n(5432),tP=n(75097),tk=n(633),tD=n(3381),tB=n(71620);let tM=function(e){var t=e.initial,n=e.add,r=e.remove;return(0,tA.A)((0,$._)(t).concat((0,$._)(n))).filter(function(e){return!r.includes(e)})};var tN=n(55364),tR=n(6456);let tL=function(){var e=(0,tD.A)(),t=e.editImages,n=e.cancelEditImages,r=(0,tB.A)().sortBy,i=(0,eX.h)().images,o=(0,tk.g)().updateImages;return{batchUpdateImages:(0,d.useCallback)(function(e){var s=e.shouldUpdate,l=e.updates,u=e.tagChanges,c=(0,tR.PM)(r),d=(null==t?void 0:t.batch)||[];s&&(null==d?void 0:d.length)&&o(d.reduce(function(e,t){var n=i.find(function(e){return e.hash===t});return n?(0,$._)(e).concat([n]):e},[]).map(tR.YZ).sort(c).map(tR.lt).map(function(e,t){return tP.RQ.reduce(function(e,n){if(!s[n])return e;switch(n){case tP.No.TITLE:return(0,a._)((0,F._)({},e),{title:l.title.replace(/%(n+)/gi,function(e,n){return(t+1).toString(10).padStart(n.length,"0")})});case tP.No.TAGS:var r=tM((0,a._)((0,F._)({},u),{initial:e.tags}));return(0,a._)((0,F._)({},e),{tags:r});case tP.No.ROTATION:case tP.No.LOCK_FRAME:case tP.No.FRAME:case tP.No.CREATED:return(0,a._)((0,F._)({},e),(0,et._)({},n,l[n]))}if((0,tN.pl)(e))return n===tP.No.PALETTE?(0,a._)((0,F._)({},e),{palette:l.palette}):e;switch(n){case tP.No.PALETTE:case tP.Q3.FRAME_PALETTE:case tP.Q3.INVERT_FRAME_PALETTE:case tP.Q3.INVERT_PALETTE:return(0,a._)((0,F._)({},e),(0,et._)({},n,l[n]));default:return e}},e)})),n()},[n,null==t?void 0:t.batch,i,r,o])}};var tG=n(98250),tO=n(5847),tH=function(){var e=(0,V.c3)("useEditForm"),t=(0,tD.A)(),n=t.editImages,r=t.cancelEditImages,i=(0,eX.h)(),o=i.palettes,s=i.frames,l=i.images,u=tL().batchUpdateImages,c=function(e){return o.find(function(t){return e===t.shortName})||tS.Fv},f=(0,tO.p)(l,s),p=(0,tG.h)(),h=(0,d.useMemo)(function(){if(n){var e=n.batch||[],t=n.tags||[];if(e[0]){var r=l.find(function(t){return t.hash===e[0]});if(r){var F=p.width<=600?p.height:Math.min(900,p.height),a=e.reduce(function(e,t){var n=l.find(function(e){return e.hash===t});if(!n)return e;var r=(0,tN.pl)(n);return{mono:e.mono||!r,rgb:e.rgb||r}},{mono:!1,rgb:!1}),i=a.mono&&a.rgb,o=(0,tN.pl)(r)?r.palette:void 0,s=(0,tN.pl)(r)?void 0:r.palette,u=(0,tN.pl)(r)?void 0:r.framePalette;return{created:r.created,hash:r.hash,height:F,imageCount:(null==e?void 0:e.length)||0,invertPalette:r.invertPalette||!1,invertFramePalette:r.invertFramePalette||!1,lockFrame:r.lockFrame||!1,mixedTypes:i,tags:t,title:r.title,frame:r.frame,hashes:(0,tN.pl)(r)?r.hashes:void 0,meta:r.meta,paletteRGBN:o,paletteShort:s,framePaletteShort:u,rotation:r.rotation}}}}},[n,l,p]),g=(0,m._)((0,d.useState)((null==h?void 0:h.title)||""),2),v=g[0],x=g[1],A=(0,m._)((0,d.useState)((null==h?void 0:h.created)||""),2),b=A[0],j=A[1],y=(0,m._)((0,d.useState)((null==h?void 0:h.frame)||""),2),_=y[0],C=y[1],I=(0,m._)((0,d.useState)(null==h?void 0:h.lockFrame),2),E=I[0],w=I[1],T=(0,m._)((0,d.useState)(null==h?void 0:h.rotation),2),S=T[0],P=T[1],k=(0,m._)((0,d.useState)(null==h?void 0:h.invertPalette),2),D=k[0],B=k[1],M=(0,m._)((0,d.useState)(null==h?void 0:h.invertFramePalette),2),N=M[0],R=M[1],L=(0,m._)((0,d.useState)((null==h?void 0:h.paletteShort)||""),2),G=L[0],O=L[1],H=(0,m._)((0,d.useState)((null==h?void 0:h.framePaletteShort)||""),2),U=H[0],z=H[1],W=(0,m._)((0,d.useState)(null==h?void 0:h.paletteRGBN),2),Y=W[0],X=W[1],Q=(0,m._)((0,d.useState)(!1),2),K=Q[0],Z=Q[1],q=Y||c(G).palette,J=c(U).palette,$=null==h?void 0:h.hash;(0,d.useEffect)(function(){var e;(e=(0,e3._)(function(){return(0,e5.YH)(this,function(e){switch(e.label){case 0:if(!$)return[2];return[4,f($)];case 1:return Z(360===e.sent()),[2]}})}),function(){return e.apply(this,arguments)})()},[f,$]);var ee=(0,m._)((0,d.useState)({initial:(null==h?void 0:h.tags)||[],add:[],remove:[]}),2),en=ee[0],er=ee[1],eF=(0,m._)((0,d.useState)({created:!1,title:!1,frame:!1,lockFrame:!1,tags:!1,rotation:!1,palette:!1,invertPalette:!1,framePalette:!1,invertFramePalette:!1}),2),ea=eF[0],ei=eF[1];return{toEdit:h,form:{title:v,created:b,frame:_,lockFrame:E,rotation:S,invertPalette:D,paletteShort:G,framePaletteShort:U,invertFramePalette:N,paletteRGBN:Y},isRegularImage:K,shouldUpdate:ea,willUpdateBatch:[ea.created?e("updateDate"):"",ea.title?e("updateTitle"):"",ea.palette?e("updatePalette"):"",ea.invertPalette?e("updateInvertPalette"):"",ea.frame?e("updateFrame"):"",ea.lockFrame?e("updateLockFrame"):"",ea.framePalette?e("updateFramePalette"):"",ea.invertFramePalette?e("updateInvertFramePalette"):"",ea.tags?e("updateTags"):"",ea.rotation?e("updateRotation"):""].filter(Boolean),tagChanges:en,usedPalette:q,usedFramePalette:J,updateForm:function(e){return function(t){switch(ei((0,a._)((0,F._)({},ea),(0,et._)({},e,!0))),e){case"title":x(t);break;case"created":j(t);break;case"invertPalette":B(t);break;case"invertFramePalette":R(t);break;case"framePalette":z(t);break;case"frame":C(t);break;case"lockFrame":w(t);break;case"rotation":P(t)}}},updatePalette:function(e,t){e&&(t&&ei((0,a._)((0,F._)({},ea),{palette:!0})),"string"==typeof e?O(e):X(e))},updateFramePalette:function(e,t){t&&ei((0,a._)((0,F._)({},ea),{framePalette:!0})),z(e)},updateTags:function(e,t){ei((0,a._)((0,F._)({},ea),{tags:!0})),er((0,F._)({},en,tx(en,{mode:e,tag:t})))},resetTags:function(){ei((0,a._)((0,F._)({},ea),{tags:!1})),er(function(e){return{initial:e.initial,add:[],remove:[]}})},save:function(){u({shouldUpdate:ea,updates:{title:v,created:b,frame:_,lockFrame:E,rotation:S,palette:Y||G,invertPalette:D||!1,framePalette:U,invertFramePalette:N||!1},tagChanges:en})},cancel:function(){return r()}}},tU=function(e){for(var t=e.parentElement;t;){var n=getComputedStyle(t),r=n.overflowY,F=n.overflowX,a=("auto"===r||"scroll"===r)&&t.scrollHeight>t.clientHeight,i=("auto"===F||"scroll"===F)&&t.scrollWidth>t.clientWidth;if(a||i)return t;t=t.parentElement}return document.scrollingElement||document.documentElement};let tz=function(){var e=(0,V.c3)("EditForm"),t=tH(),n=t.toEdit,r=t.form,F=t.isRegularImage,a=t.willUpdateBatch,o=t.tagChanges,s=t.usedPalette,u=t.usedFramePalette,c=t.updateForm,f=t.updatePalette,p=t.updateFramePalette,h=t.updateTags,x=t.resetTags,b=t.save,j=t.cancel,y=(0,eL.A)(),_=(0,m._)((0,d.useState)(null),2),C=_[0],I=_[1],E=(0,m._)((0,d.useState)({top:y.spacing(-2)}),2),w=E[0],T=E[1];if((0,d.useEffect)(function(){if(!C)return function(){};var e,t=function(e){var t=C.getBoundingClientRect(),n=Math.min(1,Math.max(144/t.height,1-e.scrollTop/t.height)),r=Math.min(t.height-144,e.scrollTop);T({position:"sticky",zIndex:2,transition:"top ease-in-out 150ms",transform:"translateY(-16px)",top:"-".concat(Math.round(r),"px"),"& .gameboy-image":{transformOrigin:"center bottom",transition:"transform ease-in-out 150ms",transform:"scale(".concat(n.toPrecision(4),")")}})};t(C);var n=function(n){clearTimeout(e),e=setTimeout(function(){t(n.target)},50)},r=tU(C);return r.addEventListener("scroll",n),function(){clearTimeout(e),r.removeEventListener("scroll",n)}},[C]),!n)return console.warn('Editform should be open, but "toEdit" is undefined',n),null;var S=r.title,P=r.created,k=r.frame,D=r.lockFrame,B=r.rotation,M=r.invertPalette,N=r.invertFramePalette,R=r.framePaletteShort,L=r.paletteShort,G=r.paletteRGBN;return(0,i.jsx)(eA.A,{contentHeight:n.height,header:e("dialogHeader",{count:n.imageCount}),open:!0,confirm:b,deny:j,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(eC.A,{ref:I,sx:w,children:(0,i.jsxs)(eC.A,{sx:{mx:y.spacing(-2),position:"relative",backgroundColor:y.palette.background.default},children:[(0,i.jsx)(tT.A,{lockFrame:D,invertPalette:M,palette:s,invertFramePalette:N,framePalette:u,frameId:k,hash:n.hash,hashes:n.hashes,rotation:B}),n.imageCount>1?(0,i.jsxs)(g.A,{severity:"info",sx:{position:"absolute",width:"75%",top:"11%",left:"50%",transform:"translate(-50%, -50%)"},children:[(0,i.jsx)(v.A,{children:e("editingMultiple",{count:n.imageCount})}),a.length?(0,i.jsx)(eC.A,{component:"ul",children:a.map(function(e){return(0,i.jsx)(A.A,{component:"li",variant:"caption",children:e},e)})}):null]}):null]})}),(0,i.jsx)(ep.A,{helperText:n.imageCount>1?e("indexHelperText"):void 0,type:"text",label:e("editTitle"),value:S,onChange:function(e){var t=e.target.value;c("title")(t)}}),(0,i.jsx)(tw,{created:P,updateCreated:c("created"),regularImage:F,mixedTypes:n.mixedTypes,lockFrame:D,hash:n.hash,hashes:n.hashes,paletteShort:L,framePaletteShort:R,paletteRGBN:G,invertPalette:M,invertFramePalette:N,frame:k,tags:o,meta:n.meta,rotation:B,updatePalette:f,updateInvertPalette:c("invertPalette"),updateFramePalette:p,updateInvertFramePalette:c("invertFramePalette"),updateFrame:c("frame"),updateFrameLock:c("lockFrame"),updateRotation:c("rotation"),updateTags:h,resetTags:x})]})})};var tV=n(56491);let tW=function(e){var t,n,r=(null==e?void 0:e.id)||"",F=(0,tD.A)().cancelEditFrame,a=(0,eX.h)().frames,i=(0,eX.h)(),o=i.frameGroups,s=i.addFrames,l=(0,tk.g)().updateLastSyncLocalNow,u=(0,tV.A)(a,o),c=RegExp("^(?<groupName>[a-z]+)(?<id>[0-9]+)","g").exec(r),f=(null==c||null==(t=c.groups)?void 0:t.groupName)||"",p=(null==c||null==(n=c.groups)?void 0:n.id)||"0",h=(0,m._)((0,d.useState)(f),2),g=h[0],v=h[1],x=(0,m._)((0,d.useState)(parseInt(p,10)),2),A=x[0],b=x[1],j=(0,m._)((0,d.useState)((null==e?void 0:e.name)||""),2),y=j[0],_=j[1],C="".concat(g).concat(A.toString(10).padStart(2,"0")),I=C===r||!a.find(function(e){return C===e.id}),E=!!g.match(/^[a-z]{2,}$/g),w=A>0;return{groups:u,updateId:r,fullId:C,frameIndex:A,frameGroup:g,frameName:y,idValid:I,formValid:I&&E&&w,groupIdValid:E,frameIndexValid:w,setFrameIndex:b,setFrameGroup:v,setFrameName:_,saveFrame:function(){F(),l(),s([{hash:(null==e?void 0:e.hash)||"",id:C,name:y}])},cancelEdit:F}},tY=function(e){var t=e.frameIndex,n=e.frameName,r=e.idValid,F=e.groupIdValid,a=e.frameIndexValid,o=e.frameGroup,s=e.groups,u=e.fullId,c=e.frameGroupName,d=e.extraFields,f=e.setFrameGroupName,m=e.setFrameIndex,p=e.setFrameGroup,h=e.setFrameName,v=(0,V.c3)("EditFrameForm"),x=!!s.find(function(e){return o===e.id});return(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[d,(0,i.jsxs)(ep.A,{label:v("frameGroup"),select:!0,size:"small",type:"text",value:o,onChange:function(e){p(e.target.value)},slotProps:{inputLabel:{shrink:!0},select:{renderValue:function(e){var t;return x?(null==(t=s.find(function(t){return t.id===e}))?void 0:t.name)||v("unknown"):""===e?v("selectFrameGroup"):v("newFrameGroup")}}},children:[(0,i.jsx)(ef.A,{value:"",children:x?v("selectFrameGroup"):v("newFrameGroup")}),s.map(function(e){var t=e.id,n=e.name;return(0,i.jsx)(ef.A,{value:t,children:n},t)})]}),(0,i.jsx)(ep.A,{label:x?v("frameGroupId"):v("newFrameGroupId"),size:"small",type:"text",value:o,onChange:function(e){p(e.target.value)},helperText:F?void 0:v("groupIdHelperText")}),f?(0,i.jsx)(ep.A,{label:v("newFrameGroupName"),size:"small",type:"text",onChange:function(e){f(e.target.value)},value:x?"":c,disabled:x}):null,(0,i.jsx)(ep.A,{label:v("frameIndex"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:99}},value:t,onChange:function(e){m(parseInt(e.target.value,10))},helperText:a?null:v("frameIndexHelperText")}),(0,i.jsx)(ep.A,{label:v("frameName"),size:"small",type:"text",value:n,onChange:function(e){h(e.target.value)}}),!r&&(0,i.jsx)(g.A,{severity:"warning",variant:"filled",children:v("idInUse",{id:u})})]})},tX=function(){var e=(0,V.c3)("EditFrame"),t=(0,tD.A)().editFrame,n=(0,eX.h)().frames.find(function(e){return e.id===t}),r=tW(n),F=r.cancelEdit,a=r.saveFrame,o=r.updateId,s=r.fullId,l=r.formValid,u=r.groups,c=r.frameGroup,d=r.frameIndex,f=r.setFrameIndex,m=r.frameName,p=r.setFrameGroup,h=r.setFrameName,g=r.idValid,v=r.groupIdValid,x=r.frameIndexValid,A=o!==s?e("idChange",{newId:s}):"";return(0,i.jsx)(eA.A,{confirm:a,canConfirm:l,header:n?e("dialogHeader",{id:o,idChange:A}):void 0,deny:F,children:n?(0,i.jsx)(tY,{groups:u,fullId:s,frameIndex:d,frameGroup:c,frameName:m,idValid:g,groupIdValid:v,frameIndexValid:x,setFrameIndex:f,setFrameGroup:p,setFrameName:h}):null})};var tQ=n(31936),tK=n(23747);let tZ=function(){var e=(0,V.c3)("EditImageGroup"),t=(0,tK.Ay)(),n=t.editId,r=t.absoluteSlug,F=t.possibleParents,a=t.slug,o=t.title,s=t.canConfirm,u=t.canMove,c=t.slugIsInUse,d=t.slugWasChanged,f=t.parentSlug,m=t.selectionCount,p=t.setSlug,h=t.setTitle,g=t.setParentSlug,v=t.confirm,x=t.move,A=t.cancelEditImageGroup;return(0,i.jsx)(eA.A,{confirm:v,canConfirm:s,header:n!==tK.Ll?e("dialogHeader",{title:o?'"'.concat(o,'"'):""}):e("createNewGroupDialogHeader",{count:m}),deny:A,contentWidth:"auto",actionButtons:F.length>1&&n===tK.Ll&&(0,i.jsx)(D.A,{disabled:!u,onClick:x,variant:"contained",color:"secondary",children:e("moveSelectedImages",{count:m})}),children:(0,i.jsx)(l.A,{direction:"column",gap:4,children:n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ep.A,{label:e("title"),size:"small",type:"text",value:o,onChange:function(e){return h(e.target.value)}}),(0,i.jsx)(ep.A,{label:e("pathSegment"),size:"small",type:"text",value:a,onChange:function(e){return p(e.target.value)},helperText:e(c&&d?"pathInUse":"path",{path:r}),error:!s}),F.length>1&&(0,i.jsx)(ep.A,{label:e("parentGroup"),size:"small",select:!0,onChange:function(e){return g(e.target.value)},value:f,children:F.map(function(e){var t=e.value,n=e.name;return(0,i.jsx)(ef.A,{value:t,children:n},t)})}),(0,i.jsx)(tQ.A,{text:JSON.stringify({slug:a,parentSlug:f,canConfirm:s,slugIsInUse:c},null,2)})]})})})};var tq=n(63457),tJ=function(e){return/^#[0-9a-fA-F]{6}$/.test(e)};let t$=function(e){var t=e.value,n=e.onChange,r=e.label,F=(0,m._)((0,d.useState)(t),2),a=F[0],o=F[1],s=(0,m._)((0,d.useState)("id-".concat(Math.random().toString(16).split(".")[1])),1)[0];(0,d.useEffect)(function(){o(t)},[t]);var u=(0,d.useRef)(n);return(0,d.useEffect)(function(){u.current=n},[n]),(0,d.useEffect)(function(){var e=setTimeout(function(){tJ(a)&&u.current(a)},125);return function(){clearTimeout(e)}},[a]),(0,i.jsxs)(e4.A,{variant:"outlined",fullWidth:!0,size:"small",color:"tertiary",sx:{"--palette-color":tJ(a)?a:"#000000",".MuiOutlinedInput-notchedOutline":{inset:0},"[type=color]":{height:"100%",width:"100%",opacity:"0",cursor:"pointer"}},children:[(0,i.jsx)(e6.A,{shrink:!0,htmlFor:s,children:r}),(0,i.jsxs)(l.A,{direction:"row",gap:1,sx:{"& > *":{flexBasis:"auto",flexShrink:0,flexGrow:1},"& > *:first-of-type":{flexBasis:"40px",flexShrink:0,flexGrow:0,backgroundColor:"var(--palette-color)"}},children:[(0,i.jsx)(eR.A,{variant:"outlined",children:(0,i.jsx)("input",{type:"color",value:a,onChange:function(e){return o(e.target.value)},tabIndex:-1})}),(0,i.jsx)(tq.A,{id:s,type:"text",value:a,onChange:function(e){return o(e.target.value)},onBlur:function(e){return o(e.target.value.toLowerCase())}})]})]})};var t0=n(66785),t1=(0,n(85546).A)("hash");let t2=function(){var e=(0,Y.Z)().root,t=(0,tB.A)(),n=t.imageSelection,r=t.sortBy,F=t.filtersTags,a=t.filtersFrames,i=t.filtersPalettes,o=t.recentImports,s=(0,d.useMemo)(function(){return{sortBy:r,filtersTags:F,filtersPalettes:i,filtersFrames:a,recentImports:o}},[a,i,F,o,r]);return(0,d.useMemo)(function(){var t=n.map(function(t){return e.allImages.find(function(e){return e.hash===t})}).reduce(tN.iy,[]),r=t.length>1?[]:(0,t0.S)(e,s).reduce(tN.iy,[]),F=t.length+r.length>1?[]:(0,$._)(e.allImages).map(tR.YZ).sort((0,tR.PM)(s.sortBy)).map(tR.lt).reduce(tN.iy,[]),a=t1([t.shift(),r.shift(),F.shift(),F.pop(),r.pop(),t.pop()].reduce(tN.iy,[]));return[a.shift(),a.pop()].reduce(tN.iy,[])},[s,n,e])};var t3=function(){var e=(0,V.c3)("useEditPalette"),t=(0,tD.A)(),n=t.editPalette,r=t.cancelEditPalette,F=(0,eX.h)(),a=F.palettes,i=F.addPalettes,o=(0,tk.g)().updateLastSyncLocalNow,s=(null==n?void 0:n.shortName)||"",l=(null==n?void 0:n.palette)||[],u=(null==n?void 0:n.name)||"",c=(0,d.useCallback)(function(e){return!!e.match(/^[a-z]+[a-z0-9]*$/gi)&&-1===a.findIndex(function(t){return t.shortName===e})},[a]),f=s===tg.mI,p=(0,m._)((0,d.useState)(u),2),h=p[0],g=p[1],v=(0,m._)((0,d.useState)(l),2),x=v[0],A=v[1],b=(0,m._)((0,d.useState)(f?"":s),2),j=b[0],y=b[1],_=(0,d.useMemo)(function(){return(!f||c(j))&&h.length>0},[h,f,j,c]),C=t2(),I=(0,d.useCallback)(function(){i([{shortName:f?j:s,name:h,palette:x,origin:e("paletteOrigin"),isPredefined:!1}]),o(),r()},[i,f,r,h,j,x,s,o,e]);return(0,d.useEffect)(function(){var e=function(e){"Enter"===e.key&&e.ctrlKey&&_&&I()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),{canConfirm:_,canEditShortName:f,newName:h,newShortName:j,palette:x,previewImages:C,shortName:s,setNewName:g,setNewShortName:y,setPalette:A,save:I,cancelEditPalette:r}};let t5=function(){var e=(0,V.c3)("EditPalette"),t=t3(),n=t.canConfirm,r=t.canEditShortName,F=t.newName,a=t.newShortName,o=t.palette,s=t.previewImages,u=t.shortName,c=t.setNewName,f=t.setNewShortName,m=t.setPalette,p=t.save,h=t.cancelEditPalette,g=(0,d.useCallback)(function(e){c(e.target.value)},[c]),v=(0,d.useCallback)(function(e){f(e.target.value)},[f]),x=(0,d.useCallback)(function(e){f(e.target.value.toLowerCase())},[f]),A=(0,d.useCallback)(function(e,t){var n=(0,$._)(o);n[e]=t,m(n)},[o,m]);return u?(0,i.jsx)(eA.A,{confirm:p,canConfirm:n,deny:h,header:e("dialogHeader",{name:F?'"'.concat(F,'"'):""}),closeOnOverlayClick:!1,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(ep.A,{label:e("editTitle"),size:"small",type:"text",placeholder:e("addTitle"),value:F,onChange:g}),(0,i.jsx)(ep.A,{label:e("idShortName"),size:"small",type:"text",value:a,disabled:!r,onChange:v,onBlur:x,required:!0}),(0,i.jsx)(l.A,{direction:"row",gap:2,component:"ul",justifyContent:"space-around",children:s.map(function(e){return(0,i.jsx)(eC.A,{component:"li",children:(0,i.jsx)(tT.A,{hash:e.hash,invertPalette:!1,invertFramePalette:!1,lockFrame:!1,palette:o,framePalette:o})},e.hash)})}),o.map(function(t,n){return(0,i.jsx)(t$,{label:e("colorIndex",{index:n+1}),value:t,onChange:function(e){return A(n,e)}},"color-".concat(n))})]})}):null};var t4=n(29584),t6=n(7585),t7=n(19690),t8=n(75401),t9=n(41218),ne=n(96490),nt=n(16632),nn=n(70682),nr=n(24103),nF=function(e){switch(e){case"r":return"#ff0000";case"g":return"#00aa00";case"b":return"#0000ff";default:return"#444444"}};let na=function(e){var t=e.isR,n=e.isG,r=e.isB,F=e.isN,a=e.toggleChannel,o=(0,d.useMemo)(function(){return[{value:t,updateKey:"r"},{value:n,updateKey:"g"},{value:r,updateKey:"b"},{value:F,updateKey:"n"}]},[r,n,F,t]);return(0,i.jsx)(e8.A,{onChange:function(e,t){return a(t)},fullWidth:!0,sx:{".MuiToggleButton-root":{padding:"1px",border:"none"}},children:o.map(function(e){var t=e.value,n=e.updateKey;return(0,i.jsx)(e7.A,{value:n,sx:{"& svg":{color:nF(n)}},children:t?(0,i.jsx)(nn.A,{}):(0,i.jsx)(nr.A,{})},n)})})};var ni=n(52491),no=n.n(ni),ns=n(7119),nl=n(85812);let nu=function(){var e,t=(0,tB.A)().setImageSelection,r=(0,tk.g)().addImages;return{saveRGBNImage:(0,d.useCallback)((e=(0,e3._)(function(e){var F,a,i;return(0,e5.YH)(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(n.t.bind(n,52491,23))];case 1:return F=o.sent().default,a=Date.now(),r(i=e.map(function(e,t){return{palette:tS.YP,hashes:e,hash:F(e),created:(0,tF.J)(a+t),title:"",tags:[]}})),t(i.map(function(e){return e.hash})),[2]}})}),function(t){return e.apply(this,arguments)}),[r,t])}};var nc=n(80360),nd=function(e){return e.BY_COLOR="BY_COLOR",e.BY_IMAGE="BY_IMAGE",e.MANUAL="MANUAL",e}({}),nf=function(){var e,t,n,r=(0,V.c3)("useEditRGBNImages"),i=(0,ns.g)().navigateToGroup,o=(0,Y.Z)().view,s=nu().saveRGBNImage,l=(0,tB.A)().sortBy,u=(0,tD.A)(),c=u.editRGBNImages,f=u.cancelEditRGBNImages,p=u.cancelEditImageGroup,h=(0,eX.h)().addImageGroup,g=(0,m._)((0,d.useState)(c.length>5),2),v=g[0],x=g[1],A=l.split("_")[1],b=(0,d.useMemo)(function(){var e=(0,t0.S)(o,{filtersTags:[],filtersFrames:[],filtersPalettes:[],sortBy:l,recentImports:[]});return"desc"===A&&e.reverse(),e.reduce(tN.iy,[]).reduce(function(e,t){return c.includes(t.hash)?(0,$._)(e).concat([t]):e},[])},[c,A,o,l]),j=(0,m._)((0,d.useState)(["r","g","b","s","n"]),2),y=j[0],_=j[1],C=(0,m._)((0,d.useState)(b.length<=4?"MANUAL":"BY_COLOR"),2),I=C[0],E=C[1],w=(0,m._)((0,d.useState)({r:(null==(e=b[0])?void 0:e.hash)||void 0,g:(null==(t=b[Math.floor(b.length/3)])?void 0:t.hash)||void 0,b:(null==(n=b[2*Math.floor(b.length/3)])?void 0:n.hash)||void 0}),2),T=w[0],S=w[1],P=y.findIndex(function(e){return"s"===e}),k=Math.ceil(c.length/P),D=P*k!==c.length,B=(0,d.useMemo)(function(){if("MANUAL"===I)return Object.keys(T).length?[T]:[];var e=y.slice(0,P),t=Array(k).fill("").map(function(t,n){return e.reduce(function(e,t,r){var i,o=null==(i=b["BY_COLOR"===I?n+k*r:r+P*n])?void 0:i.hash;return o?(0,a._)((0,F._)({},e),(0,et._)({},t,o)):e},{})});return"desc"===A&&t.reverse(),t},[k,A,I,T,y,b,P]),M=(0,nl.N)().formatter,N=(0,d.useCallback)((0,e3._)(function(){var e,t,n,F;return(0,e5.YH)(this,function(a){switch(a.label){case 0:return f(),[4,s(B)];case 1:return a.sent(),v&&(e=r("rgbNewGroupTitle",{date:M(new Date)}),t=(0,tK.BF)(e),n=B.map(function(e){return no()(e)}),p(),h({id:F=(0,nc.z)(),slug:t,title:e,created:(0,tF.J)(),coverImage:n[0],images:n,groups:[]},o.id),i(F,0)),[2]}})}),[r,h,p,f,v,M,i,B,s,o.id]),R="MANUAL"===I;return{order:y,grouping:I,canConfirm:R?B.length>0:y.length>1,lengthWarning:!R&&D,rgbnHashes:B,sortedImages:b,createGroup:v,updateOrder:function(e,t){if(!(t<0)&&!(t>y.length)){var n=y.filter(function(t){return t!==e});n.splice(t,0,e).filter(Boolean),_(n)}},toggleSingleChannel:function(e,t){var n=(0,F._)({},T);n[e]===t?delete n[e]:n[e]=t,S(n)},setGrouping:E,save:N,setCreateGroup:x,cancelEditRGBNImages:f}};let nm=function(){var e=(0,V.c3)("EditRGBN"),t=nf(),n=t.canConfirm,r=t.order,F=t.grouping,a=t.lengthWarning,o=t.rgbnHashes,s=t.sortedImages,u=t.createGroup,d=t.updateOrder,f=t.toggleSingleChannel,m=t.setGrouping,p=t.setCreateGroup,h=t.save,v=t.cancelEditRGBNImages,x=(0,eL.A)(),b=(0,c.A)(x.breakpoints.up("sm"));return(0,i.jsx)(eA.A,{confirm:h,deny:v,closeOnOverlayClick:!1,canConfirm:n&&!a,header:e("dialogHeader"),contentWidth:"576px",children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsxs)(ep.A,{label:e("groupingLabel"),select:!0,size:"small",value:F,onChange:function(e){return m(e.target.value)},children:[(0,i.jsx)(ef.A,{value:nd.BY_COLOR,children:e("groupByColor")}),(0,i.jsx)(ef.A,{value:nd.BY_IMAGE,children:e("groupByImage")}),(0,i.jsx)(ef.A,{value:nd.MANUAL,children:e("manualChannelSelection")})]}),F===nd.MANUAL?(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{variant:"body2",children:e("manualChannelInstructions")}),(0,i.jsx)(l.A,{direction:"row",gap:2,component:"ul",justifyContent:"center",alignItems:"center",flexWrap:"wrap",sx:{"& .MuiCardContent-root":{padding:1}},children:s.map(function(e){var t,n,r,F,a,s,l,u,c=e.hash,d=(null==(a=o[0])?void 0:a.r)===c,m=(null==(s=o[0])?void 0:s.g)===c,p=(null==(l=o[0])?void 0:l.b)===c,h=(null==(u=o[0])?void 0:u.n)===c,g=(t=255*!!d,n=255*!!m,r=255*!!p,F=function(e,t,n,r){var F=function(e,t){return Math.floor(e*t).toString(16).padStart(2,"0")};return"#".concat(F(e,r)).concat(F(t,r)).concat(F(n,r))},d||m||p?[F(t,n,r,1),F(t,n,r,.66),F(t,n,r,.33),"#000000"]:h?["#ffffff","#aaaaaa","#555555","#000000"]:["#b2b2b2","#949494","#737373","#606060"]);return(0,i.jsxs)(t9.A,{className:"edit-rgbn__single-image-list-entry",variant:"outlined",children:[(0,i.jsx)(nt.A,{sx:{".gameboy-image":{width:"80px",margin:"0 auto",imageRendering:"auto"}},children:(0,i.jsx)(tT.A,{lockFrame:!1,invertPalette:!1,invertFramePalette:!1,palette:g,framePalette:g,hash:c})}),(0,i.jsx)(ne.A,{children:(0,i.jsx)(na,{isR:d,isG:m,isB:p,isN:h,toggleChannel:function(e){return f(e,c)}})})]},c)})})]}):(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{variant:"body2",children:e("channelOrderInstructions")}),(0,i.jsx)(l.A,{direction:{xs:"column",sm:"row"},gap:{xs:1,sm:2},component:"ul",justifyContent:"center",alignItems:"center",children:r.map(function(e,t){return"s"===e?(0,i.jsx)(M.A,{orientation:b?"vertical":"horizontal",variant:"middle",flexItem:!0},e):(0,i.jsxs)(B.A,{component:"li",size:"small",sx:{backgroundColor:nF(e)},children:[(0,i.jsx)(D.A,{onClick:function(){return d(e,t-1)},sx:{svg:{color:"#ffffff"}},children:b?(0,i.jsx)(t6.A,{}):(0,i.jsx)(t8.A,{})}),(0,i.jsx)(D.A,{onClick:function(){return d(e,t+1)},sx:{svg:{color:"#ffffff"}},children:b?(0,i.jsx)(t7.A,{}):(0,i.jsx)(t4.A,{})})]},e)})}),a?(0,i.jsx)(g.A,{variant:"filled",severity:"error",children:e("channelDistributionError")}):null]}),(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{variant:"body2",children:e("imagePreview")}),(0,i.jsx)(l.A,{direction:"row",component:"ul",sx:{overflowX:"auto","& > *":{flex:"160px 0 0",margin:"0 auto"}},gap:1,children:o.map(function(e,t){return(0,i.jsx)(eC.A,{component:"li",children:(0,i.jsx)(tT.A,{lockFrame:!1,invertPalette:!1,invertFramePalette:!1,palette:tS.YP,framePalette:[],hash:"newRGBN",hashes:e})},t)})})]}),(0,i.jsx)(ed.A,{label:e("createGroupLabel"),control:(0,i.jsx)(em.A,{checked:u,onChange:function(e){p(e.target.checked)}})})]})})};var np=n(9127),nh=n(70541),ng=n(93370),nv=n(87031),nx=function(e){return e.ADD="add",e.REMOVE="remove",e}({}),nA=(0,nv.A)("usage",nv.U.DESC),nb=function(){var e=(0,tB.A)(),t=e.filtersTags,n=e.filtersFrames,r=e.filtersPalettes,F=e.filtersVisible,a=e.setFiltersVisible,i=e.setFilters,o=(0,eX.h)(),s=o.frames,l=o.images,u=o.palettes,c=(0,m._)((0,d.useState)(t),2),f=c[0],p=c[1],h=(0,m._)((0,d.useState)(n),2),g=h[0],v=h[1],x=(0,m._)((0,d.useState)(r),2),A=x[0],b=x[1],j=ty().availableTags,y=(0,d.useMemo)(function(){return nA(s.map(function(e){var t=l.filter(function(t){return t.frame===e.id}).length;return{frame:e,usage:t}}).filter(function(e){var t=e.frame;return e.usage>0||g.includes(t.id)}))},[g,s,l]);(0,d.useEffect)(function(){p(t),v(n),b(r)},[n,r,t]);var _=(0,d.useCallback)(function(e,t){p("add"===t?(0,tA.A)((0,$._)(f).concat([e])):f.filter(function(t){return t!==e}))},[f]),C=(0,d.useCallback)(function(e,t){b("add"===t?(0,tA.A)((0,$._)(A).concat([e])):A.filter(function(t){return t!==e}))},[A]),I=(0,d.useCallback)(function(e,t){v("add"===t?(0,tA.A)((0,$._)(g).concat([e])):g.filter(function(t){return t!==e}))},[g]);return{visible:F,availableTags:j,availableFrames:y,availablePalettes:u,activeTags:f,activeFrames:g,activePalettes:A,updateActiveTags:_,updateActivePalettes:C,updateActiveFrames:I,applyClearTags:function(){return i([],[],[])},clearTags:function(){return p([])},clearPalettes:function(){return b([])},clearFrames:function(){return v([])},confirm:function(){return i(f,A,g)},cancel:function(){return a(!1)}}},nj=n(53982),ny=Array(20).fill(e0.BM);let n_=function(e){var t=e.frameActive,n=e.toggleFrame,r=e.frame,F=e.usage,a=e.palette,o=(0,m._)((0,d.useState)([]),2),s=o[0],u=o[1];(0,d.useEffect)(function(){var e=setTimeout((0,e3._)(function(){var e,t;return(0,e5.YH)(this,function(n){switch(n.label){case 0:return[4,(0,nj.mZ)(r.hash)];case 1:if(!(e=n.sent()))return u([]),[2];return t=function(t){return(0,$._)(e.left[t]).concat((0,$._)(ny.slice(0,16)),(0,$._)(e.right[t]))},u((0,$._)(e.upper).concat((0,$._)(t(0)),(0,$._)(t(1)),(0,$._)(ny),(0,$._)(t(e.left.length-2)),(0,$._)(t(e.left.length-1)),(0,$._)(e.lower))),[2]}})}),1);return function(){clearTimeout(e)}},[r.hash]);var c=(0,V.c3)("FilterFormFrame");return(0,i.jsx)(D.A,{title:c(t?"removeFrame":"selectFrame",{name:r.name}),onClick:function(){return n(t?nx.REMOVE:nx.ADD)},variant:t?"contained":"outlined",color:"tertiary",children:(0,i.jsxs)(l.A,{direction:"column",justifyContent:"flex-start",gap:1,sx:{height:"100%"},children:[(0,i.jsx)(eC.A,{sx:{width:"160px",minHeight:"72px"},children:(0,i.jsx)(ng.A,{tiles:s,palette:a,imageStartLine:0})}),(0,i.jsxs)(l.A,{direction:"column",children:[(0,i.jsx)(A.A,{variant:"body1",children:r.name}),(0,i.jsx)(A.A,{variant:"caption",children:c("usage",{usage:F})})]})]})})},nC=function(e){var t=e.paletteActive,n=e.togglePalette,r=e.palette,F=(0,V.c3)("FilterFormPalette"),a=(0,eL.A)();return(0,i.jsx)("button",{title:F(t?"removePalette":"selectPalette",{name:r.name}),onClick:function(){return n(t?nx.REMOVE:nx.ADD)},style:{background:t?a.palette.tertiary.main:"transparent"},children:(0,i.jsx)(tl,{palette:r.palette})})},nI=function(e){var t=e.children;return e.hidden?null:(0,i.jsx)(l.A,{direction:"column",gap:4,role:"tabpanel",sx:{pt:4},children:t})},nE=function(e){var t=e.tagActive,n=e.toggleTag,r=e.title,F=(0,V.c3)("FilterFormTag");return(0,i.jsx)(th.A,{label:r,title:F(t?"removeTag":"selectTag",{title:r}),size:"small",onClick:function(){return n(t?nx.REMOVE:nx.ADD)},color:t?"tertiary":"default"})};var nw=function(e){return e.TAGS="tabTags",e.PALETTES="tabPalettes",e.FRAMES="tabFrames",e}(nw||{}),nT=(0,nv.A)("count",nv.U.ASC);let nS=function(){var e=(0,V.c3)("FilterForm"),t=(0,V.c3)("FilterForm.filterTabs"),n=(0,m._)((0,d.useState)(null),2),r=n[0],F=n[1],a=nb(),o=a.availableTags,s=a.activeTags,u=a.updateActiveTags,c=a.availablePalettes,f=a.activePalettes,p=a.updateActivePalettes,h=a.availableFrames,g=a.activeFrames,v=a.updateActiveFrames,b=a.visible,j=a.applyClearTags,y=a.clearTags,_=a.clearPalettes,C=a.clearFrames,I=a.confirm,E=a.cancel;(0,d.useEffect)(function(){r||F(nT([{tab:"tabFrames",count:g.length},{tab:"tabPalettes",count:f.length},{tab:"tabTags",count:s.length}])[2].tab)},[g.length,f.length,s.length,r]);var w=(0,eX.h)().palettes,T=(0,Q.A)().activePalette,S=(0,d.useMemo)(function(){return w.find(function(e){return e.shortName===T})||w[0]},[T,w]),P=(0,d.useCallback)(function(){switch(r){case"tabTags":y();break;case"tabPalettes":_();break;case"tabFrames":C()}},[C,_,y,r]);if(!b||!r)return null;var k=!!(s.length+f.length+g.length);return(0,i.jsxs)(eA.A,{confirm:I,deny:E,header:e("dialogHeader"),contentWidth:"auto",contentHeight:"75vh",actionButtons:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.A,{disabled:!k,title:e("clearFiltersTitle"),color:"secondary",variant:"outlined",onClick:y,children:e("clear")}),(0,i.jsx)(D.A,{disabled:!k,title:e("clearFiltersAndApplyTitle"),color:"secondary",variant:"outlined",onClick:j,children:e("clearAndApply")})]}),children:[(0,i.jsxs)(l.A,{direction:"row",justifyContent:"space-between",children:[(0,i.jsxs)(nh.A,{value:r,onChange:function(e,t){return F(t)},children:[(0,i.jsx)(ez.A,{label:t("tabTags",{count:s.length}),value:"tabTags"}),(0,i.jsx)(ez.A,{label:t("tabPalettes",{count:f.length}),value:"tabPalettes"}),(0,i.jsx)(ez.A,{label:t("tabFrames",{count:g.length}),value:"tabFrames"})]}),(0,i.jsx)(eC.A,{children:(0,i.jsx)(x.A,{onClick:P,title:e("clearTab",{tab:r}),children:(0,i.jsx)(np.A,{})})})]}),(0,i.jsx)(nI,{hidden:"tabTags"!==r,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{component:"span",variant:"body2",children:e("allMustBeMet")}),(0,i.jsxs)(l.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:[(0,i.jsx)(nE,{title:e("untagged"),tagActive:s.includes(tg.X3.FILTER_UNTAGGED),toggleTag:function(e){return u(tg.X3.FILTER_UNTAGGED,e)}}),(0,i.jsx)(nE,{title:e("favourite"),tagActive:s.includes(tg.X3.FILTER_FAVOURITE),toggleTag:function(e){return u(tg.X3.FILTER_FAVOURITE,e)}}),(0,i.jsx)(nE,{title:e("new"),tagActive:s.includes(tg.X3.FILTER_NEW),toggleTag:function(e){return u(tg.X3.FILTER_NEW,e)}}),(0,i.jsx)(nE,{title:e("monochrome"),tagActive:s.includes(tg.X3.FILTER_MONOCHROME),toggleTag:function(e){return u(tg.X3.FILTER_MONOCHROME,e)}}),(0,i.jsx)(nE,{title:e("rgb"),tagActive:s.includes(tg.X3.FILTER_RGB),toggleTag:function(e){return u(tg.X3.FILTER_RGB,e)}}),(0,i.jsx)(nE,{title:e("recentImports"),tagActive:s.includes(tg.X3.FILTER_RECENT),toggleTag:function(e){return u(tg.X3.FILTER_RECENT,e)}}),(0,i.jsx)(nE,{title:e("imageHasComments"),tagActive:s.includes(tg.X3.FILTER_COMMENTS),toggleTag:function(e){return u(tg.X3.FILTER_COMMENTS,e)}}),(0,i.jsx)(nE,{title:e("imageHasUsername"),tagActive:s.includes(tg.X3.FILTER_USERNAME),toggleTag:function(e){return u(tg.X3.FILTER_USERNAME,e)}})]})]}),(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,i.jsx)(l.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"}},children:o.map(function(e){return(0,i.jsx)(nE,{title:e,tagActive:s.includes(e),toggleTag:function(t){return u(e,t)}},e)})})]})]})}),(0,i.jsx)(nI,{hidden:"tabPalettes"!==r,children:(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,i.jsx)(l.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",sx:{".MuiChip-root":{my:"1px"},button:{padding:0,cursor:"pointer",width:"2.5rem",height:"2.5rem",border:"none",borderRadius:"50%"}},children:c.map(function(e){return(0,i.jsx)(nC,{palette:e,paletteActive:f.includes(e.shortName),togglePalette:function(t){return p(e.shortName,t)}},e.shortName)})})]})}),(0,i.jsx)(nI,{hidden:"tabFrames"!==r,children:(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{component:"span",variant:"body2",children:e("oneMustBeMet")}),(0,i.jsx)(l.A,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"stretch",justifyContent:"center",sx:{".MuiButton-root":{width:"180px"}},children:h.map(function(e){var t=e.frame,n=e.usage;return(0,i.jsx)(n_,{usage:n,frame:t,palette:S.palette,frameActive:g.includes(t.id),toggleFrame:function(e){return v(t.id,e)}},t.id)})})]})})]})};var nP=["FFFF8080BFBFA0A0A0A0A0A0A0A0A0A0","FFFF0000FFFF00000000010103030707","FFFF0000FFFF7F7FFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFEFEFFFFFFFFFFFFFFFF","FFFF0000FFFF000000008080C0C0E0E0","FFFF0101FDFD05050505050505050505","A0A0A0A0A0A0A0A0A0A0A1A1A3A3A7A7","070703030101000000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","E0E0C0C0808000000000010103030707","050505050505050505058585C5C5E5E5","AFAFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000001018383C7C7EFEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","E0E0C0C0808000008080C1C1E3E3F7F7","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","F5F5FDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFF0F0F0F0F0F0F0F0","FFFFFFFFFFFFFFFF3F3F3F3F3F3F3F3F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","42214000000040206020602060206020","85C3800101000140C140C140C140C140","FCF0D0E0E0C080C181C1C181C181FEFC","1F0F0307070382038003800380030003","C4828000000004020602060206020602","0F070F070F060E060C060C060C060C06","A1C08000000008040804080400000000","FF7F5F3F3F1F0F1F1F0F1F0F1F0F1F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","60206020602060206020602060206020","C140C140C140C140C140C140C140C140","E8F0E0C081C080C1C181C18180C180C0","00030003800380038003810381030103","0602060206020602060000008000C482","0C060C060C060C060C060C060E060F06","00000F070C040C040C040C0408040000","1F0FFFFF1F0F1F0F1F0F1F0F0F1F3F1F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0FFFFFFFFFFFFFFFFFFFFFFFF","30303030FFFFFFFFFFFFFFFFFFFFFFFF","60206020FFFFFFFFFFFFFFFFFFFFFFFF","C140C140FFFFFFFFFFFFFFFFFFFFFFFF","C0C0D1E0FFFFFFFFFFFFFFFFFFFFFFFF","01030083FFFFFFFFFFFFFFFFFFFFFFFF","FEFE040200008000A0C0FFFFFFFFFFFF","0F070F07070F0F1F5F3FFFFFFFFFFFFF","8000A0C0FFFFFFFFFFFFFFFFFFFFFFFF","1F3FFF7FFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFAFAF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","EFEFC7C7838301010000010103030707","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F7F7E3E3C1C1808000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FDFDFDFDFDFDFDFDFDFDFDFDFDFDF5F5","A7A7A3A3A1A1A0A0A0A0A0A0A0A0A0A0","E0E0C0C0808000000000010103030707","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000000008080C0C0E0E0","E5E5C5C5858505050505050505050505","A0A0A0A0A0A0A0A0A0A0BFBF8080FFFF","07070303010100000000FFFF0000FFFF","FFFFFFFFFFFFFFFF7F7FFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFEFEFFFF0000FFFF","E0E0C0C0808000000000FFFF0000FFFF","05050505050505050505FDFD0101FFFF"];let nk=function(e){var t,n=e.tiles,r=e.startLine,F=e.setStartLine,a=(0,V.c3)("EditFrameStartLine"),o=(0,Q.A)().activePalette,s=null==(t=(0,eX.h)().palettes.find(function(e){return e.shortName===o}))?void 0:t.palette,u=(0,d.useMemo)(function(){var e=[];e.push.apply(e,(0,$._)(n.slice(0,20*r)));for(var t=0;t<14;t+=1){var F=(t+r)*20,a=F+18,i=16*t;e.push.apply(e,(0,$._)(n.slice(F,F+2)).concat((0,$._)(nP.slice(i,i+16)),(0,$._)(n.slice(a,a+2))))}return e.push.apply(e,(0,$._)(n.slice((r+14)*20))),e},[n,r]);return(0,i.jsxs)(l.A,{direction:"row",gap:3,justifyContent:"center",children:[(0,i.jsx)(ng.A,{tiles:u,palette:s,imageStartLine:r}),(0,i.jsx)(l.A,{direction:"column",justifyContent:"center",children:(0,i.jsxs)(B.A,{orientation:"vertical",variant:"contained",size:"large",color:"tertiary",fullWidth:!0,children:[(0,i.jsx)(D.A,{onClick:function(){return F(r-1)},disabled:r<=0,endIcon:(0,i.jsx)(t8.A,{}),children:a("moveUp")}),(0,i.jsx)(D.A,{onClick:function(){return F(r+1)},disabled:r>=n.length/20-14,endIcon:(0,i.jsx)(t4.A,{}),children:a("moveDown")})]})})]})},nD=function(){var e=(0,V.c3)("FrameQueue"),t=(0,eD.A)().dismissDialog,n=(0,ej.A)(),r=n.frameQueue,F=n.frameQueueCancelOne,a=n.importQueueCancelOne,o=(0,tk.g)().updateLastSyncLocalNow,s=(0,eX.h)(),l=s.addFrames,u=s.updateFrameGroups,c=r[0],f=(0,m._)((0,d.useState)(""),2),p=f[0],h=f[1],g=(0,m._)((0,d.useState)(Math.floor((c.tiles.length-280)/40)),2),v=g[0],x=g[1],A=tW({id:"",hash:"",name:c.fileName}),b=A.fullId,j=A.formValid,y=A.groups,_=A.frameGroup,C=A.frameIndex,I=A.setFrameIndex,E=A.frameName,w=A.setFrameGroup,T=A.setFrameName,S=A.idValid,P=A.groupIdValid,k=A.frameIndexValid;return(0,i.jsx)(eA.A,{header:e("dialogHeader",{id:b}),canConfirm:j,confirm:(0,e3._)(function(){var e;return(0,e5.YH)(this,function(n){switch(n.label){case 0:return[4,(0,nj.R_)(c.tiles,v)];case 1:return e=n.sent(),t(0),c.tempId&&(a(c.tempId),F(c.tempId)),l([{id:b,name:E,hash:e}]),(null==p?void 0:p.trim())&&u([{id:_,name:p}]),o(),[2]}})}),deny:function(){return F(c.tempId)},children:(0,i.jsx)(tY,{frameIndex:C,setFrameGroup:w,frameName:E,frameGroup:_,setFrameName:T,groupIdValid:P,idValid:S,frameIndexValid:k,setFrameIndex:I,groups:y,fullId:b,frameGroupName:p,setFrameGroupName:h,extraFields:(0,i.jsx)(nk,{tiles:c.tiles,startLine:v,setStartLine:x})})})};var nB=n(99475),nM=n(58617),nN=n.n(nM),nR="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF";let nL=function(e){for(;e.length%20;)e.push(nR);for(var t=Array(20).fill(nR);e.length<360;)e.push.apply(e,(0,$._)(t)),e.length<360&&e.unshift.apply(e,(0,$._)(t));return e};var nG=n(72623),nO=function(){var e=(0,e3._)(function(e){var t,n,r,F,a,i,o,s,l;return(0,e5.YH)(this,function(u){switch(u.label){case 0:return t=e.lines,n=e.filename,r=e.palette,F=e.frame,i=void 0===(a=e.tags)?[]:a,o=e.meta,l=void 0===(s=e.created)?(0,tF.J)():s,[4,(0,nG.UN)(t)];case 1:return[2,{hash:u.sent(),created:l,title:n||"",lines:t.length,tags:i,palette:r,framePalette:r,invertFramePalette:!1,invertPalette:!1,frame:F,meta:o}]}})});return function(t){return e.apply(this,arguments)}}(),nH=(0,nv.A)("fileName");let nU=function(){var e=(0,Q.A)(),t=e.importPad,n=e.setActivePalette,r=e.activePalette,i=(0,tD.A)().cancelEditImageGroup,o=(0,eX.h)(),s=o.addImageGroup,l=o.palettes,u=o.images,c=(0,tB.A)().setImageSelection,f=(0,ej.A)(),p=f.importQueue,h=f.importQueueSet,g=f.frameQueueAdd,v=f.importQueueCancelOne,x=(0,tk.g)(),A=x.addImages,b=x.importQueueCancel,j=(0,Y.Z)().view,y=(0,ns.g)().navigateToGroup,_=(0,V.c3)("useRunImport"),C=(0,m._)((0,d.useState)(""),2),I=C[0],E=C[1],w=(0,m._)((0,d.useState)(p.length>3),2),T=w[0],S=w[1],P=(0,m._)((0,d.useState)({initial:[],add:[],remove:[]}),2),k=P[0],D=P[1],B=(0,d.useCallback)(function(e){g(ej.A.getState().importQueue.filter(function(t){return t.tempId===e}))},[g]),M=(0,d.useCallback)(function(e){v(e)},[v]),N=(0,nl.N)().formatter,R=(0,d.useCallback)(function(){D(function(e){return{initial:e.initial,add:[],remove:[]}})},[]),L=(0,d.useCallback)((0,e3._)(function(){var e,n,F,a,o,l,u,d;return(0,e5.YH)(this,function(f){switch(f.label){case 0:return e=ej.A.getState().importQueue,n=new(nN())(1,1/0),F=Date.now(),[4,Promise.all(nH(e).map(function(e,a){var i=e.tiles,o=e.fileName,s=e.meta,l=e.lastModified,u=k.add,c=l||F;return n.add(function(){return nO({lines:t?nL(i):i,filename:o,palette:r,frame:I,tags:u,created:(0,tF.J)(c+a),meta:s})})}))];case 1:return o=(a=f.sent()).map(function(e){return e.hash}),A(a),T&&(l=_("importGroupTitle",{date:N(new Date)}),u=(0,tK.BF)(l),i(),s({id:d=(0,nc.z)(),slug:u,title:l,created:(0,tF.J)(),coverImage:a[0].hash,images:o,groups:[]},j.id),y(d,0)),c(o),[2]}})}),[_,r,s,A,i,T,N,I,t,y,c,k,j.id]),G=(0,d.useMemo)(function(){return l.find(function(e){return e.shortName===r})||tS.Fv},[r,l]),O=(0,d.useMemo)(function(){return new Map(u.map(function(e){return[e.hash,e]}))},[u]),H=(0,d.useMemo)(function(){var e=new Set;return p.map(function(t){var n=O.get(t.imageHash)||null,r=e.has(t.imageHash);return e.add(t.imageHash),(0,a._)((0,F._)({},t),{isDuplicateInQueue:r,alreadyImported:n})})},[p,O]),U=(0,d.useMemo)(function(){return p.filter(function(e){return -1!==e.fileName.indexOf("[last seen]")}).length},[p]),z=(0,d.useMemo)(function(){return p.filter(function(e){return -1!==e.fileName.indexOf("[deleted]")}).length},[p]),W=(0,d.useMemo)(function(){return H.filter(function(e){return e.isDuplicateInQueue}).length},[H]),X=(0,d.useMemo)(function(){return H.filter(function(e){return e.alreadyImported}).length},[H]),K=(0,d.useCallback)(function(){h(p.filter(function(e){return -1===e.fileName.indexOf("[last seen]")}))},[h,p]),Z=(0,d.useCallback)(function(){h(p.filter(function(e){return -1===e.fileName.indexOf("[deleted]")}))},[h,p]),q=(0,d.useCallback)(function(){var e=new Set;h(p.filter(function(t){var n=e.has(t.imageHash);return e.add(t.imageHash),!n}))},[h,p]);return{importQueue:H,importPad:t,palette:G,activePalette:r,frame:I,tagChanges:k,createGroup:T,updateTagChanges:D,resetTagChanges:R,setFrame:E,setCreateGroup:S,runImport:L,cancelImport:b,importAsFrame:B,cancelItemImport:M,setActivePalette:n,lastSeenCount:U,importedDuplicatesCount:X,queueDuplicatesCount:W,deletedCount:z,removeLastSeen:K,removeDeleted:Z,removeImportedDuplicates:(0,d.useCallback)(function(){h(p.filter(function(e){return!O.has(e.imageHash)}))},[h,p,O]),removeQueueDuplicates:q}};var nz=n(52466);let nV=(0,d.memo)(function(e){var t=e.importItem,n=e.palette,r=e.importAsFrame,o=e.cancelItemImport,s=e.windowStyle,u=(0,V.c3)("ImportRow"),c=t.tiles,f=t.fileName,m=t.lastModified,p=t.alreadyImported,h=t.isDuplicateInQueue,g=(0,d.useMemo)(function(){return h?{color:"error",title:u("duplicateInQueue"),badgeContent:"D"}:p?{color:"warning",title:u("alreadyImported",{title:p.title||"NO_TITLE"}),badgeContent:"I"}:{}},[p,h,u]),v=(0,nl.N)().formatter;return(0,i.jsxs)(l.A,{direction:"row",gap:1,alignItems:"stretch",justifyContent:"left",sx:s,children:[(0,i.jsx)(eC.A,{sx:{flex:"160px 0 0"},children:(0,i.jsx)(ng.A,{tiles:c,invertPalette:!1,lockFrame:!1,palette:null==n?void 0:n.palette,imageStartLine:2,asThumb:!0})}),(0,i.jsxs)(l.A,{sx:{flex:"auto 1 1",my:1},direction:"column",gap:2,justifyContent:"space-between",alignContent:"space-between",children:[(0,i.jsxs)(B.A,{fullWidth:!0,sx:{justifyContent:"flex-end",display:"flex"},children:[(0,i.jsx)(x.A,{title:u("importAsFrame"),disabled:c.length/20<14,onClick:r,children:(0,i.jsx)(nz.A,{})}),(0,i.jsx)(k.A,(0,a._)((0,F._)({},g),{anchorOrigin:{vertical:"bottom",horizontal:"left"},overlap:"circular",children:(0,i.jsx)(x.A,{title:u("removeFromQueue"),onClick:function(){return setTimeout(o,1)},children:(0,i.jsx)(C.A,{})})}))]}),(0,i.jsxs)(l.A,{sx:{pr:1},gap:1,direction:"column",children:[(0,i.jsx)(A.A,{variant:"caption",component:"p",sx:{wordBreak:"break-word"},children:f}),m&&m>0&&(0,i.jsx)(A.A,{variant:"caption",component:"p",children:v(m)})]})]})]})}),nW=function(){var e=(0,V.c3)("ImportQueue"),t=nU(),n=t.frame,r=t.palette,a=t.activePalette,o=t.importQueue,s=t.tagChanges,u=t.createGroup,c=t.setFrame,d=t.setActivePalette,f=t.setCreateGroup,m=t.updateTagChanges,p=t.resetTagChanges,h=t.runImport,g=t.cancelImport,v=t.importAsFrame,x=t.cancelItemImport,A=t.lastSeenCount,b=t.importedDuplicatesCount,j=t.queueDuplicatesCount,y=t.deletedCount,_=t.removeLastSeen,C=t.removeDeleted,I=t.removeImportedDuplicates,E=t.removeQueueDuplicates,w=(0,tG.h)().height;return(0,i.jsx)(eA.A,{header:e("dialogHeader",{count:o.length}),confirm:h,deny:g,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(nB.Y1,{height:Math.min(152*o.length,w/2),itemCount:o.length,itemSize:152,overscanCount:5,width:"100%",children:function(e){var t=e.index,n=e.style;return(0,i.jsx)(nV,{windowStyle:n,palette:r,importItem:o[t],importAsFrame:function(){return v(o[t].tempId)},cancelItemImport:function(){return x(o[t].tempId)}})}}),(0,i.jsxs)(B.A,{variant:"contained",color:"secondary",fullWidth:!0,children:[(0,i.jsx)(D.A,{disabled:!A,onClick:_,title:e("removeLastSeenTitle"),children:e("removeLastSeen",{count:A||0})}),(0,i.jsx)(D.A,{disabled:!y,onClick:C,title:e("removeDeletedTitle"),children:e("removeDeleted",{count:y||0})}),(0,i.jsx)(D.A,{disabled:!j,onClick:E,title:e("removeDuplicatesInQueueTitle"),children:e("removeDuplicatesInQueue",{count:j||0})}),(0,i.jsx)(D.A,{disabled:!b,onClick:I,title:e("removeAlreadyImportedTitle"),children:e("removeAlreadyImported",{count:b||0})})]}),(0,i.jsx)(tc,{noFancy:!0,value:a,onChange:d}),(0,i.jsx)(eK,{selectLabel:e("modifyFrame"),frame:n,lockFrame:!1,noFrameOption:e("noFrameOption"),updateFrame:c}),(0,i.jsx)(tC,{tags:s,resetTags:p,updateTags:function(e,t){m((0,F._)({},s,tx(s,{mode:e,tag:t})))}}),(0,i.jsx)(ed.A,{label:e("createGroupLabel"),control:(0,i.jsx)(em.A,{checked:u,onChange:function(e){f(e.target.checked)}})})]})})};var nY=n(66027),nX=n(27371),nQ=n(9779),nK=n(18335),nZ=n(86964),nq=function(e,t){var n,r=[];if(!(null==e?void 0:e.hash))return null;var F=(0,nK.s)(t,e),a=F.palette,i=F.framePalette;if(!a)throw Error("Palette missing?");var o=(0,nZ.f)(e),s=o.invertPalette,l=o.invertFramePalette;return(0,tN.pl)(e)?n=a:(n=(a||tS.Fv).palette,r=(i||tS.Fv).palette),{title:(null==e?void 0:e.title)||"",created:(null==e?void 0:e.created)||"",frame:e.frame,hash:e.hash,hashes:e.hashes||void 0,tags:e.tags,palette:n,framePalette:r,lockFrame:e.lockFrame,invertPalette:s,invertFramePalette:l,rotation:e.rotation}},nJ=function(){var e=(0,tB.A)(),t=(0,Y.Z)(),n=t.view,r=t.covers,F=(0,f.A)(),a=F.isFullscreen,i=F.setLightboxImage,o=F.setLightboxImagePrev,s=F.setLightboxImageNext,l=F.setIsFullscreen,u=F.lightboxImage,c=(0,eX.h)().palettes,m=(0,t0.S)(n,e),p=(0,d.useMemo)(function(){return m.filter(function(e){var t=e.hash;return!r.includes(t)})},[r,m]),h=null!==u?nq(p[u],c):null;return(0,d.useEffect)(function(){var e=function(){l(!!nQ.A.element)},t=function(e){switch(e.key){case"Esc":case"Escape":close(),e.preventDefault();break;case"Right":case"ArrowRight":case"d":s(p.length),e.preventDefault();break;case"Left":case"ArrowLeft":case"a":o(),e.preventDefault();break;case"Home":i(0),e.preventDefault();break;case"End":i(p.length-1),e.preventDefault()}};return document.addEventListener("keydown",t),nQ.A.isEnabled&&nQ.A.on("change",e),function(){document.removeEventListener("keydown",t),nQ.A.off("change",e)}}),{image:h,isFullscreen:a,currentIndex:u||0,size:p.length,canPrev:null!==u&&u>0,canNext:null!==u&&u<p.length-1,close:function(){return i(null)},prev:function(){return o()},next:function(){return s(p.length)},fullscreen:function(){nQ.A.isEnabled&&(nQ.A.element?nQ.A.exit():nQ.A.request(document.body))}}};let n$=function(){var e=(0,V.c3)("LightboxImage"),t=nJ(),n=t.image,r=t.isFullscreen,F=t.currentIndex,a=t.size,o=t.canPrev,s=t.canNext,u=t.prev,c=t.next,d=t.fullscreen,f=t.close,m=(0,nl.N)().formatter;return(0,i.jsx)(eA.A,{header:null==n?void 0:n.title,deny:f,contentWidth:"100%",contentHeight:"100%",fullSize:!0,headerActionButtons:(0,i.jsx)(x.A,{color:"inherit",onClick:d,title:e(r?"leaveFullscreen":"enterFullscreen"),children:r?(0,i.jsx)(nX.A,{}):(0,i.jsx)(nY.A,{})}),children:(0,i.jsxs)(l.A,{direction:"column",gap:2,sx:{width:"100%",height:"100%"},children:[(0,i.jsxs)(l.A,{direction:"row",gap:1,alignItems:"center",justifyContent:"center",sx:{height:"100%",overflow:"hidden",position:"relative","& > .MuiBox-root":{flexGrow:1}},children:[(0,i.jsx)(x.A,{size:"large",onClick:u,disabled:!o,children:(0,i.jsx)(t6.A,{})}),n&&(0,i.jsx)(eC.A,{sx:{width:"100%",height:"100%",flexBasis:"100%",flexGrow:1},children:(0,i.jsx)(tT.A,{lockFrame:n.lockFrame,invertPalette:n.invertPalette,invertFramePalette:n.invertFramePalette,palette:n.palette,framePalette:n.framePalette,frameId:n.frame,hash:n.hash,hashes:n.hashes,rotation:n.rotation})}),(0,i.jsx)(x.A,{size:"large",onClick:c,disabled:!s,children:(0,i.jsx)(t7.A,{})})]}),(0,i.jsxs)(l.A,{direction:"row",gap:{xs:4,md:12},alignItems:"center",justifyContent:"center",children:[(0,i.jsx)(A.A,{variant:"body2",children:e("imageCounter",{current:F+1,total:a})}),(null==n?void 0:n.created)&&(0,i.jsx)(A.A,{variant:"body2",children:m(n.created)})]})]})})};var n0=n(74802),n1=n(13338),n2=n(62412);let n3=function(){var e=(0,V.c3)("PickColors"),t=(0,tD.A)(),n=t.pickColors,r=t.setEditPalette,F=t.cancelEditPalette,a=t.cancelPickColors,o=(0,m._)((0,d.useState)([0,3,6,9]),2),s=o[0],u=o[1],c=t2(),f=(0,d.useMemo)(function(){return n?[,,,,].fill(null).map(function(e,t){var r=s[t],F=n.colors[r];return F?(0,n2.E)(F):"#000000"}):[]},[n,s]),p=(0,d.useCallback)(function(){a(),F()},[F,a]);return((0,d.useEffect)(function(){var e=((null==n?void 0:n.colors.length)||1)-1;if(e<3)return void p();u([0,Math.round(.33*e),Math.round(.66*e),e])},[p,n]),n)?(0,i.jsx)(eA.A,{confirm:function(){r({name:e("newPaletteNameFromFile",{fileName:n.fileName}),shortName:tg.mI,palette:f,origin:"generated from file",isPredefined:!1})},canConfirm:4===s.length,deny:p,header:e("dialogHeader",{fileName:n.fileName}),contentWidth:"auto",children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(l.A,{direction:"row",gap:2,component:"ul",justifyContent:"space-around",children:c.map(function(e){return(0,i.jsx)(eC.A,{component:"li",children:(0,i.jsx)(tT.A,{hash:e.hash,invertPalette:!1,invertFramePalette:!1,lockFrame:!1,palette:f,framePalette:f})},e.hash)})}),(0,i.jsx)(e8.A,{value:s,onChange:function(e,t){return u((0,$._)(t).sort())},sx:{display:"flex",justifyContent:"space-around",gap:0},children:n.colors.map(function(e,t){return(0,i.jsx)(e7.A,{value:t,sx:{"--palette-color":"rgb(".concat(e.join(","),")"),color:"var(--palette-color)",borderRadius:0,width:48,height:48,padding:0,border:"none","&&.Mui-selected":{border:"none",background:"none",color:"var(--palette-color)"},"& > svg":{width:"inherit",height:"inherit"}},children:s.includes(t)?(0,i.jsx)(n0.A,{}):(0,i.jsx)(n1.A,{})},t)})}),(0,i.jsx)(l.A,{direction:"row",gap:0,sx:{"& > .MuiBox-root":{height:"32px",flexGrow:1}},children:f.map(function(e,t){return(0,i.jsx)(eC.A,{title:e,sx:{backgroundColor:e}},t)})})]})}):null};var n5=n(77262),n4=n(41476);let n6=function(){var e=(0,V.c3)("ProgressBox"),t=(0,n4.A)().progress;return(0,i.jsx)(eA.A,{header:e("dialogHeader"),children:(0,i.jsx)(l.A,{direction:"column",gap:2,children:t.map(function(e){return(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(A.A,{children:e.label}),(0,i.jsx)(n5.A,{variant:"determinate",value:100*e.value,color:"secondary"})]},e.id)})})})};var n7=n(68893),n8=n(8963),n9=n.n(n8),re=function(){var e=(0,n4.A)(),t=e.progressLog,n=e.resetProgressLog,r=(0,K.A)(),F=r.gitStorage,a=r.dropboxStorage;return{git:{messages:t.git||[],repoUrl:"https://github.com/".concat(F.owner,"/").concat(F.repo,"/tree/").concat(F.branch),repo:F.repo,branch:F.branch},dropbox:{messages:t.dropbox||[],path:a.path||""},confirm:n}};tr().extend(n9());let rt=function(){var e=re(),t=e.git,n=t.messages,r=t.repoUrl,F=t.repo,a=t.branch,o=e.dropbox,s=o.messages,u=o.path,c=e.confirm,f=(0,V.c3)("ProgressLogBox"),p=(0,m._)((0,d.useState)(!0),2),h=p[0],g=p[1],v=n.length>0,x=s.length>0,b=(n[n.length-1]||{}).timestamp,j=n[0]||{},y=j.timestamp,_=j.message,C=(s[s.length-1]||{}).timestamp,I=s[0]||{},E=I.timestamp,w=I.message,T="."===_||"."===w,S=v?b:C,P=v?y:E,k=(0,d.useMemo)(function(){return(0,$._)(n).concat((0,$._)(s)).filter(function(e){return"."!==e.message})},[s,n]),B=(0,d.useMemo)(function(){return k.filter(function(e,t){return!h||t<15})},[h,k]);return n.length||s.length?(0,i.jsx)(eA.A,{header:f(T?"dialogHeaderDone":"dialogHeaderUpdating",{repo:v?"".concat(F,"/").concat(a):"NO_REPO"}),confirm:T?c:void 0,children:(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsx)(eC.A,{component:"ul",sx:{overflowX:"auto",overflowY:"auto",maxHeight:"30vh","& > .MuiTypography-root":{whiteSpace:"nowrap"}},children:B.map(function(e,t){var n=e.message,r=e.timestamp;return(0,i.jsx)(A.A,{variant:"caption",component:"li",title:tr().unix(r).format("HH:mm:ss"),children:n},t)})}),k.length>15&&(0,i.jsx)(D.A,{variant:"outlined",color:"secondary",onClick:function(){return g(!h)},endIcon:h?(0,i.jsx)(t4.A,{}):(0,i.jsx)(t8.A,{}),children:h?f("showAllMessages",{count:k.length}):f("reduceMessages")}),(0,i.jsxs)(l.A,{direction:"column",gap:0,children:[(0,i.jsx)(A.A,{variant:"caption",children:f("startedAt",{time:tr().unix(S).format("HH:mm:ss")})}),(0,i.jsx)(A.A,{variant:"caption",children:f(T?"finishedAfter":"runningFor",{duration:tr().duration(P-S,"seconds").format("HH:mm:ss")})})]}),v&&(0,i.jsx)(D.A,{variant:"outlined",component:"a",color:"secondary",startIcon:(0,i.jsx)(n7.A,{}),title:r,href:r,target:"_blank",rel:"noreferrer",children:f("openGitHubRepository")}),x&&(0,i.jsx)(D.A,{variant:"outlined",component:"a",color:"secondary",title:f("openDropboxFolderTitle",{path:"https://www.dropbox.com/home/Apps/GameBoyPrinter/".concat(u)}),href:"https://www.dropbox.com/home/Apps/GameBoyPrinter/".concat(u),target:"_blank",rel:"noreferrer",children:f("openDropboxFolder")})]})}):null};var rn=n(53081);let rr=function(){var e=(0,V.c3)("Serials"),t=(0,f.A)().setShowSerials;return(0,i.jsx)(eA.A,{header:e("dialogHeader"),deny:function(){return t(!1)},children:(0,i.jsx)(rn.A,{})})};var rF=function(){var e=(0,tB.A)(),t=e.setSortBy,n=e.setSortOptionsVisible,r=e.sortOptionsVisible,F=e.sortBy,a=(0,m._)(F.split("_"),2),i=a[0],o=a[1];return{visible:r,sortBy:void 0===i?"":i,sortOrder:void 0===o?"":o,setSortBy:t,hideSortForm:function(){return n(!1)}}};let ra=function(){var e=(0,V.c3)("SortForm"),t=rF(),n=t.visible,r=t.sortBy,F=t.sortOrder,a=t.setSortBy,o=t.hideSortForm,s=(0,m._)((0,d.useState)(r),2),u=s[0],c=s[1],f=(0,m._)((0,d.useState)(F),2),p=f[0],h=f[1];if((0,d.useEffect)(function(){c(r),h(F)},[c,h,n,r,F]),!n)return null;var g=[{title:e("titleOption"),key:"title"},{title:e("dateOption"),key:"created"},{title:e("paletteOption"),key:"palette"}],v=g.find(function(e){return e.key===u})||g[0],x=e(p===nv.U.ASC?"ascending":"descending");return(0,i.jsx)(eA.A,{header:e("dialogHeader",{sortBy:v.title,order:x}),confirm:function(){return a("".concat(u,"_").concat(p))},deny:o,children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(ep.A,{label:e("sortByLabel"),size:"small",select:!0,value:u,onChange:function(e){return c(e.target.value)},children:g.map(function(e){var t=e.key,n=e.title;return(0,i.jsx)(ef.A,{value:t,children:n},t)})}),(0,i.jsxs)(ep.A,{label:e("sortDirectionLabel"),size:"small",select:!0,value:p,onChange:function(e){return h(e.target.value)},children:[(0,i.jsx)(ef.A,{value:nv.U.ASC,children:e("ascending")}),(0,i.jsx)(ef.A,{value:nv.U.DESC,children:e("descending")})]})]})})};var ri=n(39487),ro=n(56277),rs=n(83936),rl=n(933),ru=function(e){var t,F,a,i,o,s,l,u,c,d=(t=(0,e3._)(function(){var t,F,a;return(0,e5.YH)(this,function(i){switch(i.label){case 0:if(r)return[3,2];return[4,Promise.all([n.e(9268),n.e(7431),n.e(1575)]).then(n.bind(n,10630))];case 1:F=(t=i.sent()).init,a=t.gitSyncTool,F(),r=r||a(e),i.label=2;case 2:return[2,r]}})}),function(){return t.apply(this,arguments)});return a=(F=K.A.getState().gitStorage).use,i=F.owner,o=F.repo,s=F.branch,l=F.token,a&&i&&o&&s&&l&&d(),{startSyncData:(u=(0,e3._)(function(e){return(0,e5.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().startSyncData(e)]}})}),function(e){return u.apply(this,arguments)}),updateSettings:(c=(0,e3._)(function(e){return(0,e5.YH)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return[2,t.sent().updateSettings(e)]}})}),function(e){return c.apply(this,arguments)})}},rc=function(){var e=(0,tk.g)(),t=(0,rs.W)().remoteImport,n=(0,f.A)().setSyncSelect,r=(0,K.A)(),F=r.gitStorage,a=r.dropboxStorage,i=r.syncLastUpdate;return{repoUrl:"https://github.com/".concat(F.owner,"/").concat(F.repo,"/tree/").concat(F.branch),dropboxActive:!!(a.use&&a.accessToken),gitActive:!!(F.use&&F.owner&&F.repo&&F.branch&&F.throttle&&F.token),autoDropboxSync:a.autoDropboxSync||!1,syncLastUpdate:i,startSync:function(n,r){switch(n){case ro.e.DROPBOX:(0,rl.E)(e,t).startSyncData(r);break;case ro.e.DROPBOXIMAGES:(0,rl.E)(e,t).startSyncImages();break;case ro.e.GIT:ru(t).startSyncData(r)}},cancelSync:function(){return n(!1)}}},rd=function(e,t){return e&&t?"error":"secondary"};let rf=function(){var e=(0,V.c3)("SyncSelect"),t=rc(),n=t.repoUrl,r=t.dropboxActive,F=t.gitActive,a=t.syncLastUpdate,o=t.autoDropboxSync,s=t.startSync,u=t.cancelSync,c=o&&a.local!==a.dropbox;return(0,i.jsx)(eA.A,{deny:u,header:e("dialogHeader"),children:(0,i.jsxs)(l.A,{direction:"column",gap:4,sx:{"& .MuiButton-endIcon svg":{fontSize:32}},children:[F&&(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsx)(D.A,{variant:"contained",color:"secondary",startIcon:(0,i.jsx)(n7.A,{}),endIcon:(0,i.jsx)(eN.A,{}),title:e("syncToGitHubTitle",{repoUrl:n}),onClick:function(){s(ro.e.GIT,ro.p.UP)},children:e("syncToGitHub")}),(0,i.jsx)(D.A,{variant:"contained",color:"secondary",startIcon:(0,i.jsx)(n7.A,{}),endIcon:(0,i.jsx)(ri.A,{}),title:e("syncFromGitHubTitle",{repoUrl:n}),onClick:function(){s(ro.e.GIT,ro.p.DOWN)},children:e("syncFromGitHub")})]}),r&&(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(D.A,{variant:"contained",color:rd(c,a.local<a.dropbox),endIcon:(0,i.jsx)(eN.A,{}),title:e("syncToDropbox"),onClick:function(){s(ro.e.DROPBOX,ro.p.UP)},children:e("syncToDropbox")}),c&&a.local<a.dropbox&&(0,i.jsx)(A.A,{variant:"caption",children:e("pendingRemoteChangesWarning")})]}),(0,i.jsxs)(l.A,{direction:"column",gap:1,children:[(0,i.jsx)(D.A,{variant:"contained",color:rd(c,a.local>a.dropbox),endIcon:(0,i.jsx)(ri.A,{}),title:e("syncFromDropbox"),onClick:function(){s(ro.e.DROPBOX,ro.p.DOWN)},children:e("syncFromDropbox")}),c&&a.local>a.dropbox&&(0,i.jsx)(A.A,{variant:"caption",children:e("pendingLocalChangesWarning")})]}),(0,i.jsx)(D.A,{variant:"contained",color:"secondary",endIcon:(0,i.jsx)(eN.A,{}),title:e("syncImagesToDropbox"),onClick:function(){s(ro.e.DROPBOXIMAGES,ro.p.UP)},children:e("syncImagesToDropbox")})]})]})})};var rm=n(47457);let rp=function(){var e=(0,V.c3)("Trashbin"),t=(0,rm.A)(),n=t.showTrashCount,r=t.purgeTrash,F=t.downloadImages,a=t.downloadFrames,o=t.trashCount,s=o.frames+o.images;return(0,i.jsx)(eA.A,{deny:function(){n(!1)},header:e("dialogHeader",{count:s}),contentWidth:"auto",actionButtons:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.A,{variant:"contained",color:"secondary",title:e("downloadFrames",{count:0}),disabled:0===o.frames,onClick:a,children:e("downloadFrames",{count:o.frames})}),(0,i.jsx)(D.A,{variant:"contained",color:"secondary",title:e("downloadImages",{count:0}),disabled:0===o.images,onClick:F,children:e("downloadImages",{count:o.images})}),(0,i.jsx)(D.A,{variant:"contained",color:"error",title:e("purgeAll",{count:0}),disabled:0===s,onClick:r,children:e("purgeAll",{count:s})})]}),children:(0,i.jsxs)(l.A,{direction:"column",gap:2,children:[(0,i.jsx)(A.A,{variant:"body2",children:e("deletedFrames",{count:o.frames})}),(0,i.jsx)(A.A,{variant:"body2",children:e("deletedImages",{count:o.images})})]})})};var rh=n(81543),rg=n(3899),rv=n.n(rg),rx=n(91540),rA=n(89222),rb=n(74335),rj=n(28952),ry=n(77683),r_=function(e){var t=e.gifWriter,n=e.queue,r=e.frameRate,F=e.total,a=e.setProgress;return function(e,i){return n.add(function(){return new Promise(function(n,o){var s=e.getContext("2d");if(!s)throw Error("missing context");for(var l=s.getImageData(0,0,e.width,e.height).data,u=rv()(l,4).reduce(function(e,t){var n=(0,m._)(t,3),r=(n[0]<<16)+(n[1]<<8)+n[2],F=e.palette.findIndex(function(e){return e===r});return -1===F&&(F=e.palette.length,e.palette.push(r)),e.pixels.push(F),e},{pixels:[],palette:[]}),c=u.palette,d=u.pixels;c.length<256;)c.push(0);try{a((i+1)/F),window.requestAnimationFrame(function(){t.addFrame(0,0,e.width,e.height,d,{delay:Math.round(100/r),palette:c}),n(null)})}catch(e){o(e)}})})}},rC=function(e){return{scaleFactor:e.scaleFactor||4,frameRate:e.frameRate||12,yoyo:e.yoyo||!1,reverse:e.reverse||!1,frame:e.frame||"",lockFrame:e.lockFrame||!1,invertPalette:e.invertPalette||!1,palette:e.palette||"",exportFrameMode:e.exportFrameMode||e0.H.FRAMEMODE_KEEP}},rI=function(){var e=(0,e3._)(function(){var e,t,n,r,i,o,s,l,u,c,d,m,p,h,g,v,x,A,b,j,y,_,C,I,E,w,T,S,P,k,D,B,M,N,R,L,G,O;return(0,e5.YH)(this,function(H){switch(H.label){case 0:return t=(e=f.A.getState()).setError,n=e.videoSelection,i=(r=n4.A.getState()).startProgress,o=r.setProgress,s=r.stopProgress,u=(l=eX.h.getState()).frames,c=l.palettes,d=l.images,p=(m=Q.A.getState()).videoParams,h=m.fileNameStyle,g=i("Creating Animation"),[4,(0,rb.c)(10)];case 1:var U;if(H.sent(),x=(v=rC(p)).scaleFactor,A=v.frameRate,b=v.yoyo,j=v.reverse,y=v.frame,_=v.lockFrame,C=v.invertPalette,I=v.palette,E=v.exportFrameMode,!n.length)return[2];return T=(w=n.map(function(e){return d.find(function(t){return t.hash===e})}).reduce(es.N,[])).reduce(function(e,t){if(!t)return e;var n=(0,tN.pl)(t)?(0,a._)((0,F._)({},t),{frame:y||t.frame}):(0,a._)((0,F._)({},t),{palette:I||t.palette});return(0,$._)(e).concat([n])},[]),S=(0,tO.T)(w,u),[4,Promise.all(T.map((U=(0,e3._)(function(e){var t,n,r,i,o,s,l,d,f,m,p,h,g,v,A,b,j,y,I;return(0,e5.YH)(this,function(w){switch(w.label){case 0:return[4,S(e.hash)];case 1:if(t=w.sent(),n=_||e.lockFrame||!1,r=e.rotation||0,o=(i=(0,nK.s)(c,(0,a._)((0,F._)({},e),{lockFrame:n}))).palette,s=i.framePalette,!(l=u.find(function(t){return t.id===e.frame})))return[3,3];return[4,(0,nj.mZ)(l.hash)];case 2:return f=w.sent(),[3,4];case 3:f=null,w.label=4;case 4:if(m=(d=f)?d.upper.length/20:2,!t||!o)throw Error("missing tiles or palette");if(!(0,tN.pl)(e))return[3,6];return[4,(0,e0.y1)({tiles:t,palette:o,lockFrame:n,imageStartLine:m,rotation:r,scaleFactor:x,handleExportFrame:E},"image/png")];case 5:return p=w.sent(),[3,8];case 6:return h=(null==o?void 0:o.palette)||e0.CU,g=(null==s?void 0:s.palette)||e0.CU,A=(v=(0,nZ.f)(e)).invertPalette,b=v.invertFramePalette,j=(0,ry.C)({imagePalette:h,invertPalette:C||A,framePalette:n?g:h,invertFramePalette:C||b}),[4,(0,e0.Yn)((0,F._)({tiles:t,imageStartLine:m,rotation:r,scaleFactor:x,handleExportFrame:E},j),"image/png")];case 7:p=w.sent(),w.label=8;case 8:return[4,createImageBitmap(p)];case 9:return y=w.sent(),(I=document.createElement("canvas")).width=y.width,I.height=y.height,I.getContext("2d").drawImage(y,0,0),[2,I]}})}),function(e){return U.apply(this,arguments)})))];case 2:if(P=H.sent(),1!==(0,tA.A)(P.map(function(e){return"".concat(e.width,"*").concat(e.height)})).length)return s(g),t(Error("All images need to have same dimensions")),[2];return k=[],D=new(nN())(1,1/0),B=new rA.e(k,P[0].width,P[0].height,{loop:65535}),b&&((N=(0,$._)(P).reverse()).shift(),N.pop(),(M=P).push.apply(M,(0,$._)(N))),j&&P.reverse(),R=r_({frameRate:A,gifWriter:B,queue:D,total:P.length,setProgress:function(e){console.log(e),o(g,e)}}),[4,Promise.all(P.map(R))];case 3:H.sent(),L=(0,rj.A)({useCurrentDate:!0,exportScaleFactor:x,frameRate:A,altTitle:"animated",frameName:y,paletteShort:I,fileNameStyle:h}),G=B.end();try{O=new File([new Uint8Array(k.slice(0,G)).buffer],"".concat(L,".gif"),{type:"image/gif"})}catch(e){O=new Blob([new Uint8Array(k.slice(0,G)).buffer])}return(0,rx.saveAs)(O,"".concat(L,".gif")),s(g),[2]}})});return function(){return e.apply(this,arguments)}}(),rE=function(){var e=(0,Q.A)(),t=e.videoParams,n=e.setVideoParams,r=(0,f.A)(),F=r.videoSelection,a=r.setVideoSelection,i=rC(t);return{imageCount:F.length||0,videoParams:i,update:n,cancel:function(){a([])},animate:function(){rI(),a([])}}};let rw=function(){var e=(0,V.c3)("VideoParamsForm"),t=rE(),n=t.update,r=t.cancel,F=t.imageCount,a=t.animate,o=t.videoParams;return F?(0,i.jsx)(eA.A,{confirm:a,deny:r,header:e("dialogHeader",{count:F}),children:(0,i.jsxs)(l.A,{direction:"column",gap:4,children:[(0,i.jsx)(ep.A,{label:e("frameRate"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:120}},value:o.frameRate,onChange:function(e){n({frameRate:parseInt(e.target.value,10)})}}),(0,i.jsx)(ep.A,{label:e("scaleGif"),size:"small",type:"number",slotProps:{htmlInput:{min:1,max:12}},value:o.scaleFactor,onChange:function(e){n({scaleFactor:parseInt(e.target.value,10)})}}),(0,i.jsx)(ed.A,{label:e("enableYoyo"),control:(0,i.jsx)(em.A,{checked:o.yoyo,onChange:function(e){n({yoyo:e.target.checked})}})}),(0,i.jsx)(ed.A,{label:e("reverseDirection"),control:(0,i.jsx)(em.A,{checked:o.reverse,onChange:function(e){n({reverse:e.target.checked})}})}),(0,i.jsx)(tc,{noFancy:!0,allowEmpty:!0,value:o.palette||"",invertPalette:o.invertPalette,onChange:function(e){n({palette:e})},updateInvertPalette:function(e){n({invertPalette:e})}}),(0,i.jsx)(ep.A,{label:e("handleFrames"),size:"small",select:!0,value:o.exportFrameMode,onChange:function(e){n({exportFrameMode:e.target.value})},children:rh.A.map(function(t){var n=t.id,r=t.name;return(0,i.jsx)(ef.A,{value:n,children:e(r)},n)})}),"crop"===o.exportFrameMode?null:(0,i.jsx)(eK,{frame:o.frame||"",lockFrame:o.lockFrame,noFrameOption:e("noFrameOption"),updateFrame:function(e){n({frame:e})},updateFrameLock:function(e){n({lockFrame:e})}})]})}):null},rT=function(){var e,t=(0,Q.A)().useSerials,n=!!(0,eD.A)().dialogs.length,r=(0,tD.A)(),F=r.editFrame,a=r.editImageGroup,o=r.editImages,s=r.editPalette,l=r.editRGBNImages,u=r.pickColors,c=!!(null==o||null==(e=o.batch)?void 0:e.length),d=l.length>0,m=(0,tB.A)(),p=m.filtersVisible,h=m.sortOptionsVisible,g=(0,ej.A)(),v=g.bitmapQueue,x=g.importQueue,A=g.frameQueue,b=!!v.length,j=!!x.length,y=!!A.length,_=(0,f.A)(),C=_.lightboxImage,I=_.dragover,E=_.trashCount.show,w=_.syncSelect,T=_.videoSelection,S=_.showSerials,P=(0,n4.A)(),k=P.progress,D=P.progressLog,B=!!D.git.length||!!D.dropbox.length,M=!!k.length,N=!!(null==T?void 0:T.length);switch(!0){case n:return(0,i.jsx)(eM,{});case y:return(0,i.jsx)(nD,{});case b:return(0,i.jsx)(e_,{});case j:return(0,i.jsx)(nW,{});case c:return(0,i.jsx)(tz,{});case!!a:return(0,i.jsx)(tZ,{});case!!F:return(0,i.jsx)(tX,{});case!!s:return(0,i.jsx)(t5,{});case d:return(0,i.jsx)(nm,{});case N:return(0,i.jsx)(rw,{});case!!u:return(0,i.jsx)(n3,{});case null!==C:return(0,i.jsx)(n$,{});case p:return(0,i.jsx)(nS,{});case h:return(0,i.jsx)(ra,{});case w:return(0,i.jsx)(rf,{});case E:return(0,i.jsx)(rp,{});case S&&t:return(0,i.jsx)(rr,{});case I:return(0,i.jsx)(eG,{});case B:return(0,i.jsx)(rt,{});case M:return(0,i.jsx)(n6,{});default:return null}};function rS(e){var t=e.children,n=(0,Q.A)().themeName,r={"--ddpx":(0,tG.h)().ddpx};(0,d.useEffect)(function(){var e,t=null==(e=document.querySelector("html"))?void 0:e.classList;t&&[W.V.BRIGHT,W.V.DARK].forEach(function(e){e===n?t.add(n):t.remove(e)})},[n]);var f=(0,d.useMemo)(function(){return n===W.V.DARK?ei:eo},[n]),m=(0,c.A)(f.breakpoints.down("md"));return(0,i.jsxs)(u.A,{theme:f,children:[(0,i.jsx)(s.Ay,{}),(0,i.jsx)(d.Suspense,{fallback:(0,i.jsx)(ec,{}),children:(0,i.jsx)(eu,{})}),(0,i.jsx)(o.A,{maxWidth:"xl",sx:(0,a._)((0,F._)({},r),{p:m?2:3,minHeight:"calc(100dvh - var(--navigation-height))",display:"flex",flexDirection:"column"}),children:(0,i.jsx)(l.A,{direction:"column",gap:2,sx:{flexGrow:1},children:t})}),(0,i.jsx)(rT,{}),(0,i.jsx)(y,{})]})}},93370:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(97004),F=n(693),a=n(78538),i=n(39249),o=n(95155),s=n(54581),l=n(15905),u=n(12115),c=n(77683);let d=function(e){var t=e.palette,n=e.tiles,d=e.imageStartLine,f=e.lockFrame,m=e.invertPalette,p=e.framePalette,h=e.invertFramePalette,g=e.asThumb,v=void 0!==g&&g,x=e.rotation,A=void 0===x?l.pL.DEG_0:x,b=!(t instanceof Array),j=(0,a._)((0,u.useState)(null),2),y=j[0],_=j[1],C=(0,a._)((0,u.useState)(""),2),I=C[0],E=C[1];(0,u.useEffect)(function(){if(t&&n){var e=setTimeout((0,r._)(function(){var e;return(0,i.YH)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,5,,6]),!b)return[3,2];return[4,(0,l.uL)({tiles:n,palette:t,lockFrame:f||!1,rotation:A})];case 1:return _.apply(void 0,[r.sent()]),[3,4];case 2:if(!(null==n?void 0:n.length))return[3,4];return[4,(0,l.qO)((0,F._)({tiles:n,imageStartLine:d,rotation:A},(0,c.C)({imagePalette:t,framePalette:p,invertPalette:m,invertFramePalette:h})))];case 3:_.apply(void 0,[r.sent()]),r.label=4;case 4:return E(""),[3,6];case 5:return(e=r.sent())instanceof Error&&(console.error(e),E(e.message)),[3,6];case 6:return[2]}})}),1);return function(){clearTimeout(e)}}},[n,t,f,m,A,b,d,p,h]);var w=(0,u.useMemo)(function(){var e=A===l.pL.DEG_90||A===l.pL.DEG_270,t=(b?(0,l.EK)(n):n.length)<=360,r=e&&t;return{display:"block",imageRendering:v?"auto":"pixelated",margin:r?"0 5%":0,width:r?"90%":"100%",maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}},[v,b,A,n]);return(0,o.jsx)(s.A,{className:"gameboy-image",sx:{display:"flex",width:"100%",height:"100%"},children:!I&&y&&(0,o.jsx)(s.A,{component:"img",width:160,src:y,sx:w,alt:""})})}},95939:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(12115),F=n(32134),a=function(){return(0,r.useContext)(F.K)}},96396:(e,t,n)=>{Promise.resolve().then(n.bind(n,92756))},98250:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(78538),F=n(12115),a=function(){var e;return{width:window.innerWidth,height:window.innerHeight,ddpx:window.devicePixelRatio<=2?window.devicePixelRatio:window.devicePixelRatio/2,layoutWidth:(e=window.innerWidth)>1220?1155:e>1025?960:e>830?765:e>635?570:e>440?375:e-40}},i=function(){var e=(0,r._)((0,F.useState)(a()),2),t=e[0],n=e[1];return(0,F.useEffect)(function(){var e=function(){n(a())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[n]),t}},99451:(e,t,n)=>{"use strict";n.d(t,{N:()=>F});var r=n(87025),F=function(e,t){return t?(0,r._)(e).concat([t]):e}}},e=>{var t=t=>e(e.s=t);e.O(0,[1090,4536,7652,4453,700,8250,5232,7271,2491,3701,3127,9710,7642,7890,6672,4991,1487,9665,6874,8681,7857,3611,1936,1190,1954,9447,8520,2973,8441,1684,7358],()=>t(96396)),_N_E=e.O()}]);