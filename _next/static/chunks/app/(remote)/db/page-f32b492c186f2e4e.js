(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2837],{20063:(e,t,r)=>{"use strict";var n=r(47260);r.o(n,"RedirectType")&&r.d(t,{RedirectType:function(){return n.RedirectType}}),r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useServerInsertedHTML")&&r.d(t,{useServerInsertedHTML:function(){return n.useServerInsertedHTML}})},21329:()=>{},29945:(e,t,r)=>{"use strict";r.d(t,{default:()=>g});var n=r(61975),a=r(22043),u=r(45377),o=r(71450),s=r(95155);r(21329);var i=r(20063),c=r(18955),l=r(12115),f=function(e,t){return(0,n._)(function(){return(0,o.YH)(this,function(r){return[2,new Promise(function(r){var a=e.result.transaction(t).objectStore(t);a.getAllKeys().onsuccess=function(e){return(0,n._)(function(){var t,u,s,i,c,l,f,d,h,v,b,p;return(0,o.YH)(this,function(y){switch(y.label){case 0:u=null==(t=e.target)?void 0:t.result,s=[],i=!0,c=!1,l=void 0,y.label=1;case 1:y.trys.push([1,6,7,8]),f=u[Symbol.iterator](),y.label=2;case 2:if(i=(d=f.next()).done)return[3,5];return h=d.value,v=s.push,b={key:h},[4,(0,n._)(function(){return(0,o.YH)(this,function(e){return[2,new Promise(function(e){a.get(h).onsuccess=function(t){var r;e(null==(r=t.target)?void 0:r.result)}})]})})()];case 3:v.apply(s,[(b.value=y.sent(),b)]),y.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return p=y.sent(),c=!0,l=p,[3,8];case 7:try{i||null==f.return||f.return()}finally{if(c)throw l}return[7];case 8:return r(s),[2]}})})()}})]})})()},d=function(e,t,r){return(0,n._)(function(){var a;return(0,o.YH)(this,function(u){return(a=e.result.transaction(t,"readwrite").objectStore(t)).clear().onsuccess=function(){return(0,n._)(function(){var e,t,n,u,s,i,c,l;return(0,o.YH)(this,function(o){e=!0,t=!1,n=void 0;try{for(u=r[Symbol.iterator]();!(e=(s=u.next()).done);e=!0)c=(i=s.value).key,l=i.value,a.add(l,c)}catch(e){t=!0,n=e}finally{try{e||null==u.return||u.return()}finally{if(t)throw n}}return[2]})})()},[2]})})()},h=function(){var e=!0,t=!1,r=void 0;try{for(var n,a=Object.keys(localStorage)[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var u=n.value;localStorage.removeItem(u)}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}},v=function(e){var t=!0,r=!1,n=void 0;try{for(var a,u=e[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var o=a.value,s=o.key,i=o.value;localStorage.setItem(s,i)}}catch(e){r=!0,n=e}finally{try{t||null==u.return||u.return()}finally{if(r)throw n}}},b=r(94468),p="GB Printer Web",y="DBDATA";function g(){var e=(0,c.c)("CopyDatabase"),t=(0,a._)((0,l.useState)("https://herrzatacke.github.io/gb-printer-web/db/"),2),r=t[0],g=t[1],m=(0,a._)((0,l.useState)(),2),w=m[0],S=m[1],_=(0,a._)((0,l.useState)(),2),k=_[0],x=_[1],j=(0,a._)((0,l.useState)(),2),C=j[0],H=j[1],T=(0,a._)((0,l.useState)(!1),2),Y=T[0],D=T[1],I=(0,a._)((0,l.useState)([]),2),L=I[0],P=I[1],R=(0,i.useRouter)().replace,B=(0,l.useCallback)(function(e){P(function(t){return(0,u._)(t).concat([e])})},[]);(0,l.useEffect)(function(){(0,n._)(function(){var e,t,r,a;return(0,o.YH)(this,function(u){switch(u.label){case 0:return[4,(0,b.ZU)()];case 1:return u.sent(),[4,indexedDB.databases()];case 2:return t=(null==(e=u.sent().find(function(e){return e.name===p}))?void 0:e.version)||1,H(r=indexedDB.open(p,t)),a=window.opener||null,window.addEventListener("message",function(e){e.data.type===y&&x(e.data)}),a&&(D(!0),r.onsuccess=function(){return(0,n._)(function(){var e,t,u;return(0,o.YH)(this,function(s){switch(s.label){case 0:return[4,f(r,"gb-printer-web-images")];case 1:return e=s.sent(),[4,f(r,"gb-printer-web-frames")];case 2:return t=s.sent(),[4,(0,n._)(function(){var e,t,r,n,a,u,s,i;return(0,o.YH)(this,function(o){e=Object.keys(localStorage).filter(function(e){return e.startsWith("gbp")}),t=[],r=!0,n=!1,a=void 0;try{for(u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)i=s.value,t.push({key:i,value:localStorage.getItem(i)})}catch(e){n=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(n)throw a}}return[2,t]})})()];case 3:return u=s.sent(),window.setTimeout(function(){var r={type:y,images:e,frames:t,localStorageData:u};a.postMessage(r,"*")},500),[2]}})})()}),[2]}})})()},[]),(0,l.useEffect)(function(){k?P([e("reportImages",{count:k.images.length}),e("reportFrames",{count:k.frames.length}),e("reportLocalStorage",{count:k.localStorageData.length})]):P([])},[e,k]);var E=(0,l.useCallback)(function(){S(window.open(r,"db-child","width=480,height=400"))},[r]),N=(0,l.useCallback)(function(){return(0,n._)(function(){return(0,o.YH)(this,function(t){switch(t.label){case 0:if(!k||!C)return[2];return[4,h()];case 1:return t.sent(),B(e("reportLocalStorageCleared")),[4,v(k.localStorageData)];case 2:return t.sent(),B(e("reportLocalStorageCopied")),[4,d(C,"gb-printer-web-images",k.images)];case 3:return t.sent(),B(e("reportImagesCopied")),[4,d(C,"gb-printer-web-frames",k.frames)];case 4:return t.sent(),B(e("reportFramesCopied")),window.setTimeout(function(){null==w||w.close(),R("/")},800),[2]}})})()},[B,C,w,R,e,k]);return(0,s.jsxs)("div",{className:"database-page ".concat(Y?"is-child":""),children:[(0,s.jsxs)("div",{className:"url-load",children:[(0,s.jsxs)("label",{children:[(0,s.jsx)("span",{children:e("sourceUrl")}),(0,s.jsx)("input",{id:"db-url",type:"text",value:r,onChange:function(e){return g(e.target.value)}})]}),(0,s.jsx)("button",{type:"button",onClick:E,children:e("loadButton")})]}),(0,s.jsx)("pre",{children:L.join("\n")}),(0,s.jsx)("button",{type:"button",disabled:!k,onClick:N,children:e("copyButton")})]})}},34067:(e,t,r)=>{Promise.resolve().then(r.bind(r,29945))}},e=>{e.O(0,[5624,5266,7400,8955,4468,8441,9342,1255,7358],()=>e(e.s=34067)),_N_E=e.O()}]);