(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4021],{1607:(e,t,n)=>{"use strict";n.d(t,{D:()=>m,EnvProvider:()=>p});var r=n(97004),s=n(693),a=n(60376),i=n(78538),u=n(39249),o=n(95155),c=n(12115),f=n(52166),l=n(75380),d=(0,c.createContext)(null),m=function(){return(0,c.useContext)(d)},p=function(e){var t=e.children,n=(0,i._)((0,c.useState)(null),2),m=n[0],p=n[1],h=(0,f.A)().setPrinterUrl;return(0,c.useEffect)(function(){var e=["/gb-printer-web","/env.json"].filter(Boolean).join("/");e&&(0,r._)(function(){var t,n,r,i;return(0,u.YH)(this,function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),[4,(0,l.ZU)()];case 1:return u.sent(),[4,fetch(e)];case 2:return[4,u.sent().json()];case 3:return t=u.sent(),r=[(0,s._)({},t)],i={},[4,l.mU.driver()];case 4:return"esp8266"===(n=a._.apply(void 0,r.concat([(i.localforage=u.sent(),i)]))).env&&h("/"),p(n),[3,6];case 5:return u.sent(),p({version:"0.0.0",maximages:0,localforage:"error",env:"error",fstype:"-",bootmode:"-",oled:!1}),[3,6];case 6:return[2]}})})()},[h]),(0,o.jsx)(d.Provider,{value:m,children:t})}},4862:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var r=function(e){return e.GALLERY_VIEW_SMALL="small",e.GALLERY_VIEW_1X="1x",e.GALLERY_VIEW_2X="2x",e.GALLERY_VIEW_MAX="max",e.PALETTE_VIEW="res2x",e}({})},10746:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r="gbp-z-web"},27803:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.DEFAULT_ASC="default_asc",e.DEFAULT_DESC="default_desc",e.USAGE_ASC="usage_asc",e.USAGE_DESC="usage_desc",e.NAME_ASC="name_asc",e.NAME_DESC="name_desc",e}({})},29032:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var r=n(78538),s=n(35695),a=n(12115),i=function(){var e=(0,s.usePathname)(),t=(0,r._)((0,a.useState)(window.location.search),2),n=t[0],i=t[1],u=(0,a.useMemo)(function(){return new URLSearchParams(n)},[n]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){i(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var t=history.pushState,n=history.replaceState;return history.pushState=function(){for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];t.apply(this,r),e()},history.replaceState=function(){for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];n.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=t,history.replaceState=n}},[u,e]);var o=(0,a.useMemo)(function(){return u.toString()},[u]);return{fullPath:(0,a.useMemo)(function(){return o?"".concat(e,"?").concat(o):e},[e,o]),pathname:e,query:o,searchParams:u}}},35695:(e,t,n)=>{"use strict";var r=n(18999);n.o(r,"RedirectType")&&n.d(t,{RedirectType:function(){return r.RedirectType}}),n.o(r,"redirect")&&n.d(t,{redirect:function(){return r.redirect}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useServerInsertedHTML")&&n.d(t,{useServerInsertedHTML:function(){return r.useServerInsertedHTML}})},36816:()=>{},39893:(e,t,n)=>{"use strict";n.d(t,{C:()=>s,f:()=>r});var r=function(e){return e.WIDER="wider",e.WIDE="wide",e.NORMAL="normal",e.NARROW="narrow",e.NARROWER="narrower",e.EMULATOR="emulator",e}({}),s=[{translationKey:"contrastSettings.wider",baseValues:[0,68,187,255],value:"wider"},{translationKey:"contrastSettings.wide",baseValues:[0,85,170,255],value:"wide"},{translationKey:"contrastSettings.normal",baseValues:[51,102,153,204],value:"normal"},{translationKey:"contrastSettings.narrow",baseValues:[69,115,162,208],value:"narrow"},{translationKey:"contrastSettings.narrower",baseValues:[85,113,141,170],value:"narrower"},{translationKey:"contrastSettings.emulator",baseValues:[64,144,224,255],value:"emulator"}]},42269:(e,t,n)=>{Promise.resolve().then(n.bind(n,81713))},44965:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var r=["en-GB","en-CA","en-US","de-DE"]},45686:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var r=function(e){return e.TESTFILE="testFile",e.CHECKPRINTER="checkPrinter",e.FETCHIMAGES="fetchImages",e.CLEARPRINTER="clearPrinter",e.TEAR="tear",e}({})},49432:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=function(e,t){if(!e.trim())return"";if("/"===e&&"ws"!==t)return e;var n=!!e.match(RegExp("^".concat(t,"(s)?:\\/\\/"),"gi"));return"".concat(n?"":"".concat(t,"://")).concat(e).concat(e.endsWith("/")?"":"/")}},52166:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var r=n(693),s=n(78538),a=n(15905),i=n(65453),u=n(46786),o=n(39893),c=n(81445),f=n(80498),l=n(4862),d=n(27803),m=n(99999),p=n(44965),h=n(49432),v=n(10746),E=function(){var e="";if("undefined"!=typeof navigator){var t=(0,s._)(navigator.language.split("-"),2);e=[t[0],t[1]].filter(Boolean).join("-")}return p.I.includes(e)?e:p.I[0]};let w=(0,i.v)((0,u.Zr)(function(e){return{activePalette:"bw",bitmapQueueDither:!0,bitmapQueueSetting:o.f.WIDE,enableDebug:!1,exportFileTypes:["png"],exportScaleFactors:[4],fileNameStyle:c.B.FULL,forceMagicCheck:!0,galleryView:l.j.GALLERY_VIEW_1X,galleryClickAction:f.n.SELECT,handleExportFrame:a.H.FRAMEMODE_KEEP,hideDates:!1,importDeleted:!0,importLastSeen:!0,importPad:!1,lastBaudRate:115200,pageSize:30,preferredLocale:E(),printerParams:"",printerUrl:"",savFrameTypes:"int",themeName:m.V.BRIGHT,enableImageGroups:!1,sortPalettes:d.V.DEFAULT_DESC,useSerials:!1,videoParams:{},setActivePalette:function(t){return e({activePalette:t})},setBitmapQueueDither:function(t){return e({bitmapQueueDither:t})},setBitmapQueueSetting:function(t){return e({bitmapQueueSetting:t})},setEnableDebug:function(t){return e({enableDebug:t})},setFileNameStyle:function(t){return e({fileNameStyle:t})},setForceMagicCheck:function(t){return e({forceMagicCheck:t})},setGalleryView:function(t){return e({galleryView:t})},setGalleryClickAction:function(t){return e({galleryClickAction:t})},setHandleExportFrame:function(t){return e({handleExportFrame:t})},setHideDates:function(t){return e({hideDates:t})},setImportDeleted:function(t){return e({importDeleted:t})},setImportLastSeen:function(t){return e({importLastSeen:t})},setImportPad:function(t){return e({importPad:t})},setLastBaudRate:function(t){return e({lastBaudRate:t})},setPageSize:function(t){return e({pageSize:t})},setPrinterParams:function(t){return e({printerParams:t})},setPrinterUrl:function(t){return e({printerUrl:(0,h.A)(t,"http")})},setSavFrameTypes:function(t){return e({savFrameTypes:t})},setThemeName:function(t){return e({themeName:t})},setEnableImageGroups:function(t){return e({enableImageGroups:t})},setSortPalettes:function(t){return e({sortPalettes:t})},setUseSerials:function(t){return e({useSerials:t})},setVideoParams:function(t){return e(function(e){return{videoParams:(0,r._)({},e.videoParams,t)}})},setExportScaleFactors:function(t){return e({exportScaleFactors:t})},setExportFileTypes:function(t){return e({exportFileTypes:t})},setPreferredLocale:function(t){p.I.includes(t)?e({preferredLocale:t}):console.log('unknown locale "'.concat(t,'"'))}}},{name:"".concat(v.z,"-settings"),storage:(0,u.KU)(function(){return localStorage})}))},58617:(e,t,n)=>{var r=n(49509);e.exports=n(r.env.PROMISE_QUEUE_COVERAGE?36816:71669)},71669:function(e,t,n){var r,s;!function(a,i){"use strict";e.exports&&1?e.exports=i():void 0===(s="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=s)}(0,function(){"use strict";var e="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw Error("Queue.configure() before use Queue")}}},t=function(){};function n(e,t,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==e?e:1/0,this.maxQueuedPromises=void 0!==t?t:1/0,this.queue=[]}return n.configure=function(t){e=t},n.prototype.add=function(n){var r=this;return new e(function(e,s,a){if(r.queue.length>=r.maxQueuedPromises)return void s(Error("Queue limit reached"));r.queue.push({promiseGenerator:n,resolve:e,reject:s,notify:a||t}),r._dequeue()})},n.prototype.getPendingLength=function(){return this.pendingPromises},n.prototype.getQueueLength=function(){return this.queue.length},n.prototype._dequeue=function(){var t,n=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var r=this.queue.shift();if(!r)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,((t=r.promiseGenerator())&&"function"==typeof t.then?t:new e(function(e){e(t)})).then(function(e){n.pendingPromises--,r.resolve(e),n._dequeue()},function(e){n.pendingPromises--,r.reject(e),n._dequeue()},function(e){r.notify(e)})}catch(e){n.pendingPromises--,r.reject(e),n._dequeue()}return!0},n})},75380:(e,t,n)=>{"use strict";n.d(t,{Uv:()=>f,mU:()=>c,ZU:()=>l});var r=n(97004),s=n(39249),a=n(77271),i=n.n(a),u="dummy".concat(new Date().getTime());let o=function(e){var t,n,a,o,c=i().createInstance(e),f=(t=(0,r._)(function(){return(0,s.YH)(this,function(e){switch(e.label){case 0:return[4,c.setItem(u,u)];case 1:return e.sent(),[4,c.removeItem(u)];case 2:return e.sent(),[2]}})}),function(){return t.apply(this,arguments)});return{ready:(0,r._)(function(){var t;return(0,s.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.ready()];case 1:return n.sent(),[2,f()];case 2:throw t=n.sent(),c=i().createInstance(e),t;case 3:return[2]}})}),keys:(0,r._)(function(){return(0,s.YH)(this,function(t){try{return[2,c.keys()]}catch(t){throw c=i().createInstance(e),t}})}),driver:(0,r._)(function(){var t;return(0,s.YH)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.driver()];case 1:return[2,n.sent()];case 2:throw t=n.sent(),c=i().createInstance(e),t;case 3:return[2]}})}),setItem:(n=(0,r._)(function(t,n){var r;return(0,s.YH)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,c.setItem(t,n)];case 1:return[2,s.sent()];case 2:throw r=s.sent(),c=i().createInstance(e),r;case 3:return[2]}})}),function(e,t){return n.apply(this,arguments)}),getItem:(a=(0,r._)(function(t){var n;return(0,s.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,c.getItem(t)];case 1:return[2,r.sent()];case 2:throw n=r.sent(),c=i().createInstance(e),n;case 3:return[2]}})}),function(e){return a.apply(this,arguments)}),removeItem:(o=(0,r._)(function(t){var n;return(0,s.YH)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,c.removeItem(t)];case 1:return[2,r.sent()];case 2:throw n=r.sent(),c=i().createInstance(e),n;case 3:return[2]}})}),function(e){return o.apply(this,arguments)})}};var c=o({name:"GB Printer Web",storeName:"gb-printer-web-images"}),f=o({name:"GB Printer Web",storeName:"gb-printer-web-frames"});window.lfi=c,window.lff=f;var l=function(){var e=(0,r._)(function(){return(0,s.YH)(this,function(e){switch(e.label){case 0:return[4,f.ready()];case 1:return e.sent(),[4,c.ready()];case 2:return e.sent(),[4,new Promise(function(e){window.setTimeout(e,5)})];case 3:return e.sent(),[2]}})});return function(){return e.apply(this,arguments)}}()},80498:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var r=function(e){return e.SELECT="select",e.EDIT="edit",e.VIEW="view",e}({})},81445:(e,t,n)=>{"use strict";n.d(t,{B:()=>r,y:()=>s});var r=function(e){return e.FULL="FULL",e.TITLE_ONLY="TITLE_ONLY",e.DATE_TITLE="DATE_TITLE",e}({}),s=[{id:"FULL",name:"filenameStyles.fullTitle"},{id:"DATE_TITLE",name:"filenameStyles.dateTitle"},{id:"TITLE_ONLY",name:"filenameStyles.titleOnly"}]},81713:(e,t,n)=>{"use strict";n.d(t,{default:()=>A});var r=n(693),s=n(60376),a=n(95155),i=n(17652),u=n(12115),o=n(78538),c=n(1607),f=n(29032),l=n(97004),d=n(39249),m=n(45686),p=n(87025),h=function(){var e=(0,l._)(function(){var e;return(0,d.YH)(this,function(t){switch(t.label){case 0:return[4,fetch("/dumps/list")];case 1:return[4,t.sent().json()];case 2:if((e=t.sent()).fs&&e.fs.dumpcount!==e.dumps.length)throw Error("Inconststent image count received from printer.");return[2,{printerData:(0,s._)((0,r._)({},e),{dumps:(0,p._)(e.dumps).sort()})}]}})});return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,l._)(function(){return(0,d.YH)(this,function(e){switch(e.label){case 0:return[4,fetch("/dumps/clear")];case 1:return[4,e.sent().json()];case 2:if(void 0!==e.sent().deleted)return[2,h()];throw Error("error while deleting images")}})});return function(){return e.apply(this,arguments)}}(),E=n(58617),w=n.n(E),g=function(){var e=(0,l._)(function(e,t){var n,r,s;return(0,d.YH)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,fetch(e)];case 1:return n=a.sent(),[3,3];case 2:if(r=a.sent(),t<=1)throw r;return[2,g(e,t-1)];case 3:return s={},n.headers.forEach(function(e,t){s[t]=e}),[2,n.blob().then(function(e){return{blob:e,contentType:n.headers.get("content-type")||void 0,meta:{headers:s},status:n.status,ok:n.ok}})]}})});return function(t,n){return e.apply(this,arguments)}}(),y=new(w())(1,1/0),P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;return y.add((0,l._)(function(){return(0,d.YH)(this,function(n){switch(n.label){case 0:return[4,new Promise(function(e){window.setTimeout(e,t)})];case 1:return n.sent(),[2,e()]}})}))},I=function(){var e=(0,l._)(function(e,t,n){var r,s,a,i,u;return(0,d.YH)(this,function(o){switch(o.label){case 0:var c;return r=t.dumps,s=parseInt(n.get("delay")||"250",10),a=parseInt(n.get("retries")||"3",10),i=r.map((c=(0,l._)(function(t,n){return(0,d.YH)(this,function(i){return[2,P((0,l._)(function(){var s;return(0,d.YH)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,g("/".concat(t.replace(/^\//,"")),a)];case 1:return s=i.sent(),e.postMessage({fromRemotePrinter:{progress:(n+1)/r.length}},"*"),[2,s];case 2:return console.warn(i.sent()),[2,{ok:!1,blob:new Blob}];case 3:return[2]}})}),s)]})}),function(e,t){return c.apply(this,arguments)})),u={},[4,Promise.all(i)];case 1:return[2,(u.blobsdone=o.sent(),u)]}})});return function(t,n,r){return e.apply(this,arguments)}}(),_=n(35796),T=function(){var e=(0,l._)(function(){return(0,d.YH)(this,function(e){return[2,{lines:_.default}]})});return function(){return e.apply(this,arguments)}}();let b=function(e,t,n){var r,s=e.targetWindow,a=[];switch(t){case"webpack-dev":a.push({name:m.n.TESTFILE,fn:T},{name:m.n.CHECKPRINTER,fn:h},{name:m.n.FETCHIMAGES,fn:I},{name:m.n.CLEARPRINTER,fn:v});break;case"esp8266":a.push({name:m.n.CHECKPRINTER,fn:h},{name:m.n.FETCHIMAGES,fn:I},{name:m.n.CLEARPRINTER,fn:v});break;case"pico-gb":a.push({name:m.n.CHECKPRINTER,fn:h},{name:m.n.FETCHIMAGES,fn:I})}return window.addEventListener("message",(r=(0,l._)(function(e){var t,r;return(0,d.YH)(this,function(i){switch(i.label){case 0:if(e.source!==s||!(t=e.data.toRemotePrinter))return[2];switch(t.command){case m.n.FETCHIMAGES:return[3,1];case m.n.CLEARPRINTER:case m.n.CHECKPRINTER:return[3,3];case m.n.TESTFILE:return[3,5]}return[3,7];case 1:return[4,a.find(function(e){return e.name===t.command}).fn(s,t.params,n)];case 2:case 4:case 6:return r=i.sent(),[3,8];case 3:return[4,a.find(function(e){return e.name===t.command}).fn()];case 5:return[4,a.find(function(e){return e.name===t.command}).fn()];case 7:r=null,i.label=8;case 8:return r&&s.postMessage({fromRemotePrinter:r},"*"),[2]}})}),function(e){return r.apply(this,arguments)})),a},S=function(e,t){var n=e.targetWindow,r=window.setInterval(function(){n&&n.postMessage({fromRemotePrinter:{height:document.body.getBoundingClientRect().height,commands:t}},"*")},500);return function(){window.clearInterval(r)}};var R=function(e){return e.NONE="none",e.IFRAME="iframe",e.POPUP="popup",e}({}),L=function(){var e=(0,o._)((0,u.useState)("none"),2),t=e[0],n=e[1],r=(0,c.D)(),s=(0,f.j)().searchParams;return(0,u.useEffect)(function(){var e=window.opener||window.parent,t=e===window.parent&&e!==window,a=e===window.opener&&e!==window,i={targetWindow:e,isIframe:t,isPopup:a,isRemote:t||a};t?n("iframe"):a?n("popup"):n("none");var u=(null==r?void 0:r.env)?b(i,r.env,s):[],o=S(i,u.map(function(e){return e.name}));return console.log("started"),o},[r,s]),{parentType:t}};let A=function(){var e=(0,i.c3)("Remote"),t=L().parentType,n={p:function(e){return(0,a.jsx)("p",{children:e})},em:function(e){return(0,a.jsx)("span",{className:"remote-info--em",children:e})}};switch(t){case R.IFRAME:return(0,a.jsx)("div",{className:"remote-info",children:e.rich("iframe",n)});case R.POPUP:return(0,a.jsx)("div",{className:"remote-info",children:e.rich("popup",(0,s._)((0,r._)({},n),{host:window.location.host}))});case R.NONE:default:return(0,a.jsx)("div",{className:"remote-info",children:e.rich("noReference",n)})}}},99999:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var r=function(e){return e.BRIGHT="theme-bright",e.DARK="theme-dark",e}({})}},e=>{var t=t=>e(e.s=t);e.O(0,[7652,7271,8250,7963,8441,1684,7358],()=>t(42269)),_N_E=e.O()}]);