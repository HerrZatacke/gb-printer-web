"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6147],{4599:(e,n,t)=>{t.d(n,{NavigationToolsProvider:()=>p,g:()=>h});var r=t(95155),u=t(12115),a=t(22043),o=t(20063),i=t(89386),s=t(57203),c=t(15431),l=t(86539),f=t(84470),g=function(){var e=(0,o.useRouter)(),n=(0,i.Z)(),t=n.paths,r=n.root,g=n.isWorking,d=n.path,p=n.getUrl,h=(0,a._)((0,u.useState)(!1),2),v=h[0],m=h[1],E=(0,s.A)(),I=E.sortBy,T=E.filtersTags,R=E.filtersFrames,_=E.filtersPalettes,w=E.recentImports,F=(0,c.A)().pageSize,L=(0,u.useCallback)(function(e){return(0,f.S)(e,{filtersTags:T,filtersFrames:R,filtersPalettes:_,sortBy:I,recentImports:w})},[R,_,T,w,I]),b=(0,u.useCallback)(function(e,n){return Math.floor(L(n).findIndex(function(n){return n.hash===e})/F)},[L,F]),x=(0,u.useCallback)(function(e,n){var r;return e===l.t?p({pageIndex:n,group:""}):p({pageIndex:n,group:(null==(r=t.find(function(n){return e===n.group.id}))?void 0:r.absolutePath)||""})},[p,t]),X=(0,u.useMemo)(function(){var e;return(null==(e=t.find(function(e){return e.absolutePath===d}))?void 0:e.group)||r},[d,t,r]),y=(0,u.useCallback)(function(e){var n=t.find(function(n){return n.group.images.map(function(e){return e.hash}).includes(e)}),u=(null==n?void 0:n.absolutePath)||"";return p({pageIndex:b(e,(null==n?void 0:n.group)||r),group:u})},[b,p,t,r]),C=(0,u.useCallback)(function(e,n){g||window.setTimeout(function(){m({group:{id:e,pageIndex:n}})},1)},[g]),M=(0,u.useCallback)(function(e){window.setTimeout(function(){m({imageHash:e})},1)},[]);return(0,u.useEffect)(function(){if(!g&&v){var n=window.setTimeout(function(){v.imageHash?(e.push(y(v.imageHash)),m(!1)):v.group&&(e.push(x(v.group.id,v.group.pageIndex)),m(!1))},1);return function(){window.clearTimeout(n)}}},[x,y,g,e,v]),{currentGroup:X,getGroupPath:x,getImagePageIndexInGroup:b,navigateToGroup:C,navigateToImage:M}},d=(0,u.createContext)(null);function p(e){var n=e.children,t=g();return(0,r.jsx)(d.Provider,{value:t,children:n})}var h=function(){var e=(0,u.useContext)(d);if(!e)throw Error("useNavigationToolsContext must be used within an NavigationToolsProvider");return e}},24849:(e,n,t)=>{t.d(n,{T:()=>i,p:()=>s});var r=t(61975),u=t(71450),a=t(17403),o=t(75036),i=function(e,n,t){var i=function(s,c,l,f){return(0,r._)(function(){var r,g,d,p,h,v,m,E,I,T,R,_;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(g=e.find(function(e){return s===e.hash}),d=("string"==typeof l?l:null==g?void 0:g.frame)||void 0,p=null==(r=n.find(function(e){return e.id===d}))?void 0:r.hash,f||!(!g||!(0,a.pl)(g)))return[3,2];return[4,(0,o.Hh)(s,p,c,t)];case 1:return[2,u.sent()||[]];case 2:if(!(h=f||g.hashes).r)return[3,4];return[4,i(h.r,c,d)];case 3:return m=u.sent(),[3,5];case 4:m=[],u.label=5;case 5:if(v=m,!h.g)return[3,7];return[4,i(h.g,c,d)];case 6:return I=u.sent(),[3,8];case 7:I=[],u.label=8;case 8:if(E=I,!h.b)return[3,10];return[4,i(h.b,c,d)];case 9:return R=u.sent(),[3,11];case 10:R=[],u.label=11;case 11:if(T=R,!h.n)return[3,13];return[4,i(h.n,c,d)];case 12:return _=u.sent(),[3,14];case 13:_=[],u.label=14;case 14:return[2,{r:v,g:E,b:T,n:_}]}})})()};return i},s=function(e,n){var t=i(e,n);return function(e){return(0,r._)(function(){var n,r,a,o,i;return(0,u.YH)(this,function(u){switch(u.label){case 0:return[4,t(e,!0,"")];case 1:if(n=u.sent())return[2,(null==n?void 0:n.length)||(null==(r=n.r)?void 0:r.length)||(null==(a=n.g)?void 0:a.length)||(null==(o=n.b)?void 0:o.length)||(null==(i=n.n)?void 0:i.length)||0];return[2,0]}})})()}}},25969:(e,n,t)=>{t.d(n,{j:()=>o});var r=t(22043),u=t(20063),a=t(12115),o=function(){var e=(0,u.usePathname)(),n=(0,r._)((0,a.useState)(window.location.search),2),t=n[0],o=n[1],i=(0,a.useMemo)(function(){return new URLSearchParams(t)},[t]);(0,a.useEffect)(function(){var e=function(){window.setTimeout(function(){o(function(e){return window.location.search!==e?window.location.search:e})},1)};e(),window.addEventListener("popstate",e);var n=history.pushState,t=history.replaceState;return history.pushState=function(){for(var t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];n.apply(this,r),e()},history.replaceState=function(){for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];t.apply(this,r),e()},function(){window.removeEventListener("popstate",e),history.pushState=n,history.replaceState=t}},[i,e]);var s=(0,a.useMemo)(function(){return i.toString()},[i]);return{fullPath:(0,a.useMemo)(function(){return s?"".concat(e,"?").concat(s):e},[e,s]),pathname:e,query:s,searchParams:i}}},42485:(e,n,t)=>{t.d(n,{A:()=>u});var r=t(45073);let u=function(e){return function(n){var t=e.filter(function(e){return![r.X3.FILTER_MONOCHROME,r.X3.FILTER_NEW,r.X3.FILTER_RGB,r.X3.FILTER_UNTAGGED,r.X3.FILTER_RECENT,r.X3.FILTER_FAVOURITE,r.X3.FILTER_COMMENTS,r.X3.FILTER_USERNAME].includes(e)});return!t.length||!!n.tags.find(function(e){return t.includes(e)})}}},66375:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(45377),u=t(36117),a=t.n(u),o=t(45073),i=t(17403);let s=function(e,n,t,u,s){var c=function(s){var c,l,f=e.reduce(function(e,n){return[o.X3.FILTER_MONOCHROME,o.X3.FILTER_NEW,o.X3.FILTER_RGB,o.X3.FILTER_UNTAGGED,o.X3.FILTER_RECENT,o.X3.FILTER_FAVOURITE,o.X3.FILTER_COMMENTS,o.X3.FILTER_USERNAME].includes(n)?(0,r._)(e).concat([n]):e},[]);if(f.length&&(f.includes(o.X3.FILTER_UNTAGGED)&&0!==s.tags.length||f.includes(o.X3.FILTER_NEW)&&a()(new Date(s.created)).unix()<=a()().subtract(1,"day").unix()||f.includes(o.X3.FILTER_RECENT)&&!u.map(function(e){return e.hash}).includes(s.hash)||f.includes(o.X3.FILTER_RGB)&&!(0,i.pl)(s)||f.includes(o.X3.FILTER_MONOCHROME)&&(0,i.pl)(s)||f.includes(o.X3.FILTER_FAVOURITE)&&!s.tags.includes(o.X3.FILTER_FAVOURITE)||f.includes(o.X3.FILTER_COMMENTS)&&!(null==(c=s.meta)?void 0:c.comment)||f.includes(o.X3.FILTER_USERNAME)&&!(null==(l=s.meta)?void 0:l.userName)))return!1;return(!t.length||"string"==typeof s.palette&&!!t.includes(s.palette))&&(!n.length||!!s.frame&&!!n.includes(s.frame))};return function(e){if(c(e))return!0;var n=s.find(function(n){return n.coverImage===e.hash})||null;return!!n&&n.allImages.some(c)}}},84470:(e,n,t)=>{t.d(n,{S:()=>i});var r=t(45377),u=t(85773),a=t(66375),o=t(42485),i=function(e,n){var t=e.images,i=e.groups,s=n.filtersTags,c=n.filtersFrames,l=n.filtersPalettes,f=n.sortBy,g=n.recentImports;return(0,r._)(t).map(u.YZ).sort((0,u.PM)(f)).map(u.lt).filter((0,a.A)(s,c,l,g,i)).filter((0,o.A)(s))}},85773:(e,n,t)=>{t.d(n,{PM:()=>s,YZ:()=>o,lt:()=>i});var r=t(82732),u=t(45849),a=t(22043),o=function(e,n){return(0,u._)((0,r._)({},e),{sortIndex:n})},i=function(e){return(0,u._)((0,r._)({},e),{sortIndex:void 0})},s=function(e){return function(n,t){if(!e)return 0;var r=(0,a._)(e.split("_"),2),u=r[0],o=r[1],i=n[u],s=t[u],c="desc"===o?-1:1;return i&&s?i>s?c:i<s?-c:n.sortIndex<t.sortIndex?c:-c:0}}},86539:(e,n,t)=>{t.d(n,{t:()=>r,z:()=>u});var r="ROOT",u=function(e){return{id:r,slug:"",created:"",title:"Home",coverImage:"",images:[],groups:[],tags:[],allImages:e}}},89386:(e,n,t)=>{t.d(n,{Z:()=>a});var r=t(12115),u=t(96471),a=function(){return(0,r.useContext)(u.K)}},96471:(e,n,t)=>{t.d(n,{GalleryTreeContext:()=>p,K:()=>d});var r=t(22043),u=t(95155),a=t(81863),o=t(12115),i=t(25969),s=t(50751),c=t(52556),l=t(15431),f=t(86539),g="/gallery/",d=(0,o.createContext)({root:(0,f.z)([]),view:(0,f.z)([]),images:[],covers:[],paths:[],pathsOptions:[],isWorking:!1,pageIndex:0,path:"",lastGalleryLink:"",getUrl:function(){return"".concat(g,"?page=1")}});function p(e){var n=e.children,p=(0,c.h)(),h=p.imageGroups,v=p.images,m=p.setImageGroups,E=(0,r._)((0,o.useState)(!0),2),I=E[0],T=E[1],R=(0,r._)((0,o.useState)((0,f.z)(v)),2),_=R[0],w=R[1],F=(0,r._)((0,o.useState)([]),2),L=F[0],b=F[1],x=(0,r._)((0,o.useState)([]),2),X=x[0],y=x[1],C=(0,i.j)(),M=C.searchParams,N=C.pathname,S=(0,r._)((0,o.useState)(""),2),O=S[0],A=S[1],P=(0,l.A)().enableDebug,G=(0,s.A)().setError;(0,o.useEffect)(function(){var e=new Worker(t.tu(new URL(t.p+t.u(5647),t.b)),{type:void 0}),n=(0,a.LV)(e),r=[],u=(0,a.BX)(function(e){r.push(e)});return T(!0),n.calculate({imageGroups:h,stateImages:v},u).then(function(e){if(w(e.root),b(e.paths),y(e.pathsOptions),r.length&&G(Error(r.join("\n"))),h.length>e.paths.length){var n=e.paths.map(function(e){return e.group.id});m(h.filter(function(e){var t=e.id;return n.includes(t)}))}P&&console.info("worker ran for ".concat(e.duration.toFixed(2),"ms"))}).catch(function(e){console.error(e),G(e)}).finally(function(){T(!1),e.terminate()}),function(){e.terminate(),T(!1)}},[P,h,G,m,v]);var k=(0,o.useMemo)(function(){var e;return parseInt(null!=(e=M.get("page"))?e:"1",10)-1},[M]),U=(0,o.useMemo)(function(){return M.get("group")||""},[M]),H=(0,o.useCallback)(function(e){var n="number"==typeof e.pageIndex?e.pageIndex:k,t="string"==typeof e.group?e.group:U,r="".concat(g,"?page=").concat(n+1);return t.length&&(r="".concat(r,"&group=").concat(encodeURIComponent(t))),r},[k,U]);(0,o.useEffect)(function(){N===g&&A(H({pageIndex:k,group:U}))},[U,k,N,H]);var B=(0,o.useMemo)(function(){var e,n=(null==(e=L.find(function(e){return e.absolutePath===U}))?void 0:e.group)||_,t=n.groups.map(function(e){return e.coverImage}),r=n.images.filter(function(e){return!t.includes(e.hash)});return{view:n,covers:t,paths:L,images:r,pathsOptions:X,root:_,isWorking:I,pageIndex:k,path:U,lastGalleryLink:O,getUrl:H}},[L,_,X,I,k,U,O,H]);return(0,u.jsx)(d.Provider,{value:B,children:n})}}}]);