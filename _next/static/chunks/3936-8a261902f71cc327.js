"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3936],{633:(e,t,n)=>{n.d(t,{g:()=>f});var r=n(12115),a=n(41186),i=n(3381),u=n(71620),o=n(48675),c=n(46498),s=n(11760),l=n(24463),f=function(){var e=(0,a.A)(),t=e.dismissDialog,n=e.setDialog,f=(0,i.A)(),F=f.cancelEditFrame,m=f.cancelEditImages,p=f.cancelEditPalette,d=(0,u.A)(),h=d.updateRecentImports,g=d.updateImageSelection,A=(0,o.A)().importQueueCancel,v=(0,c.A)().setPrinterBusy,_=(0,s.h)(),D=_.addImages,E=_.deleteImages,b=_.setImageGroups,y=_.updateFrameGroups,I=_.updateImageHash,S=_.updateImages,B=_.setFrames,w=_.setImages,C=_.setPalettes,P=(0,l.A)().setSyncLastUpdate;return(0,r.useMemo)(function(){var e=function(){return P("local",Math.floor(new Date().getTime()/1e3))},r=function(){v(!1),A()};return{addImages:function(n){D(n),t(0),e(),r(),h(n)},deleteImages:function(n){E(n),g(u.N.REMOVE,n),t(0),e()},dismissDialog:t,globalUpdate:function(t){F(),p(),m(),t.lastUpdateUTC?P("local",t.lastUpdateUTC):e(),t.palettes&&C(t.palettes),t.images&&(w(t.images),h(t.images)),t.frames&&B(t.frames),t.frameGroups&&y(t.frameGroups),t.imageGroups&&b(t.imageGroups)},importQueueCancel:r,setDialog:n,updateImageHash:function(t,n){m(),e(),I(t,n)},updateImages:function(t){S(t),e()},updateLastSyncLocalNow:e}},[D,F,m,p,E,t,A,n,B,w,C,b,v,P,y,I,g,S,h])}},2608:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(97004),a=n(87025),i=n(39249),u=n(5432),o=n(72623),c=function(){var e=(0,r._)(function(e,t,n){var r,c;return(0,i.YH)(this,function(i){switch(i.label){case 0:return[4,(0,o.Hh)(e)];case 1:return r=(i.sent()||[]).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.join(" "))||""}).reduce(function(e,t,n){return n%40?(0,a._)(e).concat([t]):(0,a._)(e).concat([u.g0,t])},[]),c=[u.dm].concat((0,a._)(r),[u.R2,u.Ys]).join("\n"),[2,{folder:"images",filename:"".concat(n,".txt"),blob:new Blob(Array(c),{type:"text/plain"}),title:t}]}})});return function(t,n,r){return e.apply(this,arguments)}}()},3381:(e,t,n)=>{n.d(t,{A:()=>r});let r=(0,n(65453).v)(function(e){return{editFrame:null,editPalette:null,pickColors:null,editImageGroup:null,editImages:null,editRGBNImages:[],setEditFrame:function(t){return e({editFrame:t})},setEditImageGroup:function(t){return e({editImageGroup:t})},setEditPalette:function(t){return e({editPalette:t,pickColors:null})},setEditRGBNImages:function(t){return e({editRGBNImages:t})},setPickColors:function(t){return e({pickColors:t})},setEditImages:function(t){return e({editImages:t})},cancelEditFrame:function(){return e({editFrame:null})},cancelEditImageGroup:function(){return e({editImageGroup:null})},cancelEditPalette:function(){return e({editPalette:null})},cancelEditRGBNImages:function(){return e({editRGBNImages:[]})},cancelPickColors:function(){return e({pickColors:null})},cancelEditImages:function(){return e({editImages:null})}}})},5415:(e,t,n)=>{n.d(t,{R:()=>s,j:()=>_});var r=n(97004),a=n(39249),i=n(91540),u=n(59311),o=n.n(u),c=n(31533);let s=function(e){var t;return t=(0,r._)(function(t){var n,r,u,s;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(1===t.length)return n=t[0],[2,(0,i.saveAs)(n.blob,n.filename)];return r=new(o()),[4,Promise.all(t.map(function(e){var t,n=e.filename;return("function"==typeof(t=e.blob).arrayBuffer?t.arrayBuffer():new Promise(function(e){var n=new FileReader;n.onload=function(t){if(!t.target)throw Error("no file");var n=t.target.result;if("string"==typeof n||null===n)throw Error("unexpected filereader result");e(n)},n.readAsArrayBuffer(t)})).then(function(e){return{filename:n,arrayBuffer:e}})}))];case 1:return u=a.sent(),(0,c.A)(u).forEach(function(e){var t=e.filename,n=e.arrayBuffer;r.file(t,n)}),[4,r.generateAsync({type:"blob",compression:"DEFLATE"})];case 2:if(s=a.sent(),!e)throw Error("missing filename");return[2,(0,i.saveAs)(s,"".concat(e,".zip"))]}})}),function(e){return t.apply(this,arguments)}};var l=n(693),f=n(60376),F=n(87025),m=n(15905),p=n(28952),d=n(18335),h=n(77683),g=n(86964),A=n(55364),v=n(2608);let _=function(e,t,n,i,u){return function(o){var c;return c=(0,r._)(function(c,s){var _,D,E,b,y,I,S,B,w;return(0,a.YH)(this,function(C){switch(C.label){case 0:var P;if(_=(0,A.pl)(o),D=o.lockFrame||!1,E=o.rotation||0,y=(b=(0,d.s)(i,o)).palette,I=b.framePalette,!y)throw Error("Palette missing?");return P=(0,r._)(function(e,t){var r,i,u,F;return(0,a.YH)(this,function(a){return _?[2,(0,m.y1)({tiles:c,palette:y,lockFrame:D,imageStartLine:s,rotation:E,scaleFactor:t,handleExportFrame:n},e)]:(i=(r=(0,g.f)(o)).invertPalette,u=r.invertFramePalette,F=(0,h.C)({imagePalette:y.palette||m.CU,framePalette:(null==I?void 0:I.palette)||m.CU,invertPalette:i,invertFramePalette:u}),[2,(0,m.Yn)((0,f._)((0,l._)({tiles:c,rotation:E,scaleFactor:t,handleExportFrame:n},F),{imageStartLine:s}),e)])})}),S=function(e,t){return P.apply(this,arguments)},B=(0,F._)(e).filter(function(e){return"number"==typeof e}),w=(0,F._)(t),B.length||B.push(4),w.length||w.push("png"),[4,Promise.all(B.map(function(e){return w.map(function(t){return new Promise(function(n){var r=(0,p.A)({image:o,palette:y,exportScaleFactor:e,fileNameStyle:u});switch(t){case"txt":if(_)return void n(null);(0,v.Z)(o.hash,o.title,r).then(n);break;case"pgm":if(_)return void n(null);S("image/png",e).then(createImageBitmap).then(function(e){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var i=a.getContext("2d");i.drawImage(e,0,0);var u=y.palette;if(!i||!(null==u?void 0:u.length))return void n(null);for(var c=["P2","#","# Exported from ".concat(window.location.origin),"#","# hash: ".concat(o.hash),"# created: ".concat(o.created),"# title: ".concat(o.title),"# tags: ".concat(o.tags.join(", ")),"# dimension: ".concat(a.width,"*").concat(a.height," pixels"),"#","".concat(a.width," ").concat(a.height),"3","#"],s=0;s<a.height;s+=1){for(var l=[],f=0;f<a.width;f+=1){var F=i.getImageData(f,s,1,1).data,p=["#",F[0].toString(16).padStart(2,"0"),F[1].toString(16).padStart(2,"0"),F[2].toString(16).padStart(2,"0")].join(""),d=y.palette.indexOf(p);-1===d&&(d=m.eJ.indexOf(parseInt(p.slice(1),16))),l.push(3-d)}c.push(l.join(" "))}n({filename:"".concat(r,".").concat(t),blob:new Blob([c.join("\n")],{type:"text/plain"}),title:o.title})});break;default:S("image/".concat(t),e).then(function(e){n({filename:"".concat(r,".").concat(t),blob:e,title:o.title})}).catch(function(){return n(null)})}})})}).flat())];case 1:return[2,C.sent().reduce(function(e,t){return t?(0,F._)(e).concat([t]):e},[])]}})}),function(e,t){return c.apply(this,arguments)}}}},6732:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(87025),a={"":"006666666600FFFF"," ":"FFFFFFFFFFFFFFFF",0:"FFDDAAAAAADDFFFF",1:"FFDD99DDDDDDFFFF",2:"FF99EEDDBB88FFFF",3:"FF99EE99EE99FFFF",4:"FFDDBBBB88EEFFFF",5:"FF88BB99EE99FFFF",6:"FFCCBB99AADDFFFF",7:"FF88EEDDBBBBFFFF",8:"FFDDAADDAADDFFFF",9:"FFDDAACCEE99FFFF",a:"FFDDAAAA88AAFFFF",b:"FF99AA99AA99FFFF",c:"FFCCBBBBBBCCFFFF",d:"FF99AAAAAA99FFFF",e:"FF88BB99BB88FFFF",f:"FF88BB99BBBBFFFF",g:"FFCCBBAAAACCFFFF",h:"FFAAAA88AAAAFFFF",i:"FF88DDDDDD88FFFF",j:"FF99DDDDDDBBFFFF",k:"FFAAAA99AAAAFFFF",l:"FFBBBBBBBB88FFFF",m:"FFAA888AAAAAFFFF",n:"FFAA8A888AAAFFFF",o:"FFDDAAAAAADDFFFF",p:"FF99AA99BBBBFFFF",q:"FFDDAAAAAACCFFFF",r:"FF99AA99AAAAFFFF",s:"FFCCBBDDEE99FFFF",t:"FF88DDDDDDDDFFFF",u:"FFAAAAAAAACCFFFF",v:"FFAAAAAAAADDFFFF",w:"FFAAAA8A88AAFFFF",x:"FFAAAADDAAAAFFFF",y:"FFAAAADDDDDDFFFF",z:"FF88EEDDBB88FFFF",ä:"AADDAAAA88AAFFFF",ö:"AADDAAAAAADDFFFF",ü:"AAAFAAAAAACCFFFF",ß:"FF99AA99AA99BBFF",".":"FFFFFFFFFFDDFFFF","!":"DDDDDDDDFFDDFFFF","?":"DDAAEEDDFFDDFFFF","-":"FFFFFF88FFFFFFFF",_:"FFFFFFFFFF88FFFF",":":"FFFFDDFFDDFFFFFF"};let i=function(e){var t=(0,r._)(e.toString(10).toLowerCase().split("")).concat([" "," "]),n=t.shift()||"",i=t.shift()||"",u=a[n]||a[""],o=a[i]||a[""];return(0,r._)(Array(16)).map(function(e,t){return"".concat(u[t]).concat(o[t])}).join("")};var u="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n";let o=function(e){var t=[],n=e.split("\n").map(function(e){return e.match(/.{1,32}/g)}).flat().map(function(e){return e||""}).map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.padEnd(32," ")}).map(function(e){var t;return(null==(t=e.match(/.{1,2}/g))?void 0:t.map(function(e){return i(e)}))||[]}).map(function(e){return[u,u].concat((0,r._)(e),[u,u])}).flat();for(t.push.apply(t,(0,r._)((0,r._)(Array(40)).map(function(){return u}))),t.push.apply(t,(0,r._)(n));t.length<360;)t.push(u);return t}},18335:(e,t,n)=>{n.d(t,{s:()=>i});var r=n(5432),a=n(55364),i=function(e,t){if((0,a.pl)(t))return{palette:t.palette};var n=e.find(function(e){return e.shortName===t.palette})||r.Fv,i=e.find(function(e){return e.shortName===t.framePalette})||r.Fv;return{palette:n,framePalette:t.lockFrame?i:n}}},24463:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(86447),a=n(693),i=n(60376),u=n(65453),o=n(46786),c=n(10746);let s=(0,u.v)((0,o.eh)((0,o.Zr)(function(e){return{dropboxStorage:{},gitStorage:{},syncLastUpdate:{dropbox:0,local:0},dropboxLogout:function(){return e(function(e){return{dropboxStorage:{use:e.dropboxStorage.use}}})},setDropboxStorage:function(t){return e(function(e){var n=e.dropboxStorage;return{dropboxStorage:(0,a._)({},n,t)}})},setGitStorage:function(t){return e(function(e){var n=e.gitStorage;return{gitStorage:(0,a._)({},n,t)}})},setSyncLastUpdate:function(t,n){return e(function(e){var u=e.syncLastUpdate;return{syncLastUpdate:(0,i._)((0,a._)({},u),(0,r._)({},t,n))}})}}},{name:"".concat(c.z,"-storages"),storage:(0,o.KU)(function(){return localStorage})})))},28952:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(30832),a=n.n(r),i=n(35009),u=n(81445),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.reduce(function(e,n){return n?"".concat(e).concat(e?t:"").concat(n):e},"")},c=function(e){var t=e.r,n=e.g,r=e.b,a=e.n,i=function(e){return e.toString(16).padStart(2,"0")};return o([(null==t?void 0:t.map(i).join(""))||"",(null==n?void 0:n.map(i).join(""))||"",(null==r?void 0:r.map(i).join(""))||"",(null==a?void 0:a.map(i).join(""))||""],".")};let s=function(e){var t,n,r=e.image||null,s=e.palette||null,l=e.exportScaleFactor||null,f=e.useCurrentDate||null,F=(null==(t=e.frameRate)?void 0:t.toString(10))||"",m=e.altTitle||"",p=e.frameName||"",d=e.paletteShort||"",h=e.fileNameStyle,g=!f&&(null==r?void 0:r.created)?a()(new Date(r.created)):a()(),A=g.isValid()?g.format("YYYYMMDD-HHmmss"):"",v=d||(s?s.shortName||c(s):""),_=r&&r.title?r.title:m;switch(h){case u.B.TITLE_ONLY:n=[_];break;case u.B.DATE_TITLE:n=[A,_];break;case u.B.FULL:default:n=[A,_,l?"".concat(l,"x"):"",F?"".concat(F,"fps"):"",p,v]}var D=o(n);return(0,i.A)(D,{replacement:""})}},31533:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(693),a=n(60376);let i=function(e){var t=[];return e.map(function(e){var n=e.filename,i=n.split("."),u=i.pop();if(!u)throw Error("unknown file type");for(var o=i.join("."),c=n,s=0;t.includes(c);)s+=1,c="".concat(o,"_(").concat(s,").").concat(u);return t.includes(c)||t.push(c),(0,a._)((0,r._)({},e),{filename:c})})}},41186:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(87025);let a=(0,n(65453).v)(function(e){return{dialogs:[],dismissDialog:function(t){return e(function(e){return{dialogs:e.dialogs.filter(function(e,n){return t!==n})}})},setDialog:function(t){return e(function(e){var n=e.dialogs;return{dialogs:[t].concat((0,r._)(n))}})}}})},46498:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(693),a=n(60376),i=n(87025),u=n(30832),o=n.n(u),c=n(9779),s=n(51368);let l=(0,n(65453).v)(function(e,t){return{dragover:!1,errors:[],isFullscreen:!1,lightboxImage:null,printerBusy:!1,printerData:null,printerFunctions:[],showSerials:!1,syncBusy:!1,syncSelect:!1,trashCount:{frames:0,images:0,show:!1},videoSelection:[],dismissError:function(n){return e({errors:t().errors.filter(function(e,t){return t!==n})})},setDragover:function(t){return e({dragover:t})},setError:function(n){return e({errors:(0,i._)(t().errors).concat([{error:n,timestamp:o()().unix(),id:(0,s.A)()}])})},setIsFullscreen:function(t){return e({isFullscreen:t})},setPrinterBusy:function(t){return e({printerBusy:t})},setPrinterData:function(t){return e({printerData:t})},setPrinterFunctions:function(t){return e({printerFunctions:t})},setShowSerials:function(t){return e({showSerials:t})},setSyncBusy:function(t){return e({syncBusy:t})},setSyncSelect:function(t){return e({syncSelect:t})},showTrashCount:function(n){return e({trashCount:(0,a._)((0,r._)({},t().trashCount),{show:n})})},updateTrashCount:function(n,i){return e({trashCount:(0,a._)((0,r._)({},t().trashCount),{frames:n,images:i})})},setVideoSelection:function(t){return e({videoSelection:t})},setLightboxImage:function(t){null===t&&c.A.exit(),e({lightboxImage:t})},setLightboxImageNext:function(n){var r=t().lightboxImage;null!==r&&e({lightboxImage:Math.min(r+1,n-1)})},setLightboxImagePrev:function(){var n=t().lightboxImage;null!==n&&e({lightboxImage:Math.max(n-1,0)})}}})},47639:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(97004),a=n(87025),i=n(39249),u=n(15905),o=n(53982);let c=function(){var e=(0,r._)(function(e,t){var n,r,c,s,l,f;return(0,i.YH)(this,function(i){switch(i.label){case 0:if(360!==e.length)return[2,e];return[4,(0,o.mZ)(t)];case 1:if(!(r=i.sent()))return[2,e];if(14!==r.left.length||14!==r.right.length)return console.error("Invalid frameData"),[2,e];for(l=0,c=e.reduce(function(e,t,n){return(0,u.o1)(n,2,u.H.FRAMEMODE_KEEP)?e:(0,a._)(e).concat([t])},[]),s=(0,a._)(r.upper);l<14;l+=1)(f=s).push.apply(f,(0,a._)(r.left[l]).concat((0,a._)(c.slice(16*l,(l+1)*16)),(0,a._)(r.right[l])));return(n=s).push.apply(n,(0,a._)(r.lower)),[2,s]}})});return function(t,n){return e.apply(this,arguments)}}()},48675:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(87025);let a=(0,n(65453).v)(function(e,t){return{bitmapQueue:[],frameQueue:[],importQueue:[],bitmapQueueAdd:function(t){return e(function(e){var n=e.bitmapQueue;return{bitmapQueue:(0,r._)(n).concat((0,r._)(t))}})},bitmapQueueCancel:function(){return e({bitmapQueue:[]})},frameQueueAdd:function(t){return e(function(e){var n=e.frameQueue;return{frameQueue:(0,r._)(n).concat((0,r._)(t))}})},frameQueueCancelOne:function(t){return e(function(e){return{frameQueue:e.frameQueue.filter(function(e){return e.tempId!==t})}})},importQueueAdd:function(n){var a=t(),i=a.bitmapQueue,u=a.importQueue,o=n.map(function(e){return e.fileName});e({bitmapQueue:i.filter(function(e){var t=e.fileName;return!o.includes(t)}),importQueue:(0,r._)(u).concat((0,r._)(n))})},importQueueSet:function(t){e({importQueue:t})},importQueueCancel:function(){e({importQueue:[]})},importQueueCancelOne:function(t){return e(function(e){return{importQueue:e.importQueue.filter(function(e){return e.tempId!==t})}})},getImportItem:function(e){return t().importQueue.find(function(t){return t.tempId===e})||null}}})},50263:(e,t,n)=>{n.d(t,{K:()=>c,U:()=>o});var r=n(97004),a=n(39249),i=n(98933),u=n.n(i),o=function(){var e=(0,r._)(function(e){return(0,a.YH)(this,function(t){return[2,u().inflate(e,{to:"string"})]})});return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,r._)(function(e){return(0,a.YH)(this,function(t){return[2,u().deflate(e,{to:"string",strategy:1,level:8})]})});return function(t){return e.apply(this,arguments)}}()},53982:(e,t,n)=>{n.d(t,{Bf:()=>s,mZ:()=>f,R_:()=>l});var r=n(97004),a=n(39249),i=function(e){return e.toUpperCase()},u=function(e,t){var n=e.slice(0,20*t).map(i),r=e.slice((t+14)*20).map(i);return{upper:n,left:Array(14).fill(0).map(function(n,r){var a=(r+t)*20;return e.slice(a,a+2).map(i)}),right:Array(14).fill(0).map(function(n,r){var a=(r+t)*20;return e.slice(a+18,a+20).map(i)}),lower:r}},o=n(75380),c=n(50263),s=function(){var e=(0,r._)(function(e,t){var r,i,o;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(n.t.bind(n,52491,23))];case 1:return r=a.sent().default,i=JSON.stringify(u(e,t)),[4,(0,c.K)(i)];case 2:return o=a.sent(),[2,{dataHash:r(o),compressed:o}]}})});return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=(0,r._)(function(e,t){var n,r,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,s(e,t)];case 1:return r=(n=a.sent()).dataHash,i=n.compressed,[4,o.Uv.setItem(r,i)];case 2:return a.sent(),[2,r]}})});return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=(0,r._)(function(e){var t,n,r;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];return[4,o.Uv.getItem(e)];case 1:if(!(t=a.sent()))return[2,null];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,(0,c.U)(t)];case 3:return n=a.sent(),[3,5];case 4:return a.sent(),[2,null];case 5:try{return[2,JSON.parse(n)]}catch(e){}try{return r=n.split("\n"),[2,{upper:r.slice(0,40),left:Array(14).fill(0).map(function(e,t){return r.slice(4*t+40,4*t+42)}),right:Array(14).fill(0).map(function(e,t){return r.slice(4*t+42,4*t+44)}),lower:r.slice(96,136)}]}catch(e){return[2,null]}}})});return function(t){return e.apply(this,arguments)}}()},56491:(e,t,n)=>{n.d(t,{A:()=>i});var r=function(e,t,n){var r=n.find(function(t){return t.id===e});if(r)return r.name;switch(e){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return t}},a=function(e){switch(e){case"int":return"_1";case"jp":return"_2";case"hk":return"_3";default:return e}};let i=function(e,t){return e.reduce(function(e,n){var a=n.id,i=n.name;try{var u,o=null==(u=a.match(/^[a-z]+/g))?void 0:u[0];if(!o)return e;return e.find(function(e){return e.id===o})||e.push({id:o,name:r(o,i,t)}),e}catch(t){return e}},[]).sort(function(e,t){var n=e.id,r=t.id,i=a(n),u=a(r);return i>u?1:i<u?-1:0})}},69176:(e,t,n)=>{n.d(t,{m:()=>_});var r=n(97004),a=n(693),i=n(60376),u=n(39249),o=n(69229),c=n(71620),s=n(11760),l=n(56491),f=n(75380),F=function(){var e=(0,r._)(function(e){var t,n;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.map((i=(0,r._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.Uv.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),n={},t.forEach(function(e){var t=e.hash,r=e.data;r&&(n["frame-".concat(t)]=r)}),[2,n]}})});return function(t){return e.apply(this,arguments)}}();let m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(e){case"frames":return t;case"current_framegroup":return t.filter(function(e){return e.id.startsWith(n)});default:return[]}},p=function(e,t,n){switch(e){case"images":return t.map(function(e){return e.hash});case"selected_images":return n;default:return[]}};var d=n(87025),h=n(55364),g=n(55685),A=function(){var e=(0,r._)(function(e){var t,n;return(0,u.YH)(this,function(a){switch(a.label){case 0:var i;return[4,Promise.all(e.reduce(function(e,t){var n=(0,h.pl)(t)?(0,g.A)(Object.values(t.hashes)):[t.hash];return(0,d._)(e).concat((0,d._)(n))},[]).map((i=(0,r._)(function(e){return(0,u.YH)(this,function(t){switch(t.label){case 0:return[4,f.mU.getItem(e)];case 1:return[2,{hash:e,data:t.sent()}]}})}),function(e){return i.apply(this,arguments)})))];case 1:return t=a.sent(),n={},t.forEach(function(e){var t=e.hash,r=e.data;r&&(n[t]=r)}),[2,n]}})});return function(t){return e.apply(this,arguments)}}(),v=function(e){switch(e){case o.m.ALL:case o.m.JSON_EXPORT:return["frameGroups","frames","imageGroups","images","palettes","plugins"];case o.m.SELECTED_IMAGES:return["images"];case o.m.IMAGES:return["images","imageGroups"];case o.m.PALETTES:return["palettes"];case o.m.FRAMES:case o.m.CURRENT_FRAMEGROUP:return["frames","frameGroups"];case o.m.PLUGINS:return["plugins"];default:return[]}},_=function(){var e=(0,r._)(function(e){var t,n,r,f,d,h,g,_,D,E,b,y,I,S,B,w,C,P,U=arguments;return(0,u.YH)(this,function(u){switch(u.label){case 0:if(n=(t=U.length>1&&void 0!==U[1]?U[1]:{}).lastUpdateUTC,r=t.selectedFrameGroup,g=(h=s.h.getState()).frames,_=h.images,D=h.palettes,E=h.imageGroups,b=h.frameGroups,y=h.plugins,I=c.A.getState().imageSelection,S=(0,i._)((0,a._)({},v(e).reduce(function(t,n){switch(n){case"frameGroups":return(0,i._)((0,a._)({},t),{frameGroups:e===o.m.CURRENT_FRAMEGROUP?b.filter(function(e){return e.id===r}):(0,l.A)(g,b)});case"frames":var u=e===o.m.FRAMES?o.m.FRAMES:o.m.CURRENT_FRAMEGROUP;return(0,i._)((0,a._)({},t),{frames:m(u,g,r)});case"imageGroups":return(0,i._)((0,a._)({},t),{imageGroups:E});case"images":var c=p(e===o.m.SELECTED_IMAGES?"selected_images":"images",_,I);return(0,i._)((0,a._)({},t),{images:_.filter(function(e){var t=e.hash;return c.includes(t)})});case"palettes":return(0,i._)((0,a._)({},t),{palettes:D.filter(function(e){return!e.isPredefined})});case"plugins":return(0,i._)((0,a._)({},t),{plugins:y});default:return t}},{})),{lastUpdateUTC:n||Math.floor(new Date().getTime()/1e3),version:s.A}),B={},!((null==(f=S.images)?void 0:f.length)&&[o.m.IMAGES,o.m.SELECTED_IMAGES,o.m.ALL].includes(e)))return[3,2];return w=[{},B],[4,A(S.images)];case 1:B=a._.apply(void 0,w.concat([u.sent()])),u.label=2;case 2:if(!((null==(d=S.frames)?void 0:d.length)&&[o.m.FRAMES,o.m.CURRENT_FRAMEGROUP,o.m.ALL].includes(e)))return[3,4];return C=e===o.m.CURRENT_FRAMEGROUP?o.m.CURRENT_FRAMEGROUP:o.m.FRAMES,P=[{},B],[4,F(m(C,g,r).map(function(e){return e.hash}))];case 3:B=a._.apply(void 0,P.concat([u.sent()])),u.label=4;case 4:return[2,JSON.stringify((0,a._)({state:S},B),null,2)]}})});return function(t){return e.apply(this,arguments)}}()},69229:(e,t,n)=>{n.d(t,{m:()=>r});var r=function(e){return e.ALL="all",e.JSON_EXPORT="json_export",e.FRAMES="frames",e.CURRENT_FRAMEGROUP="current_framegroup",e.IMAGES="images",e.SELECTED_IMAGES="selected_images",e.PALETTES="palettes",e.PLUGINS="plugins",e}({})},71620:(e,t,n)=>{n.d(t,{A:()=>m,N:()=>F});var r=n(87025),a=n(30832),i=n.n(a),u=n(65453),o=n(46786),c=n(55364),s=n(55685),l=n(85546),f=n(10746),F=function(e){return e.ADD="add",e.REMOVE="remove",e}({});let m=(0,u.v)((0,o.Zr)(function(e,t){return{filtersActiveTags:[],filtersVisible:!1,imageSelection:[],lastSelectedImage:null,recentImports:[],sortBy:"created_asc",sortOptionsVisible:!1,setFiltersActiveTags:function(t){return e({filtersActiveTags:t,filtersVisible:!1})},setFiltersVisible:function(t){return e({filtersVisible:t})},setImageSelection:function(t){return e({imageSelection:t,lastSelectedImage:null})},setSortBy:function(t){return e({sortBy:t,sortOptionsVisible:!1})},setSortOptionsVisible:function(t){return e({sortOptionsVisible:t})},cleanRecentImports:function(n){var r=t().recentImports,a=i()().subtract(6,"hour").unix();e({recentImports:r.filter(function(e){var t=e.hash,r=e.timestamp;return n.includes(t)&&r>a})})},updateRecentImports:function(n){var a=t().recentImports,u=n.reduce(function(e,t){return(0,c.pl)(t)?e:(0,r._)(e).concat([{hash:t.hash,timestamp:i()().unix()}])},[]);e({recentImports:(0,l.A)("hash")((0,r._)(a).concat((0,r._)(u)))})},updateImageSelection:function(n,a){var i=t().imageSelection;switch(n){case"add":e({imageSelection:(0,s.A)((0,r._)(i).concat((0,r._)(a))),lastSelectedImage:a[0]});break;case"remove":e({imageSelection:i.filter(function(e){return!a.includes(e)}),lastSelectedImage:null})}}}},{name:"".concat(f.z,"-filters"),storage:(0,o.KU)(function(){return localStorage})}))},72623:(e,t,n)=>{n.d(t,{cg:()=>l,yH:()=>m,t9:()=>p,Hh:()=>F,UN:()=>f});var r=n(97004),a=n(39249),i=n(47639),u=n(75380),o=n(50263),c=n(6732);let s=function(e){var t="\nThe following hash is missing in\nyour indexedDb:\n".concat(e,"\n\nEither you imported a debug dump\nor your browser decided to do a\ncleanup.\n\nThis image might be able to be\nrecovered if you have set up git\nor dropbox sync.\n").trim();return(0,c.A)(t)};var l=function(){var e=(0,r._)(function(e){var t,r,i;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(n.t.bind(n,52491,23))];case 1:return t=a.sent().default,r=e.map(function(e){return e.replace(/ /gi,"").toUpperCase()}).join("\n"),[4,(0,o.K)(r)];case 2:return i=a.sent(),[2,{dataHash:t(i),compressed:i}]}})});return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,r._)(function(e){var t,n,r;return(0,a.YH)(this,function(a){switch(a.label){case 0:return[4,l(e)];case 1:return n=(t=a.sent()).dataHash,r=t.compressed,[4,u.mU.setItem(n,r)];case 2:return a.sent(),[2,n]}})});return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,r._)(function(e,t,n,r){var c,l;return(0,a.YH)(this,function(a){switch(a.label){case 0:if(!e)return[2,null];a.label=1;case 1:return a.trys.push([1,4,,5]),[4,u.mU.getItem(e)];case 2:if(!(c=a.sent()))throw Error("missing imagedata");return[4,(0,o.U)(c)];case 3:if(l=a.sent().split("\n"),!t)return[2,l];return[2,(0,i.A)(l,t)];case 4:return a.sent(),"function"==typeof r&&r(e),[2,n?[]:s(e)];case 5:return[2]}})});return function(t,n,r,a){return e.apply(this,arguments)}}(),m=function(){var e=(0,r._)(function(e){return(0,a.YH)(this,function(t){return[2,u.mU.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,r._)(function(e){return(0,a.YH)(this,function(t){return[2,u.Uv.removeItem(e)]})});return function(t){return e.apply(this,arguments)}}()},77683:(e,t,n)=>{n.d(t,{C:()=>u});var r=n(87025),a=n(15905),i=function(e){var t=e.replace("#","");if(!/^([0-9a-fA-F]{6})$/.test(t))throw Error("Invalid hex color");return parseInt(t,16)},u=function(e){var t=e.imagePalette,n=e.framePalette,u=e.invertPalette,o=e.invertFramePalette,c=(t||a.CU).map(i),s=(null==n?void 0:n.map(i))||c;return{imagePalette:void 0!==u&&u?(0,r._)(c).reverse():(0,r._)(c),framePalette:void 0!==o&&o?(0,r._)(s).reverse():(0,r._)(s)}}},81445:(e,t,n)=>{n.d(t,{B:()=>r,y:()=>a});var r=function(e){return e.FULL="FULL",e.TITLE_ONLY="TITLE_ONLY",e.DATE_TITLE="DATE_TITLE",e}({}),a=[{id:"FULL",name:"Full Title"},{id:"DATE_TITLE",name:"Date and Title"},{id:"TITLE_ONLY",name:"Title only"}]},83936:(e,t,n)=>{n.d(t,{W:()=>b});var r=n(97004),a=n(39249),i=n(12115),u=n(633),o=n(11760),c=n(52324),s=n(5415),l=n(69176),f=n(75380),F=n(693),m=n(60376),p=n(87025),d=n(85546),h=function(e){var t=(0,d.A)(e);return function(n,r){var a=new Map(n.map(function(t){return[t[e],t]})),i=r.map(function(t){var n=a.get(t[e]);return n?(0,F._)({},n,t):t});return t((0,p._)(i).concat((0,p._)(n)))}},g=h("hash"),A=h("id"),v=h("shortName"),_=h("id");let D=function(e,t,n,r,a,i){var u=e,o=n,c=t,s=r;return i?(a.frames&&a.frames.length&&(u=A(u,a.frames)),a.images&&a.images.length&&(o=g(o,a.images)),a.palettes&&a.palettes.length&&(c=v(c,a.palettes)),a.imageGroups&&a.imageGroups.length&&(s=_(s,a.imageGroups))):(u=a.frames||e,o=a.images||n,c=a.palettes||t,s=a.imageGroups||r),(0,m._)((0,F._)({},a),{images:o,frames:u,palettes:c,imageGroups:s})};var E=function(){var e=(0,r._)(function(e){var t,n,r,i,u,s,l,F=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=F.length>1&&void 0!==F[1]&&F[1],r=(n=o.h.getState()).frames,i=n.palettes,u=n.images,s=n.imageGroups,[4,(0,c.i)(e)];case 1:return Object.keys(l=a.sent()).forEach(function(e){if("state"!==e){var t=l[e];e.match(/^[a-f0-9]{40,}$/gi)?f.mU.setItem("".concat(e),t):e.startsWith("frame-")&&f.Uv.setItem("".concat(e.split("frame-").pop()),t)}}),[2,D(r,i,u,s,l.state||{},t)]}})});return function(t){return e.apply(this,arguments)}}(),b=function(){var e,t,n,o=(0,u.g)().globalUpdate;return{downloadSettings:(0,i.useCallback)((e=(0,r._)(function(e){var t,n,r,i=arguments;return(0,a.YH)(this,function(a){switch(a.label){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:"",[4,(0,l.m)(e,{selectedFrameGroup:t})];case 1:return n=a.sent(),r="frames"===e?"frames":[e,t].filter(Boolean).join("_"),(0,s.R)(null)([{blob:new Blob(Array(n)),filename:"".concat(r,".json")}]),[2]}})}),function(t){return e.apply(this,arguments)}),[]),jsonImport:(0,i.useCallback)((t=(0,r._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,E(e,!0)];case 1:return o(t.sent()),[2]}})}),function(e){return t.apply(this,arguments)}),[o]),remoteImport:(0,i.useCallback)((n=(0,r._)(function(e){return(0,a.YH)(this,function(t){switch(t.label){case 0:return[4,E(e,!1)];case 1:return o(t.sent()),[2]}})}),function(e){return n.apply(this,arguments)}),[o])}}},86964:(e,t,n)=>{n.d(t,{f:()=>r});var r=function(e){var t=e.invertPalette||!1;if(!e.lockFrame)return{invertPalette:t,invertFramePalette:t};var n=e.invertFramePalette;return{invertPalette:t,invertFramePalette:void 0===n?t:n}}}}]);