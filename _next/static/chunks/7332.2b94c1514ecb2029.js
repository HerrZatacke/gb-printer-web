(()=>{var e={67332:(e,t,r)=>{"use strict";var n,i=r(97004),s=r(39249),a=r(7062),u=r(26002),c=r(65492),o=r(66214),f=r(62570),l=r(40662),d=r.n(l),v=r(86447),h=function(e){return e.USB="USB",e.SERIAL="SERIAL",e}({}),p=function(e){return e.UNKNOWN="unknown",e.INACTIVE="inactive",e.PACKET_CAPTURE="packet_capture",e.SUPER_PRINTER_INTERFACE="super_printer_interface",e.GBXCART="gbxcart",e}({});n={},(0,v._)(n,"unknown","Unknown Device"),(0,v._)(n,"inactive","Inactive Device"),(0,v._)(n,"packet_capture","Arduino Gameboy Printer Emulator"),(0,v._)(n,"super_printer_interface","Super Printer Interface"),(0,v._)(n,"gbxcart","GBxCart RW");var _=r(51368).A,b=function(){function e(t,r){(0,c._)(this,e),this.portDeviceType=p.INACTIVE,this.bannerBytes=r,this.portType=t.portType,this.description=t.getDescription(),this.id=_()}return e.prototype.getBanner=function(){var e=this;return(0,i._)(function(){return(0,s.YH)(this,function(t){return[2,e.bannerBytes]})})()},e}(),g=r(577),y=r(52491),E=r.n(y),D={QUERY_FW_INFO:161,SET_MODE_DMG:163,SET_VOLTAGE_5V:165,SET_VARIABLE:166,DMG_CART_READ:177,DMG_CART_WRITE:178},w={ADDRESS:{size:4,value:0},TRANSFER_SIZE:{size:2,value:0},BUFFER_SIZE:{size:2,value:1},DMG_ROM_BANK:{size:2,value:2},CART_MODE:{size:1,value:0},DMG_ACCESS_MODE:{size:1,value:1},FLASH_COMMAND_SET:{size:1,value:2},FLASH_METHOD:{size:1,value:3},FLASH_WE_PIN:{size:1,value:4},FLASH_PULSE_RESET:{size:1,value:5},FLASH_COMMANDS_BANK_1:{size:1,value:6},FLASH_SHARP_VERIFY_SR:{size:1,value:7},DMG_READ_CS_PULSE:{size:1,value:8},DMG_WRITE_CS_PULSE:{size:1,value:9},FLASH_DOUBLE_DIE:{size:1,value:10},DMG_READ_METHOD:{size:1,value:11},AGB_READ_METHOD:{size:1,value:12}},A={4:"v1.3",5:"v1.4",6:"v1.4a",101:"Mini v1.0d"},R=function(e){var t=e.filter(Boolean),r=new Uint8Array(t.reduce(function(e,t){return e+t.length},0)),n=0,i=!0,s=!1,a=void 0;try{for(var u,c=t[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var o=u.value;r.set(o,n),n+=o.length}}catch(e){s=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(s)throw a}}return r},T=function(){function e(t){(0,c._)(this,e),this.textDecoder=new TextDecoder,this.receiving=function(){},this.data=function(){},this.longBuffer=null,this.portDeviceType=p.PACKET_CAPTURE,this.device=t,this.portType=t.portType,this.description=t.getDescription(),this.id=_(),this.readLoop()}var t=e.prototype;return t.readLoop=function(){var e=this;return(0,i._)(function(){var t,r,n,i;return(0,s.YH)(this,function(s){switch(s.label){case 0:t=0,r=function(){var t;(null==(t=e.longBuffer)?void 0:t.byteLength)&&(e.data(e.textDecoder.decode(e.longBuffer)),e.longBuffer=null)},n=e.device,s.label=1;case 1:if(!n.canRead())return[3,3];return[4,n.read({timeout:100})];case 2:return(i=s.sent()).byteLength&&(self.clearTimeout(t),t=self.setTimeout(r,1e3),e.receiving(),e.longBuffer=R([e.longBuffer,i])),[3,1];case 3:return[2]}})})()},t.setup=function(e){var t=e.receiving,r=e.data,n=this;return(0,i._)(function(){return(0,s.YH)(this,function(e){return n.receiving=t,n.data=r,[2]})})()},e}(),P=function(){function e(t,r){(0,c._)(this,e),this.portDeviceType=p.GBXCART,this.startProgress=(n=(0,i._)(function(e){return(0,s.YH)(this,function(t){return console.log(e),[2,"#"]})}),function(e){return n.apply(this,arguments)}),this.setProgress=function(e,t){console.log("".concat(e," - ").concat(Math.round(100*t),"%"))},this.stopProgress=function(e){console.log("".concat(e," - done"))},this.device=t,this.portType=t.portType,this.id=_();var n,a=r[4];this.description="GBxCart RW ".concat(A[a]," ").concat(t.getDescription())}var t=e.prototype;return t.setFwVariable=function(e,t){var r=this;return(0,i._)(function(){var n,i,a,u,c,o;return(0,s.YH)(this,function(s){switch(s.label){case 0:return i=(n=w[e]).size,a=n.value,u=D.SET_VARIABLE,(o=new DataView(c=new ArrayBuffer(13))).setUint8(0,u),o.setUint8(1,i),o.setUint32(2,a,!1),o.setUint32(6,t,!1),o.setUint8(10,0),o.setUint8(11,0),o.setUint8(12,0),[4,r.device.send(new Uint8Array(c),[],!0)];case 1:return s.sent(),[2]}})})()},t.cartWrite=function(e,t){var r=this;return(0,i._)(function(){var n,i;return(0,s.YH)(this,function(s){switch(s.label){case 0:return(i=new DataView(n=new ArrayBuffer(6))).setUint8(0,255&D.DMG_CART_WRITE),i.setUint32(1,e,!1),i.setUint8(5,255&t),[4,r.device.send(new Uint8Array(n),[],!0)];case 1:return s.sent(),[2]}})})()},t.readRAM=function(e,t){var r=this;return(0,i._)(function(){var n;return(0,s.YH)(this,function(i){switch(i.label){case 0:if(t>64)throw Error("read size too big");return[4,r.setFwVariable("TRANSFER_SIZE",t)];case 1:return i.sent(),[4,r.setFwVariable("ADDRESS",40960+e)];case 2:return i.sent(),[4,r.setFwVariable("DMG_ACCESS_MODE",3)];case 3:return i.sent(),[4,r.setFwVariable("DMG_READ_CS_PULSE",1)];case 4:return i.sent(),n=new Uint8Array([D.DMG_CART_READ]),[4,r.device.send(n,[{length:t}],!0)];case 5:return[2,f._.apply(void 0,[i.sent(),1])[0]]}})})()},t.readROM=function(e,t){var r=this;return(0,i._)(function(){var n;return(0,s.YH)(this,function(i){switch(i.label){case 0:if(t>64)throw Error("read size too big");return[4,r.setFwVariable("TRANSFER_SIZE",t)];case 1:return i.sent(),[4,r.setFwVariable("ADDRESS",e)];case 2:return i.sent(),[4,r.setFwVariable("DMG_ACCESS_MODE",1)];case 3:return i.sent(),n=new Uint8Array([D.DMG_CART_READ]),[4,r.device.send(n,[{length:t}],!0)];case 4:return[2,f._.apply(void 0,[i.sent(),1])[0]]}})})()},t.readROMName=function(){var e=this;return(0,i._)(function(){var t,r;return(0,s.YH)(this,function(n){switch(n.label){case 0:return[4,e.setModeVoltage()];case 1:return n.sent(),t=new TextDecoder,[4,e.readROM(308,16)];case 2:return r=n.sent(),[2,t.decode(r.filter(function(e){return 0!==e&&128!==e}))]}})})()},t.readRAMImage=function(){var e=this;return(0,i._)(function(){var t,r,n,i,a,u,c,o,f;return(0,s.YH)(this,function(s){switch(s.label){case 0:return[4,e.setModeVoltage()];case 1:return s.sent(),t=[],a=(i=16)*(n=8192)/(r=64),[4,e.startProgress("Loading Camera RAM")];case 2:u=s.sent(),c=0,s.label=3;case 3:if(!(c<i))return[3,9];return[4,e.cartWrite(16384,c)];case 4:s.sent(),e.setProgress(u,t.length/a),o=0,s.label=5;case 5:if(!(o<n/r))return[3,8];return f=t.push,[4,e.readRAM(r*o,r)];case 6:f.apply(t,[s.sent()]),s.label=7;case 7:return o+=1,[3,5];case 8:return c+=1,[3,3];case 9:return e.stopProgress(u),[2,t]}})})()},t.readPhotoRom=function(){var e=this;return(0,i._)(function(){var t,r,n,i,a,u,c,o,f,l;return(0,s.YH)(this,function(s){switch(s.label){case 0:return[4,e.setModeVoltage()];case 1:return s.sent(),t=[],a=(i=64)*(n=16384)/(r=64),[4,e.startProgress("Loading Album Rolls from Photo!")];case 2:u=s.sent(),c=0,s.label=3;case 3:if(!(c<i))return[3,11];return[4,e.cartWrite(8448,c)];case 4:s.sent(),e.setProgress(u,t.length/a),o=0,s.label=5;case 5:if(!(o<n/r))return[3,10];if(0!==c)return[3,7];return f=t.push,[4,e.readROM(o*r,r)];case 6:return f.apply(t,[s.sent()]),[3,9];case 7:return l=t.push,[4,e.readROM(o*r+16384,r)];case 8:l.apply(t,[s.sent()]),s.label=9;case 9:return o+=1,[3,5];case 10:return c+=1,[3,3];case 11:return e.stopProgress(u),[2,t]}})})()},t.checkFirmware=function(){var e=this;return(0,i._)(function(){var t,r,n,i,a,u,c,o;return(0,s.YH)(this,function(s){switch(s.label){case 0:return e.setModeVoltage(),t=new Uint8Array([D.QUERY_FW_INFO]),[4,e.device.send(t,[{length:9}],!0)];case 1:return r=f._.apply(void 0,[s.sent(),1])[0],i=(n=(0,f._)(r,5))[1],a=n[3],u=n[4],o=new Date(1e3*(c=new DataView(r.buffer,5,4).getUint32(0,!1))),console.log({cfwId:String.fromCharCode(i),fvVer:a,pcbVer:A[u],timestamp:c,date:o.toISOString()}),[2]}})})()},t.setModeVoltage=function(){var e=this;return(0,i._)(function(){var t;return(0,s.YH)(this,function(r){switch(r.label){case 0:return t=new Uint8Array([D.SET_MODE_DMG,D.SET_VOLTAGE_5V]),[4,e.device.send(t,[],!0)];case 1:return r.sent(),[2]}})})()},t.setup=function(e){var t=e.startProgress,r=e.setProgress,n=e.stopProgress,a=this;return(0,i._)(function(){return(0,s.YH)(this,function(e){return a.startProgress=t,a.setProgress=r,a.stopProgress=n,[2]})})()},e}(),C=r(3899),m=r.n(C),S=function(e){return e[e.LIGHT=0]="LIGHT",e[e.NORMAL=64]="NORMAL",e[e.DARK=127]="DARK",e}(S||{}),I=function(){function e(t){var r;(0,c._)(this,e),this.portDeviceType=p.SUPER_PRINTER_INTERFACE,this.textDecoder=new TextDecoder,this.startProgress=(r=(0,i._)(function(e){return(0,s.YH)(this,function(t){return console.log(e),[2,"#"]})}),function(e){return r.apply(this,arguments)}),this.setProgress=function(e,t){console.log("".concat(e," - ").concat(Math.round(100*t),"%"))},this.stopProgress=function(e){console.log("".concat(e," - done"))},this.setError=function(e){console.log(e)},this.device=t,this.portType=t.portType,this.description=t.getDescription(),this.id=_()}var t=e.prototype;return t.generatePrintCommand=function(e,t,r){return[80,(Math.max(0,Math.min(15,t))<<4)+Math.max(0,Math.min(15,r)),228,e,13]},t.sendCommands=function(e){var t=this;return(0,i._)(function(){var r,n,a,u;return(0,s.YH)(this,function(c){switch(c.label){case 0:if(!e.length)return[2];return r=e.length,[4,t.startProgress("Printing to Super Printer Interface")];case 1:var o;n=c.sent(),o=(0,i._)(function(){var i,u,c,o,l;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(!(null==(i=e.shift())?void 0:i.byteLength))return[3,3];return t.setProgress(n,(r-e.length)/r),u=[{length:i.byteLength},{texts:["Printer ready","Packet error"],timeout:2e4}],[4,t.device.send(i,u,!0)];case 1:if(o=(c=f._.apply(void 0,[s.sent(),2]))[0],l=c[1],E()(i)!==E()(o))throw Error("Command validation failed");if(-1===t.textDecoder.decode(l).indexOf("Printer ready"))throw Error("Packet error");return[4,a()];case 2:return[2,s.sent()];case 3:return[2,!0]}})}),a=function(){return o.apply(this,arguments)},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a()];case 3:return c.sent(),[3,5];case 4:return u=c.sent(),t.setError(u.message),t.stopProgress(n),[3,5];case 5:return t.stopProgress(n),[2]}})})()},t.printImage=function(e){var t=this,r=e.reduce(function(e,t){var r=m()(t,2).flat();return(0,g._)(e).concat((0,g._)(r.map(function(e){return parseInt(e,16)})))},[]),n=m()(r,640).map(function(e){return new Uint8Array([68].concat((0,g._)(e),[13]))}),i=m()(n,9).map(function(e,r,n){var i=3*(r===n.length-1);return(0,g._)(e).concat([new Uint8Array(t.generatePrintCommand(127,+(0===r),i))])}).flat();this.sendCommands(i)},t.setup=function(e){var t=e.startProgress,r=e.setProgress,n=e.stopProgress,a=e.setError,u=this;return(0,i._)(function(){return(0,s.YH)(this,function(e){return u.startProgress=t,u.setProgress=r,u.stopProgress=n,u.setError=a,[2]})})()},e}(),N=function(){var e=(0,i._)(function(e){return(0,s.YH)(this,function(t){return[2,new Promise(function(t){self.setTimeout(t,e)})]})});return function(t){return e.apply(this,arguments)}}(),M=function(e,t){for(var r=t.length,n=e.length-r+1,i=0;i<n;i++){for(var s=!0,a=0;a<r;a++)if(e[i+a]!==t[a]){s=!1;break}if(s)return i}return -1},U="GAMEBOY PRINTER Packet Capture",O="GAMEBOY PRINTER Emulator",H="Super Printer Interface by Rapha\xebl BOICHOT",x=function(e){function t(e){var r;return(0,c._)(this,t),(r=(0,u._)(this,t)).portDeviceType=p.UNKNOWN,r.portType=e,r.textDecoder=new TextDecoder,r.textEncoder=new TextEncoder,r.bufferedData=null,r.readQueue=Promise.resolve(),r}(0,o._)(t,e);var r=t.prototype;return r.startBuffering=function(e){var t=this;(0,i._)(function(){var r;return(0,s.YH)(this,function(n){switch(n.label){case 0:if(!t.canRead())return[3,8];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,t.readChunk()];case 2:if(!(r=n.sent()).byteLength)return[3,3];return t.bufferedData=R([t.bufferedData,r]),[3,5];case 3:return[4,N(e)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:return n.sent(),[3,8];case 7:return[3,0];case 8:return[2]}})})()},r.readFromBuffer=function(e){var t=e.timeout,r=e.length,n=e.texts,a=this;return(0,i._)(function(){var e,i,u,c,o,f;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(e="number"==typeof r?r:1/0,i=!0,"number"==typeof t&&setTimeout(function(){i=!1},t),"number"!=typeof r)return[3,6];0===r&&(i=!1),s.label=1;case 1:if(!i)return[3,5];if(!(a.bufferedData&&a.bufferedData.byteLength>=r))return[3,2];return i=!1,[3,4];case 2:return[4,N(0)];case 3:s.sent(),s.label=4;case 4:return[3,1];case 5:return[3,17];case 6:if(!(n instanceof Array))return[3,15];0===(u=n.map(function(e){return a.textEncoder.encode(e)})).length&&(i=!1),s.label=7;case 7:if(!i)return[3,14];if(!(a.bufferedData&&a.bufferedData.byteLength))return[3,11];if(!(o=null!=(c=u.map(function(e){return{needle:e,index:M(a.bufferedData,e)}}).filter(function(e){return -1!==e.index}).sort(function(e,t){return e.index-t.index})[0])?c:null))return[3,8];return e=o.index+o.needle.byteLength,i=!1,[3,10];case 8:return[4,N(0)];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return[4,N(0)];case 12:s.sent(),s.label=13;case 13:return[3,7];case 14:return[3,17];case 15:if(!i)return[3,17];return[4,N(0)];case 16:return s.sent(),[3,15];case 17:if(!a.bufferedData)return[2,new Uint8Array];return f=a.bufferedData.slice(0,e),a.bufferedData=a.bufferedData.slice(e),[2,f]}})})()},r.read=function(e){var t=this;return new Promise(function(r,n){t.readQueue=t.readQueue.then(function(){return t.readFromBuffer(e)}).then(r).catch(n)})},r.detectActiveTypes=function(e){var t=this.textDecoder.decode(e);-1!==t.indexOf(U)||-1!==t.indexOf(O)?this.portDeviceType=p.PACKET_CAPTURE:-1!==t.indexOf(H)&&(this.portDeviceType=p.SUPER_PRINTER_INTERFACE)},r.send=function(e,t,r){var n=this;return(0,i._)(function(){var i,a;return(0,s.YH)(this,function(s){switch(s.label){case 0:return r&&(n.bufferedData=null),i=n.read({length:0}),a=t.map(function(e){return n.read(e)}),[4,i];case 1:return s.sent(),[4,n.sendRaw(e)];case 2:return s.sent(),[2,Promise.all(a)]}})})()},r.detectType=function(){var e=this;return(0,i._)(function(){var t,r,n,i,a,u;return(0,s.YH)(this,function(s){switch(s.label){case 0:return[4,e.read({timeout:4e3,texts:[U,O,H]})];case 1:if(t=s.sent(),e.detectActiveTypes(t),r=new Uint8Array,e.portDeviceType===p.UNKNOWN)return[3,2];return e.bufferedData=null,[3,8];case 2:if(!t.byteLength)return[3,3];return r=t,e.portDeviceType=p.INACTIVE,[3,8];case 3:return[4,e.send(new Uint8Array([76,75]),[{length:1,timeout:100}],!0)];case 4:return(n=f._.apply(void 0,[s.sent(),1])[0]).length&&255===n[0]&&console.log("This could be a JoeyJr"),[4,e.send(new Uint8Array([D.QUERY_FW_INFO]),[{timeout:250}],!0)];case 5:if(!(i=f._.apply(void 0,[s.sent(),1])[0]).length)return[3,6];return["a0a69f6fd5747a0cafe5a287e957780c4224f009"].includes(E()((0,g._)(i)))?(r=i,e.portDeviceType=p.GBXCART):(r=i,e.portDeviceType=p.INACTIVE),[3,8];case 6:return[4,e.send(new Uint8Array([13,10]),[{timeout:250}],!0)];case 7:(a=f._.apply(void 0,[s.sent(),1])[0]).byteLength&&(r=a,e.portDeviceType=p.INACTIVE),s.label=8;case 8:switch(e.portDeviceType){case p.PACKET_CAPTURE:return[3,9];case p.SUPER_PRINTER_INTERFACE:return[3,11];case p.GBXCART:return[3,12];case p.INACTIVE:case p.UNKNOWN:}return[3,13];case 9:case 13:return[4,e.read({timeout:500})];case 10:return s.sent(),[2,new T(e)];case 11:return[2,new I(e)];case 12:return[2,new P(e,r)];case 14:return u=s.sent(),[2,new b(e,R([r,u]))];case 15:return[2]}})})()},t}(d()),k=function(e){function t(e,r){var n;return(0,c._)(this,t),(n=(0,u._)(this,t,[h.SERIAL])).device=e,n.settingsCallback=r,n.baudRate=0,n.reader=null,n}(0,o._)(t,e);var r=t.prototype;return r.getBaudRate=function(){return this.baudRate},r.canRead=function(){return!!(this.reader&&this.portDeviceType!==p.INACTIVE)},r.getDescription=function(){return"".concat(this.baudRate," baud")},r.readChunk=function(){var e=this;return(0,i._)(function(){var t,r;return(0,s.YH)(this,function(n){switch(n.label){case 0:return[4,null==(t=e.reader)?void 0:t.read()];case 1:return[2,null==(r=n.sent())?void 0:r.value]}})})()},r.connect=function(){var e=this;return(0,i._)(function(){var t;return(0,s.YH)(this,function(r){switch(r.label){case 0:return[4,e.settingsCallback()];case 1:if(e.baudRate=(null==(t=r.sent())?void 0:t.baudRate)||0,!e.baudRate)return[2,null];return[4,e.device.open({baudRate:e.baudRate})];case 2:return r.sent(),e.reader=e.device.readable.getReader(),e.startBuffering(50),[2,e.detectType()]}})})()},r.sendRaw=function(e){var t=this;return(0,i._)(function(){var r,n;return(0,s.YH)(this,function(i){switch(i.label){case 0:if(!(null==(r=t.device)?void 0:r.writable))throw Error("device is not writable");return[4,(n=t.device.writable.getWriter()).write(e)];case 1:return i.sent(),n.releaseLock(),[2]}})})()},t}(x),L=new(function(e){function t(){var e;return(0,c._)(this,t),(e=(0,u._)(this,t)).connectedPorts=new Map,e.portsWorkerClient=null,e.enabled="undefined"!=typeof navigator&&!!navigator.serial&&!!TextDecoderStream,e}(0,o._)(t,e);var r=t.prototype;return r.registerClient=function(e){this.portsWorkerClient=e},r.initDevice=function(e){var t=this;return(0,i._)(function(){var r,n,i;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(e.readable||!t.portsWorkerClient)return[2];return n=new b(r=new k(e,t.portsWorkerClient.settingsCallback),new Uint8Array),t.connectedPorts.set(n.id,e),[4,t.portsWorkerClient.addDeviceApi((0,a.BX)(n))];case 1:return s.sent(),[4,r.connect()];case 2:if(!(i=s.sent()))return[3,5];return t.connectedPorts.delete(n.id),[4,t.portsWorkerClient.removeDeviceApi(n.id)];case 3:return s.sent(),t.connectedPorts.set(i.id,e),[4,t.portsWorkerClient.addDeviceApi((0,a.BX)(i))];case 4:s.sent(),s.label=5;case 5:return[2]}})})()},r.initPorts=function(){var e=this;return(0,i._)(function(){var t,r,n,a,u,c,o,l;return(0,s.YH)(this,function(d){switch(d.label){case 0:if(!e.enabled||!e.portsWorkerClient)throw Error("could not init serial ports");return console.log("initializing serial ports"),[4,navigator.serial.getPorts()];case 1:t=d.sent(),r=!0,n=!1,a=void 0,d.label=2;case 2:d.trys.push([2,7,8,9]),u=t[Symbol.iterator](),d.label=3;case 3:if(r=(c=u.next()).done)return[3,6];return o=c.value,[4,e.initDevice(o)];case 4:d.sent(),d.label=5;case 5:return r=!0,[3,3];case 6:return[3,9];case 7:return l=d.sent(),n=!0,a=l,[3,9];case 8:try{r||null==u.return||u.return()}finally{if(n)throw a}return[7];case 9:var v;return navigator.serial.addEventListener("connect",(v=(0,i._)(function(t){return(0,s.YH)(this,function(r){if(!e.portsWorkerClient)throw Error("could not init new serial port");return e.initDevice(t.target),[2]})}),function(e){return v.apply(this,arguments)})),navigator.serial.addEventListener("disconnect",function(t){if(e.portsWorkerClient){var r=(0,f._)(e.connectedPorts.entries().find(function(e){return(0,f._)(e,2)[1]===t.target})||[""],1)[0];r&&(e.connectedPorts.delete(r),e.portsWorkerClient.removeDeviceApi(r))}}),[2]}})})()},t}(d())),Y=function(e){function t(e){var r;return(0,c._)(this,t),(r=(0,u._)(this,t,[h.USB])).device=e,r.productName=e.productName||"",r.interfaceNumber=2,r.endpointIn=5,r.endpointOut=4,r}(0,o._)(t,e);var r=t.prototype;return r.canRead=function(){return!!(this.device&&this.device.opened&&this.portDeviceType!==p.INACTIVE)},r.getDescription=function(){return this.productName},r.readChunk=function(){var e=this;return(0,i._)(function(){var t,r;return(0,s.YH)(this,function(n){switch(n.label){case 0:return[4,e.device.transferIn(e.endpointIn,64)];case 1:return r=(null==(t=n.sent())?void 0:t.data)||new DataView(new Uint8Array([]).buffer),[2,new Uint8Array(r.buffer,r.byteOffset,r.byteLength)]}})})()},r.connect=function(){var e=this;return(0,i._)(function(){var t,r;return(0,s.YH)(this,function(n){switch(n.label){case 0:return[4,e.device.open()];case 1:return n.sent(),[4,e.device.selectConfiguration(1)];case 2:if(n.sent(),!(r=null==(t=e.device.configuration)?void 0:t.interfaces))return[2,null];return r.forEach(function(t){t.alternates.forEach(function(r){255===r.interfaceClass&&(e.interfaceNumber=t.interfaceNumber,r.endpoints.forEach(function(t){"out"===t.direction&&(e.endpointOut=t.endpointNumber),"in"===t.direction&&(e.endpointIn=t.endpointNumber)}))})}),[4,e.device.claimInterface(e.interfaceNumber)];case 3:return n.sent(),[4,e.device.selectAlternateInterface(e.interfaceNumber,0)];case 4:return n.sent(),[4,e.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:e.interfaceNumber})];case 5:return n.sent(),e.startBuffering(50),[2,e.detectType()]}})})()},r.sendRaw=function(e){var t=this;return(0,i._)(function(){return(0,s.YH)(this,function(r){switch(r.label){case 0:return[4,Promise.race([t.device.transferOut(t.endpointOut,e),new Promise(function(e,t){return setTimeout(function(){return t(Error("Device did not accept data after 10s"))},1e4)})])];case 1:return r.sent(),[2]}})})()},t}(x),B=new(function(e){function t(){var e;return(0,c._)(this,t),(e=(0,u._)(this,t)).connectedDevices=new Map,e.portsWorkerClient=null,e.enabled="undefined"!=typeof navigator&&!!navigator.usb&&!!navigator.usb.getDevices,e}(0,o._)(t,e);var r=t.prototype;return r.registerClient=function(e){this.portsWorkerClient=e},r.initDevice=function(e){var t=this;return(0,i._)(function(){var r,n,i;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(e.opened||!t.portsWorkerClient)return[2];return n=new b(r=new Y(e),new Uint8Array),t.connectedDevices.set(n.id,e),[4,t.portsWorkerClient.addDeviceApi((0,a.BX)(n))];case 1:return s.sent(),[4,r.connect()];case 2:if(!(i=s.sent()))return[3,5];return t.connectedDevices.delete(n.id),[4,t.portsWorkerClient.removeDeviceApi(n.id)];case 3:return s.sent(),t.connectedDevices.set(i.id,e),[4,t.portsWorkerClient.addDeviceApi((0,a.BX)(i))];case 4:s.sent(),s.label=5;case 5:return[2]}})})()},r.initPorts=function(){var e=this;return(0,i._)(function(){return(0,s.YH)(this,function(t){switch(t.label){case 0:if(!e.enabled||!e.portsWorkerClient)return[2];return[4,navigator.usb.getDevices()];case 1:return t.sent().forEach(function(t){return e.initDevice(t)}),navigator.usb.addEventListener("connect",function(t){e.initDevice(t.device)}),navigator.usb.addEventListener("disconnect",function(t){if(e.portsWorkerClient){var r=(0,f._)(e.connectedDevices.entries().find(function(e){return(0,f._)(e,2)[1]===t.device})||[""],1)[0];r&&(e.connectedDevices.delete(r),e.portsWorkerClient.removeDeviceApi(r))}}),[2]}})})()},t}(d()));(0,a.p)({openSerial:function(){return(0,i._)(function(){return(0,s.YH)(this,function(e){switch(e.label){case 0:return console.log("open serial"),[4,L.initPorts()];case 1:return e.sent(),[2]}})})()},openUSB:function(){return(0,i._)(function(){return(0,s.YH)(this,function(e){switch(e.label){case 0:return[4,B.initPorts()];case 1:return e.sent(),[2]}})})()},registerClient:function(e){return(0,i._)(function(){return(0,s.YH)(this,function(t){switch(t.label){case 0:if(!L.enabled)return[3,3];return[4,L.registerClient(e)];case 1:return t.sent(),[4,L.initPorts()];case 2:t.sent(),t.label=3;case 3:if(!B.enabled)return[3,6];return[4,B.registerClient(e)];case 4:return t.sent(),[4,B.initPorts()];case 5:t.sent(),t.label=6;case 6:return e.setStatus(B.enabled,L.enabled),[2]}})})()}})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}},a=!0;try{e[n].call(s.exports,s,s.exports,r),a=!1}finally{a&&delete t[n]}return s.exports}r.m=e,r.x=()=>{var e=r.O(void 0,[2491,5955,1004],()=>r(67332));return r.O(e)},(()=>{var e=[];r.O=(t,n,i,s)=>{if(n){s=s||0;for(var a=e.length;a>0&&e[a-1][2]>s;a--)e[a]=e[a-1];e[a]=[n,i,s];return}for(var u=1/0,a=0;a<e.length;a++){for(var[n,i,s]=e[a],c=!0,o=0;o<n.length;o++)(!1&s||u>=s)&&Object.keys(r.O).every(e=>r.O[e](n[o]))?n.splice(o--,1):(c=!1,s<u&&(u=s));if(c){e.splice(a--,1);var f=i();void 0!==f&&(t=f)}}return t}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,n)=>(r.f[n](e,t),t),[])),r.u=e=>1004===e?"static/chunks/1004.0388831cf3cbc725.js":"static/chunks/"+e+"-"+({2491:"7671e5eaecdf23e1",5955:"0429eec6e04765df"})[e]+".js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.tt=()=>(void 0===e&&(e={createScriptURL:e=>e},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(e=trustedTypes.createPolicy("nextjs#bundler",e))),e)})(),r.tu=e=>r.tt().createScriptURL(e),r.p="/gb-printer-web/_next/",(()=>{var e={7332:1};r.f.i=(t,n)=>{e[t]||importScripts(r.tu(r.p+r.u(t)))};var t=self.webpackChunk_N_E=self.webpackChunk_N_E||[],n=t.push.bind(t);t.push=t=>{var[i,s,a]=t;for(var u in s)r.o(s,u)&&(r.m[u]=s[u]);for(a&&a(r);i.length;)e[i.pop()]=1;n(t)}})(),(()=>{var e=r.x;r.x=()=>Promise.all([2491,5955,1004].map(r.e,r)).then(e)})(),_N_E=r.x()})();