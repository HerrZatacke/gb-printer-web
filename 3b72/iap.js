(self.webpackChunkgb_printer_web=self.webpackChunkgb_printer_web||[]).push([[42],{67508:function(t,e,r){"use strict";r.d(e,{vc:function(){return a},k3:function(){return o},Z6:function(){return i},z3:function(){return u},W4:function(){return c},q1:function(){return d},d$:function(){return h},jU:function(){return s},fb:function(){return f},T6:function(){return p},oU:function(){return y}});r(47042);var n=r(21334),a="YYYY-MM-DD HH:mm:ss:SSS",o="YYYY-MM-DD",i="HH:mm",u="YYYYMMDD-HHmmss",c="DD.MM.YYYY HH:mm",l=[0,85,170,255],s='!{"command":"INIT"}',f='!{"command":"DATA", "compressed":0, "more":1}',p='!{"command":"DATA","compressed":0,"more":0}',y='!{"command":"PRNT","sheets":1,"margin_upper":1,"margin_lower":3,"pallet":228,"density":64 }',d={r:l.slice(),g:l.slice(),b:l.slice(),n:l.slice(),blend:n._I.MULTIPLY},h={shortName:"-",name:"Missing Palette",palette:["#aaaaaa","#999999","#888888","#777777"]}},34415:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return Tn}});r(19601),r(66992),r(41539),r(88674),r(78783),r(33948),r(92222);var n=r(67294),a=r(22115),o=r(73935),i=r(90879),u=function(t,e){return void 0!==t?t:e},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cybl",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PALETTE_SET_ACTIVE":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.activePalette,t);case"PALETTE_DELETE":return e.payload.newSelectedPalette||t;default:return t}};r(83710),r(79753),r(82526),r(41817),r(32165),r(91038),r(47042),r(68309);function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var f=null,p=function(){if(null===f)try{f=window.navigator.canShare({files:[new File([new Blob(l("test"))],"test.txt",{type:"text/plain",lastModified:new Date})]})}catch(t){f=!1}return f};r(57327);function y(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"CONFIRM_ASK":return[e.payload].concat(y(t));case"ADD_FRAME":case"ADD_IMAGES":case"DELETE_IMAGE":case"DELETE_IMAGES":case"PALETTE_DELETE":case"CONFIRM_ANSWERED":return t.filter((function(t,e){return e}));default:return t}},m=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"IMPORT_DRAGOVER_START":return!0;case"IMPORT_DRAGOVER_END":return!1;default:return t}};r(69070),r(47941),r(38880),r(89554),r(54747),r(49337),r(33321);function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){b(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function b(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"DROPBOX_LOGOUT":return{use:t.use};case"SET_DROPBOX_STORAGE":return v(v({},t),e.payload);default:return t}},E=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"EDIT_IMAGE":return{hash:e.payload};case"EDIT_IMAGE_SELECTION":return e.payload;case"CANCEL_EDIT_IMAGE":case"UPDATE_IMAGE":case"UPDATE_IMAGES_BATCH":case"GLOBAL_UPDATE":return null;default:return t}},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_EDIT_PALETTE":return e.payload;case"PALETTE_CANCEL_EDIT":case"PALETTE_UPDATE":return{};default:return t}},S=r(1373);function F(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var T=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["png"],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"UPDATE_EXPORT_FILE_TYPES":return e.payload.checked?(0,S.Z)([].concat(F(t),[e.payload.fileType])):t.filter((function(t){return t!==e.payload.fileType}));case"GLOBAL_UPDATE":return u(e.payload.exportFileTypes,t);default:return t}};function I(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return D(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"UPDATE_EXPORT_SCALE_FACTORS":return e.payload.checked?window.navigator.msSaveBlob?[e.payload.factor]:[].concat(I(t),[e.payload.factor]):t.filter((function(t){return t!==e.payload.factor}));case"GLOBAL_UPDATE":return u(e.payload.exportScaleFactors,t);default:return t}},P=(r(26699),r(32023),r(99449)),j=[P.Dh,P.TZ,P.z2,P.ee,P.Vn],R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_ACTIVE_TAGS":return e.payload;case"SET_AVAILABLE_TAGS":return t.filter((function(t){return j.includes(t)||e.payload.includes(t)}));default:return t}},L=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SHOW_FILTERS":return!0;case"HIDE_FILTERS":case"SET_ACTIVE_TAGS":return!1;default:return t}},N=(r(2707),r(4181));function M(t){return function(t){if(Array.isArray(t))return G(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return G(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var C=function(t,e){return t.id<e.id?-1:t.id>e.id?1:0},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_FRAME":return(0,N.Z)("id")([e.payload].concat(M(t))).sort(C);case"DELETE_FRAME":return t.filter((function(t){return t.id!==e.payload}));case"GLOBAL_UPDATE":return(0,N.Z)("id")(e.payload.frames).sort(C);default:return t}},B=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"FRAMES_MESSAGE_SHOW":return 1;case"FRAMES_MESSAGE_HIDE":return 2;default:return t}},x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1x",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_CURRENT_GALLERY_VIEW":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.galleryView,t);default:return t}};function U(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Z(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?U(Object(r),!0).forEach((function(e){H(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function H(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var V=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_GIT_STORAGE":return Z(Z({},t),e.payload);default:return t}},Y=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_HANDLE_EXPORT_FRAME":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.handleExportFrame,t);default:return t}},X=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_HIDE_DATES":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.hideDates,t);default:return t}};r(21249),r(69826);function $(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function W(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$(Object(r),!0).forEach((function(e){z(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var K=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_IMAGES":return(0,N.Z)("hash")([].concat(J(t),J(e.payload)));case"DELETE_IMAGE":return J(t.filter((function(t){return t.hash!==e.payload})));case"DELETE_IMAGES":return J(t.filter((function(t){var r=t.hash;return!e.payload.includes(r)})));case"UPDATE_IMAGE":return t.map((function(t){return t.hash===e.payload.hash?W(W({},t),e.payload):t}));case"IMAGE_FAVOURITE_TAG":return t.map((function(t){return t.hash===e.payload.hash?W(W({},t),{},{tags:(0,S.Z)(e.payload.isFavourite?[P.oJ].concat(J(t.tags)):t.tags.filter((function(t){return t!==P.oJ})))}):t}));case"UPDATE_IMAGES_BATCH":return t.map((function(t){return e.payload.find((function(e){return e.hash===t.hash}))||t}));case"GLOBAL_UPDATE":return(0,N.Z)("hash")(e.payload.images);default:return t}};function Q(t){return function(t){if(Array.isArray(t))return tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return tt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"IMAGE_SELECTION_REMOVE":case"DELETE_IMAGE":return Q(t.filter((function(t){return t!==e.payload})));case"IMAGE_SELECTION_ADD":return[].concat(Q(t),[e.payload]);case"IMAGE_SELECTION_SET":return e.payload;case"DELETE_IMAGES":return[];case"GLOBAL_UPDATE":return u(e.payload.imageSelection,t);default:return t}},rt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_IMPORT_LAST_SEEN":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.importLastSeen,t);default:return t}},nt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_IS_FULLSCREEN":return e.payload;default:return t}},at=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"IMAGE_SELECTION_ADD":case"IMAGE_SELECTION_REMOVE":return e.payload;case"DELETE_IMAGE":case"DELETE_IMAGES":case"SET_CURRENT_GALLERY_VIEW":return null;default:return t}},ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_LIGHTBOX_IMAGE_INDEX":return e.payload;default:return t}},it=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_PAGESIZE":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.pageSize,t);default:return t}};function ut(t){return function(t){if(Array.isArray(t))return ct(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ct(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ct(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var lt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PALETTE_DELETE":return ut(t.filter((function(t){return t.shortName!==e.payload.shortName})));case"PALETTE_UPDATE":return(0,N.Z)("shortName")([].concat(ut(t.map((function(t){return t.shortName!==e.payload.shortName?t:e.payload}))),[e.payload]));case"GLOBAL_UPDATE":return(0,N.Z)("shortName").apply(void 0,[e.payload.palettes].concat(ut(t)));default:return t}},st=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(r){var n="desc"===e?-1:1;return r.sort((function(e,r){return e[t]>r[t]?n:e[t]<r[t]?-n:0}))}};function ft(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function pt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(r),!0).forEach((function(e){yt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ft(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function yt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dt(t){return function(t){if(Array.isArray(t))return ht(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ht(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ht(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var mt=(0,N.Z)("url"),gt=st("url"),vt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PLUGIN_REMOVE":return gt(mt(dt(t.filter((function(t){return t.url!==e.payload})))));case"PLUGIN_ADD":return gt(mt([{url:e.payload}].concat(dt(t))));case"PLUGIN_UPDATE_PROPERTIES":return gt(mt(t.map((function(t){return t.url!==e.payload.url?t:pt(pt({},t),e.payload)}))));case"PLUGIN_UPDATE_CONFIG":return gt(mt(t.map((function(t){if(t.url!==e.payload.url)return t;var r=pt(pt({},t.config||{}),e.payload.config||{});return pt(pt({},t),{},{config:r})}))));default:return t}},bt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"REMOTE_CALL_FUNCTION":case"HEARTBEAT_TIMED_OUT":return!0;case"ADD_IMAGES":case"PRINTER_FUNCTIONS_RECEIVED":case"PRINTER_DATA_RECEIVED":return!1;default:return t}},At=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PRINTER_DATA_RECEIVED":return e.payload;case"HEARTBEAT_TIMED_OUT":return{};default:return t}},Et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PRINTER_FUNCTIONS_RECEIVED":return e.payload;case"HEARTBEAT_TIMED_OUT":return[];default:return t}},Ot=r(11054),St=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_PRINTER_URL":return(0,Ot.Z)(e.payload,"http");case"GLOBAL_UPDATE":return u(e.payload.printerUrl,t);default:return t}},Ft=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_PRINTER_PARAMS":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.printerParams,t);default:return t}};function wt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(r),!0).forEach((function(e){It(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function It(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{gif:0,printer:0},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ANIMATE_IMAGES":return Tt(Tt({},t),{},{gif:.01});case"CREATE_GIF_PROGRESS":return Tt(Tt({},t),{},{gif:e.payload});case"EXECUTE_PLUGIN_PROGRESS":return Tt(Tt({},t),{},{plugin:e.payload});case"PRINTER_PROGRESS":return Tt(Tt({},t),{},{printer:e.payload});case"ADD_IMAGES":case"CONFIRM_ANSWERED":return Tt(Tt({},t),{},{printer:0});default:return t}};function _t(t){return function(t){if(Array.isArray(t))return Pt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Pt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Rt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(r),!0).forEach((function(e){Lt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Lt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Nt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{git:[],dropbox:[]},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"GITSTORAGE_LOG_ACTION":return Rt(Rt({},t),{},{git:[e.payload].concat(_t(t.git))});case"DROPBOX_LOG_ACTION":return Rt(Rt({},t),{},{dropbox:[e.payload].concat(_t(t.dropbox))});case"STORAGE_SYNC_DONE":return Rt(Rt({},t),{},Lt({},e.payload.storageType,[{timestamp:(new Date).getTime()/1e3,message:"."}].concat(_t(t[e.payload.storageType]))));case"LOG_CLEAR":return{git:[],dropbox:[]};default:return t}},Mt=r(27484),Gt=r.n(Mt);function Ct(t){return function(t){if(Array.isArray(t))return kt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return kt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Bt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_IMAGES":var r=e.payload.map((function(t){var e=t.hash;return t.hashes?null:{hash:e,timestamp:Gt()().unix()}})).filter(Boolean);return[].concat(Ct(t.filter((function(t){var e=t.hash;return!r.includes(e)}))),Ct(r));case"GLOBAL_UPDATE":var n,a;return null!==(n=e.payload)&&void 0!==n&&null!==(a=n.imageSelection)&&void 0!==a&&a.length?[].concat(Ct(t.filter((function(t){var r=t.hash;return!e.payload.imageSelection.includes(r)}))),Ct(e.payload.imageSelection.map((function(t){return{hash:t,timestamp:Gt()().unix()}})))):t;default:return t}};function xt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ut(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(r),!0).forEach((function(e){Zt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Zt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ht=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case"UPDATE_RGBN_PART":return Ut(Ut({},e),r.payload);case"ADD_IMAGES":return null!==(t=r.payload[0])&&void 0!==t&&t.hashes?null:e;case"DELETE_IMAGE":case"DELETE_IMAGES":return null;case"GLOBAL_UPDATE":return u(r.payload.rgbnImages,e);default:return e}},Vt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"int",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_SAV_FRAME_TYPES":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.savFrameTypes,t);default:return t}},Yt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_SORT_BY":return e.payload;case"GLOBAL_UPDATE":return u(e.payload.sortBy,t);default:return t}},Xt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SHOW_SORT_OPTIONS":return!0;case"HIDE_SORT_OPTIONS":case"SET_SORT_BY":return!1;default:return t}},$t=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"STORAGE_SYNC_START":return!0;case"STORAGE_SYNC_DONE":return!1;default:return t}},Wt=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"STORAGE_SYNC_SELECT":return!0;case"STORAGE_SYNC_START":case"STORAGE_SYNC_DONE":case"STORAGE_SYNC_CANCEL":return!1;default:return t}};function zt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Jt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(r),!0).forEach((function(e){qt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function qt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Kt={imageSelection:[]},Qt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_VIDEO_PARAMS":return Jt(Jt({},t),e.payload);case"ANIMATE_IMAGES":case"CANCEL_ANIMATE_IMAGES":return Jt(Jt({},t),{},{imageSelection:[]});case"GLOBAL_UPDATE":return u(e.payload.videoParams,t);default:return t}},te=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{height:window.innerHeight,width:window.innerWidth},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"WINDOW_DIMENSIONS":return e.payload;default:return t}},ee=(0,i.UY)({activePalette:c,canShare:p,confirm:h,dragover:m,dropboxStorage:A,editImage:E,editPalette:O,exportFileTypes:T,exportScaleFactors:_,filtersActiveTags:R,filtersVisible:L,frames:k,framesMessage:B,galleryView:x,gitStorage:V,handleExportFrame:Y,hideDates:X,images:K,imageSelection:et,importLastSeen:rt,isFullscreen:nt,lastSelectedImage:at,progressLog:Nt,lightboxImage:ot,pageSize:it,palettes:lt,plugins:vt,printerBusy:bt,printerData:At,printerFunctions:Et,printerUrl:St,printerParams:Ft,progress:Dt,recentImports:Bt,rgbnImages:Ht,savFrameTypes:Vt,sortBy:Yt,sortOptionsVisible:Xt,syncBusy:$t,syncSelect:Wt,videoParams:Qt,windowDimensions:te}),re=r(28443),ne=r.n(re),ae=r(67508),oe=r(21334);function ie(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ue(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(r),!0).forEach((function(e){ce(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ce(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function le(t){return function(t){if(Array.isArray(t))return se(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return se(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return se(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var fe=function(t){var e=(0,N.Z)("shortName")([].concat(le(ne().map((function(t){return ue(ue({},t),{},{isPredefined:!0})}))),le(t.palettes))),r=e.map((function(t){return t.shortName})),n=t.frames.map((function(t){return t.id})),a=(0,Ot.Z)(t.printerUrl,"http"),o=t.framesMessage,i=r.includes(t.activePalette)?t.activePalette:"bw",u=t.images.map((function(t){return ue(ue({},t),{},{created:Gt()(t.created).format(ae.vc)})})).map((function(t){return ue(ue({},t),{},{tags:t.tags||[]})})).map((function(t){return t.hashes?t.palette?t.palette.blend?t:ue(ue({},t),{},{palette:ue(ue({},t.palette),{},{blend:oe._I.MULTIPLY})}):ue(ue({},t),{},{palette:ae.q1}):t.palette?r.includes(t.palette)?t:ue(ue({},t),{},{palette:r[0]||"bw"}):null})).filter(Boolean),c=u.map((function(t){return t.hash}));u.forEach((function(t){!t.frame||n.includes(t.frame)||o||(o=1)}));var l=Gt()().subtract(6,"hour").unix(),s=t.recentImports.filter((function(t){var e=t.hash,r=t.timestamp;return c.includes(e)&&r>l})),f=t.plugins.map((function(t){return ue(ue({},t),{},{loading:!0,error:void 0})}));return ue(ue({},t),{},{images:u,palettes:e,plugins:f,printerUrl:a,framesMessage:o,activePalette:i,recentImports:s})},pe=r(81913),ye=function(t){return function(e){return function(r){e(r);var n=t.getState(),a={};pe.C.forEach((function(t){var e=t.key;if(t.saveLocally)switch(e){case"palettes":a[e]=n.palettes.filter((function(t){return!t.isPredefined}));break;default:a[e]=n[e]}})),localStorage.setItem("gbp-web-state",JSON.stringify(a))}}},de=(r(34553),r(39575),r(82472),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(25009)),he=r.n(de),me=r(11494),ge=r(93162),ve=r(30236),be=r.n(ve),Ae=r(7309),Ee=r(70954),Oe=r(25984),Se=r(99005),Fe=r(75409);function we(t){return function(t){if(Array.isArray(t))return je(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ie(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Te(Object(r),!0).forEach((function(e){De(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function De(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(t){u=!0,a=t}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(t,e)||Pe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){if(t){if("string"==typeof t)return je(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?je(t,e):void 0}}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Re=function(t){return function(e){return function(r){if("ANIMATE_IMAGES"===r.type){var n=t.getState(),a=n.videoParams,o=a.scaleFactor,i=a.frameRate,u=a.imageSelection,c=a.yoyo,l=a.frame,s=a.lockFrame,f=a.invertPalette,p=a.palette,y=a.exportFrameMode;Promise.all(u.map((function(t){return n.images.find((function(e){return e.hash===t}))})).filter(Boolean).map((function(t){return Ie(Ie({},t),{},{frame:l||t.frame,palette:t.hashes?t.palette:p||t.palette})})).map((function(t){return(0,Ae.Z)(n)(t).then((function(e){var r=(0,Ee.Z)(n,t),a=!!t.hashes,i=a?new Oe.Z:new Se.Z,u=s||t.lockFrame||!1,c=f||t.invertPalette||!1;return a?i.update({tiles:e,palette:r,lockFrame:u}):i.update({tiles:e,palette:r.palette,lockFrame:u,invertPalette:c}),i.getScaledCanvas(o,y)}))}))).then((function(e){var r=[],n=new(he())(1,1/0),a=new me.g(r,e[0].width,e[0].height,{loop:65535}),u=we(e);if(c){var s=we(e).reverse();s.shift(),s.pop(),u.push.apply(u,we(s))}var f=function(t,e,r,n,a){return function(o,i){return r.add((function(){return new Promise((function(r,u){for(var c=o.getContext("2d").getImageData(0,0,o.width,o.height).data,l=[],s=be()(c,4).map((function(t){var e=_e(t,3),r=(e[0]<<16)+(e[1]<<8)+e[2],n=l.findIndex((function(t){return t===r}));return-1===n&&(n=l.length,l.push(r)),n}));l.length<256;)l.push(0);try{t({type:"CREATE_GIF_PROGRESS",payload:(i+1)/a}),window.requestAnimationFrame((function(){e.addFrame(0,0,o.width,o.height,s,{delay:Math.round(100/n),palette:l}),r()}))}catch(t){u(t)}}))}))}}(t.dispatch,a,n,i,u.length);Promise.all(u.map(f)).then((function(){var e,n=(0,Fe.Z)({useCurrentDate:!0,exportScaleFactor:o,frameRate:i,altTitle:"animated",frameName:l,paletteShort:p}),u=a.end();try{e=new File([new Uint8Array(r.slice(0,u)).buffer],"".concat(n,".gif"),{type:"image/gif"})}catch(t){e=new Blob([new Uint8Array(r.slice(0,u)).buffer])}(0,ge.saveAs)(e,"".concat(n,".gif")),t.dispatch({type:"CREATE_GIF_PROGRESS",payload:0})}))})).catch((function(e){t.dispatch({type:"ERROR",payload:e.message})}))}e(r)}}},Le=(r(84944),r(74916),r(15306),r(83112),r(39714),r(13509)),Ne=r(23506),Me=r(39532);function Ge(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ce(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(r),!0).forEach((function(e){ke(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ke(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Be(t){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var xe=["lockFrame","frame","palette","invertPalette","title","tags","created"],Ue=function(t){return(0,S.Z)(t.map((function(t){return t.tags})).flat())},Ze=function(t){return function(e){return function(r){if("IMAGE_SELECTION_SHIFTCLICK"===r.type){var n=t.getState(),a=(0,Le.Z)(n),o=n.lastSelectedImage,i=n.pageSize,u=a.findIndex((function(t){return t.hash===r.payload})),c=a.findIndex((function(t){return t.hash===o}));-1===c&&(c=r.page*i);var l=Math.min(c,u),s=Math.max(c,u);t.dispatch({type:"IMAGE_SELECTION_SET",payload:a.slice(l,s+1).map((function(t){return t.hash}))})}if("UPDATE_IMAGES_BATCH"===r.type){var f=t.getState(),p=(0,Me.$b)(f),y=f.editImage,d=f.images,h=r.payload,m=h.image,g=h.batch,v=h.tagChanges;if(g&&y.batch&&y.batch.length){var b=y.batch.map((function(t){return d.find((function(e){return e.hash===t}))})).map(Me.Np).sort(p).map(Me.fD).map((function(t,e){if(!t)return!1;var r={},n=t.tags;return xe.forEach((function(a){switch(a){case"title":if(!g.title)break;r.title=m.title.replace(/%(n+)/gi,(function(t,r){return(e+1).toString(10).padStart(r.length,"0")}));break;case"created":if(!g.created)break;r.created=m.created;break;case"palette":if(!g.palette)break;Be(t.palette)===Be(m.palette)&&(r.palette=m.palette);break;case"invertPalette":if(!g.invertPalette)break;r.invertPalette=m.invertPalette;break;case"frame":if(!g.frame)break;r.frame=m.frame;break;case"lockFrame":if(!g.lockFrame)break;r.lockFrame=m.lockFrame;break;case"tags":n=(0,Ne.Z)(Ce(Ce({},v),{},{initial:t.tags}))}})),Ce(Ce(Ce({},t),r),{},{tags:n})})).filter(Boolean);Object.assign(r,{payload:b})}}if("BATCH_TASK"!==r.type)e(r);else{var A=t.getState(),E=A.images,O=A.imageSelection,S=A.pageSize,F=E.filter((function(t){var e=t.hash;return O.includes(e)}));if(O.length)switch(r.payload){case"delete":t.dispatch({type:"CONFIRM_ASK",payload:{message:"Delete ".concat(O.length," images?"),confirm:function(){t.dispatch({type:"DELETE_IMAGES",payload:O})},deny:function(){t.dispatch({type:"CONFIRM_ANSWERED"})}}});break;case"animate":t.dispatch({type:"SET_VIDEO_PARAMS",payload:{imageSelection:O}});break;case"download":t.dispatch({type:"DOWNLOAD_SELECTION",payload:O});break;case"edit":t.dispatch({type:"EDIT_IMAGE_SELECTION",payload:{hash:F[0].hash,tags:Ue(F),batch:F.map((function(t){return t.hash}))}})}switch(r.payload){case"checkall":t.dispatch({type:"IMAGE_SELECTION_SET",payload:(0,Le.Z)(A).slice(r.page*S,(r.page+1)*S).map((function(t){return t.hash}))});break;case"uncheckall":t.dispatch({type:"IMAGE_SELECTION_SET",payload:[]})}}}}},He=r(20260),Ve=r(91252),Ye=function(t){Ve.Rt.keys().then((function(e){e.forEach((function(e){!function(t,e){(function(t,e){return!!e.find((function(e){var r=e.hashes;return!!r&&[r.r,r.g,r.b,r.n].includes(t)}))})(e,t)||function(t,e){return!!e.find((function(e){return e.hash===t}))}(e,t)||(0,He.IV)(e)}(t,e)}))}))},Xe=function(t){return function(e){return function(r){switch(e(r),r.type){case"DELETE_IMAGE":case"DELETE_IMAGES":Ye(t.getState().images)}}}},$e=function(t){var e,n=t.getState().dropboxStorage;return n.use&&Promise.all([r.e(183),r.e(991)]).then(r.bind(r,69218)).then((function(r){var n=r.default;e=n(t)})),function(a){return function(o){a(o),t.getState().dropboxStorage.use&&("DROPBOX_START_AUTH"===o.type||"SET_DROPBOX_STORAGE"===o.type||"STORAGE_SYNC_START"===o.type&&("dropbox"===o.payload.storageType||"dropboximages"===o.payload.storageType)||n.use&&"TRY_RECOVER_IMAGE_DATA"===o.type)&&(e?e(o):Promise.all([r.e(183),r.e(991)]).then(r.bind(r,69218)).then((function(r){var n=r.default;(e=n(t))(o)})))}}},We=(r(32564),r(23157),r(82772),r(73210),function(t){return function(e,r){var n=[],a="";try{for(var o=0;o<5760;o+=1)a+=" ".concat(e[o+8].toString(16).padStart(2,"0")),o%16==15&&(n.push(a.trim()),a="")}catch(e){return t({type:"ERROR",payload:"ERROR_IN_LOADED_BIN\n".concat(r)}),Promise.resolve([])}return Promise.resolve(n)}}),ze=r(88856),Je=function(t,e,r){var n=function(t){return r.find((function(e){return e.id===t}))},a=(t+1).toString(10).padStart(2,"0"),o="".concat(e).concat(a);if(n(o))return o;if("jp"===e){var i="int".concat(a);if(n(i))return i}var u="".concat(e,"01");if(n(u))return u;if("jp"!==e){var c="int".concat(a);if(n(c))return c}return"int01"},qe=r(36940);function Ke(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tr(t){return function(t){if(Array.isArray(t))return er(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return er(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return er(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var rr="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF",nr=st("albumIndex"),ar=function(t){return function(e,r){var n=t.getState(),a=n.savFrameTypes,o=n.frames,i=n.importLastSeen,u=[],c=(0,qe.Z)(o).map((function(t){var e=t.id;return{value:e,name:t.name,selected:a===e}})),l=function(t){for(var n=function(r){if(i&&0===r||r>=8192){var n=e[r+4016];if(e.length>r){var a=function(t,e){var r=[],n="",a=!1;r.push.apply(r,tr(tr(Array(40)).map((function(){return rr}))));for(var o=0;o<3584;o+=1)o%256==0&&r.push.apply(r,tr(tr(Array(2)).map((function(){return rr})))),n+=" ".concat(t[e+o].toString(16).padStart(2,"0")),o%16==15&&(r.push(n.trim()),a||"00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"===n.trim()||(a=!0),n=""),o%256==255&&r.push.apply(r,tr(tr(Array(2)).map((function(){return rr}))));return r.push.apply(r,tr(tr(Array(40)).map((function(){return rr})))),a?r:null}(e,r);a&&u.push((0,ze.Z)(a,Je(n,t,o)).then((function(t){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ke(Object(r),!0).forEach((function(e){Qe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ke(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({lines:t},function(t){var r=t/4096-2;return{cartIndex:r,albumIndex:r>=0?e[4530+r]:64,baseAddress:t}}(r))})))}}},a=0;a<131072;a+=4096)n(a);return Promise.all(u).then(nr).then((function(t){var e=0;return t.map((function(t){var n,a=t.albumIndex,o=t.lines;switch(a){case 64:n="[last seen]";break;case 255:n="[deleted]";break;default:n=(e+=1).toString(10).padStart(2,"0")}return{lines:o,file:"".concat(r," ").concat(n)}}))}))};return c.length<2?l(a):new Promise((function(e){t.dispatch({type:"CONFIRM_ASK",payload:{message:"Importing '".concat(r,"'"),questions:function(){return[{label:"Select frameset to use with this import",key:"selectedFrameset",type:"select",options:c}]},confirm:function(r){var n=r.selectedFrameset;t.dispatch({type:"CONFIRM_ANSWERED"}),e(l(n))},deny:function(){t.dispatch({type:"CONFIRM_ANSWERED"}),e([])}}})}))}},or=(r(23123),r(91058),r(2737)),ir=function(t){var e=t.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length&&0!==t.indexOf("//")&&0!==t.indexOf("/*")})).map((function(t){return t.split(" ")})).flat().map((function(t){return parseInt(t,16)}));return(0,or.parsePackets)(e).then(or.getImageDataStream).then(or.decompressDataStream).then(or.decodePrintCommands).then(or.harmonizePalettes).then(or.transformToClassic)},ur=(r(69600),r(7199)),cr=r(98613),lr=function(t){var e=t.lines,r=t.filename,n=t.palette;return(0,He.a1)(e).then((function(t){return{hash:t,created:Gt()().format(ae.vc),title:r||"",lines:e.length,tags:[],palette:n}}))},sr=(r(4723),function(t){var e=t.frameSetNew,r=t.frameSet,n=t.frameIndex,a=void 0===n?"":n,o="".concat(e||r).concat(a.padStart(2,"0"));return o.match(/^[a-z]{2,}\d{2}$/g)?o:""}),fr=function(t){var e=t.frameIds,r=t.frameGroups,n=t.fileName;return function(t){var a=t.frameSet,o=void 0===a?"":a,i=t.frameSetNew,u=void 0===i?"":i,c=t.frameIndex,l=void 0===c?"":c,s=t.frameName,f=void 0===s?"":s,p=sr({frameSet:o,frameSetNew:u,frameIndex:l}),y=e.includes(p),d=!(p&&f||!p&&!f);return[{label:"Add as frame to existing frameset",key:"frameSet",type:"select",options:r,disabled:!!u},{label:"Create new frameset with ID (min. 2 chars)",key:"frameSetNew",type:"text",disabled:!!o},{label:y?"Frame index - frame ".concat(p," will be replaced"):"Frame index",key:"frameIndex",type:"number",disabled:!(o||u.length>1)},{label:"Name of frame",key:"frameName",type:"text",disabled:!(o||u.length>1)},{label:p&&f?'"'.concat(n,'" will be imported as frame "').concat(p,'" - "').concat(f,'"'):'"'.concat(n,'" will be imported as an image'),key:"info",type:"info"},{type:"confirmForm",notComplete:d}]}};function pr(t){return function(t){if(Array.isArray(t))return hr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||dr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(t){u=!0,a=t}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(t,e)||dr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(t,e){if(t){if("string"==typeof t)return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hr(t,e):void 0}}function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var mr=st("count","desc"),gr=st("threshold"),vr=function(t){var e=function(t){return function(e){var r=yr(e,4),n=r[0],a=r[3],o=Math.floor(n*(a/255));return o<t[0]?257:o<t[1]?1:o<t[2]?256:0}}(t);return function(t){for(var r=t.data,n=[],a=0;a<8;a+=1){for(var o=0,i=0;i<8;i+=1){o+=e(r.slice(4*(8*a+i)))<<7-i}n.push((o>>8).toString(16).padStart(2,"0"),(255&o).toString(16).padStart(2,"0"))}return n.join(" ").toUpperCase()}},br=function(t){return function(e){var r=t.dispatch,n=document.createElement("img"),a=document.createElement("canvas"),o=a.getContext("2d"),i=[];a.width=160,a.height=144,n.onload=function(){o.filter="grayscale(1)",128===n.naturalWidth&&112===n.naturalHeight?o.drawImage(n,16,16):o.drawImage(n,0,0,n.naturalWidth,n.naturalHeight,0,0,160,144);for(var u,c,l,s,f,p,y=(u=o.getImageData(0,0,160,144),c=u.data,l=be()(c,4).map((function(t){var e=yr(t,4),r=e[0],n=e[3];return Math.floor(r*(n/255))})),s=Math.min.apply(Math,pr(l)),f=Math.max.apply(Math,pr(l)),p=pr(new Array(7)).map((function(t,e){return{threshold:Math.ceil((f-s)/(7/(e+1)))+s,count:0}})),l.forEach((function(t){for(var e=0;e<7;e+=1){var r;t>((null==p||null===(r=p[e-1])||void 0===r?void 0:r.threshold)||-1)&&t<=p[e].threshold&&(p[e].count+=1)}})),gr(mr(p).slice(0,4)).slice(0,3).map((function(t){return t.threshold}))),d=vr(y),h=0;h<a.height;h+=8)for(var m=0;m<a.width;m+=8)i.push(d(o.getImageData(m,h,8,8)));var g=t.getState().frames,v=(0,qe.Z)(g).filter((function(t){var e=t.id;return!["int","jp","hk"].includes(e)})).map((function(t){return{value:t.id,name:t.name}}));v.unshift({value:"",name:"Select",selected:!0});var b=g.map((function(t){return t.id}));t.dispatch({type:"CONFIRM_ASK",payload:{message:'Choose how you want to import "'.concat(e.name,'".'),questions:fr({frameIds:b,frameGroups:v,fileName:e.name}),confirm:function(n){var a=n.frameSet,o=n.frameSetNew,u=n.frameIndex,c=n.frameName,l=sr({frameSet:a,frameSetNew:o,frameIndex:u});l&&c?(0,ur.e)(l,i).then((function(){r({type:"ADD_FRAME",payload:{id:l,name:c}})})):lr({lines:i,filename:e.name.split(".").shift(),palette:t.getState().activePalette}).then((function(t){r({type:"ADD_IMAGES",payload:[t]})}))},deny:function(){r({type:"CONFIRM_ANSWERED"})}}})},(0,cr.Z)(e,"dataURL").then((function(t){n.src=t}))}},Ar=function(t){if("#"===t.charAt(0)||"/"===t.charAt(0))return null;if("!"===t.charAt(0)||"{"===t.charAt(0)){try{var e=JSON.parse(t.slice(t.indexOf("{")).trim()),r=e.command,n=e.margin_lower;if("PRNT"===r&&n>0)return{type:"IMAGE_COMPLETE"}}catch(t){return{type:"PARSE_ERROR",payload:"Error while trying to parse JSON data command block"}}return null}var a=t.replace(/[^0-9A-F]/gi,"");return a.length?{type:"NEW_LINES",payload:[a]}:null},Er=r(25108);function Or(t){return function(t){if(Array.isArray(t))return Sr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Fr=function(t,e){var r=[],n="".concat(t,"\n").concat(ae.oU).split("\n").map(Ar).filter(Boolean).map((function(t){var e;switch(t.type){case"NEW_LINES":return(e=r).push.apply(e,Or(t.payload)),null;case"IMAGE_COMPLETE":var n=r.filter(Boolean);return r=[],!!n.length&&n;default:return null}})).filter(Boolean);return n.length||Er.warn("File ".concat(e," did not contain images")),Promise.resolve(n)},wr=r(25108),Tr=function(t){var e=t.dispatch,r=ar(t),n=We(e),a=br(t),o=function(t){wr.error(t),e({type:"ERROR",payload:"FILE_NOT_READ"})};return function(i){var u=i.map((function(t){var i=t,u=t.type,c=!0;return t.blob&&(i=t.blob,u=t.contentType,c=void 0!==t.ok?t.ok:c),c&&i.size?u&&u.startsWith("image/")?(a(i),Promise.resolve([])):i.size>268435455?(e({type:"ERROR",payload:"FILE_TOO_LARGE"}),Promise.resolve([])):"application/json"===u?((0,cr.Z)(i,"text").catch(o).then((function(t){var r={};try{r=JSON.parse(t)}catch(t){}r&&r.state?e({type:"JSON_IMPORT",payload:r}):e({type:"ERROR",payload:"NOT_A_SETTINGS_FILE"})})),Promise.resolve([])):"text/plain"===u?(0,cr.Z)(i,"text").catch(o).then((function(t){if(-1===t.indexOf('{"command"'))try{return ir(t,i.name)}catch(t){return e({type:"ERROR",payload:"NOT_A_DUMP"}),[]}return Fr(t,i.name)})).then((function(t){return t.map((function(t){return{lines:t,filename:i.name}}))})):i.size%512==0?(0,cr.Z)(i,"arrayBuffer").catch(o).then((function(t){return r(t,i.name)})):!u||u.startsWith("application/")?(0,cr.Z)(i,"arrayBuffer").catch(o).then((function(t){return 71===(e=t)[0]&&66===e[1]&&45===e[2]&&66===e[3]&&73===e[4]&&78===e[5]&&48===e[6]&&49===e[7]?n(t,i.name).then((function(t){return{lines:t,filename:i.name}})):[];var e})):(e({type:"ERROR",payload:"NOT_A_DUMP"}),Promise.resolve([])):(wr.error("Error in received data",t),Promise.resolve([]))}));Promise.all(u).then((function(r){var n=r.flat().filter(Boolean);n.length?e({type:"ADD_TO_QUEUE",payload:n}):t.dispatch({type:"CONFIRM_ANSWERED"})}))}};function Ir(t){return function(t){if(Array.isArray(t))return Dr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Dr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var _r=function(t){var e,r=document.querySelector("#app"),n=Tr(t),a=!1;return r.addEventListener("dragover",(function(r){r.preventDefault(),a||t.dispatch({type:"IMPORT_DRAGOVER_START"}),window.clearTimeout(e),a=!0,e=window.setTimeout((function(){a=!1,t.dispatch({type:"IMPORT_DRAGOVER_END"})}),250)})),r.addEventListener("drop",(function(t){var e;t.preventDefault(),e=t.dataTransfer.items?Ir(t.dataTransfer.items).filter((function(t){return"file"===t.kind})).map((function(t){return t.getAsFile()})):Ir(t.dataTransfer.files),n(e)})),function(t){return function(e){t(e)}}},Pr=function(t){var e=null;return function(n){return function(a){n(a);var o=t.getState().gitStorage,i=o.use,u=o.owner,c=o.repo,l=o.branch,s=o.token;i&&u&&c&&l&&s&&("SET_GIT_STORAGE"===a.type||"STORAGE_SYNC_START"===a.type&&"git"===a.payload.storageType)&&(e?e(a):Promise.all([r.e(524),r.e(340)]).then(r.bind(r,99981)).then((function(r){var n=r.init,o=r.middleware;n(t),(e=o(t))(a)})))}}},jr=function(){return function(t){return function(e){"ERROR"===e.type&&alert(e.payload),t(e)}}};function Rr(t){return function(t){if(Array.isArray(t))return Lr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Nr=function(t){var e=Tr(t);return function(t){return function(r){"IMPORT_FILES"!==r.type?t(r):r.payload.files&&r.payload.files.length&&e(Rr(r.payload.files))}}};r(60285);function Mr(t){return function(t){if(Array.isArray(t))return Gr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Gr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Cr=function(t){var e=null,n=null;return window.addEventListener("message",(function(r){var a,o=t.getState().printerUrl;try{a=new URL(o).origin}catch(t){a=new URL(window.location.href).origin}if(r.origin===a){var i=r.data.fromRemotePrinter,u=(i=void 0===i?{}:i).lines,c=i.progress,l=i.blob,s=i.blobsdone,f=i.commands,p=i.printerData,y=r.source;if(f&&(e&&JSON.stringify(f)===JSON.stringify(t.getState().printerFunctions)||t.dispatch({type:"PRINTER_FUNCTIONS_RECEIVED",payload:f}),n=y,window.clearTimeout(e),e=window.setTimeout((function(){e=null,n=null,t.dispatch({type:"HEARTBEAT_TIMED_OUT"})}),1500)),u){var d;try{d=new File(Mr(u.join("\n")),"Text input.txt",{type:"text/plain"})}catch(t){d=new Blob(Mr(u.join("\n")),{type:"text/plain"})}t.dispatch({type:"IMPORT_FILES",payload:{files:[d]}})}if(void 0!==c&&t.dispatch({type:"PRINTER_PROGRESS",payload:c}),l&&t.dispatch({type:"IMPORT_FILES",payload:{files:[l]}}),s){if("string"==typeof s[0])return void window.setTimeout((function(){alert("You should update the web-app to a version > 1.16.0 on your printer for an optimized import experience :-)")}),200);window.setTimeout((function(){t.dispatch({type:"IMPORT_FILES",payload:{files:s}})}),250)}p&&t.dispatch({type:"PRINTER_DATA_RECEIVED",payload:p})}})),function(e){return function(a){switch(a.type){case"REMOTE_CALL_FUNCTION":var o,i=t.getState(),u="fetchImages"===a.payload?{dumps:null===(o=i.printerData)||void 0===o?void 0:o.dumps}:void 0;r.e(705).then(r.t.bind(r,40705,23)).then((function(){r.e(591).then(r.t.bind(r,99591,23)).then((function(){n.postMessage({toRemotePrinter:{command:a.payload,params:u}},"*")}))}))}e(a)}}},kr=function(t){var e=(0,N.Z)("hash"),r=new(he())(1,1/0);return function(n){return function(a){if("ADD_TO_QUEUE"===a.type)return o=a.payload,void Promise.all(o.map((function(e){return r.add((function(){return lr({lines:e.lines,filename:e.file,palette:t.getState().activePalette,dispatch:t.dispatch})}))}))).then((function(r){var n=e(r),a=n.length===r.length?"":" (".concat(r.length-n.length," duplicates found in import)");t.dispatch({type:"CONFIRM_ASK",payload:{message:"Import ".concat(n.length," images?").concat(a),confirm:function(){t.dispatch({type:"ADD_IMAGES",payload:n})},deny:function(){t.dispatch({type:"CONFIRM_ANSWERED"})}}})}));var o;n(a)}}},Br=r(10577),xr=r.n(Br),Ur=function(t){return window.addEventListener("resize",(function(){t.dispatch({type:"WINDOW_DIMENSIONS",payload:{height:window.innerHeight,width:window.innerWidth}})})),xr().isEnabled&&xr().on("change",(function(){t.dispatch({type:"SET_IS_FULLSCREEN",payload:!!xr().element})})),document.addEventListener("keydown",(function(e){if(null!==t.getState().lightboxImage)switch(e.key){case"Esc":case"Escape":t.dispatch({type:"SET_LIGHTBOX_IMAGE_INDEX",payload:null}),e.preventDefault();break;case"Right":case"ArrowRight":t.dispatch({type:"LIGHTBOX_NEXT"}),e.preventDefault();break;case"Left":case"ArrowLeft":t.dispatch({type:"LIGHTBOX_PREV"}),e.preventDefault()}})),function(e){return function(r){var n=t.getState();switch(r.type){case"LIGHTBOX_NEXT":if(null===n.lightboxImage)return;return void t.dispatch({type:"SET_LIGHTBOX_IMAGE_INDEX",payload:Math.min(n.lightboxImage+1,n.images.length-1)});case"LIGHTBOX_PREV":if(null===n.lightboxImage)return;return void t.dispatch({type:"SET_LIGHTBOX_IMAGE_INDEX",payload:Math.max(n.lightboxImage-1,0)});case"LIGHTBOX_FULLSCREEN":xr().isEnabled&&(xr().element?xr().exit():xr().request(document.querySelector("body")));break;case"SET_LIGHTBOX_IMAGE_INDEX":xr().isEnabled&&!r.payload&&xr().element&&xr().exit();break;case"SET_LIGHTBOX_IMAGE_HASH":t.dispatch({type:"SET_LIGHTBOX_IMAGE_INDEX",payload:(0,Le.Z)(n).findIndex((function(t){return t.hash===r.payload}))})}e(r)}}},Zr=r(44936),Hr=r.n(Zr),Vr=r(25108),Yr=function(t){var e={},r=new(Hr())(1,1/0),n=function(e){t.dispatch({type:"EXECUTE_PLUGIN_PROGRESS",payload:e%1})},a=function(e){var r=t.getState(),n=r.handleExportFrame,a=r.images.find((function(t){return t.hash===e})),o=(0,Ee.Z)(r,a),i=function(){return(0,Ae.Z)(r)(a)};a.isRGBN=!!a.hashes;return{getMeta:function(){return Promise.resolve(a)},getPalette:function(){return Promise.resolve(o)},getTiles:i,getCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.scaleFactor,r=void 0===e?1:e,u=t.palette,c=void 0===u?o:u,l=t.lockFrame,s=void 0===l?a.lockFrame||!1:l,f=t.invertPalette,p=void 0===f?a.invertPalette||!1:f,y=t.handleExportFrame,d=void 0===y?n:y;return i().then((function(t){var e=a.isRGBN?new Oe.Z:new Se.Z;return a.isRGBN?e.update({tiles:Oe.Z.rgbnTiles(t),palette:c,lockFrame:s}):e.update({tiles:t,palette:c.palette,lockFrame:s,invertPalette:p}),e.getScaledCanvas(r,d)}))}}},o=function(o){var i=(t.getState().plugins.find((function(t){var e=t.url;return o.url===e}))||{}).config,u=void 0===i?{}:i,c=o.url;return r.add((function(){return new Promise((function(r){window.gbpwRegisterPlugin=function(o){window.gbpwRegisterPlugin=function(){};try{var i=new o({saveAs:ge.saveAs,progress:n,store:t,collectImageData:a},u),l=i.name,s=i.description,f=void 0===s?"":s,p=i.configParams,y=void 0===p?{}:p,d=i.config,h=void 0===d?{}:d;e[c]=i,t.dispatch({type:"PLUGIN_UPDATE_PROPERTIES",payload:{url:c,name:l,description:f,configParams:y,config:h,loading:!1,error:!1}}),r(!0)}catch(e){t.dispatch({type:"PLUGIN_UPDATE_PROPERTIES",payload:{url:c,loading:!1,error:e.message}}),r(!1)}};var o=document.createElement("script");document.head.appendChild(o),o.addEventListener("error",(function(){window.gbpwRegisterPlugin=function(){},t.dispatch({type:"PLUGIN_UPDATE_PROPERTIES",payload:{url:c,loading:!1,error:"Loading error"}}),r(!1)})),o.src=c}))}))};return window.requestAnimationFrame((function(){var e=t.getState().plugins;Promise.all(e.map(o)).then((function(t){Vr.log("".concat(t.filter(Boolean).length," plugins initialized"))})).catch((function(t){Vr.error(t)}))})),function(r){return function(n){switch(n.type){case"PLUGIN_IMAGE":var i=n.payload,u=i.url,c=i.hash;e[u].withImage(a(c));break;case"PLUGIN_IMAGES":var l=n.payload.url,s=t.getState().imageSelection;e[l].withSelection(s.map(a));break;case"PLUGIN_UPDATE_CONFIG":var f=n.payload,p=f.url,y=f.config;e[p].setConfig(y);break;case"PLUGIN_ADD":o({url:n.payload});break;case"PLUGIN_REMOVE":delete e[n.payload]}r(n)}}};function Xr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $r(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Xr(Object(r),!0).forEach((function(e){Wr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Wr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zr=function(t){return["#",Math.ceil(Math.random()*t).toString(16).padStart(2,"0"),Math.ceil(Math.random()*t).toString(16).padStart(2,"0"),Math.ceil(Math.random()*t).toString(16).padStart(2,"0")].join("")},Jr=function(t,e,r,n){var a=r===P.VP?{name:"",shortName:P.VP,palette:[zr(255),zr(170),zr(102),zr(34)],origin:"Selfmade"}:e.find((function(t){return t.shortName===r}));t({type:"SET_EDIT_PALETTE",payload:$r($r({},a),{},{name:n?"Copy of ".concat(a.name):a.name,shortName:n?P.VP:r})})},qr=function(t){return document.addEventListener("keydown",(function(e){if("Enter"===e.key&&e.ctrlKey&&t.getState().editPalette.hash){var r=t.getState();t.dispatch({type:"SAVE_EDIT_PALETTE"}),r.editPalette&&e.preventDefault()}})),function(e){return function(r){switch(r.type){case"SAVE_EDIT_PALETTE":return n=t.dispatch,a=t.getState(),void n({type:"PALETTE_UPDATE",payload:$r($r({},a.editPalette),{},{tags:(0,Ne.Z)(a.editPalette.tags)})});case"PALETTE_EDIT":return void Jr(t.dispatch,t.getState().palettes,r.payload,!1);case"PALETTE_CLONE":return void Jr(t.dispatch,t.getState().palettes,r.payload,!0)}var n,a;e(r)}}};function Kr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Kr(Object(r),!0).forEach((function(e){tn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function tn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var en=function(t){return function(e){return function(n){if("SAVE_RGBN_IMAGE"===n.type){var a=t.getState();r.e(705).then(r.t.bind(r,40705,23)).then((function(e){var r=e.default,n={palette:ae.q1,hashes:Qr({},a.rgbnImages),hash:r(a.rgbnImages),created:Gt()().format(ae.vc),title:"",tags:[]};t.dispatch({type:"ADD_IMAGES",payload:[n]})}))}e(n)}}},rn=r(75634),nn=r(85953);function an(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function on(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?an(Object(r),!0).forEach((function(e){un(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):an(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function un(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cn(t){return function(t){if(Array.isArray(t))return ln(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ln(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ln(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var sn=function(t,e,r){var n=t.frames,a=t.images,o=t.palettes;if(r){var i,u,c;if(e.frames&&e.frames.length)(i=n).unshift.apply(i,cn(e.frames));if(e.images&&e.images.length)(u=a).unshift.apply(u,cn(e.images));if(e.palettes&&e.palettes.length)(c=o).unshift.apply(c,cn(e.palettes))}else n=e.frames||t.frames,a=e.images||t.images,o=e.palettes||t.palettes;return on(on(on({},t),e),{},{images:a,frames:n,palettes:o})},fn=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object.keys(r).forEach((function(t){"state"!==t&&(t.match(/^[a-f0-9]{40}$/gi)?Ve.Rt.setItem("".concat(t),r[t]):t.startsWith("frame-")&&Ve.$0.setItem("".concat(t.split("frame-").pop()),r[t]))})),t({type:"GLOBAL_UPDATE",payload:fe(sn(e,r.state||{},n))})},pn=function(t){var e=(0,nn.Z)(t);return function(r){return function(n){switch(n.type){case"JSON_EXPORT":a=n.payload,e(a).then((function(t){(0,rn.L)(null)([{blob:new Blob(new Array(t)),filename:"".concat(a,".json")}])}));break;case"JSON_IMPORT":fn(t.dispatch,t.getState(),n.payload,!0);break;case"GIT_SETTINGS_IMPORT":case"DROPBOX_SETTINGS_IMPORT":fn(t.dispatch,t.getState(),n.payload,!1)}var a;r(n)}}};function yn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function dn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?yn(Object(r),!0).forEach((function(e){hn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function hn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mn(t){return function(t){if(Array.isArray(t))return gn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return gn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var vn=function(t){return function(e){return function(r){if("SHARE_IMAGE"===r.type){var n=t.getState(),a=n.images.find((function(t){return t.hash===r.payload})),o=(0,Ee.Z)(n,a),i=mn(n.exportScaleFactors).pop()||4,u=mn(n.exportFileTypes).pop()||"png",c=(0,rn.j)(dn(dn({},n),{},{exportScaleFactors:[i],exportFileTypes:[u]}));(0,Ae.Z)(n)(a).then(c(o,a)).then((function(t){var e=t[0],r=e.blob,n=e.filename,a=e.title;window.navigator.share&&window.navigator.share({files:[new File([r],n,{type:"image/png",lastModified:new Date})],title:a}).catch((function(){return"\\_()_/"}))}))}e(r)}}},bn=r(96905),An=function(t){return function(e){return function(r){if("START_DOWNLOAD"===r.type||"DOWNLOAD_SELECTION"===r.type){var n=t.getState(),a=(0,rn.j)(n);switch(r.type){case"START_DOWNLOAD":!function(t,e){return function(r){var n=e.images.find((function(t){return t.hash===r})),a=(0,Ee.Z)(e,n),o=(0,Fe.Z)({image:n,palette:a});return(0,Ae.Z)(e)(n).then(t(a,n)).then((0,bn.Z)(o))}}(a,n)(r.payload);break;case"DOWNLOAD_SELECTION":!function(t,e){return function(r){var n=(0,Fe.Z)({altTitle:"gameboy-printer-gallery",useCurrentDate:!0});Promise.all(r.map((function(r){var n=e.images.find((function(t){return t.hash===r})),a=(0,Ee.Z)(e,n);return(0,Ae.Z)(e)(n).then(t(a,n))}))).then((function(t){return t.flat()})).then((0,bn.Z)(n))}}(a,n)(r.payload)}}return e(r)}}},En=(0,i.md)(Re,Ze,Xe,$e,jr,_r,Pr,Nr,Cr,kr,Ur,Yr,qr,en,pn,vn,An),On=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.qC,Sn=[En,(0,i.md)(ye)],Fn=function(t){var e=(0,i.MT)(ee,fe(t),On.apply(void 0,Sn));return window.store=e,e},wn=r(22429),Tn=function(){var t=document.getElementById("app");if(t){var e;try{e=JSON.parse(localStorage.getItem("gbp-web-state"))||{}}catch(t){e={}}"esp8266"===(0,wn.d)().env&&(e.printerUrl="/");var i=Object.assign(pe.c,e);Promise.all([r.e(172),r.e(143)]).then(r.bind(r,22678)).then((function(e){var r=e.default;try{var u=Fn(i);(0,o.render)(n.createElement(a.zt,{store:u},n.createElement(r,null)),t)}catch(t){document.getElementById("app").innerHTML='<p class="init-error">Error while initializing the app:<br>'.concat(t.message,"<br><small>").concat(t.stack,"</small></p>")}}))}}},81913:function(t,e,r){"use strict";r.d(e,{c:function(){return a},C:function(){return n}});r(89554);var n=[{key:"printerUrl",saveLocally:!0,saveExport:["settings"],value:""},{key:"printerParams",saveLocally:!0,saveExport:["settings"],value:""},{key:"activePalette",saveLocally:!0,saveExport:["settings","remote"],value:"bw"},{key:"images",saveLocally:!0,saveExport:["selected_images","images","remote"],value:[]},{key:"galleryView",saveLocally:!0,saveExport:["settings"],value:"1x"},{key:"exportScaleFactors",saveLocally:!0,saveExport:["settings","remote"],value:[4]},{key:"exportFileTypes",saveLocally:!0,saveExport:["settings","remote"],value:["png"]},{key:"pageSize",saveLocally:!0,saveExport:["settings","remote"],value:15},{key:"imageSelection",saveLocally:!0,saveExport:["selected_images"],value:[]},{key:"rgbnImages",saveLocally:!0,saveExport:[],value:{}},{key:"editImage",saveLocally:!0,saveExport:[],value:null},{key:"videoParams",saveLocally:!0,saveExport:["settings","remote"],value:{}},{key:"filtersActiveTags",saveLocally:!0,saveExport:[],value:[]},{key:"filtersVisible",saveLocally:!0,saveExport:[],value:!1},{key:"savFrameTypes",saveLocally:!0,saveExport:["settings","remote"],value:"int"},{key:"sortBy",saveLocally:!0,saveExport:["settings","remote"],value:"created_asc"},{key:"handleExportFrame",saveLocally:!0,saveExport:["settings","remote"],value:"keep"},{key:"importLastSeen",saveLocally:!0,saveExport:["settings","remote"],value:!0},{key:"hideDates",saveLocally:!0,saveExport:["settings","remote"],value:!1},{key:"palettes",saveLocally:!0,saveExport:["palettes","remote"],value:[]},{key:"plugins",saveLocally:!0,saveRemote:!1,saveExport:["settings","remote"],value:[]},{key:"framesMessage",saveLocally:!0,saveExport:["settings","remote"],value:0},{key:"frames",saveLocally:!0,saveExport:["frames","remote"],value:[]},{key:"recentImports",saveLocally:!0,saveExport:[],value:[]},{key:"gitStorage",saveLocally:!0,saveExport:[],value:{use:!1,owner:"",repo:"",branch:"",token:"",throttle:"330"}},{key:"dropboxStorage",saveLocally:!0,saveExport:[],value:{path:""}}],a={};n.forEach((function(t){var e=t.key,r=t.value;a[e]=r}))},99449:function(t,e,r){"use strict";r.d(e,{Dh:function(){return n},TZ:function(){return a},z2:function(){return o},ee:function(){return i},Vn:function(){return u},oJ:function(){return c},VP:function(){return l}});var n="__filter:untagged__",a="__filter:new__",o="__filter:mono__",i="__filter:rgb__",u="__filter:recent__",c="__filter:favourite__",l="__new:palette__"},99005:function(t,e,r){"use strict";r(43290),r(66992),r(39575),r(41539),r(49743),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(89554),r(54747),r(57327),r(21249),r(92222),r(47042),r(69600),r(91058),r(66528),r(74916),r(15306),r(69070),r(79753),r(82526),r(41817),r(32165),r(78783),r(33948),r(91038),r(68309);var n=r(38644);function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",c=20,l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=null,this.tiles=[],this.colors=[],this.rawImageData=[],this.lockFrame=!1,this.invertPalette=!1,this.bwPalette=[16777215,11184810,5592405,0],this.colorData=this.bwPalette,this.blackLine=Array(20).fill(u),this.whiteLine=Array(20).fill("00000000000000000000000000000000"),this.tileIndexIsFramePart=n.Z}var e,r,o;return e=t,(r=[{key:"update",value:function(t){var e=this,r=t.canvas,n=void 0===r?null:r,a=t.tiles,o=void 0===a?[]:a,i=t.palette,u=void 0===i?[]:i,c=t.lockFrame,l=void 0!==c&&c,s=t.invertPalette,f=void 0!==s&&s,p=this.setCanvas(n),y=this.setPalette(u,f),d=this.setLockFrame(l);(p||y||d||!this.tiles.length)&&(this.tiles=[]);var h=this.setTiles(o),m=this.getHeight();if(0!==m){if(this.canvas){if(this.canvas.height!==m||!this.rawImageData.length){this.canvas.height=m;var g=new Uint8ClampedArray(160*m*4);this.rawImageData.forEach((function(t,e){g[e]=t})),this.rawImageData=g}h.forEach((function(t){var r=t.index,n=t.newTile;e.renderTile(r,n)})),this.updateCanvas(m)}}else this.canvas.height=0}},{key:"updateCanvas",value:function(t){var e,r=this.canvas.getContext("2d");try{e=new ImageData(this.rawImageData,160,t)}catch(n){e=r.getImageData(0,0,160,t),this.rawImageData.forEach((function(t,r){e.data[r]=t}))}r.putImageData(e,0,0)}},{key:"getScaledCanvas",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keep",n=360===this.tiles.length?r:"keep",a=this.getScaleCanvasSize(n),o=a.initialHeight,i=a.initialWidth,u=a.tilesPerLine,c=document.createElement("canvas"),l=c.getContext("2d");return c.width=i*t,c.height=o*t,this.getExportTiles(n).forEach((function(n,a){e.paintTileScaled(e.decodeTile(n),a,l,t,u,r)})),c}},{key:"getScaleCanvasSize",value:function(t){switch(t){case"keep":return{initialHeight:this.getHeight(),initialWidth:160,tilesPerLine:c};case"crop":return{initialHeight:this.getHeight()-32,initialWidth:128,tilesPerLine:16};case"square_black":case"square_white":case"square_smart":return{initialHeight:this.getHeight()+16,initialWidth:160,tilesPerLine:c};default:throw new Error("unknown export mode ".concat(t))}}},{key:"getExportTiles",value:function(t){var e=this;switch(t){case"keep":return this.tiles;case"crop":return this.tiles.map((function(t,r){return e.tileIndexIsFramePart(r,"keep")?null:t})).filter(Boolean);case"square_black":return[].concat(a(this.blackLine),a(this.tiles),a(this.blackLine));case"square_white":return[].concat(a(this.whiteLine),a(this.tiles),a(this.whiteLine));case"square_smart":return[].concat(a(this.smartTile("first")),a(this.tiles),a(this.smartTile("last")));default:throw new Error("unknown export mode ".concat(t))}}},{key:"smartTile",value:function(t){switch(t){case"first":return this.tiles.slice(0,20).map((function(t){return Array(8).fill(t.slice(0,4)).join("")}));case"last":return this.tiles.slice(340,360).map((function(t){return Array(8).fill(t.slice(28,32)).join("")}));default:return this.blackLine}}},{key:"setCanvas",value:function(t){return this.canvas!==t&&(this.canvas=t,!0)}},{key:"setPalette",value:function(t,e){return(JSON.stringify(this.colors)!==JSON.stringify(t)||this.invertPalette!==e)&&(this.colors=t,this.invertPalette=e,this.colorData=this.colors.map((function(t){return 7!==t.length?null:parseInt(t.substring(1),16)})),!0)}},{key:"setLockFrame",value:function(t){return t!==this.lockFrame&&(this.lockFrame=t,!0)}},{key:"setTiles",value:function(t){var e=this,r=t.map((function(t,r){return t!==e.tiles[r]?{index:r,newTile:t}:null})).filter(Boolean);return this.tiles=t,r}},{key:"renderTile",value:function(t,e){var r=this.decodeTile(e);this.paintTile(r,t)}},{key:"decodeTile",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=t.replace(/[^0-9A-F]/gi,"").padEnd(32,"f"),r=new Array(16),n=0;n<r.length;n+=1)r[n]=parseInt(e.substr(2*n,2),16);for(var a=new Array(64),o=0;o<8;o+=1)for(var i=0;i<8;i+=1){var c=r[2*o+1]>>7-i&1,l=r[2*o]>>7-i&1;a[8*o+i]=c<<1|l}return a}},{key:"getRGBValue",value:function(t,e,r,n){var a=this.lockFrame&&"crop"!==n&&this.tileIndexIsFramePart(r,n)?this.bwPalette:this.colorData,o=this.invertPalette?a[3-t[e]]:a[t[e]];return{r:(16711680&o)>>16,g:(65280&o)>>8,b:255&o}}},{key:"paintTile",value:function(t,e){for(var r=e%c*8,n=8*Math.floor(e/c),a=0;a<8;a+=1)for(var o=0;o<8;o+=1){var i=4*(r+a+160*(n+o)),u=this.getRGBValue(t,8*o+a,e,"keep");this.rawImageData[i]=u.r,this.rawImageData[i+1]=u.g,this.rawImageData[i+2]=u.b,this.rawImageData[i+3]=255}}},{key:"paintTileScaled",value:function(t,e,r,n,a,o){for(var i=e%a*8*n,u=8*Math.floor(e/a)*n,c=0;c<8;c+=1)for(var l=0;l<8;l+=1){var s=this.getRGBValue(t,8*l+c,e,o);r.fillStyle="rgb(".concat(s.r,", ").concat(s.g,", ").concat(s.b,")"),r.fillRect(i+c*n,u+l*n,n+1,n+1)}}},{key:"getHeight",value:function(){return 8*Math.ceil(this.tiles.length/c)}}])&&i(e.prototype,r),o&&i(e,o),t}();e.Z=l},21334:function(t,e,r){"use strict";r.d(e,{_I:function(){return o},qe:function(){return i},Rg:function(){return u}});var n;r(69070);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o={NORMAL:"normal",NORMAL_S:"normal_s",LIGHTEN:"lighten",SCREEN:"screen",DODGE:"dodge",DODGE_S:"dodge_s",ADDITION:"addition",DARKEN:"darken",MULTIPLY:"multiply",BURN:"burn",BURN_S:"burn_s",OVERLAY:"overlay",SOFTLIGHT:"softlight",SOFTLIGHT_S:"softlight_s",HARDLIGHT:"hardlight",DIFFERENCE:"difference",SUBTRACT:"subtract",SUBTRACT_S:"subtract_s",GRAIN_EXTRACT:"grainextract",GRAIN_EXTRACT_S:"grainextract_s",GRAIN_MERGE:"grainmerge",DIVIDE:"divide",DIVIDE_S:"divide_s"},i=(a(n={},o.NORMAL,(function(t,e){return t})),a(n,o.LIGHTEN,(function(t,e){return Math.max(e,t)})),a(n,o.SCREEN,(function(t,e){return 1-(1-e)*(1-t)})),a(n,o.DODGE,(function(t,e){return t/(1-e)})),a(n,o.ADDITION,(function(t,e){return e+t})),a(n,o.DARKEN,(function(t,e){return Math.min(e,t)})),a(n,o.MULTIPLY,(function(t,e){return e*t})),a(n,o.BURN,(function(t,e){return 1-(1-t)/e})),a(n,o.OVERLAY,(function(t,e){return t<.5?2*t*e:1-2*(1-e)*(1-t)})),a(n,o.SOFTLIGHT,(function(t,e){return(1-t)*i[o.MULTIPLY](t,e)+t*i[o.SCREEN](t,e)})),a(n,o.DIFFERENCE,(function(t,e){return Math.abs(t-e)})),a(n,o.SUBTRACT,(function(t,e){return t-e})),a(n,o.GRAIN_EXTRACT,(function(t,e){return t-e+.5})),a(n,o.GRAIN_MERGE,(function(t,e){return t+e-.5})),a(n,o.DIVIDE,(function(t,e){return t/e})),a(n,o.NORMAL_S,(function(t,e){return i[o.NORMAL](e,t)})),a(n,o.DODGE_S,(function(t,e){return i[o.DODGE](e,t)})),a(n,o.BURN_S,(function(t,e){return i[o.BURN](e,t)})),a(n,o.HARDLIGHT,(function(t,e){return i[o.OVERLAY](e,t)})),a(n,o.SOFTLIGHT_S,(function(t,e){return i[o.SOFTLIGHT](e,t)})),a(n,o.SUBTRACT_S,(function(t,e){return i[o.SUBTRACT](e,t)})),a(n,o.GRAIN_EXTRACT_S,(function(t,e){return i[o.GRAIN_EXTRACT](e,t)})),a(n,o.DIVIDE_S,(function(t,e){return i[o.DIVIDE](e,t)})),n),u=[{id:o.NORMAL,label:"Normal (ignore neutral layer)"},{id:o.NORMAL_S,label:"Normal  (only neutral layer)"},{id:o.LIGHTEN,label:"Lighten only"},{id:o.SCREEN,label:"Screen"},{id:o.DODGE,label:"Dodge"},{id:o.DODGE_S,label:"Dodge "},{id:o.ADDITION,label:"Addition"},{id:o.DARKEN,label:"Darken only"},{id:o.MULTIPLY,label:"Multiply"},{id:o.BURN,label:"Burn"},{id:o.BURN_S,label:"Burn "},{id:o.OVERLAY,label:"Overlay"},{id:o.SOFTLIGHT,label:"Soft light"},{id:o.SOFTLIGHT_S,label:"Soft light "},{id:o.HARDLIGHT,label:"Hard light"},{id:o.DIFFERENCE,label:"Difference"},{id:o.SUBTRACT,label:"Subtract"},{id:o.SUBTRACT_S,label:"Subtract "},{id:o.GRAIN_EXTRACT,label:"Grain extract"},{id:o.GRAIN_EXTRACT_S,label:"Grain extract "},{id:o.GRAIN_MERGE,label:"Grain merge"},{id:o.DIVIDE,label:"Divide"},{id:o.DIVIDE_S,label:"Divide "}]},25984:function(t,e,r){"use strict";r(21249),r(47042),r(69600),r(43290),r(68304),r(30489),r(12419),r(78011),r(74819),r(38880),r(69070),r(79753),r(82526),r(41817),r(41539),r(32165),r(66992),r(78783),r(33948),r(68309),r(91038);var n=r(99005),a=r(21334);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(t){u=!0,a=t}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(r):a.value}})(t,e,r||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=h(t);if(e){var a=h(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d(this,r)}}function d(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(c,t);var e,r,n,o=y(c);function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this)).blackLine=c.rgbnTiles([t.blackLine,t.blackLine,t.blackLine,t.blackLine]),t.whiteLine=c.rgbnTiles([t.whiteLine,t.whiteLine,t.whiteLine,t.whiteLine]),t}return e=c,n=[{key:"rgbnTiles",value:function(t){var e=u(t,4),r=e[0],n=e[1],a=e[2],o=e[3],c=Math.max((null==r?void 0:r.length)||0,(null==n?void 0:n.length)||0,(null==a?void 0:a.length)||0,(null==o?void 0:o.length)||0);return i(Array(c)).map((function(t,e){return{r:null==r?void 0:r[e],g:null==n?void 0:n[e],b:null==a?void 0:a[e],n:null==o?void 0:o[e]}}))}}],(r=[{key:"setPalette",value:function(t){return!!t&&JSON.stringify(this.palette)!==JSON.stringify(t)&&(this.palette=t,!0)}},{key:"decodeTile",value:function(t){var e=t.r,r=t.g,n=t.b,a=t.n;return{r:f(h(c.prototype),"decodeTile",this).call(this,e),g:f(h(c.prototype),"decodeTile",this).call(this,r),b:f(h(c.prototype),"decodeTile",this).call(this,n),n:a?f(h(c.prototype),"decodeTile",this).call(this,a):null}}},{key:"getRGBValue",value:function(t,e,r,n){var a=t.r,o=t.g,i=t.b,u=t.n;if(this.lockFrame&&"crop"!==n&&this.tileIndexIsFramePart(r,n)&&u)try{return f(h(c.prototype),"getRGBValue",this).call(this,u,e,r,n)}catch(t){return{r:255*Math.random(),g:255*Math.random(),b:255*Math.random()}}return this.blendColors({r:a[e],g:o[e],b:i[e],n:!!u&&u[e]})}},{key:"smartTile",value:function(t){var e=this;switch(t){case"first":return this.tiles.slice(0,20).map((function(t){return{r:t.r?Array(8).fill(t.r.slice(0,4)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),g:t.g?Array(8).fill(t.g.slice(0,4)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),b:t.b?Array(8).fill(t.b.slice(0,4)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),n:t.n?Array(8).fill(t.n.slice(0,4)).join(""):f(h(c.prototype),"smartTile",e).call(e,null)}}));case"last":return this.tiles.slice(340,360).map((function(t){return{r:t.r?Array(8).fill(t.r.slice(28,32)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),g:t.g?Array(8).fill(t.g.slice(28,32)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),b:t.b?Array(8).fill(t.b.slice(28,32)).join(""):f(h(c.prototype),"smartTile",e).call(e,null),n:t.n?Array(8).fill(t.n.slice(28,32)).join(""):f(h(c.prototype),"smartTile",e).call(e,null)}}));default:return f(h(c.prototype),"smartTile",this).call(this,null)}}},{key:"blendColors",value:function(t){var e=t.r,r=t.g,n=t.b,o=t.n,i={r:this.palette.r[3-e],g:this.palette.g[3-r],b:this.palette.b[3-n]};if(!1===o)return i;var u=this.palette.blend||a._I.MULTIPLY;if(!a.qe[u])return i;var c=function(t,e){return 255*Math.max(0,Math.min(1,a.qe[u](t/255,e/255)))};return{r:c(this.palette.r[3-e],this.palette.n[3-o]),g:c(this.palette.g[3-r],this.palette.n[3-o]),b:c(this.palette.b[3-n],this.palette.n[3-o])}}},{key:"getHeight",value:function(){return 144}}])&&s(e.prototype,r),n&&s(e,n),c}(n.Z);e.Z=m},7199:function(t,e,r){"use strict";r.d(e,{v:function(){return i},e:function(){return o}});r(66992),r(41539),r(88674),r(78783),r(33948),r(69600),r(21249),r(57327),r(74916),r(15306),r(23123),r(47042),r(43290);var n=r(38644),a=r(91252),o=function(t,e){return r.e(591).then(r.t.bind(r,99591,23)).then((function(r){var o=r.default,i=e.filter((function(t,e){return(0,n.Z)(e,"keep")})).map((function(t){return t.replace(/ /gi,"")})).join("\n"),u=o.deflate(i,{to:"string",strategy:1,level:8});return a.$0.setItem(t,u)}))},i=function(t){return t?a.$0.getItem(t).then((function(t){return t?r.e(591).then(r.t.bind(r,99591,23)).then((function(e){var r=e.default;try{var n=r.inflate(t,{to:"string"}).split("\n");return{upper:n.slice(0,40),left:Array(14).fill(0).map((function(t,e){return n.slice(4*e+40,4*e+42)})),right:Array(14).fill(0).map((function(t,e){return n.slice(4*e+42,4*e+44)})),lower:n.slice(96,136)}}catch(t){return null}})):null})):Promise.resolve(null)}},88856:function(t,e,r){"use strict";r(41539),r(88674),r(89554),r(54747),r(79753),r(82526),r(41817),r(32165),r(66992),r(78783),r(33948),r(91038),r(47042),r(68309);var n=r(7199);function a(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.Z=function(t,e){return 360!==t.length?Promise.resolve(t):(0,n.v)(e).then((function(e){var r=a(t);return e.upper.forEach((function(t,e){r[e]=t})),e.lower.forEach((function(t,e){r[e+320]=t})),e.left.forEach((function(t,e){r[20*e+40]=t[0],r[20*e+41]=t[1]})),e.right.forEach((function(t,e){r[20*e+58]=t[0],r[20*e+59]=t[1]})),r})).catch((function(){return t}))}},23506:function(t,e,r){"use strict";r(92222),r(57327),r(34553),r(26699),r(32023),r(79753),r(82526),r(41817),r(41539),r(32165),r(66992),r(78783),r(33948),r(91038),r(47042),r(68309);function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.Z=function(t){var e=t.initial,r=t.add,a=t.remove,o=[].concat(n(e),n(r));return o.filter((function(t,e){return o.findIndex((function(e){return e===t}))===e})).filter((function(t){return!a.includes(t)}))}},11054:function(t,e,r){"use strict";r(73210),r(74916),r(4723),r(24603),r(39714),r(92222),r(27852);e.Z=function(t,e){if(!t.trim())return"";if("/"===t&&"ws"!==e)return t;var r=!!t.match(new RegExp("^".concat(e,"(s)?:\\/\\/"),"gi"));return"".concat(r?"":"".concat(e,"://")).concat(t).concat(t.endsWith("/")?"":"/")}},96905:function(t,e,r){"use strict";r.d(e,{Z:function(){return i}});r(66992),r(41539),r(88674),r(78783),r(33948),r(21249),r(89554),r(54747);var n=r(93162),a=function(t){return"function"==typeof t.arrayBuffer?t.arrayBuffer():new Promise((function(e){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsArrayBuffer(t)}))},o=r(46660),i=function(t){return function(e){if(1!==e.length)r.e(733).then(r.t.bind(r,55733,23)).then((function(r){var i=new(0,r.default);Promise.all(e.map((function(t){var e=t.filename,r=t.blob;return a(r).then((function(t){return{filename:e,arrayBuffer:t}}))}))).then(o.Z).then((function(t){t.forEach((function(t){var e=t.uFilename,r=t.arrayBuffer;i.file(e,r)}))})).then((function(){return i.generateAsync({type:"blob",compression:"DEFLATE"}).then((function(e){(0,n.saveAs)(e,"".concat(t,".zip"))}))}))}));else{var i=e[0];(0,n.saveAs)(i.blob,i.filename)}}}},70440:function(t,e,r){"use strict";r(57327),r(21249),r(41539),r(88674),r(85827),r(69600),r(74916),r(4723),r(92222),r(66992),r(78783),r(33948),r(84944),r(79753),r(82526),r(41817),r(32165),r(91038),r(47042),r(68309);var n=r(99005),a=r(25984),o=r(75409),i=r(20260),u=r(67508);function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.Z=function(t){return function(e,r){return function(l){var s=t.exportScaleFactors,f=t.exportFileTypes,p=t.handleExportFrame,y=!!r.hashes,d=y?new a.Z:new n.Z,h=r.lockFrame||!1,m=r.invertPalette||!1;y?d.update({tiles:l,palette:e,lockFrame:h}):d.update({tiles:l,palette:e.palette,lockFrame:h,invertPalette:m});var g=c(s).filter((function(t){return"number"==typeof t})),v=c(f);g.length||g.push(4),v.length||v.push("png");var b=g.map((function(t){return v.map((function(n){return new Promise((function(a){var l=(0,o.Z)({image:r,palette:e,exportScaleFactor:t});if("txt"===n){if(r.hashes)return void a(null);(0,i.zD)(r.hash,null).then((function(t){var e=t.map((function(t){return t.match(/.{1,2}/g).join(" ")})).reduce((function(t,e,r){return[].concat(c(t),r%40?[e]:[u.fb,e])}),[]),o=[u.jU].concat(c(e),[u.T6,u.oU]).join("\n");a({folder:"images",filename:"".concat(l,".").concat(n),blob:new Blob(new Array(o),{type:"text/plain"}),title:r.title})}))}else{d.getScaledCanvas(t,p).toBlob((function(t){a({filename:"".concat(l,".").concat(n),blob:t,title:r.title})}),"image/".concat(n),1)}}))}))}));return Promise.all(b.flat()).then((function(t){return t.filter(Boolean)}))}}}},75634:function(t,e,r){"use strict";r.d(e,{L:function(){return n.Z},j:function(){return a.Z}});var n=r(96905),a=r(70440)},75409:function(t,e,r){"use strict";r(83112),r(83710),r(41539),r(39714),r(69600),r(21249),r(57327);var n=r(27484),a=r.n(n),o=r(10285),i=r.n(o),u=r(67508);a().extend(i());e.Z=function(t){var e,r,n,o,i,c,l=t.image,s=void 0!==l&&l,f=t.palette,p=void 0!==f&&f,y=t.exportScaleFactor,d=void 0!==y&&y,h=t.frameRate,m=void 0!==h&&h,g=t.altTitle,v=void 0!==g&&g,b=t.useCurrentDate,A=void 0!==b&&b,E=t.frameName,O=void 0!==E&&E,S=t.paletteShort,F=void 0!==S&&S,w=A?a()():a()(s.created,u.vc),T=!!w.isValid()&&w.format(u.z3),I=F||!!p&&(p.shortName||(r=(e=p).r,n=e.g,o=e.b,i=e.n,c=function(t){return t.toString(16).padStart(2,"0")},[r.map(c).join(""),n.map(c).join(""),o.map(c).join(""),i.map(c).join("")].join("")));return[T,s&&s.title?s.title:v,d?"".concat(d,"x"):null,m?"".concat(m,"fps"):null,O,I].filter(Boolean).join("-")}},76293:function(t,e,r){"use strict";r(26699),r(32023),r(21249),r(69826);var n=r(27484),a=r.n(n),o=r(99449),i=r(67508);e.Z=function(t,e){return function(r){if(t.length){if(t.includes(o.Dh)&&0===r.tags.length)return!0;if(t.includes(o.TZ))if(a()(r.created,i.vc).unix()>a()().subtract("1","day").unix())return!0;return t.includes(o.Vn)?e.map((function(t){return t.hash})).includes(r.hash):!(!t.includes(o.ee)||!r.hashes)||(!(!t.includes(o.z2)||r.hashes)||!!r.tags.find((function(e){return t.includes(e)})))}return!0}}},13509:function(t,e,r){"use strict";r(57327),r(21249),r(2707),r(79753),r(82526),r(41817),r(41539),r(32165),r(66992),r(78783),r(33948),r(91038),r(47042),r(68309);var n=r(39532),a=r(76293);function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e.Z=function(t){var e=t.images,r=t.filtersActiveTags,i=t.sortBy,u=t.recentImports;return o(e).map(n.Np).sort((0,n.$b)({sortBy:i})).map(n.fD).filter((0,a.Z)(r,u))}},36940:function(t,e,r){"use strict";r(85827),r(68309),r(74916),r(4723),r(69826);var n=function(t,e){switch(t){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return e}};e.Z=function(t){return t.reduce((function(t,e){var r,a=e.id,o=e.name;try{r=a.match(/^[a-z]{2,}/g)[0]}catch(e){return t}return t.find((function(t){return t.id===r}))||t.push({id:r,name:n(r,o)}),t}),[])}},85953:function(t,e,r){"use strict";r.d(e,{Z:function(){return p}});r(89554),r(54747),r(26699),r(32023),r(57327),r(41539),r(88674),r(69070),r(47941),r(82526),r(38880),r(49337),r(33321);var n=r(81913),a=(r(66992),r(78783),r(33948),r(21249),r(91252)),o=function(t,e){return Promise.all(e.map((function(t){return a.Rt.getItem(t).then((function(e){return{hash:t,data:e}}))}))).then((function(t){var e={};return t.forEach((function(t){var r=t.hash,n=t.data;e[r]=n})),e}))},i=function(t){var e=t.map((function(t){return t.id}));return Promise.all(e.map((function(t){return a.$0.getItem(t).then((function(e){return{frameId:t,data:e}}))}))).then((function(t){var e={};return t.forEach((function(t){var r=t.frameId,n=t.data;e["frame-".concat(r)]=n})),e}))},u=function(t,e){var r=e.images,n=e.imageSelection;switch(t){case"images":return r.map((function(t){return t.hash}));case"selected_images":return n;default:return[]}},c=r(22429);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){return function(e){var r=t.getState(),a=JSON.parse(localStorage.getItem("gbp-web-state"));delete a.gitStorage,delete a.dropboxStorage,"esp8266"===(0,c.d)().env&&delete a.printerUrl;var l={};switch(n.C.forEach((function(t){var n=t.saveExport,o=t.key;n.includes(e)&&(l[o]=a[o],"images"===o&&"selected_images"===e&&(l[o]=l[o].filter((function(t){var n=t.hash;return u(e,r).includes(n)}))),"palettes"===o&&(l[o]=a[o].filter((function(t){return!t.isPredefined}))))})),e){case"debug":return Promise.resolve(JSON.stringify({state:a},null,2));case"settings":case"remote":return Promise.resolve(JSON.stringify({state:l},null,2));case"images":case"selected_images":return o(e,u(e,r)).then((function(t){return JSON.stringify(s({state:l},t),null,2)}));case"frames":return i(r.frames).then((function(t){return JSON.stringify(s({state:l},t),null,2)}));case"palettes":return Promise.resolve(l.palettes).then((function(t){return JSON.stringify({state:{palettes:t}},null,2)}));default:return null}}}},70954:function(t,e,r){"use strict";r(69826);e.Z=function(t,e){var r=t.palettes,n=e.hashes,a=e.palette;return n?a:r.find((function(t){return t.shortName===a}))}},2922:function(t,e,r){"use strict";r(69826);e.Z=function(t,e,r){var n=t.images,a=e.r,o=e.g,i=e.b,u=e.n;if(r)return{r:r,g:r,b:r,n:r};var c=n.find((function(t){return t.hash===a})),l=n.find((function(t){return t.hash===o})),s=n.find((function(t){return t.hash===i})),f=n.find((function(t){return t.hash===u}));return{r:c?c.frame:null,g:l?l.frame:null,b:s?s.frame:null,n:f?f.frame:null}}},7309:function(t,e,r){"use strict";r(66992),r(41539),r(88674),r(78783),r(33948);var n=r(20260),a=r(2922),o=r(25984);e.Z=function(t){return function(e,r,i){var u=e.hash,c=e.frame,l=e.hashes;if(!l)return(0,n.zD)(u,c,r,i);var s=(0,a.Z)(t,l,c);return Promise.all([(0,n.zD)(l.r,s.r||c,r,i),(0,n.zD)(l.g,s.g||c,r,i),(0,n.zD)(l.b,s.b||c,r,i),(0,n.zD)(l.n,s.n||c,r,i)]).then(o.Z.rgbnTiles)}}},98613:function(t,e,r){"use strict";r(41539),r(88674);var n=r(48764).Buffer;e.Z=function(t,e){return new Promise((function(r,a){var o=new FileReader;switch(o.onload=function(t){var o=t.target;if(o.result)return"arrayBuffer"===e?void r(n.from(o.result)):void r(o.result);a(new Error("Filereader has no result"))},o.onerror=function(t){a(t)},e){case"arrayBuffer":o.readAsArrayBuffer(t);break;case"text":o.readAsText(t);break;case"binaryString":o.readAsBinaryString(t);break;case"dataURL":o.readAsDataURL(t);break;default:a(new Error('readAs param missing or unknown type "'.concat(e,'"')))}}))}},46660:function(t,e,r){"use strict";r(21249),r(74916),r(23123),r(69600),r(26699),r(92222),r(69070),r(47941),r(82526),r(57327),r(38880),r(89554),r(54747),r(49337),r(33321);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}e.Z=function(t){var e=[];return t.map((function(t){for(var r=t.filename,n=r.split("."),o=n.pop(),i=n.join("."),u=r,c=0;e.includes(u);)c+=1,u="".concat(i,"_(").concat(c,").").concat(o);return e.includes(u)||e.push(u),a(a({},t),{},{uFilename:u})}))}},39532:function(t,e,r){"use strict";r.d(e,{Np:function(){return c},fD:function(){return l},$b:function(){return s}});r(74916),r(23123),r(69070),r(47941),r(82526),r(57327),r(38880),r(89554),r(54747),r(49337),r(33321),r(79753),r(41817),r(41539),r(32165),r(66992),r(78783),r(33948),r(47042),r(68309),r(91038);function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(t){u=!0,a=t}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(t,e){return i(i({},t),{},{sortIndex:e})},l=function(t){return i(i({},t),{},{sortIndex:void 0})},s=function(t){var e=t.sortBy;return function(t,r){if(!e)return 0;var a=n(e.split("_"),2),o=a[0],i=a[1],u=t[o],c=r[o],l="desc"===i?-1:1;return u&&c?u>c?l:u<c?-l:t.sortIndex<r.sortIndex?l:-l:0}}},20260:function(t,e,r){"use strict";r.d(e,{IV:function(){return h},zD:function(){return d},a1:function(){return y}});r(66992),r(41539),r(88674),r(78783),r(33948),r(69600),r(21249),r(74916),r(15306),r(23123),r(73210),r(84944),r(4723),r(66528),r(92222),r(79753),r(82526),r(41817),r(32165),r(91038),r(47042),r(68309),r(83710),r(39714);function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var o={"":"006666666600FFFF"," ":"FFFFFFFFFFFFFFFF",0:"FFDDAAAAAADDFFFF",1:"FFDD99DDDDDDFFFF",2:"FF99EEDDBB88FFFF",3:"FF99EE99EE99FFFF",4:"FFDDBBBB88EEFFFF",5:"FF88BB99EE99FFFF",6:"FFCCBB99AADDFFFF",7:"FF88EEDDBBBBFFFF",8:"FFDDAADDAADDFFFF",9:"FFDDAACCEE99FFFF",a:"FFDDAAAA88AAFFFF",b:"FF99AA99AA99FFFF",c:"FFCCBBBBBBCCFFFF",d:"FF99AAAAAA99FFFF",e:"FF88BB99BB88FFFF",f:"FF88BB99BBBBFFFF",g:"FFCCBBAAAACCFFFF",h:"FFAAAA88AAAAFFFF",i:"FF88DDDDDD88FFFF",j:"FF99DDDDDDBBFFFF",k:"FFAAAA99AAAAFFFF",l:"FFBBBBBBBB88FFFF",m:"FFAA888AAAAAFFFF",n:"FFAA8A888AAAFFFF",o:"FFDDAAAAAADDFFFF",p:"FF99AA99BBBBFFFF",q:"FFDDAAAAAACCFFFF",r:"FF99AA99AAAAFFFF",s:"FFCCBBDDEE99FFFF",t:"FF88DDDDDDDDFFFF",u:"FFAAAAAAAACCFFFF",v:"FFAAAAAAAADDFFFF",w:"FFAAAA8A88AAFFFF",x:"FFAAAADDAAAAFFFF",y:"FFAAAADDDDDDFFFF",z:"FF88EEDDBB88FFFF","":"AADDAAAA88AAFFFF","":"AADDAAAAAADDFFFF","":"AAAFAAAAAACCFFFF","":"FF99AA99AA99BBFF",".":"FFFFFFFFFFDDFFFF","!":"DDDDDDDDFFDDFFFF","?":"DDAAEEDDFFDDFFFF","-":"FFFFFF88FFFFFFFF",_:"FFFFFFFFFF88FFFF",":":"FFFFDDFFDDFFFFFF"},i=function(t){var e=[].concat(n(t.toString(10).toLowerCase()),[" "," "]),r=e.shift(),a=e.shift(),i=o[r]||o[""],u=o[a]||o[""];return n(Array(16)).map((function(t,e){return"".concat(i[e]).concat(u[e])})).join("")};function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var l="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n",s=function(t){var e=[],r="\nThe following hash is missing in\nyour indexedDb:\n".concat(t,"\n\nEither you imported a debug dump\nor your browser decided to do a\ncleanup.\n\nThis image might be able to be\nrecovered if you have set up git\nor dropbox sync.\n").trim().split("\n").map((function(t){return t.match(/.{1,32}/g)})).flat().map((function(t){return t||""})).map((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.padEnd(32," ")})).map((function(t){return t.match(/.{1,2}/g).map((function(t){return i(t)}))})).map((function(t){return[l,l].concat(u(t),[l,l])})).flat();for(e.push.apply(e,u(u(Array(40)).map((function(){return l})))),e.push.apply(e,u(r));e.length<360;)e.push(l);return e},f=r(88856),p=r(91252),y=function(t){return r.e(705).then(r.t.bind(r,40705,23)).then((function(e){var n=e.default;return r.e(591).then(r.t.bind(r,99591,23)).then((function(e){var r=e.default,a=t.map((function(t){return t.replace(/ /gi,"")})).join("\n"),o=r.deflate(a,{to:"string",strategy:1,level:8}),i=n(o);return p.Rt.setItem(i,o).then((function(){return i}))}))}))},d=function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t?r.e(591).then(r.t.bind(r,99591,23)).then((function(e){var r=e.default;return p.Rt.getItem(t).then((function(t){return r.inflate(t,{to:"string"}).split("\n")})).catch((function(){return"function"==typeof a&&a(t),n?[]:s(t)}))})).then((function(t){return e?(0,f.Z)(t,e):t})):Promise.resolve(null)},h=function(t){p.Rt.removeItem(t)}},38644:function(t,e){"use strict";e.Z=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keep",r=t-("keep"===e?0:20);if(r<40)return!0;if(r>=320)return!0;switch(r%20){case 0:case 1:case 18:case 19:return!0;default:return!1}}},4181:function(t,e,r){"use strict";r(57327),r(34553);e.Z=function(t){return function(e){return e.filter((function(r,n){return e.findIndex((function(e){return e[t]===r[t]}))===n}))}}},1373:function(t,e,r){"use strict";r(57327),r(34553);e.Z=function(t){return t.filter((function(e,r){return t.findIndex((function(t){return t===e}))===r}))}}}]);