/*! License information can be found in da97/app.js.l.txt */
"use strict";(self.webpackChunkgb_printer_web=self.webpackChunkgb_printer_web||[]).push([[524],{318:function(e,t,a){a.d(t,{s:function(){return l}});var n=a(7261),r=a(498);const l=(e,t)=>{if((0,n.pl)(t)){const{palette:e}=t;return{palette:e}}const a=t,l=e.find((({shortName:e})=>e===a.palette))||r.Fv,s=e.find((({shortName:e})=>e===a.framePalette))||r.Fv;return{palette:l,framePalette:a.lockFrame?s:l}}},985:function(e,t,a){var n=a(601);t.A=e=>t=>{const a=e.filter((e=>![n.X.FILTER_MONOCHROME,n.X.FILTER_NEW,n.X.FILTER_RGB,n.X.FILTER_UNTAGGED,n.X.FILTER_RECENT,n.X.FILTER_FAVOURITE,n.X.FILTER_COMMENTS,n.X.FILTER_USERNAME].includes(e)));return!a.length||!!t.tags.find((e=>a.includes(e)))}},1562:function(e,t){const a=(e,t,a)=>{const n=a.find((t=>t.id===e));if(n)return n.name;switch(e){case"hk":return"Hallo Katze!";case"int":return"International Frames (GameBoy Camera)";case"jp":return"Japanese Frames (Pocket Camera)";default:return t}},n=e=>{switch(e){case"int":return"_1";case"jp":return"_2";case"hk":return"_3";default:return e}};t.A=(e,t)=>e.reduce(((e,{id:n,name:r})=>{try{const l=n.match(/^[a-z]+/g)?.[0];return l?(e.find((e=>e.id===l))||e.push({id:l,name:a(l,r,t)}),e):e}catch(t){return e}}),[]).sort((({id:e},{id:t})=>{const a=n(e),r=n(t);return a>r?1:a<r?-1:0}))},3052:function(e,t){t.A=e=>{const t=[];return e.map((e=>{const{filename:a}=e,n=a.split("."),r=n.pop();if(!r)throw new Error("unknown file type");const l=n.join(".");let s=a,F=0;for(;t.includes(s);)F+=1,s=`${l}_(${F}).${r}`;return t.includes(s)||t.push(s),{...e,filename:s}}))}},3111:function(e,t,a){var n;a.d(t,{Ej:function(){return l},pL:function(){return n},zP:function(){return r}}),function(e){e[e.DEG_0=0]="DEG_0",e[e.DEG_90=1]="DEG_90",e[e.DEG_180=2]="DEG_180",e[e.DEG_270=3]="DEG_270"}(n||(n={}));const r=(e,t,a)=>{const n=t.getContext("2d");if(!n)throw new Error("No canvas context");switch(n.resetTransform(),a%2?(t.height=e.width,t.width=e.height):(t.width=e.width,t.height=e.height),a){case 1:n.translate(e.height,0);break;case 2:n.translate(e.width,e.height);break;case 3:n.translate(0,e.width)}n.rotate(90*a*Math.PI/180),n.drawImage(e,0,0),n.resetTransform()},l=(e,t)=>{const a=document.createElement("canvas");return r(e,a,t),a}},3323:function(e,t,a){a.d(t,{R:function(){return n.A},j:function(){return m}});var n=a(9860),r=a(784),l=a(9905),s=a(9809),F=a(3111),o=a(7261),i=a(7580),c=a(318);var m=(e,t,a,n)=>m=>async(u,d)=>{let p;const g=(0,o.pl)(m),h=m.lockFrame||!1,E=m.rotation||0,{palette:f,framePalette:b}=(0,c.s)(n,m);if(!f)throw new Error("Palette missing?");if(g)p=new r.Wd,p.update({canvas:null,tiles:u,palette:f,lockFrame:h});else{p=new r.XM;const e=f?.palette||r.CU,t=b?.palette||r.CU,a=m.invertPalette||!1,n=m.invertFramePalette||!1,l=(0,i.A)({palette:e,framePalette:t,invertPalette:a,invertFramePalette:n});p.update({canvas:null,tiles:u,...l,imageStartLine:d})}const v=[...e].filter((e=>"number"==typeof e)),_=[...t];v.length||v.push(4),_.length||_.push("png");const y=v.map((e=>_.map((t=>new Promise((n=>{const o=(0,l.A)({image:m,palette:f,exportScaleFactor:e});switch(t){case"txt":if(g)return void n(null);(0,s.Z)(m.hash,m.title,o).then(n);break;case"pgm":{if(g)return void n(null);const e=(0,F.Ej)(p.getScaledCanvas(1,a),E),l=["P2","#",`# Exported from ${window.location.origin}`,"#",`# hash: ${m.hash}`,`# created: ${m.created}`,`# title: ${m.title}`,`# tags: ${m.tags.join(", ")}`,`# dimension: ${e.width}*${e.height} pixels`,"#",`${e.width} ${e.height}`,"3","#"],s=e.getContext("2d");if(!s){n(null);break}for(let t=0;t<e.height;t+=1){const a=[];for(let n=0;n<e.width;n+=1){const e=s.getImageData(n,t,1,1).data,l=["#",e[0].toString(16).padStart(2,"0"),e[1].toString(16).padStart(2,"0"),e[2].toString(16).padStart(2,"0")].join("");let F=f.palette?.indexOf(l)||-1;-1===F&&(F=r.eJ.indexOf(parseInt(l.slice(1),16))),a.push(3-F)}l.push(a.join(" "))}n({filename:`${o}.${t}`,blob:new Blob([l.join("\n")],{type:"text/plain"}),title:m.title});break}default:{const r=e=>{n(e?{filename:`${o}.${t}`,blob:e,title:m.title}:null)};(0,F.Ej)(p.getScaledCanvas(e,a),E).toBlob(r,`image/${t}`,1);break}}}))))));return(await Promise.all(y.flat())).reduce(((e,t)=>t?[...e,t]:e),[])}},3839:function(e,t,a){var n;a.d(t,{j:function(){return n}}),function(e){e.GALLERY_VIEW_SMALL="small",e.GALLERY_VIEW_1X="1x",e.GALLERY_VIEW_2X="2x",e.GALLERY_VIEW_MAX="max"}(n||(n={}))},3876:function(e,t,a){var n;a.d(t,{m:function(){return n}}),function(e){e.ALL="all",e.FRAMES="frames",e.CURRENT_FRAMEGROUP="current_framegroup",e.IMAGES="images",e.SELECTED_IMAGES="selected_images",e.PALETTES="palettes",e.PLUGINS="plugins"}(n||(n={}))},5431:function(e,t){t.A=e=>e.replace(/[^a-z0-9/\\._-]/gi,"").replace(/[\\/]+/gi,"/").replace(/^\//,"").replace(/\/$/,"")},5534:function(e,t){const a={weekday:void 0,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};t.A=(e,t)=>e.toDate().toLocaleString(t,a)},6194:function(e,t,a){var n=a(1511),r=a(7134),l=a(4704);const s=(0,n.v)((0,r.eh)((0,r.Zr)((e=>({dropboxStorage:{},gitStorage:{},syncLastUpdate:{dropbox:0,local:0},dropboxLogout:()=>e((({dropboxStorage:e})=>({dropboxStorage:{use:e.use}}))),setDropboxStorage:t=>e((({dropboxStorage:e})=>({dropboxStorage:{...e,...t}}))),setGitStorage:t=>e((({gitStorage:e})=>({gitStorage:{...e,...t}}))),setSyncLastUpdate:(t,a)=>e((({syncLastUpdate:e})=>({syncLastUpdate:{...e,[t]:a}})))})),{name:`${l.z}-storages`,storage:(0,r.KU)((()=>localStorage))})));t.A=s},6521:function(e,t,a){var n=a(4353),r=a.n(n),l=a(601),s=a(498),F=a(7261);t.A=(e,t)=>a=>{const n=e.reduce(((e,t)=>[l.X.FILTER_MONOCHROME,l.X.FILTER_NEW,l.X.FILTER_RGB,l.X.FILTER_UNTAGGED,l.X.FILTER_RECENT,l.X.FILTER_FAVOURITE,l.X.FILTER_COMMENTS,l.X.FILTER_USERNAME].includes(t)?[...e,t]:e),[]);if(n.length){if(n.includes(l.X.FILTER_UNTAGGED)&&0!==a.tags.length)return!1;if(n.includes(l.X.FILTER_NEW)){if(r()(a.created,s.i$).unix()<=r()().subtract(1,"day").unix())return!1}return!(n.includes(l.X.FILTER_RECENT)&&!t.map((({hash:e})=>e)).includes(a.hash))&&(!(n.includes(l.X.FILTER_RGB)&&!(0,F.pl)(a))&&((!n.includes(l.X.FILTER_MONOCHROME)||!(0,F.pl)(a))&&(!(n.includes(l.X.FILTER_FAVOURITE)&&!a.tags.includes(l.X.FILTER_FAVOURITE))&&(!(n.includes(l.X.FILTER_COMMENTS)&&!a.meta?.comment)&&!(n.includes(l.X.FILTER_USERNAME)&&!a.meta?.userName)))))}return!0}},6533:function(e,t,a){a.d(t,{T:function(){return l},p:function(){return s}});var n=a(521),r=a(7261);const l=(e,t,a)=>{const l=async(s,F,o,i)=>{const c=e.find((e=>s===e.hash)),m=("string"==typeof o?o:c?.frame)||void 0,u=t.find((({id:e})=>e===m))?.hash;if(!(i||c&&(0,r.pl)(c))){return await(0,n.Hh)(s,u,F,a)||[]}const d=i||c.hashes;return{r:d.r?await l(d.r,F,m):[],g:d.g?await l(d.g,F,m):[],b:d.b?await l(d.b,F,m):[],n:d.n?await l(d.n,F,m):[]}};return l},s=(e,t)=>{const a=l(e,t);return async e=>{const t=await a(e,!0,"");return t&&(t?.length||t.r?.length||t.g?.length||t.b?.length||t.n?.length)||0}}},6564:function(e,t,a){var n;a.d(t,{V:function(){return n}}),function(e){e.CHECKBOX="checkbox",e.SELECT="select",e.TEXT="text",e.NUMBER="number",e.INFO="info"}(n||(n={}))},6727:function(e,t,a){const n=(0,a(1511).v)((e=>({dialogs:[],dismissDialog:t=>e((({dialogs:e})=>({dialogs:e.filter(((e,a)=>t!==a))}))),setDialog:t=>e((({dialogs:e})=>({dialogs:[t,...e]})))})));t.A=n},6964:function(e,t,a){a.d(t,{default:function(){return ko}});var n=a(6540),r=a(4976);function l(){return n.createElement("p",null)}var s=function(){const[e,t]=(0,n.useState)((()=>l));return(0,n.useEffect)((()=>{(async()=>{const{default:e}=await a.e(317).then(a.bind(a,6317));t((()=>e))})()}),[]),n.createElement("div",{className:"home"},n.createElement(e,{className:"markdown-body"},'# [Game Boy Camera Gallery](https://github.com/HerrZatacke/gb-printer-web)\n\n## Basic usage\n* choose a [color palette](#/palettes)\n* [paste your exports](#/import) into a textfield (or simply drag and drop your dump(s) into this window)\n* check your images [in the gallery](#/gallery)\n* You can also try to drag/drop your cartridge dump into this window  \n\n## Supported formats\n* This Project is mainly built around the serial output of the original [GBP Emulator](https://github.com/mofosyne/arduino-gameboy-printer-emulator)\n* Cart .SAV files are also supported. The previously selected frame will be applied as well. If you\'re importing from a JP-Cartridge (Pocket Camera), you may want to change the "Frames when importing Cartridge dumps" option in the [settings page](#/settings)    \n\n## Frames\nIn a recent change (Version 1.7.0) the pre-compiled frames have been removed from this application.  \nThe application now however gives you the opportunity to add all frames you like by yourself and also share them with others.  \nMaybe you have designed some frames by yourself, or you have aquired some previously unknown frames.\n\n### Uploading your own frames\nYou can upload your own frames by dragging any image into this app.  \nDimensions of 160x144 are highly recommended, otherwise the image will be automatically scaled to size.  \nA lossles filetype is also recommended (e.g `.png` or `.webp`)\nAfter dragging your image into the app, you will be asked on how to import the frame.\n\n### Exporting/Importing your frames\n[In the import tab](#/import) you can find an "Export frames" button. The resulting `.json` file can be shared and will contain all of your frames.  \nThis `.json` file can be dragged into the application and will add all frames from that export to your application.  \n\n## Development usage\nThe following ptions apply if you plan on contributong to this app:\n\n### Optional deployment config with `config.json`\nAdd a `deploy` section in `config.json` to automatically copy the created files to another location ([e.g your arduino project](https://github.com/HerrZatacke/wifi-gbp-emulator)).  \nIf you set the option `gzip` to `true`, each file will be separately compressed. Useful for servers capable serving pre-zipped files. This saves ~1kB storage space.\n``` json\n{\n  "ports": [...], \n  "deploy": {\n    "dir": "/copy/all/files/to/that/folder",\n    "gzip": true\n  }\n}\n```\n\n### Local Setup\n* Install [node.js](https://nodejs.org/) if you haven\'t already.\n* Check out/clone/download [this repository](https://github.com/HerrZatacke/gb-printer-web)\n* Run `npm i` in the root directory via your commandline\n* Add a `config.json` in the root dir (see above)\n* Run `npm start` via your commandline\n* Open [localhost:3000](http://localhost:3000)\n\n### Links and research\n* The source to this project is [available on GitHub](https://github.com/HerrZatacke/gb-printer-web)\n* A basic version of this tool is avaliable [on GitHub-pages](https://herrzatacke.github.io/gb-printer-web/#/)  \n* This project has replaced my [GB printer direct serial to gif converter](https://github.com/HerrZatacke/direct-serial-to-gif-converter)\n* Also check out the [Gameboy Camera Discord](https://discord.gg/Kxhjg3qN) \n* [Lots of helpful GameBoy and GameBoy Camera resources](https://github.com/gbdev/awesome-gbdev)\n\n#### Research\n* Tutorial on how to work with an ESP8266 by [ttapa: ESP8266 Beginner\'s Guide](https://tttapa.github.io/ESP8266/Chap01%20-%20ESP8266.html)  \n* [Programming a standalone ESP8266](https://www.instructables.com/id/3-Simple-Ways-of-Programming-an-ESP8266-12X-Module/)\n* [Deploying your JS App to Github Pages the easy way (or not)](https://medium.com/linagora-engineering/1ef8c48424b7)\n'))},F=a(6942),o=a.n(F),i=a(7947),c=a(4669),m=a(4353),u=a.n(m),d=a(445),p=a.n(d);var g=function(e){const t=o()("svg",`svg--${e.name}`,e.className);switch(e.name){case"download":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M8 3v7H5s5 6 5 6c0 0 5-6 5-6h-3V3z"}),n.createElement("path",{d:"M5 15v2l10 0V15z"}));case"clone":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M3 2v13h3v3h10V5h-3V2zm1 1h8v2H8.11l.78 1H15v11H7V9.639L6 8.36V14H4zm2.162.996L4.588 5.23l4.314 5.51-1.574 1.233 6.063 2.875-1.338-6.575-1.574 1.235z"}));case"delete":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M13 5v10h-1V5zM7 5v10H6V5zm4 0v10h-1V5zM9 5v10H8V5zM4 3v2h1v12h9V5h1V3h-4V2H8v1z"}));case"loading":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M10 2 4 5l6 3V6c3.15 0 4.911 3.369 3.535 5.89l1.8.881C17.337 8.996 14.7 4 10 4zm-.001 16 6-3-6-3v2c-3.15 0-4.911-3.369-3.535-5.89l-1.8-.881C2.662 11.004 5.299 16 9.999 16z"}));case"warn":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M10.75 16v-1.5h-1.5V16zm0-3V6h-1.5v7zM2 17c.192-.312 8-14 8-14l8 14z"}));case"arrowdown":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"m3 5 7 10 7-10z"}));case"plug":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M12.526 9.533c0-1.932-1.856-3.033-4.21-3.033H6.21v.778H2v.972h4.21v3.5H2.02l-.02.972h4.21v.778h2.106c2.354 0 4.21-1.1 4.21-3.033 2.31-.651 3.02.774 5.474 0v-.934c-2.27.808-2.999-.697-5.474 0z"}));case"share":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M14 3.5A2.5 2.5 0 0011.5 6a2.5 2.5 0 00.025.336l-3.85 1.812A2.5 2.5 0 006 7.5 2.5 2.5 0 003.5 10 2.5 2.5 0 006 12.5a2.5 2.5 0 001.676-.648l3.85 1.812A2.5 2.5 0 0011.5 14a2.5 2.5 0 002.5 2.5 2.5 2.5 0 002.5-2.5 2.5 2.5 0 00-2.5-2.5 2.5 2.5 0 00-1.836.807l-3.728-1.754A2.5 2.5 0 008.5 10a2.5 2.5 0 00-.066-.553l3.73-1.754A2.5 2.5 0 0014 8.5 2.5 2.5 0 0016.5 6 2.5 2.5 0 0014 3.5z"}));case"sync":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M8 8.5v5H5s4.866 6 5 6c.134 0 5-6 5-6h-3v-5zm2-8l-6 3 6 3v-2c3.15 0 4.911 3.369 3.535 5.89l1.8.881C17.337 7.496 14.7 2.5 10 2.5zM4.664 5.729C3.271 8.357 4.2 11.392 6 13h1.5v-1.4c-1.358-.983-2.02-3.185-1.035-4.99z"}));case"edit":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M4 14.978v1.978L16 17v-2.022zM13.5 3l-8 8-1 3.5 3.5-1 8-8L13.5 3zm0 .8l.85.85-9.1 9.1L6 11.5l7.5-7.7z"}));case"view":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M5.506 6.6L1 10l4.504 3.4c1.199.88 2.814 1.372 4.496 1.371 1.682 0 3.296-.492 4.494-1.37L19 10l-4.504-3.4C13.297 5.72 11.711 5.228 10 5.237c-1.711.009-3.318.5-4.494 1.363zm4.152-.502c2.101 0 3.805 1.747 3.805 3.902 0 2.155-1.704 3.902-3.805 3.902-2.1 0-3.804-1.747-3.804-3.902 0-2.155 1.703-3.902 3.804-3.902zm-.894 2.035c-1.006 0-1.821.836-1.82 1.867-.001 1.031.814 1.868 1.82 1.867 1.004 0 1.818-.836 1.818-1.867 0-1.03-.814-1.867-1.818-1.867z"}));case"fav":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"m13 6.1c1.8 0 1.9 2.1 1.9 2.1 0 1.8-1.5 3.6-4.9 5.7-3.4-2.1-4.9-3.9-4.9-5.7 0 0 0.1-2.1 1.9-2.1 0.3 0 1 0.1 1.8 0.6l1.2 0.9 1.2-0.9c0.7-0.5 1.5-0.6 1.8-0.6m0-2c-0.4 0-1.7 0-3 1-1.3-1-2.6-1-3-1-2.8 0-3.9 2.7-3.9 4.1 0 3.1 2.6 5.6 6.9 8 4.2-2.4 6.9-4.9 6.9-8 0-1.4-1.1-4.1-3.9-4.1z"}));case"animate":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M3 4v12h14V4zm.5.5h2v2h-2zm2.75 0h2v2h-2zM9 4.5h2v2H9zm2.75 0h2v2h-2zm2.75 0h2v2h-2zM4 7h12v6H4zm-.5 6.5h2v2h-2zm2.75 0h2v2h-2zm2.75 0h2v2H9zm2.75 0h2v2h-2zm2.75 0h2v2h-2z"}));case"reset":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M6 10a4 4 0 104-4v2L4 5l6-3v2a6 6 0 11-6 6"}));case"checkmark":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M15 5v10H5V5zM3 3v14h14V3z"}),n.createElement("path",{className:"tick",d:"M5.5 11l3 3 6-6.5L13 6l-4.5 5L7 9.5z"}));case"circle":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("circle",{r:"8",cx:"10",cy:"10"}));case"add":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M8 2v6H2v4h6v6h4v-6h6V8h-6V2z"}));case"file-add":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M9 6.5v3.52l-3.5-.04v2l3.5.04v3.48h2v-3.48h3.5v-2H11V6.5ZM1 17V3h6l2 2h10v12z"}));case"remove":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M2 8v4h16V8z"}));case"save":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M12 4v3h-2V4zM5 15v-4h10v4zm8-7H6l.01-4H4v12h12V6l-2-2h-1z"}));case"sort":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M4.5 8.5L10 3l5.5 5.5zm0 3L10 17l5.5-5.5z"}));case"list":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M6 6v4h28V6zm0 8v4h28v-4zm0 8v4h28v-4zm0 8v4h28V30z"}));case"small":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M8.407 9v3.5h3.66V9Zm4.881 0v3.5h3.661V9Zm4.881 0v3.5h3.662V9Zm4.882 0v3.5h3.66V9Zm4.881 0v3.5h3.661V9ZM8.407 13.667v3.5h3.66v-3.5zm4.881 0v3.5h3.661v-3.5zm4.881 0v3.5h3.662v-3.5zm4.882 0v3.5h3.66v-3.5zm4.881 0v3.5h3.661v-3.5ZM7 18.333V16l-5 3.5L7 23v-2.333h26V23l5-3.5-5-3.5v2.333zm1.407 3.5v3.5h3.66v-3.5zm4.881 0v3.5h3.661v-3.5zm4.881 0v3.5h3.662v-3.5zm4.882 0v3.5h3.66v-3.5zm4.881 0v3.5h3.661v-3.5ZM8.407 26.5V30h3.66v-3.5zm4.881 0V30h3.661v-3.5zm4.881 0V30h3.662v-3.5zm4.882 0V30h3.66v-3.5zm4.881 0V30h3.661v-3.5z"}));case"1x":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M5 5v6h6V5zm8 0v6h6V5zm8 0v6h6V5zm8 0v6h6V5zM5 13v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6zM5 21v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6zM5 29v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6zm8 0v6h6v-6z"}));case"2x":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M22 6v12h12V6zm0 16v12h12V22zM6 6v12h12V6zm0 16v12h12V22z"}));case"max":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M34 34V6H6v28z"}));case"close":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M7 3l12 17L7 37h2l11-15.584L31 37h2L21 20 33 3h-2L20 18.584 9 3H7z"}));case"fullscreen-on":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M37 13h-2V9h-5V7h7zM3 13h2V9h5V7H3zm34 14h-2v4h-5v2h7zM3 27h2v4h5v2H3z"}));case"fullscreen-off":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"m9.195 35.66 1.704 1.048L30.805 4.34l-1.704-1.048ZM37 13h-2V9h-5V7h7zM3 13h2V9h5V7H3Zm34 14h-2v4h-5v2h7zM3 27h2v4h5v2H3Z"}));case"right":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M17 3l12 17-12 17h-2l12-17L15 3z"}));case"left":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M23 3L11 20l12 17h2L13 20 25 3z"}));case"burger":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M2 6v4h36V6zm0 12v4h36v-4zm0 12v4h36v-4z"}));case"close-nav":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M5.5 2.5l-3 3L17 20 2.5 34.5l3 3L20 23l14.5 14.5 3-3L23 20 37.5 5.5l-3-3L20 17z"}));case"filter":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M34 10V6H6v4l12 12v12h4V22z"}));case"moon":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M15.715 35.424a16.016 16 0 004.273.576A16.016 16 0 0036 20.004 16.016 16 0 0019.988 4a16.016 16 0 00-4.27.585 16.016 16 0 01.303.084 16.016 16 0 01.331.105 16.016 16 0 01.331.109 16.016 16 0 01.327.12 16.016 16 0 01.323.122 16.016 16 0 01.322.129 16.016 16 0 01.323.14 16.016 16 0 01.315.146 16.016 16 0 01.315.15 16.016 16 0 01.307.16 16.016 16 0 01.306.166 16.016 16 0 01.299.169 16.016 16 0 01.298.181 16.016 16 0 01.299.186 16.016 16 0 01.29.19 16.016 16 0 01.283.197 16.016 16 0 01.283.201 16.016 16 0 01.278.214 16.016 16 0 01.274.214 16.016 16 0 01.267.221 16.016 16 0 01.262.23 16.016 16 0 01.258.23 16.016 16 0 01.25.242 16.016 16 0 01.25.242 16.016 16 0 01.243.25 16.016 16 0 01.238.254 16.016 16 0 01.23.258 16.016 16 0 01.226.266 16.016 16 0 01.218.266 16.016 16 0 01.214.278 16.016 16 0 01.21.278 16.016 16 0 01.201.282 16.016 16 0 01.194.282 16.016 16 0 01.19.295 16.016 16 0 01.181.298 16.016 16 0 01.178.298 16.016 16 0 01.17.303 16.016 16 0 01.16.306 16.016 16 0 01.162.31 16.016 16 0 01.145.315 16.016 16 0 01.146.318 16.016 16 0 01.137.319 16.016 16 0 01.129.322 16.016 16 0 01.12.323 16.016 16 0 01.114.33 16.016 16 0 01.109.33 16.016 16 0 01.1.331 16.016 16 0 01.094.34 16.016 16 0 01.084.334 16.016 16 0 01.081.338 16.016 16 0 01.069.339 16.016 16 0 01.064.343 16.016 16 0 01.057.342 16.016 16 0 01.048.343 16.016 16 0 01.04.347 16.016 16 0 01.037.346 16.016 16 0 01.024.343 16.016 16 0 01.02.35 16.016 16 0 01.012.343 16.016 16 0 010 .351 16.016 16 0 010 .121 16.016 16 0 010 .347 16.016 16 0 01-.016.346 16.016 16 0 01-.024.347 16.016 16 0 01-.028.347 16.016 16 0 01-.04.346 16.016 16 0 01-.041.343 16.016 16 0 01-.053.343 16.016 16 0 01-.056.342 16.016 16 0 01-.069.343 16.016 16 0 01-.072.339 16.016 16 0 01-.08.338 16.016 16 0 01-.09.335 16.016 16 0 01-.097.334 16.016 16 0 01-.1.331 16.016 16 0 01-.11.33 16.016 16 0 01-.12.323 16.016 16 0 01-.122.33 16.016 16 0 01-.133.323 16.016 16 0 01-.137.315 16.016 16 0 01-.145.318 16.016 16 0 01-.154.31 16.016 16 0 01-.16.31 16.016 16 0 01-.162.307 16.016 16 0 01-.174.299 16.016 16 0 01-.177.298 16.016 16 0 01-.186.294 16.016 16 0 01-.19.29 16.016 16 0 01-.201.287 16.016 16 0 01-.202.282 16.016 16 0 01-.21.274 16.016 16 0 01-.214.274 16.016 16 0 01-.226.266 16.016 16 0 01-.226.262 16.016 16 0 01-.23.262 16.016 16 0 01-.242.25 16.016 16 0 01-.242.25 16.016 16 0 01-.25.242 16.016 16 0 01-.255.234 16.016 16 0 01-.258.234 16.016 16 0 01-.266.225 16.016 16 0 01-.27.218 16.016 16 0 01-.275.214 16.016 16 0 01-.282.205 16.016 16 0 01-.279.202 16.016 16 0 01-.286.197 16.016 16 0 01-.295.186 16.016 16 0 01-.294.185 16.016 16 0 01-.3.178 16.016 16 0 01-.302.169 16.016 16 0 01-.306.161 16.016 16 0 01-.311.157 16.016 16 0 01-.315.15 16.016 16 0 01-.319.145 16.016 16 0 01-.318.133 16.016 16 0 01-.323.129 16.016 16 0 01-.323.12 16.016 16 0 01-.331.117 16.016 16 0 01-.33.11 16.016 16 0 01-.336.096 16.016 16 0 01-.19.057z"}));case"usb":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M20 3a2 2 0 0 0-2 2v17.172l-3-3V13a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7a2 2 0 0 0 .586 1.414L18 27.828V35a2 2 0 0 0 2 2 2 2 0 0 0 2-2V23.828l6.414-6.414A2 2 0 0 0 29 16V9a2 2 0 0 0-2-2 2 2 0 0 0-2 2v6.172l-3 3V5a2 2 0 0 0-2-2z"}));case"sun":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M19.96.004a1.002 1.002 0 00-.163.02 1.002 1.002 0 00-.083.022 1.002 1.002 0 00-.08.027 1.002 1.002 0 00-.075.037 1.002 1.002 0 00-.325.258 1.002 1.002 0 00-.053.068 1.002 1.002 0 00-.114.223 1.002 1.002 0 00-.045.162 1.002 1.002 0 00-.012.084 1.002 1.002 0 00-.007.087v5a1.002 1.002 0 00.004.086 1.002 1.002 0 00.174.47 1.002 1.002 0 00.049.064 1.002 1.002 0 00.057.064 1.002 1.002 0 00.128.113 1.002 1.002 0 00.14.087 1.002 1.002 0 00.076.03 1.002 1.002 0 00.083.03 1.002 1.002 0 00.08.02 1.002 1.002 0 00.083.015 1.002 1.002 0 00.495-.06 1.002 1.002 0 00.076-.038 1.002 1.002 0 00.329-.258 1.002 1.002 0 00.094-.136 1.002 1.002 0 00.038-.075 1.002 1.002 0 00.038-.076 1.002 1.002 0 00.023-.083 1.002 1.002 0 00.03-.167 1.002 1.002 0 00.004-.083V.988a1.002 1.002 0 000-.087 1.002 1.002 0 00-.038-.167 1.002 1.002 0 00-.023-.075 1.002 1.002 0 00-.068-.155 1.002 1.002 0 00-.045-.072 1.002 1.002 0 00-.11-.129 1.002 1.002 0 00-.06-.056 1.002 1.002 0 00-.209-.14 1.002 1.002 0 00-.238-.084 1.002 1.002 0 00-.083-.015 1.002 1.002 0 00-.166-.007zm-9.43 2.542a1.002 1.002 0 00-.082.004 1.002 1.002 0 00-.167.022 1.002 1.002 0 00-.442.235 1.002 1.002 0 00-.114.12 1.002 1.002 0 00-.049.069 1.002 1.002 0 00-.113.227 1.002 1.002 0 00-.038.163 1.002 1.002 0 00-.012.25 1.002 1.002 0 00.008.082 1.002 1.002 0 00.019.084 1.002 1.002 0 00.026.079 1.002 1.002 0 00.068.151 1.002 1.002 0 000 .004l2.504 4.334a1.002 1.002 0 00.046.068 1.002 1.002 0 00.049.068 1.002 1.002 0 00.057.06 1.002 1.002 0 00.064.058 1.002 1.002 0 00.136.098 1.002 1.002 0 00.151.072 1.002 1.002 0 00.163.045 1.002 1.002 0 00.083.015 1.002 1.002 0 00.416-.045 1.002 1.002 0 00.076-.03 1.002 1.002 0 00.287-.178 1.002 1.002 0 00.114-.121 1.002 1.002 0 00.049-.068 1.002 1.002 0 00.045-.076 1.002 1.002 0 00.068-.151 1.002 1.002 0 00.023-.08 1.002 1.002 0 00.015-.083 1.002 1.002 0 00.015-.083 1.002 1.002 0 000-.087 1.002 1.002 0 00-.015-.163 1.002 1.002 0 00-.113-.321l-2.497-4.33a1.002 1.002 0 00-.11-.14 1.002 1.002 0 00-.056-.06 1.002 1.002 0 00-.06-.058 1.002 1.002 0 00-.212-.136 1.002 1.002 0 00-.076-.034 1.002 1.002 0 00-.166-.041 1.002 1.002 0 00-.167-.023zm18.953 0a1.002 1.002 0 00-.48.14 1.002 1.002 0 00-.068.045 1.002 1.002 0 00-.238.235 1.002 1.002 0 00-.05.072l-2.503 4.326a1.002 1.002 0 00-.038.076 1.002 1.002 0 00-.034.075 1.002 1.002 0 00-.023.084 1.002 1.002 0 00-.019.083 1.002 1.002 0 00-.011.25 1.002 1.002 0 00.007.083 1.002 1.002 0 00.042.162 1.002 1.002 0 00.068.155 1.002 1.002 0 00.095.14 1.002 1.002 0 00.056.065 1.002 1.002 0 00.121.113 1.002 1.002 0 00.072.05 1.002 1.002 0 00.072.037 1.002 1.002 0 00.235.09 1.002 1.002 0 00.416.008 1.002 1.002 0 00.083-.019 1.002 1.002 0 00.159-.056 1.002 1.002 0 00.075-.042 1.002 1.002 0 00.137-.094 1.002 1.002 0 00.12-.118 1.002 1.002 0 00.099-.14l2.5-4.334a1.002 1.002 0 00.072-.151 1.002 1.002 0 00.023-.08 1.002 1.002 0 00.03-.166 1.002 1.002 0 000-.17 1.002 1.002 0 00-.117-.4 1.002 1.002 0 00-.152-.201 1.002 1.002 0 00-.12-.114 1.002 1.002 0 00-.073-.049 1.002 1.002 0 00-.147-.076 1.002 1.002 0 00-.076-.034 1.002 1.002 0 00-.083-.019 1.002 1.002 0 00-.083-.015 1.002 1.002 0 00-.083-.011 1.002 1.002 0 00-.087 0zm-9.478 6.448A11.006 11.005 0 009 20a11.006 11.005 0 0011.006 11.009 11.006 11.005 0 0011.006-11.006A11.006 11.005 0 0020.005 8.998zm-16.452.51a1.002 1.002 0 00-.083 0 1.002 1.002 0 00-.167.027 1.002 1.002 0 00-.076.027 1.002 1.002 0 00-.079.03 1.002 1.002 0 00-.076.038 1.002 1.002 0 00-.075.041 1.002 1.002 0 00-.19.163 1.002 1.002 0 00-.052.064 1.002 1.002 0 00-.05.076 1.002 1.002 0 00-.075.144 1.002 1.002 0 00-.034.08 1.002 1.002 0 00-.02.082 1.002 1.002 0 00-.026.167 1.002 1.002 0 000 .083 1.002 1.002 0 00.016.166 1.002 1.002 0 00.018.083 1.002 1.002 0 00.061.156 1.002 1.002 0 00.136.211 1.002 1.002 0 00.057.065 1.002 1.002 0 00.2.155l4.33 2.503a1.002 1.002 0 00.077.038 1.002 1.002 0 00.242.076 1.002 1.002 0 00.25.011 1.002 1.002 0 00.325-.083 1.002 1.002 0 00.34-.246 1.002 1.002 0 00.053-.064 1.002 1.002 0 00.155-.295 1.002 1.002 0 00.038-.167 1.002 1.002 0 00.011-.083 1.002 1.002 0 00-.004-.166 1.002 1.002 0 00-.06-.246 1.002 1.002 0 00-.117-.223 1.002 1.002 0 00-.106-.129 1.002 1.002 0 00-.129-.11 1.002 1.002 0 00-.072-.045L4.037 9.63a1.002 1.002 0 00-.151-.069 1.002 1.002 0 00-.246-.052 1.002 1.002 0 00-.083-.004zm32.905 0a1.002 1.002 0 00-.087 0 1.002 1.002 0 00-.084.012 1.002 1.002 0 00-.162.045 1.002 1.002 0 00-.076.03 1.002 1.002 0 00-.075.039l-4.339 2.503a1.002 1.002 0 00-.068.046 1.002 1.002 0 00-.068.049 1.002 1.002 0 00-.06.056 1.002 1.002 0 00-.19.277 1.002 1.002 0 00-.083.238 1.002 1.002 0 00-.015.253 1.002 1.002 0 00.023.163 1.002 1.002 0 00.132.31 1.002 1.002 0 00.046.072 1.002 1.002 0 00.053.064 1.002 1.002 0 00.06.06 1.002 1.002 0 00.064.054 1.002 1.002 0 00.069.049 1.002 1.002 0 00.071.045 1.002 1.002 0 00.076.038 1.002 1.002 0 00.076.03 1.002 1.002 0 00.083.023 1.002 1.002 0 00.08.015 1.002 1.002 0 00.086.015 1.002 1.002 0 00.167 0 1.002 1.002 0 00.083-.015 1.002 1.002 0 00.083-.015 1.002 1.002 0 00.235-.095l4.334-2.503a1.002 1.002 0 00.068-.046 1.002 1.002 0 00.068-.053 1.002 1.002 0 00.06-.056 1.002 1.002 0 00.057-.06 1.002 1.002 0 00.099-.137 1.002 1.002 0 00.072-.151 1.002 1.002 0 00.045-.167 1.002 1.002 0 00.011-.08 1.002 1.002 0 00.004-.17 1.002 1.002 0 00-.007-.083 1.002 1.002 0 00-.016-.083 1.002 1.002 0 00-.022-.08 1.002 1.002 0 00-.03-.079 1.002 1.002 0 00-.038-.075 1.002 1.002 0 00-.038-.076 1.002 1.002 0 00-.05-.068 1.002 1.002 0 00-.241-.227 1.002 1.002 0 00-.076-.045 1.002 1.002 0 00-.076-.038 1.002 1.002 0 00-.075-.03 1.002 1.002 0 00-.163-.038 1.002 1.002 0 00-.17-.015zM.988 19.002a1.002 1.002 0 00-.087.004 1.002 1.002 0 00-.166.03 1.002 1.002 0 00-.303.144 1.002 1.002 0 00-.064.05 1.002 1.002 0 00-.064.056 1.002 1.002 0 00-.057.06 1.002 1.002 0 00-.053.068 1.002 1.002 0 00-.049.069 1.002 1.002 0 00-.076.15 1.002 1.002 0 00-.06.243 1.002 1.002 0 00.011.333 1.002 1.002 0 00.344.567 1.002 1.002 0 00.068.05 1.002 1.002 0 00.224.116 1.002 1.002 0 00.075.027 1.002 1.002 0 00.087.019 1.002 1.002 0 00.083.011 1.002 1.002 0 00.087.004h5a1.002 1.002 0 00.17-.015 1.002 1.002 0 00.084-.02 1.002 1.002 0 00.23-.094 1.002 1.002 0 00.072-.045 1.002 1.002 0 00.065-.053 1.002 1.002 0 00.064-.057 1.002 1.002 0 00.057-.06 1.002 1.002 0 00.174-.284 1.002 1.002 0 00.049-.163 1.002 1.002 0 00-.019-.499 1.002 1.002 0 00-.026-.08 1.002 1.002 0 00-.122-.218 1.002 1.002 0 00-.052-.065 1.002 1.002 0 00-.061-.064 1.002 1.002 0 00-.06-.053 1.002 1.002 0 00-.137-.098 1.002 1.002 0 00-.4-.125A1.002 1.002 0 005.987 19H.992zm33.019 0a1.002 1.002 0 00-.167.015 1.002 1.002 0 00-.158.046 1.002 1.002 0 00-.076.034 1.002 1.002 0 00-.216.132 1.002 1.002 0 00-.219.254 1.002 1.002 0 00-.042.075 1.002 1.002 0 00-.098.318 1.002 1.002 0 00-.008.17 1.002 1.002 0 00.008.083 1.002 1.002 0 00.038.163 1.002 1.002 0 00.023.08 1.002 1.002 0 00.037.075 1.002 1.002 0 00.137.212 1.002 1.002 0 00.26.212 1.002 1.002 0 00.076.037 1.002 1.002 0 00.076.038 1.002 1.002 0 00.08.023 1.002 1.002 0 00.082.019 1.002 1.002 0 00.084.011 1.002 1.002 0 00.087.004h5.003a1.002 1.002 0 00.167-.015 1.002 1.002 0 00.083-.02 1.002 1.002 0 00.23-.094 1.002 1.002 0 00.14-.098 1.002 1.002 0 00.175-.182 1.002 1.002 0 00.087-.143 1.002 1.002 0 00.06-.155 1.002 1.002 0 00-.026-.662 1.002 1.002 0 00-.121-.22 1.002 1.002 0 00-.114-.128 1.002 1.002 0 00-.196-.151 1.002 1.002 0 00-.076-.038 1.002 1.002 0 00-.238-.076 1.002 1.002 0 00-.17-.019h-5zm-26.15 7.012a1.002 1.002 0 00-.163.015 1.002 1.002 0 00-.083.019 1.002 1.002 0 00-.238.095l-4.33 2.5a1.002 1.002 0 00-.073.045 1.002 1.002 0 00-.128.113 1.002 1.002 0 00-.106.125 1.002 1.002 0 00-.046.072 1.002 1.002 0 00-.075.151 1.002 1.002 0 00-.023.08 1.002 1.002 0 00-.034.166 1.002 1.002 0 00-.008.083 1.002 1.002 0 00.08.409 1.002 1.002 0 00.076.151 1.002 1.002 0 00.049.068 1.002 1.002 0 00.056.064 1.002 1.002 0 00.057.06 1.002 1.002 0 00.133.107 1.002 1.002 0 00.15.08 1.002 1.002 0 00.076.03 1.002 1.002 0 00.163.041 1.002 1.002 0 00.083.011 1.002 1.002 0 00.25-.011 1.002 1.002 0 00.163-.042 1.002 1.002 0 00.079-.034 1.002 1.002 0 00.076-.037l4.334-2.5a1.002 1.002 0 00.136-.099 1.002 1.002 0 00.06-.056 1.002 1.002 0 00.057-.065 1.002 1.002 0 00.053-.064 1.002 1.002 0 00.144-.303 1.002 1.002 0 00.019-.083 1.002 1.002 0 00.019-.25 1.002 1.002 0 00-.076-.328 1.002 1.002 0 00-.37-.447 1.002 1.002 0 00-.076-.041 1.002 1.002 0 00-.076-.038 1.002 1.002 0 00-.075-.03 1.002 1.002 0 00-.08-.027 1.002 1.002 0 00-.083-.015 1.002 1.002 0 00-.083-.011 1.002 1.002 0 00-.087 0zm24.3 0a1.002 1.002 0 00-.083 0 1.002 1.002 0 00-.083.011 1.002 1.002 0 00-.083.02 1.002 1.002 0 00-.076.022 1.002 1.002 0 00-.083.03 1.002 1.002 0 00-.148.083 1.002 1.002 0 00-.068.05 1.002 1.002 0 00-.125.113 1.002 1.002 0 00-.14.208 1.002 1.002 0 00-.037.076 1.002 1.002 0 00-.053.158 1.002 1.002 0 00-.027.254 1.002 1.002 0 00.02.163 1.002 1.002 0 00.018.083 1.002 1.002 0 00.027.08 1.002 1.002 0 00.034.079 1.002 1.002 0 00.136.211 1.002 1.002 0 00.057.06 1.002 1.002 0 00.124.114 1.002 1.002 0 00.072.046l4.335 2.5a1.002 1.002 0 00.15.071 1.002 1.002 0 00.25.053 1.002 1.002 0 00.167 0 1.002 1.002 0 00.083-.007 1.002 1.002 0 00.163-.042 1.002 1.002 0 00.227-.113 1.002 1.002 0 00.189-.163 1.002 1.002 0 00.056-.064 1.002 1.002 0 00.087-.144 1.002 1.002 0 00.069-.151 1.002 1.002 0 00.045-.25 1.002 1.002 0 000-.087 1.002 1.002 0 000-.083 1.002 1.002 0 00-.06-.242 1.002 1.002 0 00-.03-.08 1.002 1.002 0 00-.088-.143 1.002 1.002 0 00-.11-.129 1.002 1.002 0 00-.06-.06 1.002 1.002 0 00-.064-.05 1.002 1.002 0 00-.076-.049l-4.33-2.5a1.002 1.002 0 00-.152-.071 1.002 1.002 0 00-.08-.023 1.002 1.002 0 00-.166-.03 1.002 1.002 0 00-.087 0zM12.97 31.145a1.002 1.002 0 00-.083.008 1.002 1.002 0 00-.083.011 1.002 1.002 0 00-.083.019 1.002 1.002 0 00-.367.197 1.002 1.002 0 00-.064.056 1.002 1.002 0 00-.11.125 1.002 1.002 0 00-.046.072l-2.503 4.334a1.002 1.002 0 00-.095.235 1.002 1.002 0 00-.03.25 1.002 1.002 0 00.053.328 1.002 1.002 0 00.03.076 1.002 1.002 0 00.129.22 1.002 1.002 0 00.177.177 1.002 1.002 0 00.076.05 1.002 1.002 0 00.223.105 1.002 1.002 0 00.163.038 1.002 1.002 0 00.336-.008 1.002 1.002 0 00.163-.045 1.002 1.002 0 00.288-.17 1.002 1.002 0 00.174-.182 1.002 1.002 0 00.045-.072l2.504-4.334a1.002 1.002 0 00.068-.151 1.002 1.002 0 00.026-.08 1.002 1.002 0 00.015-.087 1.002 1.002 0 00.004-.332 1.002 1.002 0 00-.019-.084 1.002 1.002 0 00-.185-.374 1.002 1.002 0 00-.114-.125 1.002 1.002 0 00-.132-.098 1.002 1.002 0 00-.076-.042 1.002 1.002 0 00-.15-.068 1.002 1.002 0 00-.167-.038 1.002 1.002 0 00-.083-.007 1.002 1.002 0 00-.084 0zm14.07 0a1.002 1.002 0 00-.25.027 1.002 1.002 0 00-.162.052 1.002 1.002 0 00-.076.038 1.002 1.002 0 00-.14.087 1.002 1.002 0 00-.181.178 1.002 1.002 0 00-.2.454 1.002 1.002 0 00-.012.087 1.002 1.002 0 000 .083 1.002 1.002 0 00.011.166 1.002 1.002 0 00.042.163 1.002 1.002 0 00.068.151 1.002 1.002 0 000 .004l2.504 4.334a1.002 1.002 0 00.045.068 1.002 1.002 0 00.238.239 1.002 1.002 0 00.144.083 1.002 1.002 0 00.817.019 1.002 1.002 0 00.151-.076 1.002 1.002 0 00.068-.05 1.002 1.002 0 00.065-.052 1.002 1.002 0 00.06-.06 1.002 1.002 0 00.057-.061 1.002 1.002 0 00.05-.068 1.002 1.002 0 00.113-.227 1.002 1.002 0 00.022-.083 1.002 1.002 0 00.015-.08 1.002 1.002 0 00.016-.17 1.002 1.002 0 00-.016-.166 1.002 1.002 0 00-.041-.163 1.002 1.002 0 00-.034-.076 1.002 1.002 0 00-.038-.075l-2.5-4.338a1.002 1.002 0 00-.045-.068 1.002 1.002 0 00-.239-.238 1.002 1.002 0 00-.072-.046 1.002 1.002 0 00-.075-.038 1.002 1.002 0 00-.155-.056 1.002 1.002 0 00-.167-.038 1.002 1.002 0 00-.083 0zm-7.076 1.88a1.002 1.002 0 00-.48.143 1.002 1.002 0 00-.069.05 1.002 1.002 0 00-.128.11 1.002 1.002 0 00-.053.064 1.002 1.002 0 00-.053.064 1.002 1.002 0 00-.144.302 1.002 1.002 0 00-.034.254v5.003a1.002 1.002 0 00.004.084 1.002 1.002 0 00.011.083 1.002 1.002 0 00.076.238 1.002 1.002 0 00.038.076 1.002 1.002 0 00.098.14 1.002 1.002 0 00.057.064 1.002 1.002 0 00.268.196 1.002 1.002 0 00.076.035 1.002 1.002 0 00.083.026 1.002 1.002 0 00.08.023 1.002 1.002 0 00.253.019 1.002 1.002 0 00.73-.363 1.002 1.002 0 00.094-.137 1.002 1.002 0 00.133-.484v-5.003a1.002 1.002 0 000-.083 1.002 1.002 0 00-.015-.087 1.002 1.002 0 00-.02-.08 1.002 1.002 0 00-.14-.302 1.002 1.002 0 00-.052-.068 1.002 1.002 0 00-.057-.065 1.002 1.002 0 00-.125-.11 1.002 1.002 0 00-.143-.086 1.002 1.002 0 00-.239-.084 1.002 1.002 0 00-.083-.015 1.002 1.002 0 00-.166-.007z"}));case"frame":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M30 29H10V11h20zm1 1V10H9v20zm1 1H8V9h24zm2 2V7H6v26z"}));case"meta":return n.createElement("svg",{className:t,viewBox:"0 0 40 40"},n.createElement("path",{d:"M31.596 9.683c0-1.494-.265-2.396-.795-2.705-.518-.322-1.452-.483-2.801-.483V3.539l1.608-.039c1.904 0 3.26.444 4.067 1.333.819.889 1.229 2.3 1.229 4.231v6.164c0 1.25.192 2.106.578 2.57.398.463.904.766 1.518.908v2.801c-1.398.31-2.096 1.385-2.096 3.227v6.472c0 1.88-.428 3.233-1.284 4.057-.843.825-2.21 1.237-4.102 1.237-.337 0-.843-.013-1.518-.039v-2.956c1.518 0 2.494-.206 2.928-.618.445-.412.668-1.243.668-2.492zM18 25v5h-5v-5zm9 0v5h-5v-5ZM8.404 30.317c0 1.494.265 2.396.795 2.705.53.322 1.464.483 2.801.483v2.956l-1.627.039c-1.843 0-3.186-.425-4.03-1.275-.843-.85-1.265-2.28-1.265-4.29v-6.163c0-1.262-.198-2.119-.596-2.57A2.753 2.753 0 0 0 3 21.295v-2.801c1.386-.31 2.078-1.385 2.078-3.227V8.794c0-1.88.422-3.233 1.265-4.057C7.2 3.912 8.578 3.5 10.482 3.5c.325 0 .831.013 1.518.039v2.956c-1.518 0-2.5.206-2.946.618-.434.412-.65 1.243-.65 2.492z"}));case"rgb":return n.createElement("svg",{className:t,viewBox:"0 0 20 20"},n.createElement("path",{d:"M10 3.535a5 5 0 0 0-4.969 4.442A5 5 0 0 1 8 7a5 5 0 0 1 2 .418A5 5 0 0 1 12 7a5 5 0 0 1 2.969.979A5 5 0 0 0 10 3.535m4.969 4.444a5 5 0 0 1 .031.556 5 5 0 0 1-2.031 4.022A5 5 0 0 1 10 16.582 5 5 0 0 0 12 17a5 5 0 0 0 5-5 5 5 0 0 0-2.031-4.021M10 16.582a5 5 0 0 1-2.969-4.025A5 5 0 0 1 5 8.535a5 5 0 0 1 .031-.558A5 5 0 0 0 3 12a5 5 0 0 0 5 5 5 5 0 0 0 2-.418m-2.969-4.025a5 5 0 0 0 2.969.978 5 5 0 0 0 2.969-.978A5 5 0 0 0 13 12a5 5 0 0 0-3-4.582A5 5 0 0 0 7 12a5 5 0 0 0 .031.557"}));default:return null}},h=a(7673),E=a(2388);const f=(0,n.createContext)({runWithImage:async()=>{},runWithImages:async()=>{},validateAndAddPlugin:async()=>!1}),b=()=>(0,n.useContext)(f);var v=function({children:e,pluginsActive:t,hash:a}){const{plugins:r}=(0,E.h)(),{imageSelection:l}=(0,h.A)(),{runWithImage:s,runWithImages:F}=b();return n.createElement("span",{className:"plugin-select__wrapper"},e,n.createElement("ul",{className:o()("plugin-select",{"plugin-select--active":t})},r.map((({url:e,name:t,description:r,loading:o,error:i})=>n.createElement("li",{className:"plugin-select__plugin-list-entry",key:e},n.createElement("button",{type:"button",className:"plugin-select__button",disabled:Boolean(o||i),title:`${i||r||""}\n${e}`,onClick:()=>(e=>{a?s(e,a):F(e,l)})(e)},i&&n.createElement(g,{name:"warn"}),o&&n.createElement(g,{name:"loading"}),t||e))))))},_=a(6727),y=a(1511);var N=(0,y.v)((e=>({editFrame:null,editPalette:null,pickColors:null,editImageGroup:null,editImages:null,editRGBNImages:[],setEditFrame:t=>e({editFrame:t}),setEditImageGroup:t=>e({editImageGroup:t}),setEditPalette:t=>e({editPalette:t,pickColors:null}),setEditRGBNImages:t=>e({editRGBNImages:t}),setPickColors:t=>e({pickColors:t}),setEditImages:t=>e({editImages:t}),cancelEditFrame:()=>e({editFrame:null}),cancelEditImageGroup:()=>e({editImageGroup:null}),cancelEditPalette:()=>e({editPalette:null}),cancelEditRGBNImages:()=>e({editRGBNImages:[]}),cancelPickColors:()=>e({pickColors:null}),cancelEditImages:()=>e({editImages:null})}))),w=a(8231),k=a(3323),C=a(9860),A=a(9905),S=a(6533),I=a(318),P=a(8222);var x=()=>{const{exportScaleFactors:e,exportFileTypes:t,handleExportFrame:a}=(0,i.A)(),{frames:r,palettes:l,images:s}=(0,E.h)(),F=(0,k.j)(e,t,a,l);return{downloadSingleImage:(0,n.useCallback)((async e=>{const t=s.find((({hash:t})=>t===e));if(!t)throw new Error("image not found");const a=r.find((({id:e})=>e===t.frame)),{palette:n}=(0,I.s)(l,t);if(!n)throw new Error("imagePalette not found");const o=(0,A.A)({image:t,palette:n}),i=await(0,S.T)(s,r)(t.hash),c=a?await(0,P.mZ)(a?.hash):null,m=c?c.upper.length/20:2;if(!i)throw new Error("no tiles");const u=await F(t)(i,m);return(0,C.A)(o)(u)}),[r,s,l,F]),downloadImageCollection:(0,n.useCallback)((async e=>{const t=(0,A.A)({altTitle:"gameboy-printer-gallery",useCurrentDate:!0}),a=await Promise.all(e.map((async e=>{const t=s.find((({hash:t})=>t===e));if(!t)throw new Error("image not found");const a=r.find((({id:e})=>e===t.frame)),n=await(0,S.T)(s,r)(t.hash),l=a?await(0,P.mZ)(a?.hash):null,o=l?l.upper.length/20:2;return F(t)(n||[],o)})));(0,C.A)(t)(a.flat())}),[r,s,F])}};let T=null;const D=()=>{if(null===T)try{T=window.navigator.canShare({files:[new File([new Blob(["t","e","s","t"])],"test.txt",{type:"text/plain",lastModified:Date.now()})]})}catch(e){T=!1}return T||!1};var B=a(9200);var R=()=>{const{exportScaleFactors:e,exportFileTypes:t,handleExportFrame:a}=(0,i.A)(),{frames:r,palettes:l,images:s}=(0,E.h)();return{shareImage:(0,n.useCallback)((async n=>{const F=s.find((({hash:e})=>n===e));if(!F)throw new Error("image not found");const o=r.find((({id:e})=>e===F.frame)),i=[...e].pop()||4,c=[...t].pop()||"png",m=(0,k.j)([i],[c],a,l),u=await(0,S.T)(s,r)(F.hash),d=o?await(0,P.mZ)(o?.hash):null,p=d?d.upper.length/20:2,g=await m(F)(u||[],p),{blob:h,filename:E,title:f}=g[0];window.navigator.share&&window.navigator.share({files:[new File([h],E,{type:"image/png",lastModified:Date.now()})],title:f}).catch((()=>"¯\\_(ツ)_/¯"))}),[t,e,r,a,s,l])}};var L=(0,y.v)(((e,t)=>({bitmapQueue:[],frameQueue:[],importQueue:[],bitmapQueueAdd:t=>e((({bitmapQueue:e})=>({bitmapQueue:[...e,...t]}))),bitmapQueueCancel:()=>e({bitmapQueue:[]}),frameQueueAdd:t=>e((({frameQueue:e})=>({frameQueue:[...e,...t]}))),frameQueueCancelOne:t=>e((({frameQueue:e})=>({frameQueue:e.filter((e=>e.tempId!==t))}))),importQueueAdd:a=>{const{bitmapQueue:n,importQueue:r}=t(),l=a.map((({fileName:e})=>e));e({bitmapQueue:n.filter((({fileName:e})=>!l.includes(e))),importQueue:[...r,...a]})},importQueueCancel:()=>{e({importQueue:[]})},importQueueCancelOne:t=>e((({importQueue:e})=>({importQueue:e.filter((e=>e.tempId!==t))})))}))),M=a(6194);const G=()=>{const{dismissDialog:e,setDialog:t}=(0,_.A)(),{cancelEditFrame:a,cancelEditImages:r,cancelEditPalette:l}=N(),{updateRecentImports:s,updateImageSelection:F}=(0,h.A)(),{importQueueCancel:o}=L(),{setProgress:i,setPrinterBusy:c}=(0,w.A)(),{addImages:m,deleteImages:u,setImageGroups:d,updateFrameGroups:p,updateImageHash:g,updateImages:f,setFrames:b,setImages:v,setPalettes:y}=(0,E.h)(),{setSyncLastUpdate:k}=(0,M.A)();return(0,n.useMemo)((()=>{const n=()=>k("local",Math.floor((new Date).getTime()/1e3)),E=()=>{i("printer",0),c(!1),o()};return{addImages:t=>{m(t),e(0),n(),E(),s(t)},deleteImages:t=>{u(t),F(h.N.REMOVE,t),e(0),n()},dismissDialog:e,globalUpdate:e=>{a(),l(),r(),e.lastUpdateUTC?k("local",e.lastUpdateUTC):n(),e.palettes&&y(e.palettes),e.images&&(v(e.images),s(e.images)),e.frames&&b(e.frames),e.frameGroups&&p(e.frameGroups),e.imageGroups&&d(e.imageGroups)},importQueueCancel:E,setDialog:t,updateImageHash:(e,t)=>{r(),n(),g(e,t)},updateImages:e=>{f(e),n()},updateLastSyncLocalNow:n}}),[m,a,r,l,u,e,o,t,b,v,y,d,c,i,k,p,g,F,f,s])};var V;!function(e){e.EDIT="edit",e.DOWNLOAD="download",e.DELETE="delete",e.SHARE="share",e.SELECT="select",e.VIEW="view",e.FAVOURITE="favourite",e.PLUGINS="plugins"}(V||(V={}));const $=({hash:e,imageTitle:t,tags:a})=>{const{imageSelection:n,updateImageSelection:r,filtersActiveTags:l,sortBy:s,recentImports:F}=(0,h.A)(),{setLightboxImage:o}=(0,w.A)(),{plugins:i,images:c,updateImageFavouriteTag:m}=(0,E.h)(),{setEditImages:u}=N(),{dismissDialog:d,setDialog:p}=(0,_.A)(),{updateLastSyncLocalNow:g,deleteImages:f}=G(),{downloadSingleImage:b}=x(),{shareImage:v}=R(),y=n.includes(e);return{hasPlugins:!!i.length,isSelected:y,canShare:D(),startDownload:()=>b(e),deleteImage:()=>{p({message:t?`Delete image "${t}"?`:"Delete this image?",confirm:async()=>{f([e])},deny:async()=>d(0)})},shareImage:()=>v(e),updateImageToSelection:t=>{r(t,[e])},setLightboxImage:()=>{o((0,B.S)(c,{filtersActiveTags:l,sortBy:s,recentImports:F}).findIndex((t=>e===t.hash)))},updateFavouriteTag:t=>{m(t,e),g()},editImage:()=>{u({tags:a,batch:[e]})}}};var O=a(6564);const U=(0,n.createContext)({view:{id:"ROOT",slug:"",created:"",title:"",coverImage:"",images:[],groups:[]},images:[],covers:[],paths:[],pathsOptions:[]}),z=()=>(0,n.useContext)(U);var H=a(7767);const W=a(3829).A;var X=a(498);const j=()=>{const{"*":e}=(0,H.g)(),t=/(?<slug>.*\/)*(page\/)(?<page>\d*)/g.exec(e||""),a=t?.groups?.page,n=t?.groups?.slug||"";return{pageIndex:a?parseInt(a,10)-1:0,path:n}},Y="NEW_GROUP",Z=e=>e.trim().replace(/[^A-Z0-9_-]+/gi,"_").toLowerCase(),Q=(e,t)=>e.find((({group:{groups:e}})=>e.find((({id:e})=>e===t))))||null;var K=()=>{const{imageSelection:e}=(0,h.A)(),{editImageGroup:t,cancelEditImageGroup:a}=N(),{imageGroups:r,addImageGroup:l,updateImageGroup:s}=(0,E.h)(),F=r.find((({id:e})=>e===t?.groupId))||null,{view:o,paths:i,pathsOptions:c}=z(),{path:m}=j(),d=(0,H.Zp)(),[p,g]=(0,n.useState)(F?.title||t?.newGroupTitle||""),[f,b]=(0,n.useState)(F?.slug||Z(p)),[v,_]=(0,n.useState)(Boolean(F)),[y,w]=(0,n.useState)(Q(i,t?.groupId||"")?.absolutePath||""),k=(0,n.useMemo)((()=>{if(!t?.groupId)return"";if(t?.groupId===Y)return`${m}${f}/`;const e=Q(i,t.groupId);return`${e?.absolutePath||""}${f}/`}),[t,i,m,f]),C=!(0===f.length||f!==F?.slug&&i.find((({absolutePath:e})=>e===k))),A=c.filter((({value:e})=>!e.startsWith(k)));return{editId:t?.groupId||null,absoluteSlug:k,possibleParents:A,slug:f,title:p,canConfirm:C,parentSlug:y,setSlug:e=>{b(e),_(!0)},setTitle:e=>{g(e),(e.length<2||!v)&&(_(!1),b(Z(e)))},setParentSlug:w,confirm:()=>{if(a(),C){if(t?.groupId===Y){if(!t?.newGroupCover)return;l({id:W(),slug:f,title:p,created:u()(Date.now()).format(X.i$),coverImage:t?.newGroupCover,images:e,groups:[]},o.id)}else{if(!F)return;const e=i.find((({absolutePath:e})=>e===y))?.group.id||"";s({...F,slug:f,title:p},e)}d(`/gallery/${y}${f}/page/1`)}},cancelEditImageGroup:a}};const q=()=>{const{view:e}=z(),{dismissDialog:t,setDialog:a}=(0,_.A)(),{setEditImageGroup:n}=N(),{deleteImageGroup:r,setImageGroups:l}=(0,E.h)();return{resetGroups:()=>{a({message:"Reset image groups?",questions:()=>[{key:"info",type:O.V.INFO,label:"This will remove ALL your created groups and all existing images will be moved to the top level."}],confirm:async()=>{t(0),l([])},deny:async()=>{t(0)}})},createGroup:(e,t)=>{n({groupId:Y,newGroupCover:e,newGroupTitle:t?.trim()?`Group - ${t}`:"New group"})},editGroup:e=>{n({groupId:e})},deleteGroup:n=>{const l=e.groups.find((e=>e.id===n));l&&a({message:"Delete image group?",questions:()=>[{key:"info",type:O.V.INFO,label:`This will delete this group "${l.title||l.slug}" and move all children (images & groups) to the current level.`}],confirm:async()=>{t(0),r(n)},deny:async()=>{t(0)}})}}};u().extend(p());var J=function({hash:e,buttons:t,isFavourite:a,imageTitle:r,tags:l}){const[s,F]=(0,n.useState)(!1),{enableImageGroups:c}=(0,i.A)(),{canShare:m,isSelected:u,hasPlugins:d,deleteImage:p,setLightboxImage:E,shareImage:f,startDownload:b,updateImageToSelection:_,updateFavouriteTag:y,editImage:N}=$({hash:e,imageTitle:r,tags:l}),{createGroup:w}=q();return n.createElement("div",{className:"gallery-image-buttons",onClick:e=>{e.stopPropagation()},onMouseLeave:()=>F(!1),role:"presentation"},t.includes(V.SELECT)?n.createElement("button",{type:"button",className:o()("gallery-image-buttons__button",{"gallery-image-buttons__button--unchecked":!u,"gallery-image-buttons__button--checked":u}),onClick:()=>_(u?h.N.REMOVE:h.N.ADD),title:u?"Remove from selection":"Add to selection"},n.createElement(g,{name:"checkmark"})):null,t.includes(V.EDIT)?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:N,title:"Edit"},n.createElement(g,{name:"edit"})):null,t.includes(V.DOWNLOAD)?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:b,title:"Download"},n.createElement(g,{name:"download"})):null,t.includes(V.DELETE)?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:p,title:"Delete"},n.createElement(g,{name:"delete"})):null,t.includes(V.VIEW)?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:E,title:"View in Lightbox"},n.createElement(g,{name:"view"})):null,d?n.createElement(v,{pluginsActive:s,hash:e},n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:()=>{F(!0)},title:"Use Plugin"},n.createElement(g,{name:"plug"}))):null,t.includes(V.SHARE)&&m?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:f,title:"Share"},n.createElement(g,{name:"share"})):null,t.includes(V.FAVOURITE)?n.createElement("button",{type:"button",className:o()("gallery-image-buttons__button",{"gallery-image-buttons__button--unchecked":!a,"gallery-image-buttons__button--favourite":a}),onClick:()=>y(!a),title:a?"Remove from favourites":"Add to favourites"},a?"❤️":n.createElement(g,{name:"fav"})):null,u&&c?n.createElement("button",{type:"button",className:"gallery-image-buttons__button",onClick:()=>w(e,r)},n.createElement(g,{name:"file-add"})):null)},ee=a(784),te=a(3111),ae=a(7580),ne=a(6763);var re=function({palette:e,tiles:t,imageStartLine:a,lockFrame:r,invertPalette:l,framePalette:s,invertFramePalette:F,asThumb:i=!1,rotation:c=te.pL.DEG_0}){const m=!(e instanceof Array),u=(0,n.useRef)(null),[d,p]=(0,n.useState)(""),g=(m?(0,ee.EK)(t):t.length)<=360;return(0,n.useEffect)((()=>{if(!e||!t)return;const n=document.createElement("canvas");n.width=160,n.height=144;try{if(m){const a=new ee.Wd;t&&a.update({canvas:n,tiles:t,palette:e,lockFrame:r})}else{const r=new ee.XM;if(t?.length){const o=(0,ae.A)({palette:e,framePalette:s,invertPalette:l,invertFramePalette:F});r.update({canvas:n,tiles:t,...o,imageStartLine:a})}}u.current&&(0,te.zP)(n,u.current,c||te.pL.DEG_0),p("")}catch(e){e instanceof Error&&(ne.error(e),p(e.message))}}),[t,e,r,l,c,m,a,s,F]),n.createElement("div",{className:o()("gameboy-image",{"gameboy-image--rot-90":c===te.pL.DEG_90,"gameboy-image--rot-180":c===te.pL.DEG_180,"gameboy-image--rot-270":c===te.pL.DEG_270})},d?n.createElement("p",{className:"gameboy-image__error"},d):n.createElement("canvas",{className:o()("gameboy-image__image",{"gameboy-image__image--as-thumb":i,"gameboy-image__image--min-size":g}),width:160,ref:u}))};let le;const se=(e,t)=>{const n=async()=>{if(!le){const{dropBoxSyncTool:n}=await Promise.all([a.e(350),a.e(575)]).then(a.bind(a,584));le=le||n(e,t)}return le};M.A.getState().dropboxStorage.use&&n();return{recoverImageData:async e=>(await n()).recoverImageData(e),startAuth:async()=>(await n()).startAuth(),startSyncData:async e=>(await n()).startSyncData(e),startSyncImages:async()=>(await n()).startSyncImages(),updateSettings:async e=>(await n()).updateSettings(e),subscribe:()=>M.A.subscribe((e=>e.dropboxStorage),(async e=>{(await n()).updateSettings(e)}))}};var Fe=a(7837),oe=a(3299);const ie=e=>{const t=(0,oe.A)(e);return(a,n)=>{const r=n.map((t=>{const n=a.find((a=>a[e]===t[e]));return n?{...n,...t}:t}));return t([...r,...a])}},ce=ie("hash"),me=ie("id"),ue=ie("shortName");var de=(e,t,a,n,r)=>{let l=e,s=a,F=t;return r?(n.frames&&n.frames.length&&(l=me(l,n.frames)),n.images&&n.images.length&&(s=ce(s,n.images)),n.palettes&&n.palettes.length&&(F=ue(F,n.palettes))):(l=n.frames||e,s=n.images||a,F=n.palettes||t),{...n,images:s,frames:l,palettes:F}},pe=a(2419);const ge=async(e,t=!1)=>{const{frames:a,palettes:n,images:r}=E.h.getState();return Object.keys(e).forEach((t=>{if("state"!==t){const a=e[t];t.match(/^[a-f0-9]{40,}$/gi)?pe.mU.setItem(`${t}`,a):t.startsWith("frame-")&&pe.Uv.setItem(`${t.split("frame-").pop()}`,a)}})),de(a,n,r,e.state||{},t)},he=()=>{const{globalUpdate:e}=G();return(0,n.useMemo)((()=>{const t=(0,Fe.A)();return{downloadSettings:async(e,a="")=>{const n=await t(e,{selectedFrameGroup:a}),r="frames"===e?"frames":[e,a].filter(Boolean).join("_");(0,k.R)(null)([{blob:new Blob(new Array(n)),filename:`${r}.json`}])},jsonImport:async t=>{const a=await ge(t,!0);e(a)},remoteImport:async t=>{const a=await ge(t,!1);e(a)}}}),[e])};var Ee=function({hash:e,hashes:t,frameId:a,lockFrame:r,invertPalette:l,invertFramePalette:s,palette:F,framePalette:o,rotation:i}){const{gbImageProps:c}=(({hash:e,hashes:t,palette:a,invertPalette:r,framePalette:l,invertFramePalette:s,lockFrame:F,frameId:o,rotation:i})=>{const[c,m]=(0,n.useState)(null),u=G(),{remoteImport:d}=he(),{frames:p,palettes:g,images:h}=(0,E.h)(),f=p.find((({id:e})=>e===o))?.hash,b=(0,n.useCallback)(((e,a,n)=>(0,S.T)(h,p,(()=>{se(u,d).recoverImageData(e)}))(e,a,n,t)),[h,p,t,u,d]),v=(0,n.useMemo)((()=>"string"==typeof a?(g.find((({shortName:e})=>e===a))||X.Fv).palette:a),[g,a]);return(0,n.useEffect)((()=>{let t=!1;return e||m(null),(async()=>{if(t)return;const n=await b(e,!1,o),c=f?await(0,P.mZ)(f):null,u=c?c.upper.length/20:2;t||n&&m({tiles:n,palette:v,invertPalette:r,imageStartLine:u,lockFrame:F,rotation:i,framePalette:F?l:a,invertFramePalette:F?s:r})})(),()=>{t=!0}}),[b,e,o,a,r,F,i,v,f,l,s]),{gbImageProps:c}})({hash:e,hashes:t,frameId:a,lockFrame:r,invertPalette:l,invertFramePalette:s,palette:F,framePalette:o,rotation:i});return c?n.createElement(re,{lockFrame:c.lockFrame,invertPalette:c.invertPalette,invertFramePalette:c.invertFramePalette,tiles:c.tiles,palette:c.palette,framePalette:c.framePalette,imageStartLine:c.imageStartLine,rotation:c.rotation}):n.createElement("div",{className:"image-render--loading"})},fe=a(5534);var be=function({hideDate:e,created:t,className:a,preferredLocale:r}){return e||!t?null:n.createElement("span",{className:a},(0,fe.A)(u()(t,X.i$),r))},ve=a(601);var _e,ye=function({tags:e}){return n.createElement("ul",{className:"gallery-image__tags"},e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))).map((e=>n.createElement("li",{key:e,title:e===ve.X.FILTER_FAVOURITE?"Favourite":e,className:"gallery-image__tag"},e===ve.X.FILTER_FAVOURITE?"❤️":e))))},Ne=a(7261);!function(e){e.ADD="add",e.REMOVE="remove"}(_e||(_e={}));const we=e=>{const{setEditImages:t}=N(),{enableDebug:a,hideDates:r,preferredLocale:l,pageSize:s}=(0,i.A)(),{filtersActiveTags:F,sortBy:o,recentImports:c,imageSelection:m,updateImageSelection:u,lastSelectedImage:d,setImageSelection:p}=(0,h.A)(),{palettes:g,images:f}=(0,E.h)(),b=m.includes(e),v=(0,n.useMemo)((()=>{const t=f.find((t=>t.hash===e));let n;if(!t)return;n=(0,Ne.pl)(t)?t.palette:(g.find((({shortName:e})=>e===t.palette))||X.Fv).palette;const s=(g.find((({shortName:e})=>e===t.framePalette))||X.Fv).palette;return{title:t.title,created:t.created,frame:t.frame,hashes:t.hashes||void 0,tags:t.tags,isFavourite:t.tags.includes(ve.X.FILTER_FAVOURITE),palette:n,framePalette:s,lockFrame:t.lockFrame,invertPalette:t.invertPalette,invertFramePalette:t.invertFramePalette,hideDate:r,meta:t.meta,rotation:t.rotation,preferredLocale:l,enableDebug:a,isSelected:b}}),[a,e,r,b,g,l,f]),{images:_}=z();return{galleryImageData:v,updateImageSelection:(t,a,n)=>{if(a){const t=(0,B.S)(_,{filtersActiveTags:F,sortBy:o,recentImports:c}),a=t.findIndex((t=>t.hash===e));let r=t.findIndex((e=>e.hash===d));-1===r&&(r=n*s);const l=Math.min(r,a),i=Math.max(r,a);p(t.slice(l,i+1).map((e=>e.hash)))}else u(t,[e])},editImage:a=>{t({tags:a,batch:[e]})}}};var ke=a(7928);u().extend(p());const Ce=[V.SELECT,V.EDIT,V.FAVOURITE,V.DOWNLOAD,V.DELETE,V.VIEW,V.SHARE,V.PLUGINS];var Ae=function({page:e,hash:t}){const[a,r]=(0,n.useState)(!1),{galleryImageData:l,updateImageSelection:s,editImage:F}=we(t),i=(0,c.HZ)((()=>{(0,ke.A)()&&s(l?.isSelected?h.N.REMOVE:h.N.ADD,!1,e)})),m=(0,n.useCallback)((()=>{window.removeEventListener("click",m),r(!1)}),[]);if(!l)return null;const{created:u,hashes:d,palette:p,invertPalette:E,invertFramePalette:f,framePalette:b,frame:v,lockFrame:_,title:y,tags:N,isFavourite:w,isSelected:k,hideDate:C,preferredLocale:A,meta:S,rotation:I,enableDebug:P}=l;return n.createElement("li",{className:o()("gallery-image gallery-item",{"gallery-item--selected":k}),...i(),onClick:t=>{t.ctrlKey||t.shiftKey?(t.preventDefault(),s(k?h.N.REMOVE:h.N.ADD,t.shiftKey,e)):(0,ke.A)()?a||(r(!0),window.requestAnimationFrame((()=>{window.addEventListener("click",m)}))):(t.preventDefault(),F(N))},onMouseEnter:()=>{(0,ke.A)()||r(!0)},onMouseLeave:()=>{(0,ke.A)()||r(!1)},role:"presentation",title:P?JSON.stringify(l,null,2):void 0},a?n.createElement(J,{isFavourite:w,hash:t,imageTitle:y,buttons:Ce,tags:N}):null,n.createElement("div",{className:"gallery-image__image"},n.createElement(Ee,{lockFrame:_,invertPalette:E,palette:p,framePalette:b,invertFramePalette:f,frameId:v,hash:t,hashes:d,rotation:I})),y?n.createElement("span",{className:"gallery-image__title"},y):null,n.createElement(ye,{tags:N}),n.createElement("div",{className:"gallery-image__created-meta"},S?n.createElement(n.Fragment,null,n.createElement("div",{className:"gallery-image__meta"},n.createElement(g,{name:"meta"})),n.createElement("pre",{className:"gallery-image__meta-pre"},JSON.stringify(S,null,2))):null,n.createElement(be,{className:"gallery-image__created",hideDate:C,created:u,preferredLocale:A})),P?n.createElement("span",{className:"gallery-image__hash-debug"},t,d?Object.keys(d).map((e=>n.createElement("span",{key:e},n.createElement("br",null),`${e.toUpperCase()}: ${d[e]}`))):null):null)},Se=a(3839);const Ie=e=>{const t=40;return e>1220?1155:e>1025?960:e>830?765:e>635?570:e>440?375:e-t},Pe=()=>({width:window.innerWidth,height:window.innerHeight,ddpx:window.devicePixelRatio<3?window.devicePixelRatio:window.devicePixelRatio/2,layoutWidth:Ie(window.innerWidth)}),xe=()=>{const[e,t]=(0,n.useState)(Pe());return(0,n.useEffect)((()=>{const e=()=>{t(Pe())};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[t]),e},Te=e=>{switch(e){case Se.j.GALLERY_VIEW_SMALL:return"Smallest";case Se.j.GALLERY_VIEW_1X:return"Original Size";case Se.j.GALLERY_VIEW_2X:return"Double Size";case Se.j.GALLERY_VIEW_MAX:return"Maximum Size";default:return""}};var De,Be,Re,Le=function(){const{galleryView:e,setGalleryView:t}=(0,i.A)(),{ddpx:a}=xe(),r=a>1?[Se.j.GALLERY_VIEW_SMALL,Se.j.GALLERY_VIEW_1X,Se.j.GALLERY_VIEW_2X,Se.j.GALLERY_VIEW_MAX]:[Se.j.GALLERY_VIEW_1X,Se.j.GALLERY_VIEW_2X,Se.j.GALLERY_VIEW_MAX];return n.createElement("ul",{className:"gallery-view-select gallery-button__group"},r.map((a=>n.createElement("li",{key:a,className:o()("gallery-button gallery-button--enabled",{"gallery-button--selected":e===a})},n.createElement("button",{type:"button",onClick:()=>{t(a)},title:Te(a)},n.createElement(g,{name:a}))))))};!function(e){e.DELETE="delete",e.ANIMATE="animate",e.DOWNLOAD="download",e.EDIT="edit",e.RGB="rgb"}(De||(De={})),function(e){e.LOCK_FRAME="lockFrame",e.FRAME="frame",e.PALETTE="palette",e.TITLE="title",e.TAGS="tags",e.CREATED="created",e.ROTATION="rotation"}(Be||(Be={})),function(e){e.INVERT_PALETTE="invertPalette",e.FRAME_PALETTE="framePalette",e.INVERT_FRAME_PALETTE="invertFramePalette"}(Re||(Re={}));const Me=[Be.LOCK_FRAME,Be.FRAME,Be.TITLE,Be.TAGS,Be.CREATED,Be.ROTATION,Be.PALETTE,Re.INVERT_PALETTE,Re.FRAME_PALETTE,Re.INVERT_FRAME_PALETTE];var Ge=a(7372);const Ve=e=>(0,Ge.A)(e.map((({tags:e})=>e)).flat());var $e=e=>{const{imageSelection:t,sortBy:a,filtersActiveTags:r,recentImports:l,setFiltersVisible:s,setSortOptionsVisible:F,setImageSelection:o}=(0,h.A)(),{plugins:c,images:m}=(0,E.h)(),{pageSize:u}=(0,i.A)(),{setEditImages:d,setEditRGBNImages:p}=N(),{dismissDialog:g,setDialog:f}=(0,_.A)(),{setVideoSelection:b}=(0,w.A)(),{downloadImageCollection:v}=x(),{deleteImages:y}=G(),{view:k,covers:C}=z(),A=e*u,S=(0,B.S)(k.images,{sortBy:a,filtersActiveTags:r,recentImports:l}).splice(A,u||1/0).filter((e=>!C.includes(e.hash))).filter((({hash:e})=>t.includes(e))),I=S.reduce(Ne.iy,[]),P=(0,n.useMemo)((()=>t.reduce(((e,t)=>{const a=m.find((({hash:e})=>e===t));return a?[a,...e]:e}),[])),[t,m]),T=t.length,D=S.length>0;return{hasPlugins:!!c.length,batchEnabled:!!t.length,monochromeBatchEnabled:S.length>1&&I.length===S.length,activeFilters:r.length||0,selectedImageCount:T,hasSelected:D,batchTask:e=>{if(t.length)switch(e){case De.DELETE:f({message:`Delete ${t.length} images?`,confirm:async()=>{y(t)},deny:async()=>g(0)});break;case De.ANIMATE:b(t);break;case De.DOWNLOAD:v(t);break;case De.EDIT:d({tags:Ve(P),batch:P.map((({hash:e})=>e))});break;case De.RGB:p(P.reduce(Ne.iy,[]).map((({hash:e})=>e)))}},checkAll:()=>{o((0,B.S)(k.images,{filtersActiveTags:r,sortBy:a,recentImports:l}).slice(e*u,(e+1)*u||void 0).map((({hash:e})=>e)))},unCheckAll:()=>o([]),filter:()=>s(!0),showSortOptions:()=>F(!0)}};const Oe=[De.DOWNLOAD,De.DELETE,De.EDIT,De.ANIMATE],Ue=[De.RGB],ze=e=>{switch(e){case De.DELETE:return"Delete";case De.ANIMATE:return"Animate";case De.DOWNLOAD:return"Download";case De.EDIT:return"Edit";case De.RGB:return"Create RGB Images";default:return""}};var He=function({page:e}){const{hasPlugins:t,batchEnabled:a,monochromeBatchEnabled:r,activeFilters:l,selectedImageCount:s,hasSelected:F,batchTask:i,checkAll:c,unCheckAll:m,filter:u,showSortOptions:d}=$e(e),[p,h]=(0,n.useState)(!1);return n.createElement("ul",{className:"batch-buttons gallery-button__group"},n.createElement("li",{className:"gallery-button gallery-button--enabled"},n.createElement("button",{type:"button",onClick:d,title:"Sort"},n.createElement(g,{name:"sort"}))),n.createElement("li",{className:"gallery-button gallery-button--enabled"},n.createElement("button",{type:"button",onClick:u,title:"Manage Filters"},n.createElement(g,{name:"filter"}),0===l?null:n.createElement("span",{className:"batch-buttons__bubble"},l))),n.createElement("li",{className:o()("gallery-button gallery-button--enabled",{"gallery-button--has-selected":!F})},n.createElement("button",{type:"button",onClick:F?m:c,title:F?"Uncheck All":"Check All"},n.createElement(g,{name:"checkmark"}),0===s?null:n.createElement("span",{className:"batch-buttons__bubble"},s))),Oe.map((e=>n.createElement("li",{key:e,className:o()("gallery-button",{"gallery-button--disabled":!a,"gallery-button--enabled":a})},n.createElement("button",{disabled:!a,type:"button",onClick:()=>i(e),title:ze(e)},n.createElement(g,{name:e}))))),Ue.map((e=>n.createElement("li",{key:e,className:o()("gallery-button",{"gallery-button--disabled":!r,"gallery-button--enabled":r})},n.createElement("button",{disabled:!r,type:"button",onClick:()=>i(e),title:ze(e)},n.createElement(g,{name:e}))))),t?n.createElement("li",{className:o()("gallery-button",{"gallery-button--disabled":!a,"gallery-button--enabled":a}),onMouseLeave:()=>h(!1)},n.createElement(v,{pluginsActive:p},n.createElement("button",{type:"button",onClick:()=>h(!0),title:"Use Plugin"},n.createElement(g,{name:"plug"})))):null)};var We=function(e){return n.createElement("div",{className:o()("gallery-header",{"gallery-header--sticky":e.isSticky,"gallery-header--bottom":e.isBottom})},n.createElement(Le,null),n.createElement(He,{page:e.page}))};var Xe=function(e){return n.createElement(n.Fragment,null,n.createElement("h2",{className:"gallery-intro__counter"},`${e.imageCount} images`,e.filteredCount?` / ${e.filteredCount} filtered`:null,e.selectedCount?` / ${e.selectedCount} selected`:null),n.createElement("p",{className:"gallery-intro__content-hint"},"These images are stored in the localStorage of your browser. That's why you (currently) cannot share a link to one of them.",n.createElement("br",null),"Also if you clear your browser's cookies, the images will be gone too."))};var je=function({hash:e}){const{group:t,path:a}=(e=>{const{paths:t}=z(),{path:a}=j(),n=t.reduce(((t,{absolutePath:n,group:r})=>t||(r.coverImage===e&&n!==a?n:null)),null);return{group:t.find((({absolutePath:e})=>e===n))?.group||null,path:n}})(e),{galleryImageData:l}=we(e),{deleteGroup:s,editGroup:F}=q();if(!l||!t)return null;const{hashes:o,palette:i,invertPalette:c,framePalette:m,frame:u,lockFrame:d,rotation:p}=l;return n.createElement("li",{className:"gallery-group gallery-item",role:"presentation"},n.createElement(r.N_,{className:"gallery-group__link",to:`/gallery/${a}page/1`},n.createElement("div",{className:"gallery-group__image"},n.createElement(Ee,{lockFrame:d,invertPalette:c,framePalette:m,palette:i,frameId:u,hash:e,hashes:o,rotation:p}),n.createElement("div",{className:"gallery-group__temp"},"GROUP 🗁")),n.createElement("p",{className:"gallery-group__info"},`${t.images.length} images`),n.createElement("p",{className:"gallery-group__title"},t.title)),n.createElement("div",{className:"gallery-group__buttons"},n.createElement("button",{className:"gallery-group__button button",type:"button",onClick:()=>F(t.id)},"Edit Group"),n.createElement("button",{className:"gallery-group__button button",type:"button",onClick:()=>s(t.id)},"Delete Group")))};var Ye=function({id:e,label:t,disabled:a,value:r,setSelected:l,options:s}){return n.createElement("div",{className:"inputgroup"},t?n.createElement("label",{htmlFor:`confirm-options-${e}`,className:"inputgroup__label"},t):null,n.createElement("select",{id:`confirm-options-${e}`,disabled:a,className:"inputgroup__input inputgroup__input--select",value:r,onChange:({target:e})=>l(e.value)},s.map((({value:e,name:t})=>n.createElement("option",{value:e,key:e},t)))))};var Ze=function(){const e=(0,H.Zp)(),{path:t}=j(),{paths:a,pathsOptions:l}=z(),{setEditImageGroup:s}=N(),F=(0,n.useMemo)((()=>t.split("/").reduce(((e,t)=>{if(!t)return e;const n=e.map((({label:e})=>e)).concat(t,"").join("/"),r=a.find((({absolutePath:e})=>e===n))?.group.id||"";return r?[...e,{groupId:r,label:t,path:n}]:e}),[])),[t,a]);return l.length<2?null:n.createElement("div",{className:"folder-navi"},n.createElement("ul",{className:"folder-navi__segments"},n.createElement("li",{className:"folder-navi__entry"},n.createElement(r.N_,{className:"folder-navi__link",to:"/gallery/page/1"},"🏠")),F.map((({label:e,path:t,groupId:a})=>n.createElement("li",{key:t,className:"folder-navi__entry"},n.createElement(r.N_,{className:"folder-navi__link",to:`/gallery/${t}page/1`},e),n.createElement("button",{type:"button",className:"folder-navi__edit-button",onClick:()=>s({groupId:a})},n.createElement(g,{name:"edit",className:"folder-navi__edit-icon"})))))),n.createElement(Ye,{id:"paths",label:"Your current location",options:l,setSelected:t=>e(`/gallery/${t}page/1`),value:t,disabled:!1}))};var Qe=function(e){const{path:t}=j();return n.createElement("li",{className:o()("gallery-button pagination__button",e.className,{"gallery-button--selected":e.active})},n.createElement(r.k2,{className:"pagination__link",to:`/gallery/${t}page/${e.page+1}`,title:e.title},e.children))},Ke=a(985),qe=a(6521);var Je=(e,t,a)=>[...e].filter((0,qe.A)(t,a)).filter((0,Ke.A)(t)).length;var et=function({page:e}){const{view:t}=z(),{pageSize:a}=(0,i.A)(),{filtersActiveTags:r,recentImports:l}=(0,h.A)(),s=a?Math.ceil(Je(t.images,r,l)/a):0;if(s<2)return null;const F=[...new Array(s)].map(((e,t)=>t)),o=F.map((t=>{switch(t){case 0:case e-1:case e:case e+1:case F.length-1:return n.createElement(Qe,{key:t,page:t,active:t===e,title:`To page ${t+1}`},t+1);case e-2:case e+2:return n.createElement("li",{key:t,className:"gallery-button pagination__ellipsis"});default:return null}}));return e>0&&o.unshift(n.createElement(Qe,{className:"pagination__button--start",key:"back",title:"To previous page",page:e-1},n.createElement(g,{name:"left"}))),e<F.length-1&&o.push(n.createElement(Qe,{className:"pagination__button--end",key:"next",title:"To next page",page:e+1},n.createElement(g,{name:"right"}))),n.createElement("ul",{className:"pagination gallery-button__group"},o.filter(Boolean))};const tt=e=>{const t=10/e.ddpx,a=160/e.ddpx,n=20+a;return{"--tile-padding":"10px","--image-size":`${a}px`,"--gap":`${t}px`,"--columns":Math.floor((e.layoutWidth+t)/(n+t)).toString(10),"--col-size":`${n}px`,"--layout-width":`${e.layoutWidth}px`}};var at=function(){const{imageCount:e,selectedCount:t,filteredCount:a,page:r,images:l,covers:s,galleryView:F}=(()=>{const{view:e,covers:t}=z(),{pageSize:a,galleryView:n}=(0,i.A)(),{imageSelection:r,filtersActiveTags:l,recentImports:s,sortBy:F}=(0,h.A)(),{images:o}=(0,E.h)(),c=o.length,m=Je(e.images,l,s),{pageIndex:u,path:d}=j(),p=(0,H.Zp)(),g=a?Math.ceil(c/a):1,f=Math.max(0,g-1),b=Math.max(0,Math.min(u,f));b!==u&&p(`/gallery/${d}page/${b+1}`);const v=b*a,_=a;return{imageCount:c,selectedCount:r.length,filteredCount:m,page:b,images:(0,B.S)(e.images,{filtersActiveTags:l,recentImports:s,sortBy:F}).splice(v,_||1/0),covers:t,galleryView:n}})(),c=xe(),{enableImageGroups:m}=(0,i.A)();return n.createElement(n.Fragment,null,n.createElement(Xe,{imageCount:e,selectedCount:t,filteredCount:a}),m?n.createElement(Ze,null):null,n.createElement(We,{page:r,isSticky:!0}),n.createElement(et,{page:r}),n.createElement("ul",{className:o()("gallery",{[`gallery--${F}`]:!0}),style:F===Se.j.GALLERY_VIEW_SMALL?tt(c):void 0},l.map((e=>s.includes(e.hash)?n.createElement(je,{key:e.hash,hash:e.hash}):n.createElement(Ae,{key:e.hash,hash:e.hash,page:r})))),l.length<3?null:n.createElement(n.Fragment,null,n.createElement(et,{page:r}),n.createElement(We,{page:r,isBottom:!0})))},nt=a(1965),rt=a.n(nt);const lt=(0,n.createContext)({callRemoteFunction:async()=>{}}),st=()=>{const{printerData:e,printerFunctions:t,printerBusy:a}=(0,w.A)(),{callRemoteFunction:r}=(0,n.useContext)(lt);return{printerData:e,printerFunctions:t,printerBusy:a,printerConnected:t.length>0,callRemoteFunction:r}};var Ft;!function(e){e.TESTFILE="testFile",e.CHECKPRINTER="checkPrinter",e.FETCHIMAGES="fetchImages",e.CLEARPRINTER="clearPrinter",e.TEAR="tear"}(Ft||(Ft={}));const ot={testFile:"Print test image",checkPrinter:"Check Printer",fetchImages:"",clearPrinter:"Clear Printer",tear:"Tear"};var it=function(){const{printerData:e,printerFunctions:t,printerConnected:a,callRemoteFunction:r,printerBusy:l}=st();return a?n.createElement("div",{className:"printer-report"},n.createElement("div",{className:"inputgroup buttongroup"},t.map((a=>n.createElement("button",{key:a,type:"button",className:"button",disabled:l||[Ft.FETCHIMAGES,Ft.CLEARPRINTER,Ft.TEAR].includes(a)&&!e?.dumps?.length,onClick:()=>r(a)},a===Ft.FETCHIMAGES?((e,t)=>e.includes(Ft.TEAR)||!t?"Fetch images":`Fetch ${t||0} images`)(t,e?.dumps?.length||0):ot[a])))),e?.fs&&e?.dumps?n.createElement("table",{className:"printer-report__table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",{className:"printer-report__label printer-report__head"},"Printer Filesystem"),n.createElement("th",{className:"printer-report__value printer-report__head printer-report__value--url"}))),n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",{className:"printer-report__label"},"Total"),n.createElement("td",{className:"printer-report__value"},rt()(e?.fs.total))),n.createElement("tr",null,n.createElement("td",{className:"printer-report__label"},"Used"),n.createElement("td",{className:"printer-report__value"},rt()(e?.fs.used))),n.createElement("tr",null,n.createElement("td",{className:"printer-report__label"},"Free"),n.createElement("td",{className:"printer-report__value"},`${Math.max(0,(e?.fs.maximages||0)-(e?.dumps.length||0))} images`)),n.createElement("tr",null,n.createElement("td",{className:"printer-report__label"},"Images"),n.createElement("td",{className:"printer-report__value"},e?.dumps.length)))):null,e?.message?n.createElement("p",{className:"printer-report__message"},e?.message):null):null};var ct=e=>{const{printerUrl:t,printerParams:a}=(0,i.A)(),r=a?`#${encodeURI(a)}`:"",l=t?`${t}remote.html${r}`:void 0,{printerFunctions:s}=(0,w.A)(),F=s.length>0,[o,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),d=(0,n.useRef)();return(0,n.useEffect)((()=>(o||m||d.current||(d.current=window.setTimeout((()=>{u(!0)}),e)),()=>{window.clearTimeout(d.current)})),[m,o,e]),!o&&F&&(window.clearTimeout(d.current),c(!0)),{failed:m,loaded:o,printerUrl:l,printerConnected:F}};var mt=function(){const{printerUrl:e,failed:t,loaded:a,printerConnected:r}=ct(5e3);return n.createElement("div",{className:"connect-printer"},n.createElement(it,null),(e=>{if(!e)return!1;if(e.startsWith("/"))return!0;const{protocol:t}=new URL(e),{protocol:a}=new URL(window.location.href);return"http:"===a||a===t})(e)&&!t?n.createElement(n.Fragment,null,n.createElement("iframe",{className:o()("connect-printer__remote-printer-iframe",{"connect-printer__remote-printer-iframe--connected":r}),title:"Transfer window",src:e}),!a&&n.createElement("div",{className:"connect-printer__iframe-loading"})):(!r||t)&&n.createElement("div",{className:"inputgroup buttongroup"},n.createElement("button",{type:"button",className:"button",onClick:()=>{window.open(e,"remoteprinter","width=480,height=400")}},"Open printer page")))};const ut=e=>e.match(/^#[0-9a-f]{6}$/i);var dt;!function(e){e.TEXT="text",e.TEXTAREA="textarea",e.NUMBER="number",e.COLOR="color",e.FILE="file",e.PASSWORD="password"}(dt||(dt={}));var pt=function({id:e,labelText:t,buttonIcon:a,buttonLabel:r,buttonOnClick:l,type:s,min:F,max:i,step:c,value:m,disabled:u,onChange:d,onChangeFiles:p,onBlur:h,onKeyUp:E,children:f,autoComplete:b,autoCorrect:v,autoCapitalize:_,spellCheck:y}){const[N,w]=(0,n.useState)(!1),[k,C]=(0,n.useState)(m);(0,n.useEffect)((()=>{s===dt.COLOR&&C(m)}),[C,m,s]);const A=E?({key:e})=>E(e):void 0,S=h?()=>{s===dt.PASSWORD&&w(!1),h()}:void 0;return n.createElement("div",{className:`inputgroup inputgroup--${s}`},n.createElement("label",{htmlFor:e,className:"inputgroup__label"},t,f),s===dt.TEXTAREA?n.createElement("textarea",{id:e,className:"inputgroup__input inputgroup__input--textarea",value:m,disabled:u,onChange:({target:{value:e}})=>d&&d(e),autoComplete:b,autoCorrect:v,autoCapitalize:_,spellCheck:y,onBlur:S,onKeyUp:A}):n.createElement("input",{id:e,className:"inputgroup__input",type:N?dt.TEXT:s,min:s===dt.NUMBER?F:void 0,max:s===dt.NUMBER?i:void 0,step:s===dt.NUMBER?c:void 0,value:m,disabled:u,onChange:s===dt.FILE?({target:{files:e}})=>e&&p&&p([...e]):({target:{value:e}})=>d&&d(e),multiple:s===dt.FILE||void 0,autoComplete:b,autoCorrect:v,autoCapitalize:_,spellCheck:y,onBlur:S,onKeyUp:A}),s===dt.FILE?n.createElement("label",{htmlFor:e,className:"button button--label"},"Select"):null,l&&(a||r)?n.createElement("button",{type:"button",className:o()({button:r,[`inputgroup__button inputgroup__button--${a}`]:a}),onClick:l},a?n.createElement(g,{name:a}):r):null,s===dt.COLOR?n.createElement("input",{type:"text",autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",className:o()("inputgroup__input inputgroup__input--colortext",{"inputgroup__input--invalid-color":!k||!ut(k)}),value:k,disabled:u,onChange:({target:{value:e}})=>{C(e),d&&ut(e)&&d(e)},onBlur:S}):null,s===dt.PASSWORD?n.createElement("button",{type:"button",className:"inputgroup__button inputgroup__button--show-password",onClick:()=>w(!N)},n.createElement(g,{name:"view"})):null)},gt=a(8025);var ht=a(521);const Et=e=>{e.fillStyle="#000",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.filter="grayscale(1)",e.imageSmoothingEnabled=!1};var ft=(e,t=!1)=>new Promise(((a,n)=>{const r=document.createElement("img"),l=document.createElement("canvas");l.width=160;const s=l.getContext("2d");s?(r.onerror=n,r.onload=()=>{let n;const F=r.naturalWidth,o=r.naturalHeight;.875===o/F?(l.height=144,n=r.naturalWidth/128,t||Et(s),s.drawImage(r,0,0,F,o,16,16,l.width-32,l.height-32)):(l.height=l.width*o/F,n=F/160,t||Et(s),s.drawImage(r,0,0,F,o,0,0,l.width,l.height));const i=s.getImageData(0,0,l.width,l.height);a({imageData:i,scaleFactor:n,width:l.width,height:l.height,fileName:e.name,lastModified:e.lastModified||null})},(0,gt.A)(e,gt.Z.DATA_URL).then((e=>{r.src=e}))):n(new Error("No canvas context"))}));var bt=({baseValues:e,orderPatterns:t})=>{const a=[];for(let n=0;n<4;n+=1){const r=[];a.push(r);for(let a=0;a<4;a+=1){const l=[];r.push(l);for(let r=0;r<3;r+=1)l.push(e[r][t[r][4*n+a]])}}return a};const vt=[0,12,3,15,8,4,11,7,2,14,1,13,10,6,9,5],_t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var yt=(e,t)=>{const a=(t-e)/16;return new Array(16).fill(null).map(((t,n)=>Math.floor(e+a*n)))};var Nt=e=>{const t="number"==typeof e[0]?e[0]:0,a="number"==typeof e[1]?e[1]:85,n="number"==typeof e[2]?e[2]:170,r="number"==typeof e[3]?e[3]:255;return[yt(t,a),yt(a,n),yt(n,r)]},wt=a(6763);let kt=0;const Ct=({imageData:e,contrastBaseValues:t,dither:a,colors:n})=>{const r=new ImageData(e.width,e.height),l=bt({baseValues:Nt(t),orderPatterns:[a?vt:_t,a?vt:_t,a?vt:_t]}),s=e.width,F=e.data;for(let e=0;e<F.length;e+=4){const t=kt%s%4,a=Math.ceil(kt/s)%4,o=F[e];let i;const c=l[t][a];i=o<=c[0]?n[3]:o<=c[1]?n[2]:o<=c[2]?n[1]:n[0],r.data[e]=i.r,r.data[e+1]=i.g,r.data[e+2]=i.b,r.data[e+3]=255,kt+=1}return r},At=[0,256,1,257],St=e=>{const t=[];for(let a=0;a<8;a+=1){let n=0;for(let t=0;t<8;t+=1){n+=At[e[8*a+t]]<<7-t}t.push((n>>8).toString(16).padStart(2,"0"),(255&n).toString(16).padStart(2,"0"))}return t.join(" ").toUpperCase()},It=({bitmapQueue:e,dither:t,contrastBaseValues:a})=>{const{importQueueAdd:n}=L.getState();e.forEach((async({imageData:e,height:r,fileName:l,lastModified:s})=>{const{data:F}=Ct({imageData:e,contrastBaseValues:a,dither:t,colors:[{r:0,g:0,b:0},{r:1,g:0,b:0},{r:2,g:0,b:0},{r:3,g:0,b:0}]}),o=Array.from(F).filter(((e,t)=>!(t%4))),i=20*Math.ceil(r/8),c=(e=>t=>{const a=t%20,n=Math.floor(t/20),r=8*a,l=8*n;return new Array(8).fill(null).map(((t,a)=>e.slice(r+160*(l+a)).slice(0,8))).flat(1)})(o),m=new Array(i).fill(null).map(((e,t)=>c(t))).map(St),{dataHash:u}=await(0,ht.cg)(m);n([{fileName:l,imageHash:u,tiles:m,lastModified:s,tempId:W()}])}))};var Pt=a(1851);var xt,Tt=e=>{const t=e.split("\n").map((e=>e.trim())).filter((e=>e.length&&0!==e.indexOf("//")&&0!==e.indexOf("/*"))).map((e=>e.split(" "))).flat().map((e=>parseInt(e,16))).filter((e=>!isNaN(e)));return(0,Pt.gV)(t)};!function(e){e.NEW_LINES="NEW_LINES",e.IMAGE_COMPLETE="IMAGE_COMPLETE",e.PARSE_ERROR="PARSE_ERROR"}(xt||(xt={}));var Dt=e=>{if("#"===e.charAt(0)||"/"===e.charAt(0))return null;if("!"===e.charAt(0)||"{"===e.charAt(0)){try{const{command:t,margin_lower:a}=JSON.parse(e.slice(e.indexOf("{")).trim());if("PRNT"===t&&a>0)return{type:xt.IMAGE_COMPLETE}}catch(e){return{type:xt.PARSE_ERROR,payload:"Error while trying to parse JSON data command block"}}return null}const t=e.replace(/[^0-9A-F]/gi,"");return t.length?{type:xt.NEW_LINES,payload:[t]}:null},Bt=a(6763);var Rt=(e,t)=>{const a=`${e}\n${X.Ys}`.split("\n").map(Dt).reduce(((e,t)=>{switch(t?.type){case xt.NEW_LINES:return e[e.length-1].push(...t.payload),e;case xt.IMAGE_COMPLETE:return[...e,[]];default:return e}}),[[]]).filter((e=>e.length>0));return a.length||Bt.warn(`File ${t} did not contain images`),a};var Lt=a(5021),Mt=a.n(Lt),Gt=a(6344),Vt=a.n(Gt),$t=a(894);var Ot=(e,t,a)=>{if(!t)return"";const n=e=>a.find((({id:t})=>t===e)),r=(e+1).toString(10).padStart(2,"0"),l=n(`${t}${r}`);if(l?.hash)return l.hash;if("jp"===t){const e=n(`int${r}`);if(e?.hash)return e.hash}const s=n(`${t}01`);if(s?.hash)return s.hash;if("jp"!==t){const e=n(`int${r}`);if(e?.hash)return e.hash}return n("int01")?.hash||""};const Ut={86:"A",87:"B",88:"C",89:"D",90:"E",91:"F",92:"G",93:"H",94:"I",95:"J",96:"K",97:"L",98:"M",99:"N",100:"O",101:"P",102:"Q",103:"R",104:"S",105:"T",106:"U",107:"V",108:"W",109:"X",110:"Y",111:"Z",112:"_",113:"'",114:",",115:".",116:"Á",117:"Â",118:"À",119:"Ä",120:"É",121:"Ê",122:"È",123:"Ë",124:"Í",125:"Ï",126:"Ó",127:"Ö",128:"Ú",129:"Ü",130:"Ñ",131:"-",132:"&",133:"!",134:"?",135:" ",136:"a",137:"b",138:"c",139:"d",140:"e",141:"f",142:"g",143:"h",144:"i",145:"j",146:"k",147:"l",148:"m",149:"n",150:"o",151:"p",152:"q",153:"r",154:"s",155:"t",156:"u",157:"v",158:"w",159:"x",160:"y",161:"z",162:"•",163:"~",164:"📱",165:" ",166:"á",167:"â",168:"à",169:"ä",170:"é",171:"ê",172:"è",173:"ë",174:"í",175:"ï",176:"ó",177:"ö",178:"ú",179:"ü",180:"ñ",181:"ḉ",182:"ß",183:"😄",184:"😟",185:"😅",186:"0",187:"1",188:"2",189:"3",190:"4",191:"5",192:"6",193:"7",194:"8",195:"9",196:"/",197:":",198:"~",199:'"',200:"@"},zt={1:"あ",2:"い",3:"う",4:"え",5:"お",6:"か",7:"き",8:"く",9:"け",10:"こ",11:"さ",12:"し",13:"す",14:"せ",15:"そ",16:"た",17:"ち",18:"つ",19:"て",20:"と",21:"な",22:"に",23:"ぬ",24:"ね",25:"の",26:"は",27:"ひ",28:"ふ",29:"へ",30:"ほ",31:"ま",32:"み",33:"む",34:"め",35:"も",36:"や",37:"ゆ",38:"よ",39:"、",40:"。",41:"ら",42:"り",43:"る",44:"れ",45:"ろ",46:"わ",47:"を",48:"ん",49:"〜",50:"♥",51:"が",52:"ぎ",53:"ぐ",54:"げ",55:"ご",56:"ざ",57:"じ",58:"ず",59:"ぜ",60:"ぞ",61:"だ",62:"ぢ",63:"づ",64:"で",65:"ど",66:"ば",67:"び",68:"ぶ",69:"べ",70:"ぼ",71:"ぱ",72:"ぴ",73:"ぷ",74:"ぺ",75:"ぽ",76:"っ",77:"ゃ",78:"ゅ",79:"ょ",80:"・",81:"ぁ",82:"ぃ",83:"ぅ",84:"ぇ",85:"ぉ",86:"ア",87:"イ",88:"ウ",89:"エ",90:"オ",91:"カ",92:"キ",93:"ク",94:"ケ",95:"コ",96:"サ",97:"シ",98:"ス",99:"セ",100:"ソ",101:"タ",102:"チ",103:"ツ",104:"テ",105:"ト",106:"ナ",107:"ニ",108:"ヌ",109:"ネ",110:"ノ",111:"ハ",112:"ヒ",113:"フ",114:"ヘ",115:"ホ",116:"マ",117:"ミ",118:"ム",119:"メ",120:"モ",121:"ヤ",122:"ユ",123:"ヨ",124:"!",125:"?",126:"ラ",127:"リ",128:"ル",129:"レ",130:"ロ",131:"ワ",132:"ヲ",133:"ン",134:"ヴ",135:" ",136:"ガ",137:"ギ",138:"グ",139:"ゲ",140:"ゴ",141:"ザ",142:"ジ",143:"ズ",144:"ゼ",145:"ゾ",146:"ダ",147:"ヂ",148:"ヅ",149:"デ",150:"ド",151:"バ",152:"ビ",153:"ブ",154:"ベ",155:"ボ",156:"パ",157:"ピ",158:"プ",159:"ペ",160:"ポ",161:"ッ",162:"ャ",163:"ュ",164:"ョ",165:"ー",166:"ァ",167:"ィ",168:"ゥ",169:"ェ",170:"ォ",171:"A",172:"B",173:"C",174:"D",175:"E",176:"F",177:"G",178:"H",179:"I",180:"J",181:"K",182:"L",183:"M",184:"N",185:"O",186:"P",187:"Q",188:"R",189:"S",190:"T",191:"U",192:"V",193:"W",194:"X",195:"Y",196:"Z",197:"_",198:"'",199:",",200:".",201:"a",202:"b",203:"c",204:"d",205:"e",206:"f",207:"g",208:"h",209:"i",210:"j",211:"k",212:"l",213:"m",214:"n",215:"o",216:"p",217:"q",218:"r",219:"s",220:"t",221:"u",222:"v",223:"w",224:"x",225:"y",226:"z",227:"📱",228:"😅",229:"😄",230:"_",231:"0",232:"1",233:"2",234:"3",235:"4",236:"5",237:"6",238:"7",239:"8",240:"9",241:"/",242:":",243:"~",244:'"',245:"@"},Ht="00123456789?????";var Wt;!function(e){e.PHOTO="photo",e.STOCK="stock",e.PXLR="pxlr"}(Wt||(Wt={}));const Xt=2,jt=0,Yt=0,Zt=1,Qt=2,Kt=3,qt=4,Jt=16,ea=5,ta=17,aa=6,na=18,ra=7,la=19,sa=8,Fa=20,oa=21,ia=9,ca=22,ma=23,ua=10,da=24,pa=11,ga=25,ha=12,Ea=26,fa=13,ba=27,va=28,_a=14,ya=29,Na=15,wa=30,ka=31,Ca=0,Aa=32,Sa=64,Ia=96,Pa=128,xa=0,Ta=0,Da=16,Ba=32,Ra=48,La=64,Ma=80,Ga=96,Va=112,$a=8,Oa=0,Ua=0,za=1,Ha=2,Wa=3,Xa=4,ja=5,Ya=6,Za=7,Qa=0,Ka=128,qa=64,Ja=31,en=30,tn=29,an=28,nn=27,rn=26,ln=25,sn=24,Fn=23,on=22,cn=21,mn=20,un=19,dn=18,pn=17,gn=16,hn=15,En=14,fn=13,bn=12,vn=11,_n=10,yn=9,Nn=8,wn=7,kn=6,Cn=5,An=4,Sn=3,In=2,Pn=1,xn=0,Tn=32,Dn=33,Bn=34,Rn=35,Ln=36,Mn=37,Gn=38,Vn=39,$n=40,On=41,Un=42,zn=43,Hn=44,Wn=45,Xn=46,jn=47,Yn=48,Zn=49,Qn=50,Kn=51,qn=52,Jn=53,er=54,tr=55,ar=56,nr=57,rr=58,lr=59,sr=60,Fr=61,or=62,ir=63,cr=0,mr=1,ur=0,dr=16,pr={thumbnailByteCapture:0,thumbnailByteEdgegains:16,thumbnailByteExposureHigh:32,thumbnailByteExposureLow:48,thumbnailByteEdmovolt:198,thumbnailByteVoutzero:214,thumbnailByteDitherset:230,thumbnailByteContrast:246},gr={thumbnailByteCapture:200,thumbnailByteEdgegains:201,thumbnailByteExposureHigh:203,thumbnailByteExposureLow:202,thumbnailByteEdmovolt:204,thumbnailByteVoutzero:205,thumbnailByteDitherset:200,thumbnailByteContrast:200},hr=(e,t)=>{const a=.016*e+4.096*t;return a<10?`${a.toFixed(1)}ms`:`${Math.floor(a)}ms`},Er=e=>{switch(e){case Xt:return"positive";case jt:return"negative";default:return"unknown"}},fr=e=>{switch(e){case Pa:return"on";case xa:return"off";default:return"unknown"}},br=e=>{switch(e){case Ca:return"none";case Aa:return"horizontal";case Sa:return"vertical";case Ia:return"2d";default:return"unknown"}},vr=e=>{switch(e){case Yt:return"14.0";case Zt:return"15.5";case Qt:return"17.0";case Kt:return"18.5";case qt:return"20.0";case Jt:return"20.0 (d)";case ea:return"21.5";case ta:return"21.5 (d)";case aa:return"23.0";case na:return"23.0 (d)";case ra:return"24.5";case la:return"24.5 (d)";case sa:return"26.0";case Fa:return"26.0 (d)";case oa:return"27.5";case ia:return"29.0";case ca:return"29.0 (d)";case ma:return"30.5";case ua:return"32.0";case da:return"32.0 (d)";case pa:return"35.0";case ga:return"35.0 (d)";case ha:return"38.0";case Ea:return"38.0 (d)";case fa:return"41.0";case ba:return"41.0 (d)";case va:return"44.0";case _a:return"45.5";case ya:return"47.0";case Na:return"51.5";case wa:return"51.5 (d)";case ka:return"57.5";default:return"unknown"}},_r=e=>{switch(e){case Ta:return"50%";case Da:return"75%";case Ba:return"100%";case Ra:return"125%";case La:return"200%";case Ma:return"300%";case Ga:return"400%";case Va:return"500%";default:return"unknown"}},yr=e=>{switch(e){case $a:return"on";case Oa:return"off";default:return"unknown"}},Nr=e=>{switch(e){case Ua:return"0.0V";case za:return"0.5V";case Ha:return"1.0V";case Wa:return"1.5V";case Xa:return"2.0V";case ja:return"2.5V";case Ya:return"3.0V";case Za:return"3.5V";default:return"unknown"}},wr=e=>{switch(e){case Qa:return"none";case Ka:return"positive";case qa:return"negative";default:return"unknown"}},kr=e=>{switch(e){case Ja:return"-0.992mV";case en:return"-0.960mV";case tn:return"-0.928mV";case an:return"-0.896mV";case nn:return"-0.864mV";case rn:return"-0.832mV";case ln:return"-0.800mV";case sn:return"-0.768mV";case Fn:return"-0.736mV";case on:return"-0.704mV";case cn:return"-0.672mV";case mn:return"-0.640mV";case un:return"-0.608mV";case dn:return"-0.576mV";case pn:return"-0.544mV";case gn:return"-0.512mV";case hn:return"-0.480mV";case En:return"-0.448mV";case fn:return"-0.416mV";case bn:return"-0.384mV";case vn:return"-0.352mV";case _n:return"-0.320mV";case yn:return"-0.288mV";case Nn:return"-0.256mV";case wn:return"-0.224mV";case kn:return"-0.192mV";case Cn:return"-0.160mV";case An:return"-0.128mV";case Sn:return"-0.096mV";case In:return"-0.064mV";case Pn:return"-0.032mV";case xn:return"-0.000mV";case Tn:return" 0.000mV";case Dn:return"0.032mV";case Bn:return"0.064mV";case Rn:return"0.096mV";case Ln:return"0.128mV";case Mn:return"0.160mV";case Gn:return"0.192mV";case Vn:return"0.224mV";case $n:return"0.256mV";case On:return"0.288mV";case Un:return"0.320mV";case zn:return"0.352mV";case Hn:return"0.384mV";case Wn:return"0.416mV";case Xn:return"0.448mV";case jn:return"0.480mV";case Yn:return"0.512mV";case Zn:return"0.544mV";case Qn:return"0.576mV";case Kn:return"0.608mV";case qn:return"0.640mV";case Jn:return"0.672mV";case er:return"0.704mV";case tr:return"0.736mV";case ar:return"0.768mV";case nr:return"0.800mV";case rr:return"0.832mV";case lr:return"0.864mV";case sr:return"0.896mV";case Fr:return"0.928mV";case or:return"0.960mV";case ir:return"0.992mV";default:return"unknown"}},Cr=e=>{let t,a;switch(1&e){case cr:t="High";break;case mr:t="Low";break;default:t="unknown"}switch(2&e){case ur:a="On";break;case dr:a="Off";break;default:a="unknown"}return`${t}/${a}`},Ar=(e,t)=>{let a;switch(t){case Wt.PHOTO:a=gr;break;case Wt.PXLR:a=pr;break;default:return null}const n=e[a.thumbnailByteExposureHigh],r=e[a.thumbnailByteExposureLow],l=2&e[a.thumbnailByteCapture],s=128&e[a.thumbnailByteEdgegains],F=96&e[a.thumbnailByteEdgegains],o=31&e[a.thumbnailByteEdgegains],i=112&e[a.thumbnailByteEdmovolt],c=8&e[a.thumbnailByteEdmovolt],m=7&e[a.thumbnailByteEdmovolt],u=192&e[a.thumbnailByteVoutzero],d=63&e[a.thumbnailByteVoutzero],p=e[a.thumbnailByteDitherset],g=e[a.thumbnailByteContrast];return t===Wt.PHOTO?{romType:t,exposure:hr(n,r),captureMode:Er(l),edgeExclusive:fr(s),edgeOperation:br(F),gain:vr(o),edgeMode:_r(i),invertOut:yr(c),voltageRef:Nr(m),zeroPoint:wr(u),vOut:kr(d)}:{romType:t,exposure:hr(n,r),captureMode:Er(l),edgeExclusive:fr(s),edgeOperation:br(F),gain:vr(o),edgeMode:_r(i),invertOut:yr(c),voltageRef:Nr(m),zeroPoint:wr(u),vOut:kr(d),ditherset:Cr(p),contrast:g+1}},Sr=(e,t)=>{const a=t?zt:Ut;return[...e].map((e=>a[e]||" ")).join("").trim()},Ir=e=>{switch(28&e){case 4:return"A";case 8:return"B";case 12:return"0";case 16:return"AB";default:return"-"}},Pr=e=>{if(!e)return"--";return`${Ht[e>>4]}${Ht[15&e]}`},xr=(e,t)=>{const[a,n,r,l]=[...e].map(Pr),s=((e,t)=>"--"===e&&"--"!==t?`00${t}`:"--"!==e&&"--"===t?`${e}00`:`${e}${t}`)(a,n);return t?`${s}年${r}月${l}日`:`${r}/${l}/${s}`},Tr=(e,t)=>`${t?"PC-":"GC-"}${[...e].map(Pr).map((e=>"--"===e?"00":e)).join("")}`,Dr=(e,t,a)=>{const n=e.subarray(t+3840,t+3843+1),r=e.subarray(t+3844,t+3852+1),l=e[t+3853],s=e.subarray(t+3854,t+3857+1),F=e.subarray(t+3861,t+3887+1),o=Boolean(e[t+3891]);return{userId:Tr(n,a),birthDate:xr(s,a),userName:Sr(r,a),gender:(i=l,1&i?"m":2&i?"f":"-"),bloodType:Ir(l),comment:Sr(F,a),isCopy:o};var i};var Br=(e,t,a)=>{const n=t/4096-2,r=n>=0?e[4530+n]:64,l=e[t+3924],s=e.slice(t+3584,t+3839+1);let F;if(r<64){const n=(e=>{const t=[200,201,202,203,204,205,206,207,216,217,218,219,220,221,222,223,232,233,234,235,236,237,238,239,248,249,250,251,252,253,254,255];return t.map((t=>e[t])).filter((e=>0===e)).length===t.length?Wt.STOCK:t.map((t=>e[t])).filter((e=>255===e)).length===t.length?Wt.PXLR:Wt.PHOTO})(s);F={romType:n},"stock"!==n&&(F={...F,...Ar(s,n)}),"stock"===n&&(F={...F,...Dr(e,t,a)})}return{cartIndex:n,albumIndex:r,baseAddress:t,frameNumber:l,meta:F}},Rr=a(446);const Lr="FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF";var Mr=(e,t)=>{const a=[];let n="",r=!1;a.push(...[...Array(40)].map((()=>Lr)));for(let l=0;l<3584;l+=1)l%256==0&&a.push(...[...Array(2)].map((()=>Lr))),n+=` ${e[t+l].toString(16).padStart(2,"0")}`,l%16==15&&(a.push(n.trim()),r||"00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"===n.trim()||(r=!0),n=""),l%256==255&&a.push(...[...Array(2)].map((()=>Lr)));return a.push(...[...Array(40)].map((()=>Lr))),r?a:null},Gr=a(7482);const Vr=(0,Rr.A)("albumIndex");var $r=({importLastSeen:e,data:t,lastModified:a,frames:n,fileName:r,importDeleted:l,forceMagicCheck:s})=>{const{importQueueAdd:F}=L.getState();if(s){if([4306,4523,4560,4597].some((e=>"Magic"!==[...t.subarray(e,e+5)].map((e=>String.fromCharCode(e))).join(""))))return null}return async(s,o)=>{const i=new Array(30).fill(null).map(((e,t)=>4096*(t+2))).filter((e=>e<t.length));e&&i.unshift(0);const c=await Promise.all(i.map((async e=>{const a=Br(t,e,o),{frameNumber:r}=a,l=Mr(t,e);if(l){return{tiles:await(0,$t.A)(l,Ot(r,s,n)),...a}}return null}))),m=Vr(c.filter(Boolean)),u=new(Vt())(1,1/0);let d=0;const p=await Promise.all(m.map((async({albumIndex:e,tiles:t,meta:n})=>u.add((async()=>{let s;switch(e){case 64:s="[last seen]";break;case 255:if(!l)return;s="[deleted]";break;default:d+=1,s=d.toString(10).padStart(2,"0")}const{dataHash:F}=await(0,ht.cg)(t);return{fileName:"function"==typeof r?r({indexText:s,albumIndex:e,displayIndex:d}):`${r} ${s}`,imageHash:F,tiles:t,lastModified:a,meta:n,tempId:W()}})))));return F(p.reduce(Gr.N,[])),!0}};const Or=e=>e.toString(10).padStart(2,"0");var Ur=a(1562);var zr=e=>{let t,a;if(e.blob){const n=e;if(t=new File([n.blob],n.blobName||"blob"),a=n.contentType||"application/unknown",void 0!==n.ok&&!n.ok)throw new Error("Invalid file received from printer")}else t=e,a=t.type;if(!t.size)throw new Error("empty file");return{file:t,contentType:a}};var Hr=e=>{const t=(e=>async t=>{const a=await(0,gt.A)(t,gt.Z.TEXT);let n;try{n=JSON.parse(a)}catch(e){throw new Error("Not a valid .json file")}if(!n?.state)throw new Error("Not a settings .json file");return e(n),!0})(e);return async(e,{fromPrinter:n}={fromPrinter:!1})=>{await Promise.all(e.map((e=>{const{file:r,contentType:l}=zr(e);if(l&&l.startsWith("image/"))return(async(e,t=!1)=>{const a=await ft(e);return t?It({bitmapQueue:[a],dither:!1,contrastBaseValues:[0,85,170,255]}):L.getState().bitmapQueueAdd([a]),!0})(r,n);if(r.size>268435455)throw new Error("File too large");if("text/plain"===l)return(async e=>{const{importQueueAdd:t}=L.getState(),a=await(0,gt.A)(e,gt.Z.TEXT);let n;return n=-1!==a.indexOf('{"command"')?await Rt(a,e.name):await Tt(a),await Promise.all(n.map((async(a,r)=>{const{dataHash:l}=await(0,ht.cg)(a),s=n.length<2?"":` ${(r+1).toString(10).padStart(2,"0")}`;return t([{fileName:`${e.name}${s}`,imageHash:l,tiles:a,lastModified:e.lastModified?e.lastModified+r:void 0,tempId:W()}]),!0}))),!0})(r);if("application/json"===l)return t(r);if(r.name?.toLowerCase().endsWith(".sav")&&(r.size%4096==0||3584===r.size))return(async(e,t)=>{const{dismissDialog:a,setDialog:n}=_.A.getState(),{frames:r,frameGroups:l}=E.h.getState(),{savFrameTypes:s,setSavFrameTypes:F}=i.A.getState(),o=await(0,gt.A)(e,gt.Z.UINT8_ARRAY),{importLastSeen:c,importDeleted:m,forceMagicCheck:u}=i.A.getState(),d=(0,Ur.A)(r,l).map((({id:e,name:t})=>({value:e,name:t,selected:s===e})));d.unshift({value:"",name:"None (Black frame)"});const p=$r({importLastSeen:!!t||c,data:o,lastModified:e.lastModified,frames:r,fileName:e.name,importDeleted:!!t||m,forceMagicCheck:!t&&u});if(!p)throw new Error(".sav file seems to be invalid");return t?(await p("",!1),!0):new Promise((t=>{n({message:`Importing '${e.name}'`,questions:()=>[{type:O.V.CHECKBOX,label:"Import is from a Japanese Cart (PocketCamera)",key:"cartIsJP"},d.length>1?{type:O.V.SELECT,label:"Select frame group to use with this import",key:"chosenFrameset",options:d}:void 0].reduce(Gr.N,[]),confirm:async e=>{const{chosenFrameset:n,cartIsJP:r}=e;a(0),F(n),await p(n||"",Boolean(r)),t(!0)},deny:async()=>{a(0),t(!0)}})}))})(r,3584===r.size);if((r.name?.toLowerCase().endsWith(".gb")||r.name?.toLowerCase().endsWith(".gbc"))&&r.size%1048576==0)return(async e=>{const{default:t}=await Promise.resolve().then(a.t.bind(a,4802,23)),n=await(0,gt.A)(e,gt.Z.UINT8_ARRAY),{importLastSeen:r,importDeleted:l,forceMagicCheck:s}=i.A.getState(),F=Mt()(n,131072).reduce(((e,a,n)=>{const r=t(a);return-1!==e.findIndex((({hash:e})=>e===r))?e:[...e,{bankData:a,bankIndex:n,hash:r}]}),[]),o=await F.reduce((async(t,{bankData:a,bankIndex:n})=>{const F=await t;if(0===n)return[...F,!1];const o=$r({importLastSeen:r,data:a,lastModified:e.lastModified,frames:[],fileName:({albumIndex:t})=>64===t?`${e.name} - bank ${Or(n)} [last seen]`:255===t?`${e.name} - bank ${Or(n)} [deleted]`:`${e.name} - bank ${Or(n)} - image ${Or(t+1)}`,importDeleted:l,forceMagicCheck:s});return o?[...F,await o("",!1)]:[...F,!1]}),Promise.resolve([]));if(!o.filter(Boolean).length)throw new Error("File does not contain any recognizable images");return o})(r);if("application/pico-printer-binary-log"===l)return(async e=>{const{importQueueAdd:t}=L.getState(),a=await(0,gt.A)(e,gt.Z.UINT8_ARRAY),n=await(0,Pt.Eh)(a);return await Promise.all(n.map((async(a,r)=>{const{dataHash:l}=await(0,ht.cg)(a),s=n.length<2?"":` (${r+1})`;return t([{fileName:`${e.name}${s}`,imageHash:l,tiles:a,lastModified:e.lastModified?e.lastModified+r:void 0,tempId:W()}]),!0}))),!0})(r);if(l.startsWith("application/"))return(async e=>{const{importQueueAdd:t}=L.getState(),a=await(0,gt.A)(e,gt.Z.UINT8_ARRAY);if(71!==(n=a)[0]||66!==n[1]||45!==n[2]||66!==n[3]||73!==n[4]||78!==n[5]||48!==n[6]||49!==n[7])throw new Error('Not a valid .bin file - is it missing the "GB-BIN01" header?');var n;const r=[];let l=[];for(let e=8;e<a.length;e+=1){const t=a[e];l.push(t.toString(16).padStart(2,"0").toUpperCase()),16===l.length&&(r.push(l.join(" ")),l=[])}if(l.length){for(;l.length<16;)l.push("FF");r.push(l.join(" "))}const{dataHash:s}=await(0,ht.cg)(r);return t([{fileName:e.name,imageHash:s,tiles:r,lastModified:e.lastModified,tempId:W()}]),!0})(r);throw new Error("Not a dump")})))}};var Wr=()=>{const{setError:e}=w.A.getState(),{jsonImport:t}=he(),a=(0,n.useMemo)((()=>Hr(t)),[t]);return{handleFileImport:async(t,n)=>{try{await a(t,n)}catch(t){e(t)}}}};var Xr=a(3876);var jr=function(){const[e,t]=(0,n.useState)(""),{importPlainText:r,importFiles:l,printerUrl:s,exportJson:F}=(()=>{const{printerUrl:e}=(0,i.A)(),{printerFunctions:t}=(0,w.A)(),{downloadSettings:a}=he(),n=e?`${e}remote.html`:void 0,r=t.length>0,{handleFileImport:l}=Wr();return{printerUrl:n,printerConnected:r,importPlainText:e=>{const t=new File([...e],"Text input.txt",{type:"text/plain"});l([t])},importFiles:l,exportJson:e=>a(e)}})();return(0,n.useEffect)((()=>{a.e(963).then(a.bind(a,4553)).then((({default:e})=>{t(e.join("\n"))}))}),[]),n.createElement("div",{className:"import"},s&&n.createElement(mt,null),n.createElement(pt,{id:"import-file",labelText:"Select file for import",type:dt.FILE,onChangeFiles:e=>{e&&e.length&&l(e)}}),n.createElement("div",{className:"inputgroup inputgroup--column"},n.createElement("label",{htmlFor:"import-plaintext",className:"inputgroup__label"},"Paste your plaintext"),n.createElement("textarea",{id:"import-plaintext",className:"import__data",value:e,onChange:({target:e})=>{t(e.value)}}),n.createElement("button",{className:"button button--label",type:"button",onClick:()=>{r(e)}},"Import")),n.createElement("div",{className:"inputgroup buttongroup"},n.createElement("button",{type:"button",className:"button",onClick:()=>F(Xr.m.IMAGES)},"Export images"),n.createElement("button",{type:"button",className:"button",onClick:()=>F(Xr.m.SELECTED_IMAGES)},"Export selected images"),n.createElement("button",{type:"button",className:"button",onClick:()=>F(Xr.m.PALETTES)},"Export palettes")))};const Yr=e=>["#",Math.ceil(Math.random()*e).toString(16).padStart(2,"0"),Math.ceil(Math.random()*e).toString(16).padStart(2,"0"),Math.ceil(Math.random()*e).toString(16).padStart(2,"0")].join(""),Zr=()=>({name:"",shortName:ve.m,palette:[Yr(255),Yr(170),Yr(102),Yr(34)],origin:"",isPredefined:!1});var Qr=()=>{const{palettes:e}=(0,E.h)(),{setEditPalette:t}=N(),a=(0,n.useCallback)(((a,n)=>{const r=a===ve.m?Zr():e.find((e=>a===e.shortName))||Zr();t({...r,name:n?`Copy of ${r.name}`:r.name,shortName:n?ve.m:a})}),[e,t]);return{editPalette:e=>a(e,!1),clonePalette:e=>a(e,!0)}};const Kr="36";var qr=function({shortName:e,name:t,isPredefined:a,palette:r,usage:l}){const{isActive:s,setActive:F,deletePalette:c,editPalette:m,clonePalette:u}=((e,t)=>{const{activePalette:a,setActivePalette:n}=(0,i.A)(),{dismissDialog:r,setDialog:l}=(0,_.A)(),{updateLastSyncLocalNow:s}=G(),{deletePalette:F}=(0,E.h)(),{editPalette:o,clonePalette:c}=Qr(),m=a===e;return{isActive:m,setActive:()=>n(e),deletePalette:()=>{l({message:`Delete palette "${t||"no name"}"?`,confirm:async()=>{m&&n("dsh"),s(),F(e),r(0)},deny:async()=>r(0)})},editPalette:()=>o(e),clonePalette:()=>c(e)}})(e,t);return 4!==r?.length?n.createElement("li",{className:"palette palette--broken"}):n.createElement("li",{className:o()("palette",{"palette--active":s}),style:{"--gradient-1":`${r[0]}${Kr}`,"--gradient-2":`${r[1]}${Kr}`,"--gradient-3":`${r[2]}${Kr}`,"--gradient-4":`${r[3]}${Kr}`}},n.createElement("button",{onClick:()=>{F()},className:"palette__button",type:"button"},n.createElement("div",{className:"palette__name"},t,n.createElement("span",{className:"palette__shortname"},e),n.createElement("span",{className:"palette__usage"},l?`Used ${l} times`:"Not used")),n.createElement("div",{className:"palette__colors"},n.createElement("div",{className:"palette__color",style:{backgroundColor:r[0]},title:r[0]}," "),n.createElement("div",{className:"palette__color",style:{backgroundColor:r[1]},title:r[1]}," "),n.createElement("div",{className:"palette__color",style:{backgroundColor:r[2]},title:r[2]}," "),n.createElement("div",{className:"palette__color",style:{backgroundColor:r[3]},title:r[3]}," "))),n.createElement("div",{className:"palette__manage-buttons"},n.createElement("button",{type:"button",title:"Clone palette",className:"palette__manage-button palette__manage-button--clone",onClick:()=>u()},n.createElement(g,{name:"clone"})),a?null:n.createElement(n.Fragment,null,n.createElement("button",{type:"button",title:"Edit palette",className:"palette__manage-button palette__manage-button--edit",onClick:()=>m()},n.createElement(g,{name:"edit"})),n.createElement("button",{type:"button",title:"Delete palette",className:"palette__manage-button palette__manage-button--delete",onClick:()=>c()},n.createElement(g,{name:"delete"})))))},Jr=a(1785),el=a(3371),tl=a.n(el);const al=(e,t)=>{const a=.299*e[0]+.587*e[1]+.114*e[2],n=.299*t[0]+.587*t[1]+.114*t[2];return a>n?-1:a<n?1:0};var nl=()=>{const[e,t]=(0,n.useState)(!1),{setError:a}=(0,w.A)(),{setPickColors:r}=N();return{onInputChange:async({target:e})=>{if(e.files?.[0]){t(!0);const{imageData:n,fileName:l}=await ft(e.files[0],!0),s=Mt()(n.data,4).map((([e,t,a])=>[e,t,a]));Jr.clusterize(s,{k:6},((e,n)=>{if(e)a(e);else{const e=tl()(s,4),t=[...e?e.palette():[],...n?n.map((({centroid:[e,t,a]})=>[Math.round(e),Math.round(t),Math.round(a)])):[]].filter(((e,t,a)=>a.findIndex((t=>t.join(",")===e.join(",")))===t)).sort(al);r({colors:t,fileName:l})}t(!1)}))}e.value=""},busy:e}},rl=a(7402);var ll=()=>{const{sortPalettes:e,setSortPalettes:t}=(0,i.A)(),{images:a}=(0,E.h)(),r=[{label:"Default (ascending)",value:rl.V.DEFAULT_ASC},{label:"Default (descending)",value:rl.V.DEFAULT_DESC},{label:"Usage (ascending)",value:rl.V.USAGE_ASC},{label:"Usage (descending)",value:rl.V.USAGE_DESC},{label:"Name (ascending)",value:rl.V.NAME_ASC},{label:"Name (descending)",value:rl.V.NAME_DESC}],l=(0,n.useMemo)((()=>a.reduce(((e,t)=>(0,Ne.pl)(t)?e:{...e,[t.palette]:(e[t.palette]||0)+1}),{})),[a]),s=(0,n.useCallback)(((t,a)=>{const[n,r]=e.split("_"),s="asc"===r?1:-1;switch(n){case"usage":{const e=l[t.shortName]||0,n=l[a.shortName]||0;return e<n?-1*s:e>n?s:0}case"name":return t.name.localeCompare(a.name)*s;default:return s}}),[l,e]);return{sortPalettes:e,setSortPalettes:t,paletteSortOptions:r,paletteUsages:l,sortFn:s}};const sl=[{id:"own",headline:"Own palettes",filter:({isPredefined:e})=>!e},{id:"predefined",headline:"Predefined palettes",filter:({isPredefined:e})=>e},{id:"all",headline:"All palettes",filter:Boolean}];var Fl=function(){const{palettes:e}=(0,E.h)(),{onInputChange:t,busy:a}=nl(),{editPalette:r}=Qr(),[l,s]=(0,n.useState)(0),{filter:F,headline:i,id:c}=sl[l||0],{sortFn:m,sortPalettes:u,setSortPalettes:d,paletteSortOptions:p,paletteUsages:h}=ll(),f=[...e].sort(m);return n.createElement(n.Fragment,null,n.createElement("ul",{className:"contenttabs__tabs"},sl.map(((e,t)=>n.createElement("li",{className:"contenttabs__tab",key:e.id},n.createElement("button",{type:"button",className:o()("button contenttabs__tabs-button",{"button contenttabs__tabs-button--active":t===l}),onClick:()=>s(t)},e.headline))))),n.createElement("h2",{className:"palettes__headline"},i,"own"===c?n.createElement(n.Fragment,null,n.createElement("button",{type:"button",disabled:a,title:"New palette",className:"button palettes__add-button",onClick:()=>r(ve.m)},n.createElement(g,{name:"add"})),n.createElement("label",{title:"New palette from file",className:o()("button palettes__add-button",{"button--disabled":a})},n.createElement(g,{name:"file-add"}),n.createElement("input",{disabled:a,type:"file",hidden:!0,onChange:t}))):null),n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"settings-sort-palettes",className:"inputgroup__label"},"Sort Palettes"),n.createElement("select",{id:"settings-sort-palettes",className:"inputgroup__input inputgroup__input--select",value:u,onChange:e=>{d(e.target.value)}},p.map((({label:e,value:t})=>n.createElement("option",{value:t,key:t},e))))),n.createElement("ul",{className:"palettes"},f.filter(F).map((e=>n.createElement(qr,{key:e.shortName,name:e.name,isPredefined:e.isPredefined||!1,shortName:e.shortName,palette:e.palette,usage:h[e.shortName]||0})))))},ol=a(8714);var il=()=>{const{enableDebug:e,savFrameTypes:t,activePalette:a}=(0,i.A)(),{frames:r,palettes:l,frameGroups:s,addFrames:F,updateFrameGroups:o}=(0,E.h)(),{updateLastSyncLocalNow:c}=G(),{downloadSettings:m}=he(),u=l.find((({shortName:e})=>e===a))||l[0],d=(0,Ur.A)(r,s),[p,g]=(0,n.useState)([]),[h,f]=(0,n.useState)(((e,t)=>{const a=e.find((({id:e})=>e===t));return a?a.id:e[0]?.id||""})(d,t));(0,n.useEffect)((()=>{g(h?r.reduce(((e,t)=>{const a=/^(?<group>[a-z]+)(?<id>[0-9]+)/g.exec(t.id)?.groups?.group;return h===a?[...e,t]:e}),[]):[])}),[r,h]);const b=d.find((({id:e})=>e===h))||d[0];return{selectedFrameGroup:h,groupFrames:p,setSelectedFrameGroup:f,frameGroups:d,exportJson:e=>m(e,h),palette:u?.palette,setActiveFrameGroupName:e=>{o([{...b,name:e}]),c()},activeFrameGroup:b,convertFormat:async()=>{const e=await Promise.all(r.map((async e=>{const t=await(0,P.mZ)(e.hash);if(!t)return e;const a=t.upper.length/20,n=(0,ol.L2)(t),{dataHash:r}=await(0,P.Bf)(n,a);if(e.hash===r)return e;const l=await(0,P.R_)(n,a);return{...e,hash:l}})));F(e)},enableDebug:e}};var cl=function({deleteFrame:e,editFrame:t}){return n.createElement("div",{className:"frame-buttons",onClick:e=>{e.stopPropagation()},role:"presentation"},n.createElement("button",{type:"button",className:"frame-buttons__button",onClick:e},n.createElement(g,{name:"delete"})),n.createElement("button",{type:"button",className:"frame-buttons__button",onClick:t},n.createElement(g,{name:"edit"})))},ml=a(6362);var ul=({frameId:e,name:t})=>{const[a,r]=(0,n.useState)([]),[l,s]=(0,n.useState)(2),{setEditFrame:F}=N(),{enableDebug:o}=(0,i.A)(),{dismissDialog:c,setDialog:m}=(0,_.A)(),{frames:u,deleteFrame:d,images:p}=(0,E.h)(),{updateLastSyncLocalNow:g}=G(),h=u.find((({id:t})=>t===e))?.hash||"",f=p.filter((({frame:t})=>t===e)).length;return(0,n.useEffect)((()=>{s(2),r([]);(async()=>{if(!h)return;const a=await(0,P.mZ)(h),n=await(({frameId:e,frameHash:t,name:a})=>{const n=`\n  frameId: ${e}\n\n  ${a}\n\n${t}`;return(0,$t.A)((0,ml.A)(n),t)})({frameId:e,frameHash:h,name:t});s(a?a.upper.length/20:2),r(n)})()}),[e,h,t]),{frameHash:h,tiles:a,imageStartLine:l,enableDebug:o,usage:f,setTiles:r,deleteFrame:()=>{m({message:`Delete frame "${t}" (${e})?`,confirm:async()=>{c(0),g(),d(e)},deny:async()=>c(0)})},editFrame:()=>F(e)}};var dl=function({frameId:e,name:t,palette:a}){const{tiles:r,deleteFrame:l,editFrame:s,frameHash:F,enableDebug:o,imageStartLine:i,usage:c}=ul({frameId:e,name:t});return r?n.createElement("li",{className:"frame",onClick:s,role:"presentation"},n.createElement("div",{className:"frame__image"},r.length?n.createElement(re,{lockFrame:!1,invertPalette:!1,palette:a,imageStartLine:i,tiles:r}):null),n.createElement("div",{className:"frame__row"},n.createElement("code",{className:"frame__id"},e),n.createElement("span",{className:"frame__usage"},c?`Used ${c} times`:"Not used")),n.createElement("span",{className:"frame__name"},t),o?n.createElement("span",{className:"frame__hash-debug"},F):null,n.createElement(cl,{deleteFrame:l,editFrame:s})):null};var pl=function(){const{frameGroups:e,selectedFrameGroup:t,setSelectedFrameGroup:a,palette:r,groupFrames:l,exportJson:s,setActiveFrameGroupName:F,activeFrameGroup:o,convertFormat:i,enableDebug:c}=il();return n.createElement("div",{className:"frames"},n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"framegroups",className:"inputgroup__label"},"Edit Framegroup"),n.createElement("select",{id:"framegroups",className:"inputgroup__input inputgroup__input--select",value:t,onChange:e=>{a(e.target.value)}},n.createElement("option",{value:""},"Select frame group"),e.map((({id:e,name:t})=>n.createElement("option",{value:e,key:e},t))))),o?n.createElement(pt,{type:dt.TEXT,id:"frames-edit-group-name",onChange:F,value:o.name||"",labelText:"Rename Framegroup"}):null,n.createElement("ul",{className:"frames__list"},l?.map((e=>n.createElement(dl,{frameId:e.id,key:`frame-${e.id}`,name:e.name,palette:r}))),n.createElement("li",{className:"frame frame--dummy",key:"dummy1"}),n.createElement("li",{className:"frame frame--dummy",key:"dummy2"}),n.createElement("li",{className:"frame frame--dummy",key:"dummy3"}),n.createElement("li",{className:"frame frame--dummy",key:"dummy4"}),n.createElement("li",{className:"frame frame--dummy",key:"dummy5"})),n.createElement("div",{className:"inputgroup buttongroup"},n.createElement("button",{type:"button",className:"button",onClick:()=>s(Xr.m.FRAMES)},"Export frames"),n.createElement("button",{type:"button",className:"button",onClick:()=>s(Xr.m.CURRENT_FRAMEGROUP)},`Export current framegroup (${t})`),c?n.createElement("button",{type:"button",className:"button",onClick:i},"Convert frames to new format"):null))};var gl=()=>{const[e,t]=(0,n.useState)(!1),a=!(!navigator.storage||!navigator.storage.persist);a&&navigator.storage.persisted().then(t);return{persistAPIAvailable:a,persisted:e,requestPersist:()=>{t(!1),a&&navigator.storage.persist().then(t)}}},hl=a(6763);const El=async(e,t,a)=>{const n=await(0,S.T)(e,t)(a,!1);if(!n)return null;const{dataHash:r}=await(0,ht.cg)(n);return r!==a?(0,ht.UN)(n):null};var fl=()=>{const{frames:e,images:t}=(0,E.h)(),{updateImageHash:r}=G(),[l,s]=(0,n.useState)(!0);return window.enableHashCleanup=()=>s(!1),{cleanupBusy:l,hashCleanup:async()=>{s(!0);let n=0,l=0;const{default:F}=await Promise.resolve().then(a.t.bind(a,4802,23));await Promise.all(t.map((async a=>{const{hash:s}=a;if((0,Ne.pl)(a)){const{hashes:l}=a,o=Object.keys(l),i=await Promise.all(o.map((async a=>{const n=l[a];let r=null;return n&&(r=await El(t,e,n)),{[a]:r||n}}))),c=i.reduce(((e,t)=>({...e,...t})),{}),m=F(c);m!==s&&(n+=1,r(s,{...a,hash:m,hashes:c}))}else{const n=await El(t,e,s);n&&(l+=1,r(s,{...a,hash:n}))}}))),s(!1),hl.info({iCounterRGBN:n,iCounterMono:l})}}};var bl=function(){const{hashCleanup:e,cleanupBusy:t}=fl(),{downloadSettings:a}=he(),{resetGroups:r}=q(),l=e=>a(e),{persistAPIAvailable:s,persisted:F,requestPersist:o}=gl();return n.createElement("div",{className:"inputgroup buttongroup settings__export"},s?n.createElement("button",{type:"button",className:"button",disabled:F,onClick:o},F?"Storage is persistent":"Request storage persistence"):null,n.createElement("button",{type:"button",className:"button",onClick:r},"Reset image groups"),n.createElement("button",{type:"button",className:"button",onClick:()=>l(Xr.m.ALL)},"Export Everything"),n.createElement("button",{type:"button",className:"button",onClick:()=>l(Xr.m.PLUGINS)},"Export Plugins"),n.createElement("button",{disabled:t,type:"button",className:"button button--tiny",onClick:e},"Hash Cleanup"))},vl=a(3920);const _l=(0,vl._)(),yl=[{path:"/settings/generic",headline:"Generic Settings"},{path:"/settings/git",headline:"Git Settings"},{path:"/settings/plugins",headline:"Plugin Settings"}];yl.push({path:"/settings/dropbox",headline:"Dropbox Settings"}),"esp8266"!==(0,vl._)()?.env&&"webpack-dev"!==(0,vl._)()?.env||yl.push({path:"/settings/wifi",headline:"WiFi Settings"});var Nl=function(){const e=(0,H.FE)(),t=e[2]?.pathname,a=yl.find((({path:e})=>e===t));return a?n.createElement("div",{className:"settings"},n.createElement("ul",{className:"contenttabs__tabs"},yl.map((({headline:e,path:t})=>n.createElement("li",{className:"contenttabs__tab",key:t},n.createElement(r.k2,{to:t,className:({isActive:e})=>"button contenttabs__tabs-button "+(e?"contenttabs__tabs-button--active":"")},e))))),n.createElement("h2",{className:"settings__headline"},a.headline),n.createElement(H.sv,null),n.createElement(bl,null),n.createElement("ul",{className:"settings__version"},n.createElement("li",null,"Web-App version: 1.44.0"),n.createElement("li",null,"Web-App branch: master"),n.createElement("li",null,`Printer version: ${_l?.version}`),n.createElement("li",null,`Max Images: ${_l?.maximages}`),n.createElement("li",null,`Localforage driver: ${_l?.localforage}`),n.createElement("li",null,`Environment type: ${_l?.env}`),n.createElement("li",null,`Compiled Filesystem: ${_l?.fstype}`),n.createElement("li",null,`Compiled Bootmode: ${_l?.bootmode}`),n.createElement("li",null,"Compiled for OLED: "+(_l?.oled?"yes":"no")))):n.createElement(H.C5,{to:yl[0].path,replace:!0})},wl=a(7007),kl=a.n(wl);class Cl extends(kl()){device;manufacturerName;productName;serialNumber;interfaceNumber;endpointIn;endpointOut;textDecoder;constructor(e){super(),this.device=e,this.manufacturerName=e.manufacturerName||"",this.productName=e.productName||"",this.serialNumber=e.serialNumber||"",this.interfaceNumber=2,this.endpointIn=5,this.endpointOut=4,this.textDecoder=new TextDecoder}connect(){const e=()=>{this.device.transferIn(this.endpointIn,64).then((t=>{this.emit("data",this.textDecoder.decode(t.data)),e()})).catch((e=>{this.emit("error",e)}))};return this.device.open().then((()=>this.device?.selectConfiguration?.(1))).then((()=>{const e=this.device.configuration?.interfaces;e&&e.forEach((e=>{e.alternates.forEach((t=>{255===t.interfaceClass&&(this.interfaceNumber=e.interfaceNumber,t.endpoints.forEach((e=>{"out"===e.direction&&(this.endpointOut=e.endpointNumber),"in"===e.direction&&(this.endpointIn=e.endpointNumber)})))}))}))})).then((()=>this.device.claimInterface(this.interfaceNumber))).then((()=>this.device.selectAlternateInterface(this.interfaceNumber,0))).then((()=>this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:this.interfaceNumber}))).then((()=>{e()}))}disconnect(){return this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:0,index:this.interfaceNumber}).then((()=>this.device.close()))}send(e){return this.device.transferOut(this.endpointOut,e)}}var Al=Cl,Sl=a(6763);class Il extends(kl()){enabled;activePorts;constructor(){super(),this.enabled=!!navigator.usb&&!!navigator.usb.getDevices,this.activePorts=[],this.watchPorts()}getPorts(){return this.enabled?navigator.usb.getDevices().then((e=>e.filter((({opened:e})=>!e)).map((e=>new Al(e))))):Promise.resolve([])}getActivePorts(){return this.activePorts}watchPorts(){window.setInterval((()=>{this.getPorts().then((e=>{e.forEach((e=>{e.addListener("error",(t=>{Sl.warn(t),this.activePorts=this.activePorts.filter((t=>t!==e)),this.emit("activePortsChange",[...this.activePorts])})),e.addListener("data",(e=>{this.emit("data",e)})),e.connect().then((()=>{this.activePorts.push(e),this.emit("activePortsChange",[...this.activePorts])}))}))}))}),1e3)}requestPort(){if(!this.enabled)return;navigator.usb.requestDevice({filters:[{vendorId:9025,productId:32822},{vendorId:9025,productId:32823},{vendorId:9025,productId:32845},{vendorId:9025,productId:32846},{vendorId:9025,productId:32847},{vendorId:9025,productId:32848},{vendorId:9025,productId:32850},{vendorId:9025,productId:32851},{vendorId:9025,productId:32852},{vendorId:9025,productId:32853},{vendorId:9025,productId:32854},{vendorId:9025,productId:32855},{vendorId:9114}]}).then((e=>{if(e.opened)throw new Error("device already opened");return new Al(e)})).catch((()=>null)).then((e=>{e&&e.connect().then((()=>{this.activePorts.push(e),this.emit("activePortsChange",[...this.activePorts])}))}))}}var Pl=new Il;var xl=()=>{const{handleFileImport:e}=Wr();return(0,n.useCallback)((t=>{const a=new File([...t],"Text input.txt",{type:"text/plain"});e([a])}),[e])};var Tl=e=>{const t=Pl.enabled,a=xl(),[r,l]=(0,n.useState)([]),[s,F]=(0,n.useState)(!1),o=(0,n.useRef)(""),i=(0,n.useRef)();(0,n.useEffect)((()=>{if(!Pl.enabled)return()=>{};const t=e=>{window.clearTimeout(i.current),i.current=window.setTimeout((()=>{F(!1),a(o.current),o.current=""}),1e3),F(!0),o.current=`${o.current}${e}`};return l(Pl.getActivePorts()),Pl.addListener("activePortsChange",l),e||Pl.addListener("data",t),()=>{Pl.removeListener("activePortsChange",l),Pl.removeListener("data",t)}}),[a,e]);return{activePorts:r,webUSBEnabled:t,openWebUSBSerial:()=>{Pl.enabled&&Pl.requestPort()},isReceiving:s}};class Dl extends(kl()){device;baudRate;usbProductId;usbVendorId;reader;constructor({device:e,baudRate:t}){super(),this.device=e,this.baudRate=t;const{usbProductId:a,usbVendorId:n}=e.getInfo();this.usbProductId=a,this.usbVendorId=n,this.reader=null}connect(){const e=()=>{this.reader?.read().then((({value:t})=>{this.emit("data",t),e()})).catch((e=>{this.emit("error",e)}))};return this.device.open({baudRate:this.baudRate}).then((()=>{const t=new window.TextDecoderStream;this.device.readable.pipeTo(t.writable),this.reader=t.readable.getReader(),e()}))}}var Bl=Dl,Rl=a(6763);class Ll extends(kl()){enabled;activePorts;baudRate;constructor(){super(),this.enabled=!!navigator.serial&&!!window.TextDecoderStream,this.activePorts=[],this.baudRate=115200,this.watchPorts()}getPorts(){return this.enabled?navigator.serial.getPorts().then((e=>e.filter((({readable:e})=>!e)).map((e=>new Bl({device:e,baudRate:this.baudRate}))))):Promise.resolve([])}getActivePorts(){return this.activePorts}watchPorts(){window.setInterval((()=>{this.getPorts().then((e=>{e.forEach((e=>{e.addListener("error",(t=>{Rl.warn(t),this.activePorts=this.activePorts.filter((t=>t!==e)),this.emit("activePortsChange",[...this.activePorts])})),e.addListener("data",(e=>{this.emit("data",e)})),e.connect().then((()=>{this.activePorts.push(e),this.emit("activePortsChange",[...this.activePorts])})).catch((()=>{}))}))}))}),1e3)}requestPort(){this.enabled&&navigator.serial.requestPort().then((e=>{if(e.readable)throw new Error("device already opened");return new Bl({device:e,baudRate:this.baudRate})})).catch((()=>null)).then((e=>{e&&e.connect().then((()=>{this.activePorts.push(e),this.emit("activePortsChange",[...this.activePorts])}))}))}}var Ml=new Ll;var Gl=e=>{const t=Ml.enabled,a=xl(),[r,l]=(0,n.useState)([]),[s,F]=(0,n.useState)(!1),o=(0,n.useRef)(""),i=(0,n.useRef)();(0,n.useEffect)((()=>{if(!Ml.enabled)return()=>{};const t=e=>{window.clearTimeout(i.current),i.current=window.setTimeout((()=>{F(!1),a(o.current),o.current=""}),1e3),F(!0),o.current=`${o.current}${e}`};return l(Ml.getActivePorts()),Ml.addListener("activePortsChange",l),e||Ml.addListener("data",t),()=>{Ml.removeListener("activePortsChange",l),Ml.removeListener("data",t)}}),[a,e]);return{activePorts:r,webSerialEnabled:t,openWebSerial:()=>{Ml.enabled&&Ml.requestPort()},isReceiving:s}};var Vl=function({confirm:e,deny:t,canConfirm:a}){return n.createElement("div",{className:"buttons"},t?n.createElement("button",{className:"buttons__button buttons__button--deny",type:"button",onClick:t},"Cancel"):null,e?n.createElement("button",{disabled:!1===a,className:"buttons__button buttons__button--confirm",type:"button",onClick:e},"Ok"):null)};var $l=({confirm:e,canConfirm:t,deny:a})=>{(0,n.useEffect)((()=>{const n=n=>{"Escape"===n.key&&a&&a(),"Enter"===n.key&&n.ctrlKey&&e&&t&&e()};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}}),[e,t,a])};var Ol=()=>{const e=(0,n.useRef)();return(0,n.useEffect)((()=>{const t=document.activeElement,a=e.current?[...e.current.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')]:[];return a.length&&!(0,ke.A)()&&a[0].focus(),()=>{t?.focus()}}),[]),{autofocusRef:e}};var Ul=function(e){const t="boolean"!=typeof e.closeOnOverlayClick||e.closeOnOverlayClick;$l({confirm:e.confirm,canConfirm:e.canConfirm||!1,deny:e.deny});const{autofocusRef:a}=Ol();return n.createElement("div",{className:`lightbox ${e.className}`},n.createElement("button",{type:"button",className:`lightbox__backdrop ${e.className}__backdrop`,onClick:t?e.deny:void 0}),n.createElement("div",{className:`lightbox__box ${e.className}__box`,ref:a,style:{height:e.height?`${e.height}px`:void 0}},n.createElement("dialog",{className:`lightbox__box-content ${e.className}__box-content`,"aria-labelledby":"lightbox-header"},e.header?n.createElement("div",{id:"lightbox-header",className:`lightbox__header ${e.className}__header`},e.header):null,e.children),e.confirm||e.deny?n.createElement(Vl,{confirm:e.confirm,canConfirm:e.canConfirm,deny:e.deny}):null))};var zl=()=>{const{useSerials:e}=(0,i.A)(),{showSerials:t,setShowSerials:a}=(0,w.A)();return{lightBoxOpen:t&&e,hideSerials:()=>a(!1)}};var Hl=function({inline:e,passive:t}){const a="WebUSB Serial devices",{activePorts:r,isReceiving:l,webUSBEnabled:s,openWebUSBSerial:F}=Tl(t||!1),{activePorts:i,isReceiving:c,webSerialEnabled:m,openWebSerial:u}=Gl(t||!1),{lightBoxOpen:d,hideSerials:p}=zl(),g=n.createElement("div",{className:"connect-usb-serial-overlay__content"},n.createElement("button",{type:"button",className:o()("connect-usb-serial-overlay__button button",{"connect-usb-serial-overlay__button--is-receiving":l,"connect-usb-serial-overlay__button--disabled":!s}),title:a,onClick:F,disabled:!s||l},"Open WebUSB device",l?" (receiving)":null),n.createElement("div",{className:"connect-usb-serial-overlay__info connect-usb-serial-overlay__info--spaced"},n.createElement("h4",null,`Connected devices (${r.length}):`),n.createElement("ul",null,r.map((({productName:e},t)=>n.createElement("li",{key:t},e))))),n.createElement("button",{type:"button",className:o()("connect-usb-serial-overlay__button button",{"connect-usb-serial-overlay__button--is-receiving":c,"connect-usb-serial-overlay__button--disabled":!m}),title:a,onClick:u,disabled:!m||c},"Open Web Serial device",c?" (receiving)":null),n.createElement("div",{className:"connect-usb-serial-overlay__info"},`${i.length} devices connected`));return e?g:d||l||c?n.createElement(Ul,{header:"WebUSB / Serial devices",confirm:p,canConfirm:!l&&!c,className:"connect-usb-serial-overlay"},g):null};var Wl=function(){const{useSerials:e,setUseSerials:t}=(0,i.A)();return n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":e})},n.createElement("span",{className:"inputgroup__label",title:"Hide dates in gallery"},"Enable WebUSB / Serial ports",n.createElement("span",{className:"inputgroup__note inputgroup__note--warn"},"This is currently an experimental feature")),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:e,onChange:({target:e})=>{t(e.checked)}}),n.createElement(g,{name:"checkmark"})))};var Xl=function(){const{useSerials:e}=(0,i.A)();return n.createElement(n.Fragment,null,n.createElement(Wl,null),e?n.createElement(n.Fragment,null,n.createElement(Hl,{inline:!0,passive:!0}),n.createElement("div",{className:"usb-greeting"},n.createElement("p",null,"After connecting a USB (or serial) device, you can continue to the ",n.createElement(r.N_,{to:"/gallery"},"Gallery Page")," or ",n.createElement(r.N_,{to:"/"},"Home Page")," now."),n.createElement("p",null,"An overlay will appear once you're receiving data."),n.createElement("p",null,"You can also access these options via the USB-Symbol in the navigation and the ",n.createElement(r.N_,{to:"/settings/generic"},"Settings Page")," ."),n.createElement("p",null,n.createElement("strong",null,"Note: WebUSB and Web Serial are similar but not the same:")),n.createElement("p",null,"While Web Serial has access to a regular COM-port and does not require special devices, the feature is not available on mobile devices. ",n.createElement("br",null),n.createElement("span",{className:Ml.enabled?"usb-greeting--supported":"usb-greeting--not-supported"},Ml.enabled?"Your current device does support Web Serial":"Your current device does not support Web Serial")),n.createElement("p",null,"WebUSB requires certain microcontrollers where the processor has direct access to the USB interface (e.g. an Arduino Leonardo). ",n.createElement("a",{href:"https://github.com/webusb/arduino"},"See webusb for arduino on GitHub for more information"),".",n.createElement("br",null),n.createElement("span",{className:Pl.enabled?"usb-greeting--supported":"usb-greeting--not-supported"},Pl.enabled?"Your current device does support WebUSB":"Your current device does not support WebUSB")))):null)},jl=a(4852);const Yl=["https://herrzatacke.github.io","https://localhost:5000","https://127.0.01:5000","http://localhost:5000","http://127.0.01:5000"];var Zl,Ql=function(){const{url:e,source:t,isTrusted:a,pluginExists:l,canAdd:s,addPlugin:F}=(()=>{const e=(0,H.g)().pluginUrl||"",t=(0,jl.vx)(e),{plugins:a}=(0,E.h)(),{validateAndAddPlugin:n}=b(),r=(0,H.Zp)(),l=Yl.some((e=>{const a=(0,jl.vx)(e);return a.protocol===t.protocol&&a.host===t.host})),s=a.some((t=>t.url===e));return{url:e,pluginExists:s,source:`${t.protocol}//${t.host}`,isTrusted:l,canAdd:!s,addPlugin:async()=>{await n({url:e}),r("/settings/plugins",{replace:!0})}}})();return e?n.createElement("div",{className:"add-plugin"},a?null:n.createElement("p",{className:"add-plugin__message  add-plugin__message--warning-strong"},n.createElement(g,{className:"add-plugin__warn",name:"warn"}),n.createElement("span",null,"The source of this plugin"),n.createElement("code",{className:"add-plugin__source"},t),n.createElement("span",null,"is not trusted!!")),l?n.createElement(n.Fragment,null,n.createElement("p",{className:"add-plugin__message add-plugin__message--warning"},n.createElement(g,{className:"add-plugin__warn",name:"warn"}),n.createElement("span",null,"The plugin"),n.createElement("code",{className:"add-plugin__source"},e),n.createElement("span",null,"is already installed")),n.createElement(r.N_,{to:"/settings/plugins",className:"add-plugin__button add-plugin__button--goto"},"Go to plugins")):n.createElement(n.Fragment,null,n.createElement("p",{className:"add-plugin__message"},n.createElement("span",null,"This will add"),n.createElement("code",{className:"add-plugin__source"},e),n.createElement("span",null,"to your plugins.")),n.createElement("button",{disabled:!s,className:"add-plugin__button add-plugin__button--confirm",type:"button",onClick:F},"Add"))):n.createElement(H.C5,{to:"/settings/plugins",replace:!0})};!function(e){e.BRIGHT="theme-bright",e.DARK="theme-dark"}(Zl||(Zl={}));var Kl=function({closeNavigation:e}){const{theme:t,setTheme:a}=(()=>{const[e,t]=(0,n.useState)(localStorage.getItem("gbp-web-theme")||[Zl.BRIGHT,Zl.DARK][0]);return(0,n.useEffect)((()=>{localStorage.setItem("gbp-web-theme",e);const t=document.querySelector("html")?.classList;t&&[Zl.BRIGHT,Zl.DARK].forEach((a=>{a===e?t.add(e):t.remove(a)}))}),[e]),{theme:e,setTheme:t}})(),r=t===Zl.BRIGHT?"Switch to dark mode":"Switch to bright mode";return n.createElement("label",{className:"theme-toggle navigation__link",title:r},n.createElement(g,{name:t===Zl.BRIGHT?"sun":"moon"}),n.createElement("span",{className:"theme-toggle__title"},r),n.createElement("input",{type:"checkbox",checked:t===Zl.BRIGHT,onChange:({target:t})=>{e(),a(t.checked?Zl.BRIGHT:Zl.DARK)}}))};var ql=()=>{const{gitStorage:e,dropboxStorage:t}=(0,M.A)(),a=t.autoDropboxSync||!1,n=!!(t.use||e.use&&e.owner&&e.repo&&e.branch&&e.throttle&&e.token),{syncBusy:r,setSyncSelect:l,setShowSerials:s}=(0,w.A)(),{useSerials:F}=(0,i.A)(),{syncLastUpdate:o}=(0,M.A)();return{disableSerials:!Pl.enabled&&!Ml.enabled,syncBusy:r,useSync:n,useSerials:F,syncLastUpdate:o,autoDropboxSync:a,selectSync:()=>l(!0),setShowSerials:()=>s(!0)}};var Jl=function(){const[e,t]=(0,n.useState)(!1),{disableSerials:a,syncBusy:l,useSync:s,useSerials:F,syncLastUpdate:i,autoDropboxSync:c,selectSync:m,setShowSerials:u}=ql(),{showTrashCount:d,trashCount:p}=(0,w.A)(),h=p.frames+p.images,E=({isActive:e})=>"navigation__link "+(e?"navigation__link--active":"");return n.createElement("nav",{className:o()("navigation",{"navigation--mobile-open":e})},n.createElement("button",{className:"navigation__burger-button",type:"button",onClick:()=>t(!e)},n.createElement(g,{name:e?"close-nav":"burger"})),n.createElement("ul",{className:"navigation__list"},n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/home",className:E,onClick:()=>t(!1)},"Home")),n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/gallery",className:E,onClick:()=>t(!1)},"Gallery")),n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/import",className:E,onClick:()=>t(!1)},"Import")),n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/palettes",className:E,onClick:()=>t(!1)},"Palettes")),n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/frames",className:E,onClick:()=>t(!1)},"Frames")),n.createElement("li",{className:"navigation__entry"},n.createElement(r.k2,{to:"/settings",className:E,onClick:()=>t(!1)},"Settings")),n.createElement("li",{className:"navigation__entry navigation__entry--buttons"},n.createElement("button",{type:"button",title:"Trash Bin",className:"navigation__link navigation__link--icon",onClick:()=>d(!0)},n.createElement(g,{name:"delete"}),h>0?n.createElement("span",{className:"navigation__link-bubble"},h):null)),s?n.createElement("li",{className:"navigation__entry navigation__entry--buttons"},n.createElement("button",{type:"button",title:"Synchronize",className:"navigation__link navigation__link--icon",onClick:m,disabled:l},n.createElement(g,{name:"sync"}),c&&i.local!==i.dropbox?n.createElement("span",{className:"navigation__link-bubble",title:i.local>i.dropbox?"There are local changes not synched to dropbox yet":"There are remote changes not synched yet"},"!"):null)):null,n.createElement("li",{className:"navigation__entry navigation__entry--right"},n.createElement(Kl,{closeNavigation:()=>t(!1)})),F?n.createElement("li",{className:"navigation__entry navigation__entry--right"},n.createElement("button",{title:"WebUSB Serial devices",type:"button",className:"connect-usb-serial navigation__link",disabled:a,onClick:()=>{t(!1),u()}},n.createElement(g,{name:"usb"}),n.createElement("span",{className:"connect-usb-serial__title"},"WebUSB Serial devices"))):null))},es=a(3522),ts=a.n(es);u().extend(ts());var as=function(){const{git:{messages:e,repoUrl:t,repo:a,branch:r},dropbox:{messages:l,path:s},confirm:F}=(()=>{const{progressLog:e,resetProgressLog:t}=(0,w.A)(),{gitStorage:a,dropboxStorage:n}=(0,M.A)();return{git:{messages:e.git||[],repoUrl:`https://github.com/${a.owner}/${a.repo}/tree/${a.branch}`,repo:a.repo,branch:a.branch},dropbox:{messages:e.dropbox||[],path:n.path||""},confirm:t}})(),[o,i]=(0,n.useState)(!0);if(!e.length&&!l.length)return null;const c=e.length>0,m=l.length>0,{timestamp:d}=e[e.length-1]||{},{timestamp:p,message:g}=e[0]||{},{timestamp:h}=l[l.length-1]||{},{timestamp:E,message:f}=l[0]||{},b="."===g||"."===f,v=c?d:h,_=c?p:E,y=e.concat(l),N=y.filter(((e,t)=>!o||t<15));return n.createElement(Ul,{className:"progress-log",header:`${b?"✔️ Update done":"⏳ Updating..."} ${c?` - "${a}/${r}"`:""}`,confirm:b?F:void 0},n.createElement("ul",{className:"progress-log__messages"},N.map((({message:e,timestamp:t},a)=>"."===e?null:n.createElement("li",{key:a,className:"progress-log__message",title:u().unix(t).format("HH:mm:ss")},e)))),y.length>15?n.createElement("button",{type:"button",className:"progress-log__button",onClick:()=>i(!o)},o?`Show all ${y.length} messages`:"Reduce messages"):null,n.createElement("div",{className:"progress-log__duration"},`Started at: ${u().unix(v).format("HH:mm:ss")}`,n.createElement("br",null),`${b?"Finished after":"Running for"}: ${u().duration(_-v,"seconds").format("HH:mm:ss")}`,c?n.createElement(n.Fragment,null,n.createElement("br",null),"Repository: ",n.createElement("a",{title:t,href:t,target:"_blank",rel:"noreferrer"},"Open GitHub")):null,m?n.createElement(n.Fragment,null,n.createElement("br",null),n.createElement("a",{title:`Open Dropbox folder:\nhttps://www.dropbox.com/home/Apps/GameBoyPrinter/${s}`,href:`https://www.dropbox.com/home/Apps/GameBoyPrinter/${s}`,target:"_blank",rel:"noreferrer"},"Open Dropbox folder")):null))};var ns=function(){const{message:e,progress:t}=(()=>{const{progress:e}=(0,w.A)();return e.gif?{progress:e.gif,message:"Creating GIF animation..."}:e.plugin?{progress:e.plugin,message:"Executing plugin..."}:e.printer?{progress:e.printer,message:"Fetching images from printer..."}:{progress:0,message:""}})();return t?n.createElement(Ul,{className:"progress-box"},n.createElement("div",{className:"progress-box__message"},e),n.createElement("progress",{className:"progress-box__progress",value:t,max:1})):null};var rs,ls=()=>{const{dialogs:e}=(0,_.A)(),t=e[0],{questions:a}=t,[r,l]=(0,n.useState)((e=>e?e({}).reduce(((e,t)=>{const{key:a}=t;let n;switch(t.type){case O.V.SELECT:{const e={...t};n=e.options?.find((({selected:e})=>e))?.value||"";break}case O.V.CHECKBOX:n=!1;break;case O.V.TEXT:n=t.initialValue||"";break;case O.V.NUMBER:n=0;break;case O.V.INFO:default:return e}return{...e,[a]:n}}),{}):{})(a));return{message:t.message,confirm:()=>t.confirm(r),deny:t.deny,questions:a?a(r):[],values:r,setSelected:e=>{l({...r,...e})}}};!function(e){e.INFO="info",e.WARNING="warning",e.ERROR="error"}(rs||(rs={}));var ss=function({label:e,themes:t}){return n.createElement("p",{className:o()("info-text",(t||[]).map((e=>`info-text--${e}`)))},e)};var Fs=function(){const{message:e,questions:t,values:a,setSelected:r,confirm:l,deny:s}=ls();return n.createElement(Ul,{className:"confirm",confirm:l,deny:s,header:e},n.createElement("div",{className:"confirm__content"},t.map((e=>{switch(e.type){case O.V.SELECT:{const{label:t,key:l,options:s,disabled:F=!1}=e;return n.createElement(Ye,{key:l,id:l,disabled:F,value:a[l]||"",label:t,options:s,setSelected:e=>r({[l]:e})})}case O.V.TEXT:{const{label:t,key:l,disabled:s=!1}=e;return n.createElement(pt,{key:l,id:l,disabled:s,value:a[l]||"",type:dt.TEXT,labelText:t,onChange:e=>r({[l]:e})})}case O.V.NUMBER:{const{label:t,key:l,min:s,max:F,disabled:o=!1}=e;return n.createElement(pt,{key:l,id:l,disabled:o,value:a[l]||"",type:dt.NUMBER,labelText:t,min:s,max:F,onChange:e=>r({[l]:e})})}case O.V.CHECKBOX:{const{label:t,key:l,disabled:s=!1}=e;return n.createElement("label",{key:l,id:l,className:o()("confirm__check-label",{"confirm__check-label--checked":a[l]})},n.createElement("input",{type:"checkbox",className:"confirm__checkbox",checked:a[l],disabled:s,onChange:({target:e})=>{r({[l]:e.checked})}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"confirm__check-label-text"},t))}case O.V.INFO:{const{label:t,key:a,themes:r}=e;return n.createElement(ss,{label:t,themes:r,key:a})}default:return null}})).filter(Boolean)))};var os=function({frame:e,updateFrame:t,noFrameOption:a,updateFrameLock:r,lockFrame:l,selectLabel:s}){const{frames:F}=(0,E.h)();return n.createElement("div",{className:"frame-select"},s?n.createElement("label",{className:"frame-select__select-label",htmlFor:"frame-select-select"},s):null,n.createElement("select",{className:"frame-select__select",id:"frame-select-select",value:e,onChange:e=>{t(e.target.value)}},n.createElement("option",{value:""},a||"As imported / No frame"),F.map((({id:e,name:t})=>n.createElement("option",{key:e,value:e},`${t} (${e})`)))),"function"==typeof r?n.createElement("label",{className:o()("frame-select__check-label",{"frame-select__check-label--checked":l})},n.createElement("input",{type:"checkbox",className:"frame-select__checkbox",checked:l,onChange:({target:e})=>{r(e.checked)}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"frame-select__check-label-text"},"Use separate color settings for frame")):null)},is=a(777);const cs=[{id:ee.Nx.NORMAL,label:"Normal (ignore neutral layer)"},{id:ee.Nx.NORMAL_S,label:"Normal ⇵ (only neutral layer)"},{id:ee.Nx.LIGHTEN,label:"Lighten"},{id:ee.Nx.SCREEN,label:"Screen"},{id:ee.Nx.DODGE,label:"Dodge"},{id:ee.Nx.ADDITION,label:"Addition"},{id:ee.Nx.DARKEN,label:"Darken"},{id:ee.Nx.MULTIPLY,label:"Multiply"},{id:ee.Nx.BURN,label:"Burn"},{id:ee.Nx.OVERLAY,label:"Overlay"},{id:ee.Nx.SOFTLIGHT,label:"Soft light"},{id:ee.Nx.HARDLIGHT,label:"Hard light"},{id:ee.Nx.DIFFERENCE,label:"Difference"},{id:ee.Nx.EXCLUSION,label:"Exclusion"}];var ms=a(227);var us=function({domain:e,handle:t,getHandleProps:a}){const{onKeyDown:r,onMouseDown:l,onTouchStart:s}=a(t.id);return n.createElement("button",{role:"slider",type:"button","aria-valuemin":e[0],"aria-valuemax":e[1],"aria-valuenow":t.value,className:"color-slider__handle",style:{left:`${t.percent}%`},onKeyDown:r,onMouseDown:l,onTouchStart:s})},ds=a(5556),ps=a.n(ds);function gs({getRailProps:e}){const{onMouseDown:t,onTouchStart:a}=e();return n.createElement("button",{type:"button",className:"color-slider__rail",onMouseDown:t,onTouchStart:a,tabIndex:-1},n.createElement("div",{className:"color-slider__rail-inner"}))}gs.propTypes={getRailProps:ps().func.isRequired};var hs=gs;const Es=[0,255];var fs=function({color:e,onChange:t,values:a}){return n.createElement("div",{className:"color-slider","data-color":e},n.createElement("button",{className:"color-slider__button color-slider__button--reset",type:"button",onClick:()=>{t([0,85,170,255])}},n.createElement(g,{name:"reset"})),n.createElement(ms.Ap,{className:"color-slider__root",mode:2,step:4,domain:Es,onUpdate:t,onChange:t,values:a},n.createElement(ms.hM,null,(({getRailProps:e})=>n.createElement(hs,{getRailProps:e}))),n.createElement(ms.ot,null,(({handles:e,getHandleProps:t})=>n.createElement("div",{className:"slider-handles"},e.map((e=>n.createElement(us,{key:e.id,handle:e,domain:Es,getHandleProps:t}))))))))};var bs=function(e){const[t,a]=(0,n.useState)(e.values),r=(0,is.A)((t=>{e.onChange(t,!0)}),150,{leading:!0,trailing:!0}),l=(e,n)=>{const l={...t,[e]:n};a(l),r.callback(l)},s=["r","g","b","n"].reduce(((t,a)=>e.useChannels[a]?[...t,a]:t),[]);return n.createElement("div",{className:"grey-select"},s.map((e=>["n"===e?n.createElement("select",{key:"blendmode",className:"grey-select__select",value:t.blend,onChange:e=>{l("blend",e.target.value)}},cs.map((({id:e,label:t})=>n.createElement("option",{key:e,value:e},t)))):null,n.createElement(fs,{key:`slider-${e}`,color:e,values:t[e],onChange:t=>{l(e,t)}})].flat().filter(Boolean))))};var vs=function({value:e,allowEmpty:t,invertPalette:a,noFancy:r,selectLabel:l,onChange:s,updateInvertPalette:F}){const[i,c]=(0,n.useState)(e),{palettes:m}=(0,E.h)(),{sortFn:u}=ll(),d=[...m].sort(u);return t&&d.unshift({shortName:"",name:"As selected per image",palette:[],isPredefined:!1,origin:""}),n.createElement(n.Fragment,null,l?n.createElement("label",{className:"palette-select__select-label",htmlFor:"palette-select-select"},l):null,n.createElement("select",{id:"palette-select-select",className:"palette-select",value:e,onChange:e=>{s(e.target.value,!0),c(e.target.value)}},d.map((({shortName:e,name:t})=>n.createElement("option",{key:e,value:e},t)))),F?n.createElement("label",{className:o()("palette-select__check-label",{"palette-select__check-label--checked":a})},n.createElement("input",{type:"checkbox",className:"palette-select__checkbox",checked:a,onChange:({target:e})=>{F(e.checked)}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"palette-select__check-label-text"},"Invert Palette")):null,r?null:n.createElement("ul",{className:"fancy-palette-select"},d.map((({shortName:e,name:t,palette:a})=>n.createElement("li",{key:e,className:o()("fancy-palette-select__entry",{"fancy-palette-select__entry--active":i===e})},n.createElement("button",{type:"button",className:"fancy-palette-select__button",title:t,onClick:()=>{s(e,!0),c(e)},onMouseEnter:()=>{s(e,!1)},onMouseLeave:()=>{s(i)}},n.createElement("span",{className:"fancy-palette-select__color",style:{backgroundColor:a[0]}}),n.createElement("span",{className:"fancy-palette-select__color",style:{backgroundColor:a[1]}}),n.createElement("span",{className:"fancy-palette-select__color",style:{backgroundColor:a[2]}}),n.createElement("span",{className:"fancy-palette-select__color",style:{backgroundColor:a[3]}})))))))},_s=a(9432);const ys=e=>(0,Ge.A)(e.map((({tags:e})=>e)).flat()).filter((e=>e!==ve.X.FILTER_FAVOURITE)).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),Ns=()=>{const{images:e}=(0,E.h)(),[t,a]=(0,n.useState)(ys(e));return(0,n.useEffect)((()=>{a(ys(e))}),[e]),{availableTags:t}};var ws;!function(e){e.ADD="add",e.REMOVE="remove"}(ws||(ws={}));var ks=(e,{mode:t,tag:a})=>{switch(t){case"add":return{add:[...e.add,a],remove:[...e.remove.filter((e=>e!==a))]};case"remove":return{remove:[...e.remove,a],add:[...e.add.filter((e=>e!==a))]};default:return e}};var Cs=function({updateTags:e,selectedTags:t,direction:a}){const{availableTags:r}=Ns(),l=r.filter((e=>!t.includes(e))),[s,F]=(0,n.useState)(l),{isOpen:i,getMenuProps:c,getInputProps:m,getComboboxProps:u,getToggleButtonProps:d,highlightedIndex:p,getItemProps:h,reset:E,inputValue:f}=(0,_s.Bp)({items:s,onSelectedItemChange:({inputValue:t})=>{t?.trim()&&(e(ws.ADD,t.trim()),E())},onInputValueChange:({inputValue:e})=>{F(l.filter((t=>t.toLowerCase().startsWith(e?.trim().toLowerCase()||""))))}}),b=()=>{f.trim()&&(e(ws.ADD,f.trim()),E())};return n.createElement("li",{...u(),className:"tags-select__tag tags-select__tag--input"},n.createElement("input",{type:"text",className:"tags-select__tag-name",id:"tags-select-new-tag",...m(),onKeyUp:e=>{if("Enter"===e.key)b()}}),n.createElement("button",{type:"button",className:"tags-select__button tags-select__button--add tags-select__button--only-touch",onClick:b},n.createElement(g,{name:"add"})),n.createElement("button",{type:"button",className:"tags-select__combo-box-toggle-button",...d(),"aria-label":"toggle tag select menu"},n.createElement(g,{name:"arrowdown"})),n.createElement("ul",{...c(),className:o()("tags-select__combo-box-list",{"tags-select__combo-box-list--open":i,[`tags-select__combo-box-list--${a}`]:a})},i&&s.map(((e,t)=>n.createElement("li",{className:o()("tags-select__combo-box-item",{"tags-select__combo-box-item--selected":p===t}),key:`${e}${t}`,...h({item:e,index:t})},e)))))};var As=function({label:e,tags:t,updateTags:a,listDirection:r}){const l=(0,Ge.A)([...t.initial,...t.add]);return n.createElement(n.Fragment,null,e?n.createElement("label",{className:"tags-select__label",htmlFor:"tags-select-new-tag"},e):null,n.createElement("ul",{className:"tags-select"},l.map((e=>n.createElement("li",{className:o()("tags-select__tag",{"tags-select__tag--add":t.add.includes(e),"tags-select__tag--remove":t.remove.includes(e)}),key:e},n.createElement("span",{className:"tags-select__tag-name"},e===ve.X.FILTER_FAVOURITE?"❤️":e),n.createElement("button",{type:"button",className:"tags-select__button tags-select__button--remove",onClick:()=>a(ws.REMOVE,e)},n.createElement(g,{name:"remove"})),n.createElement("button",{type:"button",className:"tags-select__button tags-select__button--add",onClick:()=>a(ws.ADD,e)},n.createElement(g,{name:"add"}))))),n.createElement(Cs,{updateTags:a,selectedTags:l,direction:r})))};var Ss=(e,t)=>{const a=u()(t),[r,l]=(0,n.useState)(t?a.format(X.IY):""),[s,F]=(0,n.useState)(t?a.format(X.rf):"");return{date:r,time:s,setDate:l,setTime:F,updateDate:n=>{const[r,s,F]=n.split("-"),o=parseInt(r,10),i=parseInt(s,10),c=parseInt(F,10);if(isNaN(o)||isNaN(i)||isNaN(c))return void l(a.format(X.IY));const m=u()(t).date(c).month(i-1).year(o);e(m.format(X.i$))},updateTime:n=>{const[r,s]=n.split(":"),F=parseInt(r,10),o=parseInt(s,10);if(isNaN(F)||isNaN(o))return void l(a.format(X.rf));const i=u()(t).hour(F).minute(o);e(i.format(X.i$))}}};const Is=[{value:0,label:"0°"},{value:1,label:"90°"},{value:2,label:"180°"},{value:3,label:"270°"}];var Ps,xs=function({created:e,hash:t,hashes:a,updateCreated:r,meta:l,rotation:s,updateRotation:F}){const{date:i,time:c,setDate:m,setTime:u,updateDate:d,updateTime:p}=Ss(r,e),g={...l,hash:t},h=Object.keys(g).reduce(((e,t)=>{let a;a="number"!=typeof g[t]&&"string"!=typeof g[t]?JSON.stringify(g[t]):g[t];return[...e,{key:t,value:a}]}),[]);if(a){const e=Object.keys(a).reduce(((e,t)=>[...e,{key:`hash ${t}`,value:a[t]}]),[]);h.push(...e)}return n.createElement("div",{className:"image-meta-form"},n.createElement("div",{className:"image-meta-form__datetime"},n.createElement("label",{className:"image-meta-form__label image-meta-form__label--date"},n.createElement("span",{className:"image-meta-form__label-text"},"Edit Date"),n.createElement("input",{type:"date",className:"image-meta-form__date",value:i,onChange:({target:{value:e}})=>{m(e)},onBlur:({target:{value:e}})=>{d(e)}})),n.createElement("label",{className:"image-meta-form__label image-meta-form__label--time"},n.createElement("span",{className:"image-meta-form__label-text"},"Edit Time"),n.createElement("input",{type:"time",className:"image-meta-form__date",value:c,onChange:({target:{value:e}})=>{u(e)},onBlur:({target:{value:e}})=>{p(e)}}))),n.createElement("div",{className:"image-meta-form__rotation"},n.createElement("span",{className:"image-meta-form__label-text"},"Edit Rotation"),n.createElement("div",{className:"inputgroup buttongroup"},Is.map((({value:e,label:t})=>n.createElement("button",{key:t,type:"button",className:o()("button image-meta-form__rotation-button",{"button--active":e===(s||0)}),onClick:()=>{F(e)}},t))))),n.createElement("table",{className:"image-meta-form__meta-table"},n.createElement("tbody",null,h.map((({key:e,value:t})=>n.createElement("tr",{key:e},n.createElement("td",{className:"image-meta-form__meta-cell image-meta-form__meta-cell--key"},e),n.createElement("td",{className:"image-meta-form__meta-cell image-meta-form__meta-cell--value"},t)))))))};!function(e){e.PALETTE="pal",e.FRAME="frame",e.TAGS="tags",e.MISC="misc"}(Ps||(Ps={}));var Ts=function(e){const t=[e.mixedTypes?null:Ps.PALETTE,e.regularImage?Ps.FRAME:null,Ps.TAGS,Ps.MISC].reduce(Gr.N,[]),[a,r]=(0,n.useState)(t[0]),[l,s]=(0,n.useState)(0),F=e=>()=>{r(e),s(t.findIndex((t=>t===e)))};return n.createElement("div",{className:"edit-image-tabs"},n.createElement("ul",{className:"edit-image-tabs__list",style:{marginLeft:`-${100*l}%`}},t.includes(Ps.PALETTE)?n.createElement("li",{className:o()("edit-image-tabs__tab",{"edit-image-tabs__tab--active":"pal"===a}),onFocus:F(Ps.PALETTE),onClick:F(Ps.PALETTE)},e.paletteRGBN?n.createElement(n.Fragment,null,n.createElement("button",{type:"button",className:"edit-image-tabs__button"},"Edit Greytones"),n.createElement(bs,{values:e.paletteRGBN,onChange:e.updatePalette,useChannels:{r:!!e.hashes?.r,g:!!e.hashes?.g,b:!!e.hashes?.b,n:!!e.hashes?.n}})):n.createElement(n.Fragment,null,n.createElement("button",{type:"button",className:"edit-image-tabs__button"},"Select Palette"),n.createElement(vs,{value:e.paletteShort||"",invertPalette:e.invertPalette,onChange:e.updatePalette,updateInvertPalette:e.updateInvertPalette}))):null,t.includes(Ps.FRAME)?n.createElement("li",{className:o()("edit-image-tabs__tab",{"edit-image-tabs__tab--active":a===Ps.FRAME}),onFocus:F(Ps.FRAME),onClick:F(Ps.FRAME)},n.createElement("button",{type:"button",className:"edit-image-tabs__button"},"Select Frame"),n.createElement(os,{updateFrame:e.updateFrame,updateFrameLock:e.updateFrameLock,frame:e.frame||"",lockFrame:e.lockFrame}),e.lockFrame&&!e.paletteRGBN?n.createElement(vs,{value:e.framePaletteShort||"",invertPalette:e.invertFramePalette,onChange:e.updateFramePalette,updateInvertPalette:e.updateInvertFramePalette}):null):null,t.includes(Ps.TAGS)?n.createElement("li",{className:o()("edit-image-tabs__tab",{"edit-image-tabs__tab--active":a===Ps.TAGS}),onFocus:F(Ps.TAGS),onClick:F(Ps.TAGS)},n.createElement("button",{type:"button",className:"edit-image-tabs__button"},"Tags"),n.createElement(As,{updateTags:e.updateTags,tags:e.tags})):null,t.includes(Ps.MISC)?n.createElement("li",{className:o()("edit-image-tabs__tab",{"edit-image-tabs__tab--active":a===Ps.MISC}),onFocus:F(Ps.MISC),onClick:F(Ps.MISC)},n.createElement("button",{type:"button",className:"edit-image-tabs__button"},"Misc"),n.createElement(xs,{created:e.created,hash:e.hash,hashes:e.hashes,updateCreated:e.updateCreated,meta:e.meta,rotation:e.rotation,updateRotation:e.updateRotation})):null))},Ds=a(8137);var Bs=({initial:e,add:t,remove:a})=>(0,Ge.A)([...e,...t]).filter((e=>!a.includes(e)));var Rs=()=>{const{editImages:e,cancelEditImages:t}=N(),{sortBy:a}=(0,h.A)(),{images:r}=(0,E.h)(),{updateImages:l}=G();return{batchUpdateImages:(0,n.useCallback)((({shouldUpdate:n,updates:s,tagChanges:F})=>{const o=(0,Ds.PM)(a),i=e?.batch||[];if(n&&i?.length){const e=i.reduce(((e,t)=>{const a=r.find((({hash:e})=>e===t));return a?[...e,a]:e}),[]).map(Ds.YZ).sort(o).map(Ds.lt).map(((e,t)=>Me.reduce(((e,a)=>{if(!n[a])return e;switch(a){case Be.TITLE:return{...e,title:s.title.replace(/%(n+)/gi,((e,a)=>(t+1).toString(10).padStart(a.length,"0")))};case Be.TAGS:{const t=Bs({...F,initial:e.tags});return{...e,tags:t}}case Be.ROTATION:case Be.LOCK_FRAME:case Be.FRAME:case Be.CREATED:return{...e,[a]:s[a]}}if((0,Ne.pl)(e)){const t=e;return a===Be.PALETTE?{...t,palette:s.palette}:t}{const t=e;switch(a){case Be.PALETTE:case Re.FRAME_PALETTE:case Re.INVERT_FRAME_PALETTE:case Re.INVERT_PALETTE:return{...t,[a]:s[a]};default:return t}}}),e)));l(e)}t()}),[t,e?.batch,r,a,l])}};var Ls=a(6763);var Ms=function(){const{toEdit:e,form:t,isRegularImage:a,willUpdateBatch:r,tagChanges:l,usedPalette:s,usedFramePalette:F,updateForm:o,updatePalette:i,updateFramePalette:c,updateTags:m,save:u,cancel:d}=(()=>{const{editImages:e,cancelEditImages:t}=N(),{palettes:a,frames:r,images:l}=(0,E.h)(),{batchUpdateImages:s}=Rs(),F=e=>a.find((t=>e===t.shortName))||X.Fv,o=(0,S.p)(l,r),{windowDimensions:i}=(0,w.A)(),c=(0,n.useMemo)((()=>{if(!e)return;const t=e.batch||[],a=e.tags||[];if(!t[0])return;const n=l.find((({hash:e})=>e===t[0]));if(!n)return;const r=i.width<=600?i.height:Math.min(900,i.height),s=t.reduce(((e,t)=>{const a=l.find((({hash:e})=>e===t));if(!a)return e;const n=(0,Ne.pl)(a);return{mono:e.mono||!n,rgb:e.rgb||n}}),{mono:!1,rgb:!1}),F=s.mono&&s.rgb,o=(0,Ne.pl)(n)?n.palette:void 0,c=(0,Ne.pl)(n)?void 0:n.palette,m=(0,Ne.pl)(n)?void 0:n.framePalette;return{created:n.created,hash:n.hash,height:r,imageCount:t?.length||0,invertPalette:n.invertPalette||!1,invertFramePalette:n.invertFramePalette||!1,lockFrame:n.lockFrame||!1,mixedTypes:F,tags:a,title:n.title,frame:n.frame,hashes:(0,Ne.pl)(n)?n.hashes:void 0,meta:n.meta,paletteRGBN:o,paletteShort:c,framePaletteShort:m,rotation:n.rotation}}),[e,l,i]),[m,u]=(0,n.useState)(c?.title||""),[d,p]=(0,n.useState)(c?.created||""),[g,h]=(0,n.useState)(c?.frame||""),[f,b]=(0,n.useState)(c?.lockFrame),[v,_]=(0,n.useState)(c?.rotation),[y,k]=(0,n.useState)(c?.invertPalette),[C,A]=(0,n.useState)(c?.invertFramePalette),[I,P]=(0,n.useState)(c?.paletteShort||""),[x,T]=(0,n.useState)(c?.framePaletteShort||""),[D,B]=(0,n.useState)(c?.paletteRGBN),[R,L]=(0,n.useState)(!1),M={title:m,created:d,frame:g,lockFrame:f,rotation:v,invertPalette:y,paletteShort:I,framePaletteShort:x,invertFramePalette:C,paletteRGBN:D},G=D||F(I).palette,V=F(x).palette,$=c?.hash;(0,n.useEffect)((()=>{(async()=>{if(!$)return;const e=await o($);L(360===e)})()}),[o,$]);const[O,U]=(0,n.useState)({initial:c?.tags||[],add:[],remove:[]}),[z,H]=(0,n.useState)({created:!1,title:!1,frame:!1,lockFrame:!1,tags:!1,rotation:!1,palette:!1,invertPalette:!1,framePalette:!1,invertFramePalette:!1});return{toEdit:c,form:M,isRegularImage:R,shouldUpdate:z,willUpdateBatch:(W=z,[W.created?"Date":"",W.title?"Title":"",W.palette?"Image palette colors":"",W.invertPalette?"Invert image palette":"",W.frame?"Frame":"",W.lockFrame?"Separate frame settings":"",W.framePalette?"Frame palette colors":"",W.invertFramePalette?"Invert frame palette":"",W.tags?"Tags":"",W.rotation?"Rotation":""].filter(Boolean)),tagChanges:O,usedPalette:G,usedFramePalette:V,updateForm:e=>t=>{switch(H({...z,[e]:!0}),e){case"title":u(t);break;case"created":p(t);break;case"invertPalette":k(t);break;case"invertFramePalette":A(t);break;case"framePalette":T(t);break;case"frame":h(t);break;case"lockFrame":b(t);break;case"rotation":_(t)}},updatePalette:(e,t)=>{t&&H({...z,palette:!0}),I?P(e):B(e)},updateFramePalette:(e,t)=>{t&&H({...z,framePalette:!0}),T(e)},updateTags:(e,t)=>{H({...z,tags:!0}),U({...O,...ks(O,{mode:e,tag:t})})},save:()=>{s({shouldUpdate:z,updates:{title:m,created:d,frame:g,lockFrame:f,rotation:v,palette:D||I,invertPalette:y||!1,framePalette:x,invertFramePalette:C||!1},tagChanges:O})},cancel:()=>t()};var W})();if(!e)return Ls.warn('Editform should be open, but "toEdit" is undefined',e),null;const{title:p,created:g,frame:h,lockFrame:f,rotation:b,invertPalette:v,invertFramePalette:_,framePaletteShort:y,paletteShort:k,paletteRGBN:C}=t;return n.createElement(Ul,{height:e.height,className:"edit-image",confirm:()=>u(),deny:d},n.createElement("label",{className:"edit-image__header"},n.createElement("input",{className:"edit-image__header-edit",placeholder:"Add a title",value:p,onChange:({target:{value:e}})=>{o("title")(e)}})),e.imageCount?n.createElement("span",{className:"edit-image__title-hint"},"Use %n (or %nn, %nnn, ...) to add an index to the image titles"):null,n.createElement(Ee,{lockFrame:f,invertPalette:v,palette:s,invertFramePalette:_,framePalette:F,frameId:h,hash:e.hash,hashes:e.hashes,rotation:b}),e.imageCount>1?n.createElement("div",{className:"edit-image__batch-warn"},n.createElement("h2",{className:"edit-image__batch-update-title"},`You are editing ${e.imageCount} images`),r.length?n.createElement(n.Fragment,null,n.createElement("p",{className:"edit-image__batch-update-list"},"Will update:"),n.createElement("ul",{className:"edit-image__batch-update-list"},r.map(((e,t)=>n.createElement("li",{key:t},e))))):null):null,n.createElement(Ts,{created:g,updateCreated:o("created"),regularImage:a,mixedTypes:e.mixedTypes,lockFrame:f,hash:e.hash,hashes:e.hashes,paletteShort:k,framePaletteShort:y,paletteRGBN:C,invertPalette:v,invertFramePalette:_,frame:h,tags:l,meta:e.meta,rotation:b,updatePalette:i,updateInvertPalette:o("invertPalette"),updateFramePalette:c,updateInvertFramePalette:o("invertFramePalette"),updateFrame:o("frame"),updateFrameLock:o("lockFrame"),updateRotation:o("rotation"),updateTags:m}))};var Gs=function(){const{editId:e,absoluteSlug:t,possibleParents:a,slug:r,title:l,canConfirm:s,parentSlug:F,setSlug:i,setTitle:c,setParentSlug:m,confirm:u,cancelEditImageGroup:d}=K();return n.createElement(Ul,{className:"edit-image-group",confirm:u,canConfirm:s,header:e!==Y?"Editing group "+(l?`"${l}"`:""):"Create new image group",deny:d},n.createElement("div",{className:"edit-image-group__content"},e?n.createElement(n.Fragment,null,n.createElement(pt,{id:"title",labelText:"Title / Description",value:l,onChange:c,type:dt.TEXT}),n.createElement(pt,{id:"slug",labelText:"Pathsegment / Identifier",value:r,onChange:i,type:dt.TEXT},n.createElement("p",{className:o()("edit-image-group__text",{"edit-image-group__text--error":!s})},`Full Path: "${t}"`)),e===Y?null:n.createElement(Ye,{id:"paths",label:"Parent group",options:a,setSelected:m,value:F,disabled:!1})):n.createElement("p",null,`A group with the ID '${e}' does not exist!`)))};var Vs=e=>{const t=e?.id||"",{cancelEditFrame:a}=N(),{frames:r}=(0,E.h)(),{frameGroups:l,addFrames:s}=(0,E.h)(),{updateLastSyncLocalNow:F}=G(),o=(0,Ur.A)(r,l),i=/^(?<groupName>[a-z]+)(?<id>[0-9]+)/g.exec(t),c=i?.groups?.groupName||"",m=i?.groups?.id||"0",[u,d]=(0,n.useState)(c),[p,g]=(0,n.useState)(parseInt(m,10)),[h,f]=(0,n.useState)(e?.name||""),b=`${u}${p.toString(10).padStart(2,"0")}`,v=b===t||!r.find((e=>b===e.id)),_=Boolean(u.match(/^[a-z]{2,}$/g)),y=p>0;return{groups:o,updateId:t,fullId:b,frameIndex:p,frameGroup:u,frameName:h,idValid:v,formValid:v&&_&&y,groupIdValid:_,frameIndexValid:y,setFrameIndex:g,setFrameGroup:d,setFrameName:f,saveFrame:()=>{a(),F(),s([{hash:e?.hash||"",id:b,name:h}])},cancelEdit:a}};var $s=function({frameIndex:e,setFrameIndex:t,frameName:a,setFrameGroup:r,setFrameName:l,idValid:s,groupIdValid:F,frameIndexValid:o,frameGroup:i,groups:c,fullId:m,frameGroupName:u,setFrameGroupName:d}){const p=Boolean(c.find((({id:e})=>i===e)));return n.createElement(n.Fragment,null,n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"frame-edit-group",className:"inputgroup__label"},"Frame group"),n.createElement("select",{id:"frame-edit-group",className:"inputgroup__input inputgroup__input--select",value:i,onChange:e=>{r(e.target.value)}},n.createElement("option",{value:""},p?"Select frame group":"New frame group"),c.map((({id:e,name:t})=>n.createElement("option",{value:e,key:e},t))))),n.createElement(pt,{id:"frame-edit-new-group",labelText:p?"Frame group id":"New frame group id",type:dt.TEXT,value:i,onChange:r},F?null:n.createElement("span",{className:"inputgroup__note inputgroup__note--warn"},"Must have at least two characters, only lowercase")),d?n.createElement(pt,{id:"frame-edit-new-group-name",labelText:"New frame group name",disabled:p,type:dt.TEXT,value:p?"":u,onChange:d}):null,n.createElement(pt,{id:"frame-edit-index",labelText:"Frame Index",type:dt.NUMBER,min:1,max:99,value:e,onChange:e=>t(parseInt(e,10))},o?null:n.createElement("span",{className:"inputgroup__note inputgroup__note--warn"},"Integer, must be greater 0")),n.createElement(pt,{id:"frame-edit-shortname",labelText:"Frame name",type:dt.TEXT,value:a,onChange:l}),n.createElement("p",{className:"edit-frame__warning"},s?" ":`Specified frame index/identifier "${m}" is already in use, please try another one.`))};var Os=()=>{const{editFrame:e}=N(),{frames:t}=(0,E.h)(),a=t.find((({id:t})=>t===e)),{cancelEdit:r,saveFrame:l,updateId:s,fullId:F,formValid:o,groups:i,frameGroup:c,frameIndex:m,setFrameIndex:u,frameName:d,setFrameGroup:p,setFrameName:g,idValid:h,groupIdValid:f,frameIndexValid:b}=Vs(a),v=s!==F?` -> "${F}"`:"";return n.createElement(Ul,{className:"edit-frame",confirm:l,canConfirm:o,header:a?`Editing frame "${s}"${v}`:`Error editing '${e}'`,deny:r},n.createElement("div",{className:"edit-frame__content"},a?n.createElement($s,{groups:i,fullId:F,frameIndex:m,frameGroup:c,frameName:d,idValid:h,groupIdValid:f,frameIndexValid:b,setFrameIndex:u,setFrameGroup:p,setFrameName:g}):n.createElement("p",null,`A frame with the ID '${e}' does not exist!`)))};const Us=(0,oe.A)("hash");var zs=(e,t,a)=>()=>{const n=a.map((t=>e.find((({hash:e})=>e===t)))).reduce(Ne.iy,[]),r=n.length>1?[]:(0,B.S)(e,t).reduce(Ne.iy,[]),l=n.length+r.length>1?[]:[...e].map(Ds.YZ).sort((0,Ds.PM)(t.sortBy)).map(Ds.lt).reduce(Ne.iy,[]),s=Us([n.shift(),r.shift(),l.shift(),l.pop(),r.pop(),n.pop()].reduce(Ne.iy,[]));return[s.shift(),s.pop()].reduce(Ne.iy,[])};const Hs=()=>{const{imageSelection:e,sortBy:t,filtersActiveTags:a,recentImports:r}=(0,h.A)(),{editPalette:l,cancelEditPalette:s}=N(),{images:F,palettes:o,addPalettes:i}=(0,E.h)(),{updateLastSyncLocalNow:c}=G(),m=l?.shortName||"",u=l?.palette||[],d=l?.name||"",p=m===ve.m,[g,f]=(0,n.useState)(d),[b,v]=(0,n.useState)(u),[_,y]=(0,n.useState)(p?"":m),w=!p||!!(k=_).match(/^[a-z]+[a-z0-9]*$/gi)&&-1===o.findIndex((e=>e.shortName===k));var k;const C=(0,n.useMemo)((()=>zs(F,{sortBy:t,filtersActiveTags:a,recentImports:r},e)()),[a,e,F,r,t]),A=()=>(i([{shortName:p?_:m,name:g,palette:b,origin:"Made with the webapp",isPredefined:!1}]),c(),void s());return(0,n.useEffect)((()=>{const e=e=>{"Enter"===e.key&&e.ctrlKey&&w&&A()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)})),{canConfirm:w,canEditShortName:p,newName:g,newShortName:_,palette:b,previewImages:C,shortName:m,setNewName:f,setNewShortName:y,setPalette:v,save:A,cancelEditPalette:s}};var Ws=function(){const{canConfirm:e,canEditShortName:t,newName:a,newShortName:r,palette:l,previewImages:s,shortName:F,setNewName:o,setNewShortName:i,setPalette:c,save:m,cancelEditPalette:u}=Hs();return F?n.createElement(Ul,{className:"edit-palette",confirm:m,canConfirm:e,deny:()=>u(),closeOnOverlayClick:!1},n.createElement("label",{className:"edit-palette__header"},n.createElement("input",{className:"edit-palette__header-edit",placeholder:"Add a title",value:a,onChange:e=>{o(e.target.value)}})),n.createElement("div",{className:"edit-palette__content"},n.createElement(pt,{id:"palette-edit-shortname",labelText:"ID/Short name",type:dt.TEXT,value:r,disabled:!t,onChange:e=>{i(e.toLowerCase())}}),n.createElement("ul",{className:"edit-palette__previews"},s.map((e=>n.createElement("li",{className:"edit-palette__preview-image",key:e.hash},n.createElement(Ee,{hash:e.hash,invertPalette:!1,invertFramePalette:!1,lockFrame:!1,palette:l,framePalette:l}))))),l.map(((e,t)=>n.createElement(pt,{key:t,id:`palette-color-${t}`,labelText:`Color ${t+1}`,type:dt.COLOR,value:e,onChange:e=>{const a=[...l];a[t]=e,c(a)}}))))):null},Xs=a(4802),js=a.n(Xs);var Ys,Zs=()=>{const{setImageSelection:e}=(0,h.A)(),{addImages:t}=G();return{saveRGBNImage:(0,n.useCallback)((async n=>{const{default:r}=await Promise.resolve().then(a.t.bind(a,4802,23)),l=u()(),s=n.map(((e,t)=>({palette:X.YP,hashes:e,hash:r(e),created:l.add(t,"milliseconds").format(X.i$),title:"",tags:[]})));t(s),e(s.map((e=>e.hash)))}),[t,e])}};!function(e){e.BY_COLOR="BY_COLOR",e.BY_IMAGE="BY_IMAGE",e.MANUAL="MANUAL"}(Ys||(Ys={}));var Qs=function({isR:e,isG:t,isB:a,isN:r,toggleChannel:l}){const s=[{value:e,cssModifier:"red",updateKey:"r"},{value:t,cssModifier:"green",updateKey:"g"},{value:a,cssModifier:"blue",updateKey:"b"},{value:r,cssModifier:"normal",updateKey:"n"}];return n.createElement("div",{className:"rgbn-select",onClick:e=>{e.stopPropagation()},role:"presentation"},s.map((({value:e,cssModifier:t,updateKey:a})=>n.createElement("button",{type:"button",key:a,className:o()(`rgbn-select__button rgbn-select__button--${t}`,{"rgbn-select__button--selected":e}),onClick:()=>l(a)},n.createElement(g,{name:"circle"})))))};function Ks(e,t,a,n){const r=e?255:0,l=t?255:0,s=a?255:0,F=(e,t,a,n)=>{const r=(e,t)=>Math.floor(e*t).toString(16).padStart(2,"0");return`#${r(e,n)}${r(t,n)}${r(a,n)}`};return e||t||a?[F(r,l,s,1),F(r,l,s,.66),F(r,l,s,.33),"#000000"]:n?["#ffffff","#aaaaaa","#555555","#000000"]:["#b2b2b2","#949494","#737373","#606060"]}var qs=function(){const{canConfirm:e,order:t,grouping:a,lengthWarning:r,rgbnHashes:l,sortedImages:s,createGroup:F,updateOrder:i,toggleSingleChannel:c,setGrouping:m,setCreateGroup:d,save:p,cancelEditRGBNImages:f}=(()=>{const e=(0,H.Zp)(),{view:t}=z(),{saveRGBNImage:a}=Zs(),{sortBy:r}=(0,h.A)(),{editRGBNImages:l,cancelEditRGBNImages:s,cancelEditImageGroup:F}=N(),{addImageGroup:o,images:i}=(0,E.h)(),[c,m]=(0,n.useState)(l.length>5),d=r.split("_")[1],p=(0,n.useMemo)((()=>{const e=(0,B.S)(i,{filtersActiveTags:[],sortBy:r,recentImports:[]});return"desc"===d&&e.reverse(),e.reduce(Ne.iy,[]).reduce(((e,t)=>l.includes(t.hash)?[...e,t]:e),[])}),[l,d,i,r]),[g,f]=(0,n.useState)(["r","g","b","s","n"]),[b,v]=(0,n.useState)(p.length<=4?Ys.MANUAL:Ys.BY_COLOR),[_,y]=(0,n.useState)({r:p[0]?.hash||void 0,g:p[Math.floor(p.length/3)]?.hash||void 0,b:p[2*Math.floor(p.length/3)]?.hash||void 0}),w=g.findIndex((e=>"s"===e)),k=Math.ceil(l.length/w),C=w*k!==l.length,A=(0,n.useMemo)((()=>{switch(b){case Ys.MANUAL:return Object.keys(_).length?[_]:[];case Ys.BY_COLOR:case Ys.BY_IMAGE:default:{const e=g.slice(0,w),t=Array(k).fill("").map(((t,a)=>e.reduce(((e,t,n)=>{const r=b===Ys.BY_COLOR?a+k*n:n+w*a,l=p[r]?.hash;return l?{...e,[t]:l}:e}),{})));return"desc"===d&&t.reverse(),t}}}),[k,d,b,_,g,p,w]),S=b===Ys.MANUAL;return{order:g,grouping:b,canConfirm:S?A.length>0:g.length>1,lengthWarning:!S&&C,rgbnHashes:A,sortedImages:p,createGroup:c,updateOrder:(e,t)=>{if(t<0||t>g.length)return;const a=g.filter((t=>t!==e));a.splice(t,0,e).filter(Boolean),f(a)},toggleSingleChannel:(e,t)=>{const a={..._};a[e]===t?delete a[e]:a[e]=t,y(a)},setGrouping:v,save:()=>{if(s(),a(A),c){const a=`RGB ${u()().format(X.i$)}`,n=Z(a),r=A.map((e=>js()(e)));F(),o({id:W(),slug:n,title:a,created:u()(Date.now()).format(X.i$),coverImage:r[0],images:r,groups:[]},t.id),e(`/gallery/${t.slug}${n}/page/1`)}},setCreateGroup:m,cancelEditRGBNImages:s}})();return n.createElement(Ul,{className:"edit-rgbn",confirm:p,deny:f,closeOnOverlayClick:!1,canConfirm:e&&!r,header:"Create RGBN images"},n.createElement("div",{className:"edit-rgbn__content"},n.createElement(Ye,{id:"select-grouping",disabled:!1,value:a,label:"Select how your selection is grouped.",options:[{value:Ys.BY_COLOR,name:"Selection is grouped by colors (RRR GGG BBB)"},{value:Ys.BY_IMAGE,name:"Selection is grouped by image (RGB RGB RGB)"},{value:Ys.MANUAL,name:"Manual selection for single image"}],setSelected:e=>m(e)}),a===Ys.MANUAL?n.createElement(n.Fragment,null,n.createElement("p",{className:"edit-rgbn__info-text"},"Manually select the channels to create a single RGBN image."),n.createElement("ul",{className:"edit-rgbn__single-image-list"},s.map((({hash:e})=>{const t=l[0]?.r===e,a=l[0]?.g===e,r=l[0]?.b===e,s=l[0]?.n===e;return n.createElement("li",{key:e,className:"edit-rgbn__single-image-list-entry"},n.createElement(Ee,{lockFrame:!1,invertPalette:!1,invertFramePalette:!1,palette:Ks(t,a,r,s),framePalette:Ks(t,a,r,s),hash:e}),n.createElement(Qs,{isR:t,isG:a,isB:r,isN:s,toggleChannel:t=>c(t,e)}))})))):n.createElement(n.Fragment,null,n.createElement("p",{className:"edit-rgbn__info-text"},"Select the order of channels to be applied (in the order of images taken). Channels to the right of the separator will not be used."),n.createElement("ul",{className:"edit-rgbn__order-list"},t.map(((e,t)=>"s"===e?n.createElement("li",{key:e,className:"edit-rgbn__order-list-entry edit-rgbn__order-list-entry--separator"}):n.createElement("li",{key:e,className:`edit-rgbn__order-list-entry edit-rgbn__order-list-entry--${e}`},n.createElement("button",{className:"edit-rgbn__order-list-button",type:"button",onClick:()=>i(e,t-1)},n.createElement(g,{name:"left"})),n.createElement("button",{className:"edit-rgbn__order-list-button",type:"button",onClick:()=>i(e,t+1)},n.createElement(g,{name:"right"})))))),r?n.createElement("p",{className:"edit-rgbn__info-text edit-rgbn__info-text--warning"},"Warning: Your distribution of channels and number of selected images does not add up!"):null,n.createElement("p",{className:"edit-rgbn__info-text"},"Preview the RGBN images that will be created:")),n.createElement("ul",{className:"edit-rgbn__image-list"},l.map(((e,t)=>n.createElement("li",{className:"edit-rgbn__image-list-entry",key:t},n.createElement(Ee,{lockFrame:!1,invertPalette:!1,invertFramePalette:!1,palette:X.YP,framePalette:[],hash:"newRGBN",hashes:e}))))),n.createElement("label",{className:o()("import-overlay__checkgroup inputgroup checkgroup",{"checkgroup--checked":F})},n.createElement("span",{className:"inputgroup__label",title:"Create group from images"},"Create group from created images"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:F,onChange:({target:e})=>{d(e.checked)}}),n.createElement(g,{name:"checkmark"})))))};var Js=[{id:ee.H.FRAMEMODE_KEEP,name:"Keep frame"},{id:ee.H.FRAMEMODE_CROP,name:"Crop frame"},{id:ee.H.FRAMEMODE_SQUARE_BLACK,name:"Make image squared (add black)"},{id:ee.H.FRAMEMODE_SQUARE_WHITE,name:"Make image squared (add white)"}],eF=a(4399),tF=a(4213);const aF=e=>({scaleFactor:e.scaleFactor||4,frameRate:e.frameRate||12,yoyo:e.yoyo||!1,reverse:e.reverse||!1,frame:e.frame||"",lockFrame:e.lockFrame||!1,invertPalette:e.invertPalette||!1,palette:e.palette||"",exportFrameMode:e.exportFrameMode||ee.H.FRAMEMODE_KEEP}),nF=async()=>{const{setProgress:e,setError:t,videoSelection:a}=w.A.getState(),{frames:n,palettes:r,images:l}=E.h.getState(),{videoParams:s}=i.A.getState();e("gif",.01);const{scaleFactor:F,frameRate:o,yoyo:c,reverse:m,frame:u,lockFrame:d,invertPalette:p,palette:g,exportFrameMode:h}=aF(s);if(!a.length)return;const f=a.map((e=>l.find((({hash:t})=>t===e)))).reduce(Gr.N,[]),b=f.reduce(((e,t)=>{if(!t)return e;const a=(0,Ne.pl)(t)?{...t,frame:u||t.frame}:{...t,palette:g||t.palette};return[...e,a]}),[]),v=(0,S.T)(f,n),_=await Promise.all(b.map((async e=>{const t=await v(e.hash),a=d||e.lockFrame||!1,l=e.rotation||0,{palette:s,framePalette:o}=(0,I.s)(r,{...e,lockFrame:a}),i=n.find((({id:t})=>t===e.frame)),c=i?await(0,P.mZ)(i.hash):null,m=c?c.upper.length/20:2;if(!t||!s)throw new Error("missing tiles or palette");let u;if((0,Ne.pl)(e))u=new ee.Wd,u.update({canvas:null,tiles:t,palette:s,lockFrame:a});else{u=new ee.XM;const n=s?.palette||ee.CU,r=o?.palette||ee.CU,l=p||e.invertPalette||!1,F=p||e.invertFramePalette||!1,i=(0,ae.A)({palette:n,invertPalette:l,framePalette:a?r:n,invertFramePalette:a?F:l});u.update({canvas:null,tiles:t,...i,imageStartLine:m})}return(0,te.Ej)(u.getScaledCanvas(F||1,h),l)})));if(1!==(0,Ge.A)(_.map((e=>`${e.width}*${e.height}`))).length)return e("gif",0),void t(new Error("All images need to have same dimensions"));const y=[],N=new(Vt())(1,1/0),k=new eF.e(y,_[0].width,_[0].height,{loop:65535});if(c){const e=[..._].reverse();e.shift(),e.pop(),_.push(...e)}m&&_.reverse();const C=((e,t,a,n)=>(r,l)=>t.add((()=>new Promise(((t,s)=>{const F=r.getContext("2d");if(!F)throw new Error("missing context");const{data:o}=F.getImageData(0,0,r.width,r.height),{palette:i,pixels:c}=Mt()(o,4).reduce(((e,[t,a,n])=>{const r=(t<<16)+(a<<8)+n;let l=e.palette.findIndex((e=>e===r));return-1===l&&(l=e.palette.length,e.palette.push(r)),e.pixels.push(l),e}),{pixels:[],palette:[]});for(;i.length<256;)i.push(0);try{w.A.getState().setProgress("gif",(l+1)/n),window.requestAnimationFrame((()=>{e.addFrame(0,0,r.width,r.height,c,{delay:Math.round(100/a),palette:i}),t(null)}))}catch(e){s(e)}})))))(k,N,o,_.length);await Promise.all(_.map(C));const x=(0,A.A)({useCurrentDate:!0,exportScaleFactor:F,frameRate:o,altTitle:"animated",frameName:u,paletteShort:g}),T=k.end();let D;try{D=new File([new Uint8Array(y.slice(0,T)).buffer],`${x}.gif`,{type:"image/gif"})}catch(e){D=new Blob([new Uint8Array(y.slice(0,T)).buffer])}(0,tF.saveAs)(D,`${x}.gif`),e("gif",0)};var rF=function(){const{update:e,cancel:t,imageCount:a,animate:r,videoParams:l}=(()=>{const{videoParams:e,setVideoParams:t}=(0,i.A)(),{videoSelection:a,setVideoSelection:n}=(0,w.A)(),r=aF(e);return{imageCount:a.length||0,videoParams:r,update:t,cancel:()=>{n([])},animate:()=>{nF(),n([])}}})();return a?n.createElement(Ul,{className:"video-params",confirm:r,deny:t,header:`Create an animated GIF with ${a} frames`},n.createElement(pt,{id:"video-params-frameRate",labelText:"Framerate",type:dt.NUMBER,min:1,max:120,value:l.frameRate,onChange:t=>{e({frameRate:parseInt(t,10)})}}),n.createElement(pt,{id:"video-params-scaleFactor",labelText:"Scale GIF",type:dt.NUMBER,min:1,max:12,value:l.scaleFactor,onChange:t=>{e({scaleFactor:parseInt(t,10)})}}),n.createElement("label",{className:o()("video-params__check-label",{"video-params__check-label--checked":l.yoyo}),title:"Enable Yoyo-Effect (loop back to the beginning)"},n.createElement("input",{type:"checkbox",className:"video-params__checkbox",checked:l.yoyo,onChange:t=>{e({yoyo:t.target.checked})}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"video-params__check-label-text"},"Yoyo-Effect")),n.createElement("label",{className:o()("video-params__check-label",{"video-params__check-label--checked":l.reverse}),title:"Reverse animation direction"},n.createElement("input",{type:"checkbox",className:"video-params__checkbox",checked:l.reverse,onChange:t=>{e({reverse:t.target.checked})}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"video-params__check-label-text"},"Reverse Direction")),n.createElement("div",{className:"video-params__select-label"},"Palette"),n.createElement(vs,{noFancy:!0,allowEmpty:!0,value:l.palette||"",invertPalette:l.invertPalette,onChange:t=>{e({palette:t})},updateInvertPalette:t=>{e({invertPalette:t})}}),n.createElement("label",{htmlFor:"settings-handle-export-frames",className:"video-params__select-label"},"How to handle frames when exporting images"),n.createElement("select",{id:"settings-handle-export-frames",className:"video-params__frameexport-select",value:l.exportFrameMode,onChange:t=>{e({exportFrameMode:t.target.value})}},Js.map((({id:e,name:t})=>n.createElement("option",{value:e,key:e},t)))),"crop"===l.exportFrameMode?null:n.createElement(n.Fragment,null,n.createElement("div",{className:"video-params__select-label"},"Frame"),n.createElement(os,{frame:l.frame||"",lockFrame:l.lockFrame,noFrameOption:"As selected per image",updateFrame:t=>{e({frame:t})},updateFrameLock:t=>{e({lockFrame:t})}}))):null},lF=a(1916),sF=a.n(lF);const FF=()=>{const e=(0,h.A)(),{view:t,covers:a}=z(),{isFullscreen:r,setLightboxImage:l,setLightboxImagePrev:s,setLightboxImageNext:F,setIsFullscreen:o,lightboxImage:c}=(0,w.A)(),{preferredLocale:m}=(0,i.A)(),{palettes:u}=(0,E.h)(),d=(0,B.S)(t.images,e),p=(0,n.useMemo)((()=>d.filter((({hash:e})=>!a.includes(e)))),[a,d]),g=null!==c?((e,t)=>{let a;if(!e?.hash)return null;a=(0,Ne.pl)(e)?e.palette:(t.find((({shortName:t})=>t===e.palette))||X.Fv).palette;const n=(t.find((({shortName:t})=>t===e.framePalette))||X.Fv).palette;return{title:e?.title||"",created:e?.created||"",frame:e.frame,hash:e.hash,hashes:e.hashes||void 0,tags:e.tags,palette:a,framePalette:n,lockFrame:e.lockFrame,invertPalette:e.invertPalette,invertFramePalette:e.invertFramePalette,rotation:e.rotation}})(p[c],u):null;return(0,n.useEffect)((()=>{const e=()=>{o(!!sF().element)},t=e=>{switch(e.key){case"Esc":case"Escape":close(),e.preventDefault();break;case"Right":case"ArrowRight":F(p.length),e.preventDefault();break;case"Left":case"ArrowLeft":s(),e.preventDefault()}};return document.addEventListener("keydown",t),sF().isEnabled&&sF().on("change",e),()=>{document.removeEventListener("keydown",t),sF().off("change",e)}})),{image:g,isFullscreen:r,currentIndex:c||-1,size:p.length,canPrev:null!==c&&c>0,canNext:null!==c&&c<p.length-1,preferredLocale:m,close:()=>l(null),prev:()=>s(),next:()=>F(p.length),fullscreen:()=>{sF().isEnabled&&(sF().element?sF().exit():sF().request(document.body))}}};var oF=function(){const{image:e,isFullscreen:t,currentIndex:a,size:r,preferredLocale:l,canPrev:s,canNext:F,prev:o,next:i,fullscreen:c,close:m}=FF();return n.createElement(Ul,{className:"lightbox-image",deny:m},n.createElement("h2",{className:"lightbox-image__header"},n.createElement("span",{className:"lightbox-image__title"},e?.title),n.createElement("span",{className:"lightbox-image__counter"},`${a+1}/${r}`),n.createElement("button",{type:"button",className:"lightbox-image__button lightbox-image__header-button lightbox-image__button--fullscreen",onClick:c,title:t?"Leave fullscreen":"Enter fullscreen"},n.createElement(g,{name:t?"fullscreen-off":"fullscreen-on"})),n.createElement("button",{type:"button",className:"lightbox-image__button lightbox-image__header-button lightbox-image__button--close",onClick:m,title:"Close"},n.createElement(g,{name:"close"}))),e?n.createElement(Ee,{lockFrame:e.lockFrame,invertPalette:e.invertPalette,invertFramePalette:e.invertFramePalette,palette:e.palette,framePalette:e.framePalette,frameId:e.frame,hash:e.hash,hashes:e.hashes,rotation:e.rotation}):null,n.createElement("div",{className:"lightbox-image__navigation"},s?n.createElement("button",{type:"button",className:"lightbox-image__button lightbox-image__nav-button lightbox-image__button--left",onClick:o},n.createElement(g,{name:"left"})):null,F?n.createElement("button",{type:"button",className:"lightbox-image__button lightbox-image__nav-button lightbox-image__button--right",onClick:i},n.createElement(g,{name:"right"})):null),n.createElement("div",{className:"lightbox-image__created"},(0,fe.A)(u()(e?.created,X.i$),l)))};var iF,cF=function(){const{dragover:e}=(0,w.A)();return e?n.createElement("div",{className:"drag-over"}):null};!function(e){e.ADD="add",e.REMOVE="remove"}(iF||(iF={}));var mF=function({tagActive:e,toggleTag:t,title:a,icon:r}){return n.createElement("li",{title:a,className:o()("filter-form__tag",{"filter-form__tag--active":e})},n.createElement("button",{className:"filter-form__tag-button",type:"button",onClick:()=>t(e?iF.REMOVE:iF.ADD)},n.createElement(g,{name:r||"checkmark"}),n.createElement("span",{className:"filter-form__tag-text"},a)))};var uF=function(){const{visible:e,availableTags:t,activeTags:a,updateActiveTags:r,clearTags:l,confirm:s,cancel:F}=(()=>{const{filtersActiveTags:e,filtersVisible:t,setFiltersVisible:a,setFiltersActiveTags:r}=(0,h.A)(),[l,s]=(0,n.useState)(e),{availableTags:F}=Ns();return(0,n.useEffect)((()=>{s(e)}),[e]),{visible:t,availableTags:F,activeTags:l,updateActiveTags:(e,t)=>{s("add"===t?(0,Ge.A)([...l,e]):l.filter((t=>t!==e)))},clearTags:()=>s([]),confirm:()=>r(l),cancel:()=>a(!1)}})();return e?n.createElement(Ul,{className:"filter-form",confirm:s,deny:F,header:"Select Filters"},n.createElement("span",{className:"filter-form__hint"},"If set, all must be met"),n.createElement("ul",{className:"filter-form__tag-list"},n.createElement(mF,{title:"Untagged",tagActive:a.includes(ve.X.FILTER_UNTAGGED),toggleTag:e=>r(ve.X.FILTER_UNTAGGED,e)}),n.createElement(mF,{title:"❤️ Favourite",tagActive:a.includes(ve.X.FILTER_FAVOURITE),toggleTag:e=>r(ve.X.FILTER_FAVOURITE,e)}),n.createElement(mF,{title:"New",tagActive:a.includes(ve.X.FILTER_NEW),toggleTag:e=>r(ve.X.FILTER_NEW,e)}),n.createElement(mF,{title:"Monochrome",tagActive:a.includes(ve.X.FILTER_MONOCHROME),toggleTag:e=>r(ve.X.FILTER_MONOCHROME,e)}),n.createElement(mF,{title:"RGB",tagActive:a.includes(ve.X.FILTER_RGB),toggleTag:e=>r(ve.X.FILTER_RGB,e)}),n.createElement(mF,{title:"Recent Imports",tagActive:a.includes(ve.X.FILTER_RECENT),toggleTag:e=>r(ve.X.FILTER_RECENT,e)}),n.createElement(mF,{title:"Image has comments",tagActive:a.includes(ve.X.FILTER_COMMENTS),toggleTag:e=>r(ve.X.FILTER_COMMENTS,e)}),n.createElement(mF,{title:"Image has username",tagActive:a.includes(ve.X.FILTER_USERNAME),toggleTag:e=>r(ve.X.FILTER_USERNAME,e)})),n.createElement("ul",{className:"filter-form__tag-list filter-form__tag-list--clear"},n.createElement(mF,{title:"Clear Filters",tagActive:!1,icon:"delete",toggleTag:l})),n.createElement("span",{className:"filter-form__hint"},"If set, one must be met"),n.createElement("ul",{className:"filter-form__tag-list"},t.map((e=>n.createElement(mF,{key:e,title:e,tagActive:a.includes(e),toggleTag:t=>r(e,t)}))))):null};const dF=[{title:"Title",key:"title"},{title:"Date",key:"created"},{title:"Palette",key:"palette"}];var pF=function(){const e=(()=>{const{setSortBy:e,setSortOptionsVisible:t,sortOptionsVisible:a,sortBy:n}=(0,h.A)(),[r="",l=""]=n.split("_");return{visible:a,sortBy:r,sortOrder:l,setSortBy:e,hideSortForm:()=>t(!1)}})(),[t,a]=(0,n.useState)(e.sortBy),[r,l]=(0,n.useState)(e.sortOrder);if((0,n.useEffect)((()=>{a(e.sortBy),l(e.sortOrder)}),[a,l,e.visible,e.sortBy,e.sortOrder]),!e.visible)return null;const s=dF.find((({key:e})=>e===t))||dF[0],F=r===Rr.U.ASC?"ascending":"descending";return n.createElement(Ul,{className:"sort-form",confirm:()=>e.setSortBy(`${t}_${r}`),deny:()=>{e.hideSortForm()},header:`Sort by: ${s.title}/${F}`},n.createElement("ul",{className:"sort-form__list"},dF.map((({key:e,title:r})=>n.createElement("li",{key:e},n.createElement("button",{className:o()("sort-form__button",{"sort-form__button--selected":t===e}),type:"button",onClick:()=>a(e)},r))))),n.createElement("ul",{className:"sort-form__list"},n.createElement("li",null,n.createElement("button",{className:o()("sort-form__button sort-form__button--order-asc",{"sort-form__button--selected":"asc"===r}),type:"button",onClick:()=>l(Rr.U.ASC)},"Ascending")),n.createElement("li",null,n.createElement("button",{className:o()("sort-form__button sort-form__button--order-desc",{"sort-form__button--selected":"desc"===r}),type:"button",onClick:()=>l(Rr.U.DESC)},"Descending"))))};let gF;const hF=e=>{const t=async()=>{if(!gF){const{init:t,gitSyncTool:n}=await Promise.all([a.e(350),a.e(575)]).then(a.bind(a,5927));t(),gF=gF||n(e)}return gF};return(()=>{const{gitStorage:{use:e,owner:t,repo:a,branch:n,token:r}}=M.A.getState();return!!(e&&t&&a&&n&&r)})()&&t(),{startSyncData:async e=>(await t()).startSyncData(e),updateSettings:async e=>(await t()).updateSettings(e)}};var EF=function(){const{repoUrl:e,dropboxActive:t,gitActive:a,syncLastUpdate:r,autoDropboxSync:l,startSync:s,cancelSync:F}=(()=>{const e=G(),{remoteImport:t}=he(),{setSyncSelect:a}=(0,w.A)(),{gitStorage:n,dropboxStorage:r,syncLastUpdate:l}=(0,M.A)();return{repoUrl:`https://github.com/${n.owner}/${n.repo}/tree/${n.branch}`,dropboxActive:!(!r.use||!r.accessToken),gitActive:!!(n.use&&n.owner&&n.repo&&n.branch&&n.throttle&&n.token),autoDropboxSync:r.autoDropboxSync||!1,syncLastUpdate:l,startSync:(a,n)=>{if("dropbox"===a)se(e,t).startSyncData(n);else if("dropboximages"===a)se(e,t).startSyncImages();else{if("diff"===n)throw new Error("diff is invalid direction for github sync");hF(t).startSyncData(n)}},cancelSync:()=>a(!1)}})(),i=l&&r.local!==r.dropbox;return n.createElement(Ul,{className:"sync-select",deny:F,header:"Synchronize"},n.createElement("ul",{className:"sync-select__list"},a&&n.createElement(n.Fragment,null,n.createElement("li",{className:"sync-select__option"},n.createElement("button",{type:"button",className:"sync-select__button button",title:`Synchronize to GitHub\n${e}`,onClick:()=>{s("git","up")}},n.createElement("span",{className:"sync-select__button-label"},"Synchronize to GitHub"),n.createElement(g,{name:"sync",className:"svg--180"}))),n.createElement("li",{className:"sync-select__option"},n.createElement("button",{type:"button",className:"sync-select__button button",title:`Synchronize from GitHub\n${e}`,onClick:()=>{s("git","down")}},n.createElement("span",{className:"sync-select__button-label"},"Synchronize from GitHub"),n.createElement(g,{name:"sync"})))),t&&n.createElement(n.Fragment,null,n.createElement("li",{className:"sync-select__option"},n.createElement("button",{type:"button",className:"sync-select__button button",title:"Synchronize to Dropbox",onClick:()=>{s("dropbox","up")}},n.createElement("span",{className:"sync-select__button-label"},"Synchronize to Dropbox"),n.createElement(g,{name:"sync",className:"svg--180"}),i&&n.createElement("span",{className:o()("sync-select__button-hint",{"sync-select__button-hint--warn":r.local<r.dropbox})},r.local<r.dropbox?"There are pending remote changes. If you synchronize to dropbox now, these will be lost.":"Upload changes to dropbox"))),n.createElement("li",{className:"sync-select__option"},n.createElement("button",{type:"button",className:"sync-select__button button",title:"Synchronize from Dropbox",onClick:()=>{s("dropbox","down")}},n.createElement("span",{className:"sync-select__button-label"},"Synchronize from Dropbox"),n.createElement(g,{name:"sync"}),i&&n.createElement("span",{className:o()("sync-select__button-hint",{"sync-select__button-hint--warn":r.local>r.dropbox})},r.local>r.dropbox?"There are local changes not synched to dropbox yet. If you synchronize from dropbox now, these will be lost.":"Download changes from dropbox"))),n.createElement("li",{className:"sync-select__option"},n.createElement("button",{type:"button",className:"sync-select__button button",title:"Synchronize images to Dropbox",onClick:()=>{s("dropboximages","up")}},n.createElement("span",{className:"sync-select__button-label"},"Synchronize images to Dropbox"),n.createElement(g,{name:"sync",className:"svg--180"}))))))};var fF=e=>{return Math.floor(e)===e&&(t=e,Boolean(t&&!(t&t-1)));var t};var bF=function({imageData:e,scaleFactor:t,width:a,height:r,fileName:l,palette:s,dither:F,contrastBaseValues:o}){const i=(0,n.useRef)(null),c=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i.current&&c.current&&o?.length&&(({targetCanvas:e,originalCanvas:t,imageData:a,palette:n,dither:r,contrastBaseValues:l})=>{const s=n.map((e=>({r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}))),F=e.getContext("2d"),o=t.getContext("2d");F&&o?(F.putImageData(Ct({imageData:a,contrastBaseValues:l,dither:r,colors:s}),0,0),o.putImageData(a,0,0)):wt.error("canvas context is missing")})({targetCanvas:i.current,originalCanvas:c.current,imageData:e,palette:s,dither:F,contrastBaseValues:o})})),n.createElement("div",{className:"import-preview-image",title:`${l} - ${t}x`},n.createElement("canvas",{className:"import-preview-image__canvas",width:a,height:r,ref:c}),n.createElement(g,{className:"import-preview-image__arrow",name:"right"}),n.createElement("canvas",{className:"import-preview-image__canvas",width:a,height:r,ref:i}),fF(t)?null:n.createElement(ss,{label:`The scale factor of your image is ${t.toPrecision(3)}. To get a clean result without artifacts, use images with factors being powers of two. (1, 2, 4, 8 ...)`,themes:[rs.WARNING]}))};const vF=[{name:"Wider",baseValues:[0,68,187,255],value:"wider"},{name:"Wide",baseValues:[0,85,170,255],value:"wide"},{name:"Normal",baseValues:[51,102,153,204],value:"normal"},{name:"Narrow",baseValues:[69,115,162,208],value:"narrow"},{name:"Narrower",baseValues:[85,113,141,170],value:"narrower"},{name:"From Emulator",baseValues:[64,144,224,255],value:"emulator"}];var _F=function(){const{bitmapQueue:e,bitmapQueueCancel:t}=L(),[a,r]=(0,n.useState)(!0),[l,s]=(0,n.useState)("wide"),F=(vF.find((({value:e})=>e===l))||vF[1]).baseValues;return n.createElement(Ul,{className:"bitmap-import-overlay",header:"Prepare Bitmaps for import",confirm:()=>{It({bitmapQueue:e,dither:a,contrastBaseValues:F})},deny:t},n.createElement("div",{className:"bitmap-import-overlay__content"},e.map(((e,t)=>n.createElement(bF,{key:t,imageData:e.imageData,scaleFactor:e.scaleFactor,width:e.width,height:e.height,fileName:e.fileName,dither:a,contrastBaseValues:F,palette:["#ffffff","#aaaaaa","#555555","#000000"]}))),n.createElement("label",{className:o()("bitmap-import-overlay__dither-check",{"bitmap-import-overlay__dither-check--checked":a})},n.createElement("input",{type:"checkbox",className:"bitmap-import-overlay__dither",checked:a,onChange:({target:e})=>{r(e.checked)}}),n.createElement(g,{name:"checkmark"}),n.createElement("span",{className:"bitmap-import-overlay__dither-text"},"Enable Dither")),n.createElement(Ye,{id:"contasts",label:"Contrast preset",options:vF,setSelected:s,value:l,disabled:!1})))};var yF=function({importItem:e,paletteShort:t}){const{tiles:a,fileName:r,lastModified:l,imageHash:s,tempId:F}=e,{palettes:o,images:c}=(0,E.h)(),m=o.find((({shortName:e})=>e===t)),d=c.find((({hash:e})=>e===s)),{importQueue:p}=L(),h=p.filter((e=>e.imageHash===s)).length,{preferredLocale:f}=(0,i.A)(),{frameQueueAdd:b,importQueueCancelOne:v}=L();return n.createElement("li",{className:"import-image"},n.createElement("span",{className:"import-image__image-zoom",style:{height:a.length/2.5/2.66+"px"}},n.createElement("span",{className:"import-image__image"},n.createElement(re,{tiles:a,invertPalette:!1,lockFrame:!1,palette:m?.palette,imageStartLine:2,asThumb:!0}))),n.createElement("div",{className:"import-image__meta"},n.createElement("div",{className:"import-image__name"},r),l?n.createElement("div",{className:"import-image__date"},(0,fe.A)(u()(l),f)):null),n.createElement("div",{className:"import-image__duplicate-icons"},h>1?n.createElement("div",{className:"import-image__duplicate-icon import-image__duplicate-icon--queue",title:"This image exists multiple times within this queue"},"D"):null,d?n.createElement("div",{className:"import-image__duplicate-icon import-image__duplicate-icon--image",title:"This image has already been imported"+(d.title?` as "${d.title}"`:"")},"I"):null),n.createElement("div",{className:"import-image__buttons"},n.createElement("button",{className:"import-image__button import-image__button--frame",type:"button",title:"Import as Frame",disabled:a.length/20<14,onClick:()=>b([e])},n.createElement(g,{className:"import-image__icon",name:"frame"})),n.createElement("button",{className:"import-image__button import-image__button--delete",type:"button",title:"Delete",onClick:()=>v(F)},n.createElement(g,{className:"import-image__icon",name:"delete"}))))},NF=a(2317),wF=a(8438);const kF=(0,Rr.A)("fileName");var CF=()=>{const{importPad:e,setActivePalette:t,activePalette:a}=(0,i.A)(),{cancelEditImageGroup:r}=N(),{addImageGroup:l}=(0,E.h)(),{addImages:s,importQueueCancel:F}=G(),o=new(Vt())(1,1/0),{view:c}=z(),m=(0,H.Zp)(),{importQueue:d}=L(),[p,g]=(0,n.useState)(""),[h,f]=(0,n.useState)(d.length>3),[b,v]=(0,n.useState)({initial:[],add:[],remove:[]});return{importQueue:d,importPad:e,palette:a,frame:p,tagChanges:b,createGroup:h,updateTagChanges:v,setFrame:g,setCreateGroup:f,runImport:async()=>{const t=await Promise.all(kF(d).map(((t,n)=>{const{tiles:r,fileName:l,meta:s,lastModified:F}=t;return o.add((()=>(0,NF.A)({lines:e?(0,wF.A)(r):r,filename:l,palette:a,frame:p,tags:b.add,created:u()((F||Date.now())+n).format(X.i$),meta:s})))}))),n=t.map((({hash:e})=>e));if(s(t),h){const e=`Import ${u()().format(X.i$)}`,a=Z(e);r(),l({id:W(),slug:a,title:e,created:u()(Date.now()).format(X.i$),coverImage:t[0].hash,images:n,groups:[]},c.id),m(`/gallery/${c.slug}${a}/page/1`)}},cancelImport:F,setActivePalette:t}};var AF=function(){const{frame:e,palette:t,importQueue:a,tagChanges:r,createGroup:l,setFrame:s,setActivePalette:F,setCreateGroup:i,updateTagChanges:c,runImport:m,cancelImport:u}=CF();return n.createElement(Ul,{className:"import-overlay",header:`Image Import (${a.length} images)`,confirm:m,deny:u},n.createElement("div",{className:"import-overlay__content"},n.createElement("ul",{className:"import-overlay__images"},a.map(((e,a)=>n.createElement(yF,{key:a,paletteShort:t,importItem:e})))),n.createElement(vs,{selectLabel:"Palette",noFancy:!0,value:t,onChange:F}),n.createElement(os,{selectLabel:"Modify Frame",frame:e,lockFrame:!1,noFrameOption:"No frame / import as is",updateFrame:s}),n.createElement(As,{label:"Tags",tags:r,listDirection:"up",updateTags:(e,t)=>{c({...r,...ks(r,{mode:e,tag:t})})}}),n.createElement("label",{className:o()("import-overlay__checkgroup inputgroup checkgroup",{"checkgroup--checked":l})},n.createElement("span",{className:"inputgroup__label",title:"Create group from images"},"Create group from images"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:l,onChange:({target:e})=>{i(e.checked)}}),n.createElement(g,{name:"checkmark"})))))};const SF=["FFFF8080BFBFA0A0A0A0A0A0A0A0A0A0","FFFF0000FFFF00000000010103030707","FFFF0000FFFF7F7FFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFFFFFFFFFFFFFFFFFFFF","FFFF0000FFFFFEFEFFFFFFFFFFFFFFFF","FFFF0000FFFF000000008080C0C0E0E0","FFFF0101FDFD05050505050505050505","A0A0A0A0A0A0A0A0A0A0A1A1A3A3A7A7","070703030101000000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","E0E0C0C0808000000000010103030707","050505050505050505058585C5C5E5E5","AFAFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000001018383C7C7EFEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","E0E0C0C0808000008080C1C1E3E3F7F7","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","F5F5FDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFF0F0F0F0F0F0F0F0","FFFFFFFFFFFFFFFF3F3F3F3F3F3F3F3F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","42214000000040206020602060206020","85C3800101000140C140C140C140C140","FCF0D0E0E0C080C181C1C181C181FEFC","1F0F0307070382038003800380030003","C4828000000004020602060206020602","0F070F070F060E060C060C060C060C06","A1C08000000008040804080400000000","FF7F5F3F3F1F0F1F1F0F1F0F1F0F1F0F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0","30303030303030303030303030303030","60206020602060206020602060206020","C140C140C140C140C140C140C140C140","E8F0E0C081C080C1C181C18180C180C0","00030003800380038003810381030103","0602060206020602060000008000C482","0C060C060C060C060C060C060E060F06","00000F070C040C040C040C0408040000","1F0FFFFF1F0F1F0F1F0F1F0F0F1F3F1F","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F0F0FFFFFFFFFFFFFFFFFFFFFFFF","30303030FFFFFFFFFFFFFFFFFFFFFFFF","60206020FFFFFFFFFFFFFFFFFFFFFFFF","C140C140FFFFFFFFFFFFFFFFFFFFFFFF","C0C0D1E0FFFFFFFFFFFFFFFFFFFFFFFF","01030083FFFFFFFFFFFFFFFFFFFFFFFF","FEFE040200008000A0C0FFFFFFFFFFFF","0F070F07070F0F1F5F3FFFFFFFFFFFFF","8000A0C0FFFFFFFFFFFFFFFFFFFFFFFF","1F3FFF7FFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFBFBF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FDFDFDFDFDFDFDFDFDFDFDFDFDFDFDFD","BFBFBFBFBFBFBFBFBFBFBFBFBFBFAFAF","FFFFFFFFFFFFFFFFFEFEFCFCF8F8F0F0","EFEFC7C7838301010000010103030707","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F7F7E3E3C1C1808000008080C0C0E0E0","FFFFFFFFFFFFFFFF7F7F3F3F1F1F0F0F","FDFDFDFDFDFDFDFDFDFDFDFDFDFDF5F5","A7A7A3A3A1A1A0A0A0A0A0A0A0A0A0A0","E0E0C0C0808000000000010103030707","0F0F1F1F3F3F7F7FFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","F0F0F8F8FCFCFEFEFFFFFFFFFFFFFFFF","070703030101000000008080C0C0E0E0","E5E5C5C5858505050505050505050505","A0A0A0A0A0A0A0A0A0A0BFBF8080FFFF","07070303010100000000FFFF0000FFFF","FFFFFFFFFFFFFFFF7F7FFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFFFFFFFF0000FFFF","FFFFFFFFFFFFFFFFFEFEFFFF0000FFFF","E0E0C0C0808000000000FFFF0000FFFF","05050505050505050505FDFD0101FFFF"];var IF=function({tiles:e,startLine:t,setStartLine:a}){const{activePalette:r}=(0,i.A)(),{palettes:l}=(0,E.h)(),s=l.find((({shortName:e})=>e===r))?.palette,F=(0,n.useMemo)((()=>{const a=[];a.push(...e.slice(0,20*t));for(let n=0;n<14;n+=1){const r=20*(n+t),l=r+18,s=16*n;a.push(...e.slice(r,r+2),...SF.slice(s,s+16),...e.slice(l,l+2))}return a.push(...e.slice(20*(t+14))),a}),[e,t]);return n.createElement("div",{className:"edit-frame-start-line"},n.createElement(re,{tiles:F,palette:s,imageStartLine:t}),n.createElement("div",{className:"edit-frame-start-line__buttons"},n.createElement("button",{className:"button edit-frame-start-line__button",type:"button",onClick:()=>a(t-1),disabled:t<=0},"Move image up"),n.createElement("button",{className:"button edit-frame-start-line__button",type:"button",onClick:()=>a(t+1),disabled:t>=e.length/20-14},"Move image down")))};var PF=function(){const{dismissDialog:e}=(0,_.A)(),{frameQueue:t,frameQueueCancelOne:a,importQueueCancelOne:r}=L(),{updateLastSyncLocalNow:l}=G(),{addFrames:s,updateFrameGroups:F}=(0,E.h)(),o=t[0],[i,c]=(0,n.useState)(""),[m,u]=(0,n.useState)(Math.floor((o.tiles.length-280)/40)),{fullId:d,formValid:p,groups:g,frameGroup:h,frameIndex:f,setFrameIndex:b,frameName:v,setFrameGroup:y,setFrameName:N,idValid:w,groupIdValid:k,frameIndexValid:C}=Vs({id:"",hash:"",name:o.fileName});return n.createElement(Ul,{className:"import-overlay",header:`Import new Frame as "${d}"`,canConfirm:p,confirm:async()=>{const t=await(0,P.R_)(o.tiles,m);e(0),o.tempId&&(r(o.tempId),a(o.tempId)),s([{id:d,name:v,hash:t}]),i?.trim()&&F([{id:h,name:i}]),l()},deny:()=>a(o.tempId)},n.createElement("div",{className:"import-overlay__content"},n.createElement(IF,{tiles:o.tiles,startLine:m,setStartLine:u}),n.createElement($s,{frameIndex:f,setFrameGroup:y,frameName:v,frameGroup:h,setFrameName:N,groupIdValid:k,idValid:w,frameIndexValid:C,setFrameIndex:b,groups:g,fullId:d,frameGroupName:i,setFrameGroupName:c})))};const xF=(e,t)=>!!t.find((({hashes:t})=>!!t&&Object.values(t).includes(e))),TF=(e,t)=>!!t.find((t=>t.hash===e)),DF=async({images:e,frames:t})=>{await(0,pe.ZU)();(await pe.mU.keys()).forEach((e=>t=>{xF(t,e)||TF(t,e)||(0,ht.yH)(t)})(e));(await pe.Uv.keys()).forEach((e=>t=>{((e,t)=>!!t.find((t=>t.hash===e)))(t,e)||(0,ht.t9)(t)})(t))},BF=async e=>{await(0,pe.ZU)();return(await pe.mU.keys()).filter((e=>!e.startsWith("dummy"))).filter((e=>t=>!xF(t,e)&&!TF(t,e))(e))},RF=async e=>{await(0,pe.ZU)();return(await pe.Uv.keys()).filter((e=>!e.startsWith("dummy"))).filter((e=>t=>!e.find((e=>e.hash===t)))(e))};var LF=a(6750);const MF=async(e,t)=>{await(0,pe.ZU)();return(await Promise.all(e.map((async e=>{try{const a=await t.getItem(e);if(!a)return null;return{hash:e,lines:(await(0,LF.U)(a)).split("\n"),binary:a}}catch(e){return null}})))).reduce(Gr.N,[])};var GF=()=>{const{trashCount:e,showTrashCount:t}=(0,w.A)(),{frames:a,images:r}=(0,E.h)(),{updateTrashCount:l}=(0,w.A)(),s=(0,n.useCallback)((async()=>{const e=await RF(a),t=await MF(e,pe.Uv),n={},r={state:{frames:t.map(((e,t)=>{try{return n[`frame-${e.hash}`]=e.binary,{hash:e.hash,name:`Backup export ${e.hash}`,id:`bak${t.toString(10).padStart(2,"0")}`}}catch(e){return null}})).reduce(Gr.N,[]),frameGroups:[{id:"bak",name:"Re-imported trash frames"}],lastUpdateUTC:Math.floor((new Date).getTime()/1e3),version:E.A}};(0,tF.saveAs)(new Blob([...JSON.stringify({...r,...n},null,2)]),"backup_frames.json")}),[a]),F=(0,n.useCallback)((async()=>{const e=(await RF(a)).length,t=(await BF(r)).length;l(e,t)}),[a,r,l]),o=(0,n.useCallback)((async()=>{await DF({images:r,frames:a}),t(!1),window.requestAnimationFrame((()=>{F()}))}),[F,a,r,t]);return{showTrashCount:t,purgeTrash:o,downloadImages:async()=>{const e=await BF(r),t=await MF(e,pe.mU),a={},n={state:{images:t.map((e=>{try{return a[e.hash]=e.binary,{hash:e.hash,created:u()().format(X.i$),title:`Backup export ${e.hash}`,lines:e.lines.length,tags:["backup"],palette:"bw",framePalette:"bw",invertPalette:!1,invertFramePalette:!1,frame:""}}catch(e){return null}})).reduce(Ne.iy,[]),lastUpdateUTC:Math.floor((new Date).getTime()/1e3),version:E.A}};(0,tF.saveAs)(new Blob([...JSON.stringify({...n,...a},null,2)]),"backup_images.json")},downloadFrames:s,checkUpdateTrashCount:F,trashCount:e}};var VF=function(){const{showTrashCount:e,purgeTrash:t,downloadImages:a,downloadFrames:r,trashCount:l}=GF(),s=l.frames+l.images;return n.createElement(Ul,{className:"trashbin",confirm:()=>{e(!1)},header:`Trash (${s} items)`},n.createElement("ul",{className:"trashbin__list"},n.createElement("li",{className:"trashbin__option"},n.createElement("button",{type:"button",className:"trashbin__button button",title:"Download deleted frames",disabled:0===l.frames,onClick:r},n.createElement("span",{className:"trashbin__button-label"},`Download deleted frames (${l.frames})`))),n.createElement("li",{className:"trashbin__option"},n.createElement("button",{type:"button",className:"trashbin__button button",title:"Download deleted images",disabled:0===l.images,onClick:a},n.createElement("span",{className:"trashbin__button-label"},`Download deleted images (${l.images})`))),n.createElement("li",{className:"trashbin__option"},n.createElement("button",{type:"button",className:"trashbin__button trashbin__button--sum button",title:"Purge all",disabled:0===s,onClick:t},n.createElement("span",{className:"trashbin__button-label"},`Purge all (${s})`)))))};var $F=function(){const{images:e}=(0,E.h)(),{imageSelection:t,sortBy:a,filtersActiveTags:r,recentImports:l}=(0,h.A)(),{pickColors:s,setEditPalette:F,cancelEditPalette:o,cancelPickColors:i}=N(),[c,m]=(0,n.useState)([0,3,6,9]),u=zs(e,{sortBy:a,filtersActiveTags:r,recentImports:l},t),d=(0,n.useMemo)((()=>s?Array(4).fill(null).map(((e,t)=>{const a=c[t],n=s.colors[a];return n?(([e,t,a])=>["#",Math.min(255,Math.max(0,e)).toString(16).padStart(2,"0"),Math.min(255,Math.max(0,t)).toString(16).padStart(2,"0"),Math.min(255,Math.max(0,a)).toString(16).padStart(2,"0")].join(""))(n):"#000000"})):[]),[s,c]),p=(0,n.useMemo)((()=>u()),[u]);return s?n.createElement(Ul,{className:"pick-colors",confirm:()=>{F({name:`From file ${s.fileName}`,shortName:ve.m,palette:d,origin:"generated from file",isPredefined:!1})},canConfirm:4===c.length,deny:()=>{i(),o()},header:`Pick colors from "${s.fileName}"`},n.createElement(n.Fragment,null,n.createElement("ul",{className:"edit-palette__previews"},p.map((e=>n.createElement("li",{className:"edit-palette__preview-image",key:e.hash},n.createElement(Ee,{hash:e.hash,invertPalette:!1,invertFramePalette:!1,lockFrame:!1,palette:d,framePalette:d}))))),n.createElement("ul",{className:"pick-colors__list"},s.colors.map(((e,t)=>{const a=(e=>c.findIndex((t=>t===e))+1)(t);return n.createElement("li",{key:t,className:"pick-colors__item",style:{"--color":`rgb(${e.join(",")})`}},n.createElement("button",{type:"button",className:"pick-colors__button",onClick:()=>(e=>{let t=!1;const a=c.filter((a=>a!==e||(t=!0,!1)));if(t)m(a);else{for(;a.length>3;)a.shift();m([...a,e])}})(t)},a?n.createElement("span",{className:"pick-colors__index"},a):null))}))),n.createElement("div",{className:"pick-colors__preview"},d.map(((e,t)=>n.createElement("div",{key:t,className:"pick-colors__preview-item",style:{backgroundColor:e},title:e})))))):null};var OF=function(){const{enableImageGroups:e}=(0,i.A)(),{dialogs:t}=(0,_.A)(),a=!!t.length,{editFrame:r,editImageGroup:l,editImages:s,editPalette:F,editRGBNImages:o,pickColors:c}=N(),m=!!s?.batch?.length,u=!!r,d=!!l&&e,p=!!F,g=o.length>0,E=!!c,{filtersVisible:f,sortOptionsVisible:b}=(0,h.A)(),{bitmapQueue:v,importQueue:y,frameQueue:k}=L(),C=!!v.length,A=!!y.length,S=!!k.length,{lightboxImage:I,dragover:P,trashCount:{show:x},progress:T,progressLog:D,syncSelect:B,videoSelection:R}=(0,w.A)(),M=!!D.git.length||!!D.dropbox.length,G=!!T.gif||!!T.printer||!!T.plugin;switch(!0){case a:return n.createElement(Fs,null);case S:return n.createElement(PF,null);case C:return n.createElement(_F,null);case A:return n.createElement(AF,null);case m:return n.createElement(Ms,null);case d:return n.createElement(Gs,null);case u:return n.createElement(Os,null);case p:return n.createElement(Ws,null);case g:return n.createElement(qs,null);case!!R?.length:return n.createElement(rF,null);case E:return n.createElement($F,null);case null!==I:return n.createElement(oF,null);case f:return n.createElement(uF,null);case b:return n.createElement(pF,null);case B:return n.createElement(EF,null);case x:return n.createElement(VF,null);case P:return n.createElement(cF,null);case M:return n.createElement(as,null);case G:return n.createElement(ns,null);default:return n.createElement(Hl,null)}};var UF=function({dismiss:e,errorMessage:t}){const[a,r]=(0,n.useState)(!1);return n.createElement("li",{className:"errors__item"},n.createElement("p",null,t.error.message),n.createElement("button",{type:"button",className:"errors__close-button",onClick:e},n.createElement(g,{name:"close-nav"})),a?n.createElement("pre",{className:"errors__stack"},t.error.stack):n.createElement("button",{type:"button",className:"errors__stack-button",onClick:()=>r(!0)},"show stack"))};var zF=function(){const{errors:e,dismissError:t}=(0,w.A)();return n.createElement("ul",{className:"errors"},e.map(((e,a)=>n.createElement(UF,{key:`${e.timestamp}-${a}`,dismiss:()=>t(a),errorMessage:e}))))};const HF=(e,t)=>e.filter((e=>!t.includes(e))),WF=(e,t)=>t.reduce(((t,a)=>{const n=a.slug.replace(/[^A-Z0-9_-]+/gi,"_");let r=0,l=`${e}${n}/`;const s=e=>-1!==t.findIndex((({absolutePath:t})=>t===e));for(;s(l);)r+=1,l=`${e}${n}_${r}/`;return[...t,{absolutePath:l,group:a},...WF(l,a.groups)]}),[]),XF=(e,t)=>t.groups.length+t.images.length?[...e,t]:e,jF=(e,t)=>(a,n)=>{const r=!!e.find((e=>n.hash===e)),l=!!t.find((({coverImage:e})=>n.hash===e));return r||l?[...a,n]:a},YF=()=>{const{enableImageGroups:e}=(0,i.A)(),{setError:t}=(0,w.A)(),{imageGroups:a,images:r}=(0,E.h)(),l=(0,n.useMemo)((()=>e?a:[]),[e,a]),{path:s}=j(),F=(0,n.useMemo)((()=>(e=>{let t=[],a=[];return{groups:e.map((e=>{const n=(0,Ge.A)(HF(e?.images,t)),r=(0,Ge.A)(HF(e?.groups,a));return t=(0,Ge.A)([...t,...e.images]),a=(0,Ge.A)([...a,...e.groups]),{...e,images:n,groups:r}})),usedImageHashes:t,usedGroupIDs:a}})(l)),[l]),o=(0,n.useMemo)((()=>{const e=a=>n=>{const l=(e,t)=>{const a=F.groups.find((({id:e})=>e===t));return a?[...e,a]:e};let s;if(a>20)t(new Error(`Reached maximum inflate depth at group "${n.title||n.slug}" (${n.id})`)),s=[];else try{s=n.groups.reduce(l,[]).map(e(a+1)).reduce(XF,[])}catch(e){s=[]}const o=r.reduce(jF(n.images,s),[]),i=o.find((({hash:e})=>e===n.coverImage))||o[0],c=i?.hash||n.coverImage;return{id:n.id,slug:n.slug,created:n.created,title:n.title,coverImage:c,groups:s,images:o}},a=F.groups.map(e(0)).reduce(XF,[]).filter((({id:e})=>!F.usedGroupIDs.includes(e))),n=r.reduce(((e,{hash:t})=>F.usedImageHashes.includes(t)?e:[...e,t]),[]);return{id:"ROOT",slug:"",created:"",title:"",coverImage:"",images:[],groups:[],groups:a,images:r.reduce(jF(n,a),[])}}),[F,r,t]),c=(0,n.useMemo)((()=>WF("",o.groups)),[o]),m=(0,n.useMemo)((()=>c.reduce(((e,{group:t,absolutePath:a})=>{const n=a.split("/").length-1;return[...e,{value:a,name:`${Array(n).fill(" ").join("")}${t.title} (/${a.replace(/\/$/,"")})`}]}),[{value:"",name:"/"}])),[c]);return(0,n.useMemo)((()=>{const e=c.find((({absolutePath:e})=>e===s))?.group||o,t=e.groups.map((({coverImage:e})=>e)),a=e.images.filter((e=>!t.includes(e.hash)));return{view:e,covers:t,paths:c,images:a,pathsOptions:m}}),[s,c,m,o])};var ZF=function({children:e}){const t=YF();return n.createElement(U.Provider,{value:t},e)};const QF=e=>t=>{const{frames:a,palettes:n}=E.h.getState(),{handleExportFrame:r}=i.A.getState(),l=e.find((e=>e.hash===t));if(!l)throw new Error("image not found");const{palette:s,framePalette:F}=(0,I.s)(n,l);if(!s)throw new Error("selectedPalette not found");const o=()=>(0,S.T)(e,a)(l.hash),c=(0,Ne.pl)(l);return{getMeta:async()=>({...l,isRGBN:c}),getPalette:async()=>s,getTiles:o,getCanvas:async(e={})=>{const{scaleFactor:t=1,palette:n=s,framePalette:i=F,lockFrame:m=l.lockFrame||!1,invertPalette:u=l.invertPalette||!1,invertFramePalette:d=l.invertFramePalette||!1,handleExportFrame:p=r}=e,g=await o();let h;const E=a.find((({id:e})=>e===l.frame)),f=E?await(0,P.mZ)(E.hash):null,b=f?f.upper.length/20:2;if(c)h=new ee.Wd,h.update({canvas:null,tiles:g,palette:n,lockFrame:m});else{h=new ee.XM;const e=n?.palette||ee.CU,t=i?.palette||ee.CU,a=(0,ae.A)({palette:e,framePalette:t,invertPalette:u,invertFramePalette:d});h.update({canvas:null,tiles:g,...a,imageStartLine:b})}return(0,te.Ej)(h.getScaledCanvas(t,p),l.rotation||0)}}};var KF;!function(e){e.CONFIRM_ASK="CONFIRM_ASK",e.CONFIRM_ANSWERED="CONFIRM_ANSWERED",e.ADD_IMAGES="ADD_IMAGES",e.IMPORT_FILES="IMPORT_FILES"}(KF||(KF={}));var qF=a(6763);const JF=({addImages:e,setDialog:t,dismissDialog:a},n)=>{const r=Hr(n);return{dispatch:n=>{switch(n.type){case KF.CONFIRM_ASK:t(n.payload);break;case KF.CONFIRM_ANSWERED:a(0);break;case KF.IMPORT_FILES:r(n.payload.files);break;case KF.ADD_IMAGES:e(n.payload);break;default:qF.error(`Unhandled Compatibility Action (type:"${n.type}")`)}}}},eo=({setProgress:e,addUpdatePluginProperties:t,collectImageData:a,stores:n,importFn:r},l)=>{const{url:s,config:F={}}=l,o=t=>{e("plugin",t%1)};return new Promise((e=>{window.gbpwRegisterPlugin=l=>{if(window.gbpwRegisterPlugin=()=>{},l)try{const i=new l({saveAs:tF.saveAs,progress:o,store:JF(n,r),collectImageData:a},F),{name:c,description:m="",configParams:u={},config:d={}}=i;t({url:s,name:c,description:m,configParams:u,config:d,loading:!1,error:!1}),e(i)}catch(a){t({url:s,loading:!1,error:a?.message}),e(null)}else e(null)};const l=document.createElement("script");document.head.appendChild(l),l.addEventListener("error",(()=>{window.gbpwRegisterPlugin=()=>{},t({url:s,loading:!1,error:"Loading error"}),e(null)})),l.src=s}))};var to=function({children:e}){const{plugins:t,images:a,addUpdatePluginProperties:r}=(0,E.h)(),l=G(),{setProgress:s}=(0,w.A)(),{jsonImport:F}=he(),o=(0,n.useMemo)((()=>({collectImageData:QF(a),addUpdatePluginProperties:r,setProgress:s,stores:l,importFn:F})),[a,r,s,l,F]),i=(0,n.useMemo)((()=>async e=>{const a=t.find((t=>t.url===e))||{url:""};return eo(o,a)}),[o,t]),c=(0,n.useCallback)((async e=>!!await eo(o,e)),[o]),m=(0,n.useMemo)((()=>({runWithImage:async(e,t)=>{(await i(e))?.withImage(QF(a)(t))},runWithImages:async(e,t)=>{(await i(e))?.withSelection(t.map(QF(a)))},validateAndAddPlugin:c})),[i,a,c]);return n.createElement(f.Provider,{value:m},e)};let ao,no;var ro=function({children:e}){const{setProgress:t,setPrinterFunctions:r,setPrinterBusy:l,setPrinterData:s}=w.A.getState(),{dismissDialog:F,setDialog:o}=_.A.getState(),{handleFileImport:c}=Wr();(0,n.useEffect)((()=>{const e=e=>{const{printerUrl:a}=i.A.getState();let n;try{n=new URL(a).origin}catch(e){n=new URL(window.location.href).origin}if(e.origin!==n)return;const{fromRemotePrinter:{lines:m,progress:u,blob:d,blobsdone:p,commands:g,printerData:h}={}}=e.data,E=e.source;if(g&&(ao&&JSON.stringify(g)===JSON.stringify(w.A.getState().printerFunctions)||(r(g),l(!1),s(null)),no=E,window.clearTimeout(ao),ao=window.setTimeout((()=>{ao=null,no=null,l(!0),s(null),r([])}),1500)),m){const e=new File([m.join("\n")],"Text input.txt",{type:"text/plain"});c([e])}if(void 0!==u&&t("printer",u),d){const e=new File([d],"blob.unknown");c([e])}if(p){if("string"==typeof p[0])return void window.setTimeout((()=>{alert("You should update the web-app to a version > 1.16.0 on your printer for an optimized import experience :-)")}),200);const e=p.reduce(((e,t)=>{if(!t.blob||!t.ok)return e;const a=p.length>1?(e.length+1).toString(10).padStart(2,"0"):"";return[...e,new File([t.blob],`Printer ${a}`.trim(),{type:t.contentType})]}),[]);e.length?c(e,{fromPrinter:!0}):o({message:"No valid files received from WiFi-Printer",confirm:async()=>{F(0),l(!1),s(null)}})}h&&(s(h),l(!1))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)}),[F,c,o,l,s,r,t]);const m=(0,n.useMemo)((()=>({callRemoteFunction:async e=>{const{printerData:t}=w.A.getState();let n;if(l(!0),e===Ft.FETCHIMAGES&&t&&(n={dumps:t?.dumps}),await Promise.resolve().then(a.t.bind(a,4802,23)),await a.e(668).then(a.t.bind(a,1668,23)),!no)throw new Error("remote printer window object is missing");no.postMessage({toRemotePrinter:{command:e,params:n}},"*")}})),[l]);return n.createElement(lt.Provider,{value:m},e)};var lo=function(){const e=(0,H.FE)(),t=xe();if(!e[1])return n.createElement(H.C5,{to:"/gallery/page/1",replace:!0});const a=e[1]?.handle?.headline,r={"--ddpx":t.ddpx};return n.createElement(to,null,n.createElement(ZF,null,n.createElement(ro,null,n.createElement(Jl,null),n.createElement("div",{className:"layout",style:r},a&&n.createElement("h1",{className:"layout__main-headline"},a),n.createElement(H.sv,null)),n.createElement(OF,null),n.createElement(zF,null))))},so=a(6763);var Fo=function(){const e=(0,H.r5)();return so.error(e),n.createElement("div",{id:"error-page"},n.createElement("p",null,e?.statusText||e.message),n.createElement("pre",null,e.stack))};const oo={};var io=()=>["jpeg","jpg","png","webp","bmp","gif"].filter((e=>(e=>{if(void 0!==oo[e])return oo[e];const t=document.createElement("canvas");t.width=2,t.height=2;const a=t.toDataURL(`image/${e}`);return oo[e]=0===a.indexOf(`data:image/${e};base64`),oo[e]})(e))),co=a(7769);var mo=function(){const{enableDebug:e,enableImageGroups:t,exportFileTypes:l,exportScaleFactors:s,forceMagicCheck:F,handleExportFrame:c,hideDates:m,importDeleted:d,importLastSeen:p,importPad:h,pageSize:f,preferredLocale:b,printerParams:v,printerUrl:_,savFrameTypes:y,setExportFileTypes:N,setExportScaleFactors:w,setEnableDebug:k,setEnableImageGroups:C,setForceMagicCheck:A,setHandleExportFrame:S,setHideDates:I,setImportDeleted:P,setImportLastSeen:x,setImportPad:T,setPageSize:D,setPreferredLocale:B,setSavFrameTypes:R,setPrinterParams:L,setPrinterUrl:M}=(0,i.A)(),{frames:G,frameGroups:V}=(0,E.h)(),$=(0,Ur.A)(G,V),[O,U]=(0,n.useState)(f.toString(10)),[z,H]=(0,n.useState)(_),[W,X]=(0,n.useState)(v),[j,Y]=(0,n.useState)([]),[Z]=(0,n.useState)(u()()),{sortPalettes:Q,setSortPalettes:K,paletteSortOptions:q}=ll();return(0,n.useEffect)((()=>{(async()=>{const{default:e}=await a.e(416).then(a.t.bind(a,2416,23)),t=e.all.filter((({tag:e})=>{try{return(0,fe.A)(u()(),e),!0}catch(e){return!1}}));Y(t)})()}),[]),n.createElement(n.Fragment,null,n.createElement(pt,{id:"settings-pagesize",labelText:"Page size",type:dt.NUMBER,min:0,value:O,onChange:U,onBlur:()=>{D(parseInt(O,10)||0)}},n.createElement("span",{className:o()("inputgroup__note",{"inputgroup__note--warn":!f})},"(set to 0 to disable pagination - might cause performance issues on large sets of images)")),n.createElement("div",{className:"inputgroup"},n.createElement("div",{className:"inputgroup__label"},"Image export dimensions"),[1,2,3,4,5,6,8,10].map((e=>n.createElement("label",{key:e,className:o()("inputgroup__label-check",{"inputgroup__label-check--selected":s.includes(e)}),title:`${160*e}×${144*e}`},`${e}×`,n.createElement("input",{type:"checkbox",checked:s.includes(e),onChange:({target:t})=>{w(e,t.checked)}}))))),n.createElement("div",{className:"inputgroup"},n.createElement("div",{className:"inputgroup__label"},"Image export filetypes"),[...io(),"txt","pgm"].map((e=>n.createElement("label",{key:e,className:o()("inputgroup__label-check",{"inputgroup__label-check--selected":l.includes(e)}),title:e},e,n.createElement("input",{type:"checkbox",checked:l.includes(e),onChange:({target:t})=>{N(e,t.checked)}}))))),n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"settings-handle-export-frames",className:"inputgroup__label"},"How to handle frames when exporting images"),n.createElement("select",{id:"settings-handle-export-frames",className:"inputgroup__input inputgroup__input--select",value:c,onChange:e=>{S(e.target.value)}},Js.map((({id:e,name:t})=>n.createElement("option",{value:e,key:e},t))))),n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"settings-sav-frames",className:"inputgroup__label"},"Frames to be applied when importing Cartridge dumps"),n.createElement("select",{id:"settings-sav-frames",className:"inputgroup__input inputgroup__input--select",disabled:!$.length,value:y,onChange:e=>{R(e.target.value)}},n.createElement("option",{value:""},"None"),$.map((({id:e,name:t})=>n.createElement("option",{value:e,key:e},t))))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":p})},n.createElement("span",{className:"inputgroup__label",title:"Import ‘last seen’ image when importing Cartridge dumps"},"Import ‘last seen’ image when importing Cartridge dumps"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:p,onChange:({target:e})=>{x(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":d})},n.createElement("span",{className:"inputgroup__label",title:"Import deleted images when importing Cartridge dumps"},"Import deleted images when importing Cartridge dumps"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:d,onChange:({target:e})=>{P(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":F})},n.createElement("span",{className:"inputgroup__label",title:"Force valid .sav file when importing"},"Force valid .sav file when importing"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:F,onChange:({target:e})=>{A(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":h})},n.createElement("span",{className:"inputgroup__label",title:"Pad images up to 144px height on import"},"Pad images up to 144px height on import"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:h,onChange:({target:e})=>{T(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":m})},n.createElement("span",{className:"inputgroup__label",title:"Hide dates in gallery"},"Hide dates in gallery"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:m,onChange:({target:e})=>{I(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"settings-sort-palettes",className:"inputgroup__label"},"Sort Palettes"),n.createElement("select",{id:"settings-sort-palettes",className:"inputgroup__input inputgroup__input--select",value:Q,onChange:e=>{K(e.target.value)}},q.map((({label:e,value:t})=>n.createElement("option",{value:t,key:t},e))))),n.createElement("div",{className:"inputgroup"},n.createElement("label",{htmlFor:"settings-preferred-locale",className:"inputgroup__label"},"Preferred locale",n.createElement("span",{className:"inputgroup__note inputgroup__note--newline"},`Example date format: ${(0,fe.A)(Z,b)}`)),n.createElement("select",{id:"settings-preferred-locale",className:"inputgroup__input inputgroup__input--select",value:b,onChange:e=>{B(e.target.value)}},j.map((({name:e,local:t,location:a,tag:r})=>n.createElement("option",{value:r,key:r},`${t||e}${a?` - ${a}`:""} (${r})`))))),n.createElement(Wl,null),"esp8266"===(0,vl._)()?.env?null:n.createElement(pt,{id:"settings-printer-url",labelText:"Printer URL",type:dt.TEXT,value:z,onChange:H,autoComplete:"url",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onBlur:()=>{const e=(0,co.A)(z,"http");H(e),M(e)},onKeyUp:e=>{switch(e){case"Enter":{const e=(0,co.A)(z,"http");H(e),M(e);break}case"Escape":H(_)}}},n.createElement("span",{className:"inputgroup__note"},"If you own a physical wifi-printer, you can add it's URL here and check the ",n.createElement(r.N_,{to:"/import"},"Import-tab"))),"esp8266"===(0,vl._)()?.env||_?n.createElement(pt,{id:"settings-printer-settings",labelText:"Additional printer settings",type:dt.TEXT,value:W,onChange:X,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onBlur:()=>{L(W)},onKeyUp:e=>{switch(e){case"Enter":L(W);break;case"Escape":X(v)}}}):null,n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":e})},n.createElement("span",{className:"inputgroup__label",title:"Show debug info"},"Show debug info"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:e,onChange:({target:e})=>{k(e.checked)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":t})},n.createElement("span",{className:"inputgroup__label",title:"Enable Image Groups"},"Enable Image Groups"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:t,onChange:({target:e})=>{C(e.checked)}}),n.createElement(g,{name:"checkmark"}))))};var uo=function(){const{gitStorage:e,setGitStorage:t}=(0,M.A)(),[a,r]=(0,n.useState)(e);return n.createElement(n.Fragment,null,n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":a.use})},n.createElement("span",{className:"inputgroup__label",title:"Use github as storage"},"Use github as storage"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:a.use,onChange:({target:e})=>{const n={...a,use:e.checked};r(n),t(n)}}),n.createElement(g,{name:"checkmark"}))),a.use?n.createElement(n.Fragment,null,n.createElement(pt,{id:"settings-git-owner",labelText:"Owner",type:dt.TEXT,value:a.owner,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{r({...a,owner:e})},onBlur:()=>{t(a)}}),n.createElement(pt,{id:"settings-git-repo",labelText:"Repository name",type:dt.TEXT,value:a.repo,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{r({...a,repo:e})},onBlur:()=>{t(a)}}),n.createElement(pt,{id:"settings-git-branch",labelText:"Branch",type:dt.TEXT,value:a.branch,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{r({...a,branch:e})},onBlur:()=>{t(a)}}),n.createElement(pt,{id:"settings-git-throttle",labelText:"Throttle (in ms)",type:dt.NUMBER,min:10,max:5e3,step:25,value:a.throttle,onChange:e=>{r({...a,throttle:parseInt(e,10)})},onBlur:()=>{t(a)}}),n.createElement(pt,{id:"settings-git-token",labelText:"Token",type:dt.PASSWORD,value:a.token,onChange:e=>{r({...a,token:e})},autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onBlur:()=>{t(a)}},n.createElement("span",{className:"inputgroup__note"},"Go to GitHub to create a ",n.createElement("a",{href:"https://github.com/settings/personal-access-tokens/new",target:"_blank",rel:"noreferrer"},"new fine-grained personal access token"),", select the repository you want to use for synching and allow read/write for ",n.createElement("code",{className:"inputgroup__note--code"},'"Repositoty Permissions > Contents"')))):null)};const po=e=>{switch(e){case"number":return dt.NUMBER;case"string":default:return dt.TEXT;case"multiline":return dt.TEXTAREA}},go=(e,t)=>{switch(e){case"number":{const e=parseFloat(t);return isNaN(e)?0:e}case"string":return t||"";default:return t}};var ho=function(){const{plugins:e,deletePlugin:t,updatePluginConfig:a}=(0,E.h)(),{validateAndAddPlugin:r}=b(),[l,s]=(0,n.useState)("");return n.createElement(n.Fragment,null,n.createElement("a",{rel:"noreferrer noopener nofollow",href:"https://herrzatacke.github.io/gb-printer-web-plugins/",className:"plugin-settings__ext-link",target:"_blank"},"🔗 Some plugins can be found here"),n.createElement(pt,{id:"plugin-settings-add-plugin",labelText:"Add Plugin",type:dt.TEXT,value:l,autoComplete:"url",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:s,buttonOnClick:async()=>{await r({url:l})&&s("")},buttonIcon:l?"add":void 0}),n.createElement("ul",{className:"plugin-settings__plugin-list"},e.map((({url:e,name:r,description:l,configParams:s={},config:F={},error:o,loading:i},c)=>n.createElement("li",{className:"plugin-settings__plugin",key:e},n.createElement("div",{className:"plugin-settings__plugin-details"},n.createElement("span",{className:"plugin-settings__plugin-name"},r),n.createElement("code",{className:"plugin-settings__plugin-url"},e),n.createElement("small",{className:"plugin-settings__plugin-description"},l)),o&&n.createElement("span",{className:"plugin-settings__plugin-warning",title:o},n.createElement(g,{name:"warn"})),i&&n.createElement("span",{className:"plugin-settings__plugin-loading",title:"Loading plugin"},n.createElement(g,{name:"loading"})),n.createElement("button",{type:"button",className:"button plugin-settings__button plugin-settings__button--delete",onClick:()=>t(e)},n.createElement(g,{name:"delete"})),n.createElement("div",{className:"plugin-settings__config-options"},Object.keys(s).map((t=>{const{type:r,label:l}=s[t];return n.createElement(pt,{id:`${t}-${c}`,key:`${t}-${c}`,labelText:l,type:po(r),value:go(r,F[t]),autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:n=>{a(e,t,go(r,n))}})}))))))))},Eo=a(5431);var fo=function(){const{use:e,loggedIn:t,logout:a,startAuth:r,setDropboxStorage:l,path:s,autoDropboxSync:F}=(()=>{const e=G(),{remoteImport:t}=he(),{dropboxStorage:a,dropboxLogout:n,setDropboxStorage:r}=(0,M.A)();return{use:!!a.use,loggedIn:!!a.refreshToken,path:a.path||"",autoDropboxSync:a?.autoDropboxSync||!1,logout:n,setDropboxStorage:r,startAuth:()=>se(e,t).startAuth()}})(),[i,c]=(0,n.useState)(s);return n.createElement(n.Fragment,null,n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":e})},n.createElement("span",{className:"inputgroup__label",title:"Use Dropbox as storage"},"Use Dropbox as storage"),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:e,onChange:({target:e})=>{l({use:e.checked})}}),n.createElement(g,{name:"checkmark"}))),n.createElement(pt,{id:"dropbox-settings-path",value:i,type:dt.TEXT,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:c,onBlur:()=>{c((0,Eo.A)(i)),l({path:(0,Eo.A)(i)})},labelText:"Subfolder"},n.createElement("a",{className:"inputgroup__note",title:`Open Dropbox folder:\nhttps://www.dropbox.com/home/Apps/GameBoyPrinter/${i}`,href:`https://www.dropbox.com/home/Apps/GameBoyPrinter/${i}`,target:"_blank",rel:"noreferrer"},"open")),e?n.createElement(n.Fragment,null,n.createElement("label",{className:o()("inputgroup checkgroup",{"checkgroup--checked":F})},n.createElement("span",{className:"inputgroup__label",title:"Enable enhanced dropbox sync (experimental)"},"Enable enhanced dropbox sync",n.createElement("span",{className:"inputgroup__note inputgroup__note--warn"},"This is currently an experimental feature.")),n.createElement("span",{className:"checkgroup__checkbox-wrapper"},n.createElement("input",{type:"checkbox",className:"checkgroup__input",checked:F,onChange:({target:e})=>{l({autoDropboxSync:e.checked}),window.setTimeout((()=>{window.location.reload()}),300)}}),n.createElement(g,{name:"checkmark"}))),n.createElement("div",{className:"inputgroup buttongroup"},n.createElement("button",{type:"button",className:"button",disabled:t,onClick:r},"Authenticate"),n.createElement("button",{type:"button",className:"button",disabled:!t,onClick:a},"Logout"))):null)};var bo=function(e){return n.createElement("div",{className:o()("wifi-settings__ap-group",{"wifi-settings__ap-group--delete":e.delete})},n.createElement(pt,{id:`${e.id}-settings-ap-ssid`,labelText:"Network SSID",type:dt.TEXT,value:e.ssid,disabled:!e.isNew||e.disabled,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:t=>{e.update({ssid:t})},buttonOnClick:()=>{e.update({delete:!e.delete})},buttonIcon:"delete"}),n.createElement(pt,{id:`${e.id}-settings-ap-psk`,labelText:"Network Password",type:dt.PASSWORD,value:e.psk,disabled:e.disabled,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:t=>{e.update({psk:t})}}))};const vo=(e,t)=>{t("loading");const a=new AbortController,n=a.signal;return(async()=>{try{const a=await fetch("/wificonfig/get",{signal:n}),r=await a.json();r.mdns=r.mdns||"",r.ap=r.ap||{ssid:"",psk:""},r.networks=r.networks||[],t(""),e(r)}catch(a){n.aborted||(t("error"),e(void 0))}})(),()=>{a.abort("Navigated while getting wifi settings")}};var _o=function(){const e=(0,n.useRef)(null),[t,a]=(0,n.useState)(),[r,l]=(0,n.useState)("loading");if((0,n.useEffect)((()=>vo(a,l)),[a,l]),"loading"===r||!t)return n.createElement("div",{className:"wifi-settings--loading"});const s=""!==r&&"updated"!==r;return n.createElement("div",{className:"wifi-settings",ref:e},n.createElement("h3",{className:"wifi-settings__subheadline"},"Host Settings"),n.createElement(pt,{id:"settings-mdns",labelText:"mDNS Name (Bonjour/Avahi)",type:dt.TEXT,disabled:s,value:t.mdns,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{l("updated"),a({...t,mdns:e.trim()})}}),n.createElement(pt,{id:"settings-ap-ssid",labelText:"Accesspoint SSID",type:dt.TEXT,disabled:s,value:t.ap.ssid,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{l("updated"),a({...t,ap:{...t.ap,ssid:e.trim()}})}}),n.createElement(pt,{id:"settings-ap-psk",labelText:"Accesspoint Password",type:dt.PASSWORD,disabled:s,value:t.ap.psk,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,onChange:e=>{l("updated"),a({...t,ap:{...t.ap,psk:e.trim()}})}}),n.createElement("h3",{className:"wifi-settings__subheadline"},"Networks",n.createElement("button",{type:"button",disabled:s,className:"button wifi-settings__button wifi-settings__button--add",onClick:()=>{const{networks:e}=t;e.push({ssid:"",psk:"",delete:!1,isNew:!0}),a({...t,networks:e})}},n.createElement(g,{name:"add"}))),n.createElement("ul",{className:"wifi-settings__ap-groups"},t.networks.map(((e,r)=>{const{ssid:F,psk:o="",delete:i=!1,isNew:c=!1}=e;return n.createElement(bo,{key:`apconf-${r}`,id:`apconf-${r}`,ssid:F,psk:o,disabled:s,isNew:c,delete:i,update:n=>{const{networks:s}=t;s[r]={...e,...n},l("updated"),a({...t,networks:s})}})}))),n.createElement("div",{className:"inputgroup buttongroup"},n.createElement("button",{type:"button",disabled:"updated"!==r,className:"button",onClick:()=>(async(e,t,a)=>{const n={...a,networks:a.networks.filter((e=>!0===e.delete||e.psk)).filter((e=>e.ssid)).filter((e=>!(e.delete&&e.isNew))).map((({ssid:e,psk:t,delete:a})=>({delete:a,ssid:e,psk:t})))};t("loading");try{const e=await fetch("/wificonfig/set",{method:"post",body:JSON.stringify(n)}),t=await e.json();if(t.error)throw new Error(t.error)}catch(a){alert(a),t("error"),e(void 0)}vo(e,t)})(a,l,t)},"Save WiFi-Settings")))};let yo,No=!1;var wo=()=>{const{setDragover:e,setError:t}=(0,w.A)(),{jsonImport:a}=he(),r=(0,n.useMemo)((()=>Hr(a)),[a]),l=(0,n.useCallback)((()=>{const a=t=>{t.preventDefault(),No||e(!0),window.clearTimeout(yo),No=!0,yo=window.setTimeout((()=>{No=!1,e(!1)}),250)},n=async e=>{let a;e.preventDefault();const n=e.dataTransfer.items;if(n)a=[...n].reduce(((e,t)=>{if("file"===t.kind){const a=t.getAsFile();return a?[...e,a]:e}return e}),[]);else{a=[...e.dataTransfer.files]}try{await r(a)}catch(e){t(e)}},l=document.querySelector("body");if(!l)throw new Error("dafuq?");return l.addEventListener("dragover",a),l.addEventListener("drop",n),()=>{l.removeEventListener("dragover",a),l.removeEventListener("drop",n)}}),[r,e,t]);(0,n.useEffect)(l,[l])};var ko=function(){wo();const e=G(),{remoteImport:t}=he();(0,n.useEffect)((()=>{const{subscribe:a}=se(e,t);return hF(t),a()}),[t,e]);const{checkUpdateTrashCount:a}=GF();(0,n.useEffect)((()=>{a()}),[a]);const l=(0,r.Ge)([{path:"/",element:n.createElement(lo,null),errorElement:n.createElement(Fo,null),children:[{path:"/home",element:n.createElement(s,null)},{path:"/gallery/*",element:n.createElement(at,null),handle:{headline:"Gallery"}},{path:"/import",element:n.createElement(jr,null),handle:{headline:"Import"}},{path:"/palettes",element:n.createElement(Fl,null),handle:{headline:"Palettes"}},{path:"/frames",element:n.createElement(pl,null),handle:{headline:"Frames"}},{path:"/settings",element:n.createElement(Nl,null),handle:{headline:"Settings"},children:[{path:"generic",element:n.createElement(mo,null),handle:{headline:"Generic Settings"}},{path:"git",element:n.createElement(uo,null),handle:{headline:"Git Settings"}},{path:"plugins",element:n.createElement(ho,null),handle:{headline:"Plugin Settings"}},{path:"dropbox",element:n.createElement(fo,null),handle:{headline:"Dropbox Settings"}},"esp8266"===(0,vl._)()?.env||"webpack-dev"===(0,vl._)()?.env?{path:"wifi",element:n.createElement(_o,null),handle:{headline:"WiFi Settings"}}:null].reduce(Gr.N,[])},{path:"/webusb",element:n.createElement(Xl,null)},{path:"/add-plugin/:pluginUrl?",element:n.createElement(Ql,null),handle:{headline:"Add Plugin"}}]}]);return n.createElement(r.pg,{router:l})}},7402:function(e,t,a){var n;a.d(t,{V:function(){return n}}),function(e){e.DEFAULT_ASC="default_asc",e.DEFAULT_DESC="default_desc",e.USAGE_ASC="usage_asc",e.USAGE_DESC="usage_desc",e.NAME_ASC="name_asc",e.NAME_DESC="name_desc"}(n||(n={}))},7482:function(e,t,a){a.d(t,{N:function(){return n}});const n=(e,t)=>t?[...e,t]:e},7580:function(e,t,a){a.d(t,{A:function(){return r}});var n=a(784);const r=({palette:e,framePalette:t,invertPalette:a=!1,invertFramePalette:r=!1})=>{const l=e||n.CU,s=t||l;return{palette:a?[...l].reverse():[...l],framePalette:r?[...s].reverse():[...s]}}},7769:function(e,t){t.A=(e,t)=>{if(!e.trim())return"";if("/"===e&&"ws"!==t)return e;return`${!!e.match(new RegExp(`^${t}(s)?:\\/\\/`,"gi"))?"":`${t}://`}${e}${e.endsWith("/")?"":"/"}`}},7837:function(e,t,a){a.d(t,{A:function(){return g}});var n=a(2388),r=a(7673),l=a(3876),s=a(2419),F=a(7261),o=a(7372);var i=async e=>{const t=e.reduce(((e,t)=>[...e,...(0,F.pl)(t)?(0,o.A)(Object.values(t.hashes)):[t.hash]]),[]),a=await Promise.all(t.map((async e=>({hash:e,data:await s.mU.getItem(e)})))),n={};return a.forEach((({hash:e,data:t})=>{t&&(n[e]=t)})),n};var c=async e=>{const t=await Promise.all(e.map((async e=>({hash:e,data:await s.Uv.getItem(e)})))),a={};return t.forEach((({hash:e,data:t})=>{t&&(a[`frame-${e}`]=t)})),a};var m=(e,t,a)=>{switch(e){case"images":return t.map((({hash:e})=>e));case"selected_images":return a;default:return[]}};var u=(e,t,a="")=>{switch(e){case"frames":return t.map((({hash:e})=>e));case"current_framegroup":return t.filter((({id:e})=>e.startsWith(a))).map((({hash:e})=>e));default:return[]}},d=a(1562);const p=e=>{switch(e){case l.m.ALL:return["frameGroups","frames","imageGroups","images","palettes","plugins"];case l.m.SELECTED_IMAGES:return["images"];case l.m.IMAGES:return["images","imageGroups"];case l.m.PALETTES:return["palettes"];case l.m.FRAMES:case l.m.CURRENT_FRAMEGROUP:return["frames","frameGroups"];case l.m.PLUGINS:return["plugins"];default:return[]}};var g=()=>async(e,{lastUpdateUTC:t,selectedFrameGroup:a}={})=>{const{frames:s,images:F,palettes:o,imageGroups:g,frameGroups:h,plugins:E}=n.h.getState(),{imageSelection:f}=r.A.getState(),b={...p(e).reduce(((t,n)=>{switch(n){case"frameGroups":return{...t,[n]:e===l.m.CURRENT_FRAMEGROUP?h.filter((e=>e.id===a)):(0,d.A)(s,h)};case"frames":{const r=e===l.m.FRAMES?"frames":"current_framegroup",F=u(r,s,a);return{...t,[n]:s.filter((({hash:e})=>F.includes(e)))}}case"imageGroups":return{...t,imageGroups:g};case"images":{const a=e===l.m.SELECTED_IMAGES?"selected_images":"images",r=m(a,F,f);return{...t,[n]:F.filter((({hash:e})=>r.includes(e)))}}case"palettes":return{...t,palettes:o.filter((({isPredefined:e})=>!e))};case"plugins":return{...t,plugins:E};default:return t}}),{}),lastUpdateUTC:t||Math.floor((new Date).getTime()/1e3),version:n.A};switch(e){case l.m.IMAGES:case l.m.SELECTED_IMAGES:{if(!b.images)return JSON.stringify({state:b},null,2);const e=await i(b.images);return JSON.stringify({state:b,...e},null,2)}case l.m.FRAMES:case l.m.CURRENT_FRAMEGROUP:{const t=await c(u(e,s,a));return JSON.stringify({state:b,...t},null,2)}default:return JSON.stringify({state:b},null,2)}}},7947:function(e,t,a){var n=a(1511),r=a(7134),l=a(784),s=a(4353),F=a.n(s),o=a(4704),i=a(7769),c=a(5534),m=a(3920),u=a(7402),d=a(3839),p=a(6763);const g=()=>{const[e,t]=navigator.language.split("-");return[e,t].filter(Boolean).join("-")},h=(0,n.v)((0,r.Zr)(((e,t)=>({activePalette:"bw",enableDebug:!1,exportFileTypes:["png"],exportScaleFactors:[4],forceMagicCheck:!0,galleryView:d.j.GALLERY_VIEW_1X,handleExportFrame:l.H.FRAMEMODE_KEEP,hideDates:!1,importDeleted:!0,importLastSeen:!0,importPad:!1,pageSize:30,preferredLocale:g(),printerParams:"",printerUrl:"esp8266"===(0,m._)()?.env?"/":"",savFrameTypes:"int",enableImageGroups:!1,sortPalettes:u.V.DEFAULT_DESC,useSerials:!1,videoParams:{},setActivePalette:t=>e({activePalette:t}),setEnableDebug:t=>e({enableDebug:t}),setForceMagicCheck:t=>e({forceMagicCheck:t}),setGalleryView:t=>e({galleryView:t}),setHandleExportFrame:t=>e({handleExportFrame:t}),setHideDates:t=>e({hideDates:t}),setImportDeleted:t=>e({importDeleted:t}),setImportLastSeen:t=>e({importLastSeen:t}),setImportPad:t=>e({importPad:t}),setPageSize:t=>e({pageSize:t}),setPrinterParams:t=>e({printerParams:t}),setPrinterUrl:t=>e({printerUrl:(0,i.A)(t,"http")}),setSavFrameTypes:t=>e({savFrameTypes:t}),setEnableImageGroups:t=>e({enableImageGroups:t}),setSortPalettes:t=>e({sortPalettes:t}),setUseSerials:t=>e({useSerials:t}),setVideoParams:t=>e((e=>({videoParams:{...e.videoParams,...t}}))),setExportScaleFactors:(a,n)=>{const{exportScaleFactors:r}=t();e({exportScaleFactors:n?[...r,a]:r.filter((e=>e!==a))})},setExportFileTypes:(a,n)=>{const{exportFileTypes:r}=t();e({exportFileTypes:n?[...r,a]:r.filter((e=>e!==a))})},setPreferredLocale:t=>{try{(0,c.A)(F()(),t),e({preferredLocale:t})}catch(e){p.error(e)}}})),{name:`${o.z}-settings`,storage:(0,r.KU)((()=>localStorage))}));t.A=h},8025:function(e,t,a){a.d(t,{Z:function(){return n}});var n,r=a(8287).Buffer;!function(e){e.UINT8_ARRAY="uint8array",e.TEXT="text",e.DATA_URL="dataURL",e.BINARY_STRING="binaryString"}(n||(n={})),t.A=function(e,t){return new Promise(((a,l)=>{const s=new FileReader;switch(s.onload=({target:e})=>{if(e?.result)return t===n.UINT8_ARRAY?void a(r.from(e.result)):void a(e.result);l(new Error("Filereader has no result"))},s.onerror=e=>{l(e)},t){case n.UINT8_ARRAY:s.readAsArrayBuffer(e);break;case n.TEXT:s.readAsText(e);break;case n.BINARY_STRING:s.readAsBinaryString(e);break;case n.DATA_URL:s.readAsDataURL(e);break;default:l(new Error(`readAs param missing or unknown type "${t}"`))}}))}},8137:function(e,t,a){a.d(t,{PM:function(){return l},YZ:function(){return n},lt:function(){return r}});const n=(e,t)=>({...e,sortIndex:t}),r=e=>({...e,sortIndex:void 0}),l=e=>(t,a)=>{if(!e)return 0;const[n,r]=e.split("_"),l=t[n],s=a[n],F="desc"===r?-1:1;return l&&s?l>s?F:l<s?-F:t.sortIndex<a.sortIndex?F:-F:0}},8714:function(e,t,a){a.d(t,{L2:function(){return o},_K:function(){return F}});var n=a(521),r=a(8222),l=a(7482),s=a(7261);const F=async e=>{const t=e.split("\n").filter((e=>e.match(/^[0-9a-f ]+$/gi)));return(0,n.UN)(t)},o=e=>{const t=Array(32).fill("f").join(""),a=Array(16).fill(t);return[...e.upper,...Array(14).fill("").map(((t,n)=>[...e.left[n],...a,...e.right[n]])).flat(),...e.lower]};t.Ay=async({images:e,frames:t,settings:a})=>{const i=a.state.images||[],c=a.state.frames||[],m=(await Promise.all(e.map((async e=>{const t=await(0,n.Hh)(e.hash,void 0,!0);if(t?.length)return;const a=await e.getFileContent(),r=await F(a);return e.hash!==r?{oldHash:e.hash,newHash:r}:void 0})))).reduce(l.N,[]),u=(await Promise.all(t.map((async e=>{if(await(0,r.mZ)(e.hash))return;const t=await e.getFileContent(),a=await(async e=>{const t=JSON.parse(e),a=t.upper.length/20,n=o(t);return(0,r.R_)(n,a)})(t);return e.hash!==a?{oldHash:e.hash,newHash:a}:void 0})))).reduce(l.N,[]),d=i.map((e=>{if((0,s.pl)(e)){const t=e,a=m.find((({oldHash:e})=>e===t.hashes.r)),n=m.find((({oldHash:e})=>e===t.hashes.g)),r=m.find((({oldHash:e})=>e===t.hashes.b)),l=m.find((({oldHash:e})=>e===t.hashes.n));return{...t,hashes:{r:a?.newHash||t.hashes.r,g:n?.newHash||t.hashes.g,b:r?.newHash||t.hashes.b,n:l?.newHash||t.hashes.n}}}const t=m.find((({oldHash:t})=>t===e.hash));return{...e,hash:t?.newHash||e.hash}})),p=c.map((e=>{const t=u.find((({oldHash:t})=>t===e.hash));return t?{...e,hash:t.newHash}:e}));return{...a,state:{...a.state,images:d,frames:p}}}},9200:function(e,t,a){a.d(t,{S:function(){return s}});var n=a(8137),r=a(6521),l=a(985);const s=(e,{filtersActiveTags:t,sortBy:a,recentImports:s})=>[...e].map(n.YZ).sort((0,n.PM)(a)).map(n.lt).filter((0,r.A)(t,s)).filter((0,l.A)(t))},9809:function(e,t,a){a.d(t,{Z:function(){return l}});var n=a(521),r=a(498);const l=async(e,t,a)=>{const l=(await(0,n.Hh)(e)||[]).map((e=>e.match(/.{1,2}/g)?.join(" ")||"")).reduce(((e,t,a)=>a%40?[...e,t]:[...e,r.g0,t]),[]),s=[r.dm,...l,r.R2,r.Ys].join("\n");return{folder:"images",filename:`${a}.txt`,blob:new Blob(new Array(s),{type:"text/plain"}),title:t}}},9860:function(e,t,a){a.d(t,{A:function(){return s}});var n=a(4213);var r=e=>"function"==typeof e.arrayBuffer?e.arrayBuffer():new Promise((t=>{const a=new FileReader;a.onload=e=>{if(!e.target)throw new Error("no file");const a=e.target.result;if("string"==typeof a||null===a)throw new Error("unexpected filereader result");t(a)},a.readAsArrayBuffer(e)})),l=a(3052);var s=e=>async t=>{if(1===t.length){const e=t[0];return(0,n.saveAs)(e.blob,e.filename)}const{default:s}=await a.e(710).then(a.t.bind(a,1710,23)),F=new s,o=await Promise.all(t.map((({filename:e,blob:t})=>r(t).then((t=>({filename:e,arrayBuffer:t}))))));(0,l.A)(o).forEach((({filename:e,arrayBuffer:t})=>{F.file(e,t)}));const i=await F.generateAsync({type:"blob",compression:"DEFLATE"});if(!e)throw new Error("missing filename");return(0,n.saveAs)(i,`${e}.zip`)}},9905:function(e,t,a){var n=a(4353),r=a.n(n),l=a(3460),s=a(445),F=a.n(s),o=a(498);r().extend(F());const i=(e,t="-")=>e.reduce(((e,a)=>a?`${e}${e?t:""}${a}`:e),"");t.A=e=>{const t=e.image||null,a=e.palette||null,n=e.exportScaleFactor||null,s=e.useCurrentDate||null,F=e.frameRate?.toString(10)||"",c=e.altTitle||"",m=e.frameName||"",u=e.paletteShort||"",d=s||!t?r()():r()(t.created,o.i$),p=d.isValid()?d.format(o.fE):"",g=u||(a?a.shortName||(({r:e,g:t,b:a,n:n})=>{const r=e=>e.toString(16).padStart(2,"0");return i([e?.map(r).join("")||"",t?.map(r).join("")||"",a?.map(r).join("")||"",n?.map(r).join("")||""],".")})(a):""),h=i([p,t&&t.title?t.title:c,n?`${n}x`:"",F?`${F}fps`:"",m,g]);return(0,l.A)(h,{replacement:""})}}}]);