(self.webpackChunkgb_printer_web=self.webpackChunkgb_printer_web||[]).push([[340],{"./src/javascript/app/store/middlewares/gitStorage/middleware.js":function(e,t,r){"use strict";r.r(t),r.d(t,{init:function(){return k},middleware:function(){return P}}),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.promise.js"),r("./node_modules/core-js/modules/web.timers.js"),r("./node_modules/core-js/modules/es.date.to-string.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.function.bind.js");var o=r("./node_modules/promise-queue/lib/index.js"),n=r.n(o),s=(r("./node_modules/core-js/modules/es.parse-int.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.find.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.array.index-of.js"),r("./node_modules/core-js/modules/es.object.set-prototype-of.js"),r("./node_modules/core-js/modules/es.object.get-prototype-of.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.object.create.js"),r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.object.define-properties.js"),r("./node_modules/core-js/modules/es.array.is-array.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/events/events.js")),a=r.n(s),i=r("./node_modules/@octokit/rest/dist-web/index.js"),u=r("./node_modules/dayjs/dayjs.min.js"),c=r.n(u),l=r("./src/javascript/app/defaults.js");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w,O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(a,e);var t,r,o,n,s=(o=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(o);if(n){var r=_(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return v(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return y(this,a),(e=s.call(this)).octoKit=null,e.busy=!1,e.owner=null,e.repo=null,e.branch=null,e.throttle=null,e.token=null,e.progress=0,e.queueLength=0,e.addToQueue=r,e.setOctokit(t),e}return t=a,(r=[{key:"setOctokit",value:function(e){var t=e.use,r=e.owner,o=e.repo,n=e.branch,s=e.throttle,a=e.token;if(this.busy||!t||!r||!o||!n||!s||!a)return this.octoKit=null,this.owner=null,this.repo=null,this.branch=null,this.throttle=null,void(this.token=null);this.owner=r,this.repo=o,this.branch=n,this.throttle=Math.max(parseInt(s,10)||0,10),this.token=a,this.octoKit=new i.v({auth:a})}},{key:"progressStart",value:function(e){this.queueLength=e+7,this.emit("starting",{progress:0,queueLength:this.queueLength}),this.progressTick()}},{key:"progressTick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.progress=e?0:this.progress+1,this.emit("progress",{progress:this.progress,queueLength:this.queueLength}),e&&(this.queueLength=0)}},{key:"getRepoContents",value:function(){var e=this;this.progressTick();var t=[{path:"images",value:[]},{path:"frames",value:[]},{path:"settings.json",value:{}}];return this.addToQueue("repos.getContent /",this.throttle,(function(){return e.octoKit.repos.getContent({owner:e.owner,repo:e.repo,ref:"heads/".concat(e.branch),path:""})})).then((function(r){var o=r.data;return Promise.all(t.map((function(t){var r=t.path,n=t.value;return o.find((function(e){return e.path===r}))?e.addToQueue("repos.getContent /".concat(r),e.throttle,(function(){return e.octoKit.repos.getContent({owner:e.owner,repo:e.repo,ref:"heads/".concat(e.branch),path:r})})).then((function(e){var t=e.data;return{path:r,value:"file"===t.type?JSON.parse(atob(t.content)):t}})).catch((function(){return{path:r,value:n}})):Promise.resolve({path:r,value:n})}))).then((function(t){return{images:e.augmentFileList("images",t.find((function(e){return"images"===e.path})).value),frames:e.augmentFileList("frames",t.find((function(e){return"frames"===e.path})).value),settings:t.find((function(e){return"settings.json"===e.path})).value}}))}))}},{key:"augmentFileList",value:function(e,t){var r=this;return t.map((function(o,n){var s=j(j({},o),{},{getFileContent:function(){return r.getFileContent(o.sha,n,t.length)}});switch(e){case"images":return Object.assign(s,{hash:o.name.substr(0,40)});case"frames":return Object.assign(s,{id:o.name.match(/^[a-z]+[0-9]+/gi)[0]});default:return s}}))}},{key:"getFileContent",value:function(e,t,r){var o=this;return this.progressTick(),this.addToQueue("git.getBlob (".concat(t+1,"/").concat(r,") ").concat(e),this.throttle,(function(){return o.octoKit.git.getBlob({owner:o.owner,repo:o.repo,file_sha:e})})).then((function(e){var t=e.data.content;return atob(t)}))}},{key:"getCurrentCommit",value:function(){var e=this;return this.progressTick(),this.addToQueue("git.getRef heads/".concat(this.branch),this.throttle,(function(){return e.octoKit.git.getRef({owner:e.owner,repo:e.repo,ref:"heads/".concat(e.branch)})})).then((function(t){var r=t.data.object.sha;return e.addToQueue("git.getCommit ".concat(r),e.throttle,(function(){return e.octoKit.git.getCommit({owner:e.owner,repo:e.repo,commit_sha:r})})).then((function(e){var t=e.data;return{commitSha:r,treeSha:t.tree.sha}}))}))}},{key:"createBlobForFile",value:function(e,t,r){var o=this,n=e.destination,s=e.blob;return this.progressTick(),new Promise((function(e){var t=new FileReader;t.onloadend=function(t){var r=t.target;e(r.result)},t.readAsDataURL(s)})).then((function(e){var s=e.indexOf(";base64,")+8,a=e.substr(s);return o.addToQueue("git.createBlob (".concat(t+1,"/").concat(r,") ").concat(n),o.throttle,(function(){return o.octoKit.git.createBlob({owner:o.owner,repo:o.repo,content:a,encoding:"base64"})})).then((function(e){var t=e.data;return{filename:n,blobData:t}}))}))}},{key:"createNewTree",value:function(e,t){var r=this,o=e.files,n=e.del;this.progressTick();var s=o.map((function(e){return{path:e.filename,mode:"100644",type:"blob",sha:e.blobData.sha}})),a=n.map((function(e){return{path:e.path,mode:"100644",sha:null}}));return this.addToQueue("git.createTree ".concat(t),this.throttle,(function(){return r.octoKit.git.createTree({owner:r.owner,repo:r.repo,tree:[].concat(m(s),m(a)),base_tree:t})})).then((function(e){return e.data}))}},{key:"createNewCommit",value:function(e,t,r){var o=this;return this.progressTick(),this.addToQueue("git.createCommit ".concat(e),this.throttle,(function(){return o.octoKit.git.createCommit({owner:o.owner,repo:o.repo,message:e,tree:t,parents:[r]})})).then((function(e){return e.data}))}},{key:"setBranchToCommit",value:function(e){var t=this;return this.progressTick(),this.addToQueue("git.updateRef ".concat(e),this.throttle,(function(){return t.octoKit.git.updateRef({owner:t.owner,repo:t.repo,ref:"heads/".concat(t.branch),sha:e})})).then((function(e){return e.data}))}},{key:"uploadToRepo",value:function(e){var t=this,r=e.upload,o=e.del;if(!this.octoKit)return Promise.reject(new Error("OctoClient not configured"));var n="Sync. ".concat(c()().format(l.W4)),s=r.length;return this.getCurrentCommit().then((function(e){var a=e.treeSha,i=e.commitSha;return Promise.all(r.map((function(e,r){return t.createBlobForFile(e,r,s)}))).then((function(e){return t.createNewTree({files:e,del:o},a)})).then((function(e){var r=e.sha;return t.createNewCommit(n,r,i)})).then((function(e){var r=e.sha;return t.setBranchToCommit(r)}))}))}},{key:"updateRemoteStore",value:function(e){var t=this,r=e.upload,o=void 0===r?[]:r,n=e.del,s=void 0===n?[]:n;return this.busy?Promise.reject(Error("currently busy")):o.length||s.length?(this.progressStart(o.length),this.busy=!0,this.uploadToRepo({upload:o,del:s}).then((function(){return t.progressTick(!0),t.busy=!1,{uploaded:o.map((function(e){return e.destination})),deleted:s.map((function(e){return e.path})),repo:"https://github.com/".concat(t.owner,"/").concat(t.repo,"/tree/").concat(t.branch)}})).catch((function(e){throw t.busy=!1,t.emit("error",e),e}))):Promise.resolve({})}}])&&g(t.prototype,r),a}(a()),S=r("./src/javascript/tools/getUploadImages/index.js"),T=r("./src/javascript/tools/saveLocalStorageItems/index.js"),A=function(){},k=function(e){var t=e.getState().gitStorage,r=new(n())({concurrency:1});w=new O(t,(A=function(t){return function(o,n,s){return r.add((function(){return new Promise((function(r,a){window.setTimeout((function(){e.dispatch({type:"GITSTORAGE_LOG_ACTION",payload:{timestamp:(new Date).getTime()/1e3,message:"".concat(t," runs ").concat(o)}}),s().then(r).catch(a)}),n)}))}))}})("OctoClient"))},P=function(e){return function(t){"STORAGE_SYNC_START"===t.type&&"git"===t.payload.storageType?w.getRepoContents().then((function(r){switch(t.payload.direction){case"up":return(0,S.Z)(e,r,A("GBPrinter")).then(w.updateRemoteStore.bind(w));case"down":return(0,T.Z)(r).then((function(t){return e.dispatch({type:"GIT_SETTINGS_IMPORT",payload:r.settings}),t}));default:return Promise.reject(new Error("github sync: wrong sync case"))}})).then((function(t){e.dispatch({type:"STORAGE_SYNC_DONE",payload:{syncResult:t,storageType:"git"}})})).catch((function(t){console.error(t),e.dispatch({type:"ERROR",payload:t.message})})):"SET_GIT_STORAGE"===t.type&&w.setOctokit(t.payload)}}},"./src/javascript/tools/getUploadImages/index.js":function(e,t,r){"use strict";r.d(t,{Z:function(){return y}}),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.find.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.promise.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.object.define-properties.js"),r("./node_modules/core-js/modules/es.array.is-array.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.array.slice.js");var o=r("./src/javascript/tools/download/getPrepareFiles.js"),n=r("./src/javascript/tools/loadImageTiles/index.js"),s=r("./src/javascript/tools/getImagePalette/index.js"),a=r("./src/javascript/tools/applyFrame/frameData.js");function i(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r("./node_modules/core-js/modules/es.array.index-of.js");var c=(r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.array.join.js"),r("./src/javascript/tools/getGetSettings/index.js"));function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function m(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e,t,r){var u=e.getState(),d=(0,o.Z)(j(j({},u),{},{exportScaleFactors:[1],exportFileTypes:["txt"],handleExportFrame:"keep"})),f=function(e){var t=(0,c.Z)(e);return function(e){var r=[],o=[],n={};e.forEach((function(e){var t=e.hash,s=e.files,a=e.inRepo;o.push.apply(o,l(a.map((function(e){var t=e.path,r=t.split("/")[0];return n[r]=n[r]?n[r]+1:1,{destination:t}})))),r.push.apply(r,l(s.map((function(e){var r=e.blob,o=e.folder,s=function(e){switch(e){case"image/png":return"png";case"image/jpg":case"image/jpeg":return"jpg";case"image/webp":return"webp";case"text/plain":return"txt";case"text/markdown":return"md";case"application/json":case"text/json":return"json";default:return console.warn('unknown file extension for type "'.concat(e,'"')),"none"}}(r.type),a=o||s;return n[a]=n[a]?n[a]+1:1,{destination:"".concat(a,"/").concat(t,".").concat(s),blob:r}}))))}));var s=["## Files in this repo:"].concat(l(Object.keys(n).map((function(e){return" * ".concat(e,": [").concat(n[e],"](/").concat(e,")")})))).join("\n");return t("remote").then((function(e){return r.push({destination:"README.md",blob:new Blob(l(s),{type:"text/plain"})},{destination:"settings.json",blob:new Blob(l(e),{type:"application/json"})}),{toUpload:r.filter(Boolean),toKeep:o.filter(Boolean)}}))}}(e),p=[],h=u.images.filter((function(e){return!e.hashes})).map((function(e){return j(j({},e),{},{inRepo:[t.images.find((function(t){return t.name.substr(0,40)===e.hash}))].filter(Boolean)})})),y=h.length,g=u.frames.map((function(e){return j(j({},e),{},{inRepo:[t.frames.find((function(t){return t.name.match(/^[a-z]+[0-9]+/gi)[0]===e.id}))].filter(Boolean)})})),b=g.length;return Promise.all([].concat(m(h.map((function(e,t){return e.inRepo.length?j(j({},e),{},{inRepo:e.inRepo,files:[]}):r("loadImageTiles (".concat(t+1,"/").concat(y,") ").concat(e.title),3,(function(){return(0,n.Z)(u)(e,!0).then((function(t){return t.length?d((0,s.Z)(u,e),e)(t).then((function(t){return j(j({},e),{},{files:t})})):(p.push(e.hash),Promise.resolve(null))}))}))}))),m(g.map((function(e,t){return e.inRepo.length?j(j({},e),{},{inRepo:e.inRepo,files:[]}):r("loadFrameData (".concat(t+1,"/").concat(b,") ").concat(e.id),3,(function(){return(0,a.v)(e.id).then((function(t){return j(j({},e),{},{hash:e.id,files:[{folder:"frames",filename:"",blob:new Blob(new Array(JSON.stringify(t||"{}",null,2)),{type:"application/json"}),title:e.name}]})}))}))}))))).then((function(e){return f(e.filter(Boolean))})).then((function(e){var r=e.toUpload,o=e.toKeep;return function(e,t,r,o){var n=e.images,s=e.frames;return{upload:t.filter((function(e){var t=e.destination;return!n.find((function(e){return e.path===t}))&&!s.find((function(e){return e.path===t}))})),del:[].concat(i(i(n).filter((function(e){var n=e.path;return!r.find((function(e){var t=e.destination;return n===t}))&&!t.find((function(e){var t=e.destination;return n===t}))&&!o.find((function(e){return n.indexOf(e)>=-1}))}))),i(i(s).filter((function(e){var o=e.path;return!r.find((function(e){var t=e.destination;return o===t}))&&!t.find((function(e){var t=e.destination;return o===t}))}))))}}(t,r,o,p)}))}},"./src/javascript/tools/saveLocalStorageItems/index.js":function(e,t,r){"use strict";r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.promise.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.array.join.js"),r("./node_modules/core-js/modules/es.array.fill.js"),r("./node_modules/core-js/modules/es.array.flat.js"),r("./node_modules/core-js/modules/es.array.is-array.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.function.name.js");var o=r("./src/javascript/tools/storage/index.js"),n=r("./src/javascript/tools/applyFrame/frameData.js");function s(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}t.Z=function(e){var t=e.images,r=e.frames,a=t.length,i=r.length;return Promise.all([].concat(s(t.map((function(e,t){return(0,o.zD)(e.hash,null,!0).then((function(r){return r.length?e.hash:e.getFileContent(e.sha,t,a).then((function(e){var t=e.split("\n").filter((function(e){return e.match(/^[0-9a-f ]+$/gi)}));return(0,o.a1)(t)}))}))}))),s(r.map((function(e,t){return(0,n.v)(e.id).then((function(r){return r?e.id:e.getFileContent(e.sha,t,i).then((function(t){var r=JSON.parse(t,null,2),o=Array(32).fill("f").join(""),a=Array(16).fill(o),i=[].concat(s(r.upper),s(Array(14).fill().map((function(e,t){return[].concat(s(r.left[t]),s(a),s(r.right[t]))})).flat()),s(r.lower));return(0,n.e)(e.id,i)}))}))})))))}}}]);
//# sourceMappingURL=gmw.js.map